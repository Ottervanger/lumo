!function(t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).lumo=t()}(function(){return function r(o,i,u){function a(e,t){if(!i[e]){if(!o[e]){var n="function"==typeof require&&require;if(!t&&n)return n(e,!0);if(s)return s(e,!0);throw(n=new Error("Cannot find module '"+e+"'")).code="MODULE_NOT_FOUND",n}n=i[e]={exports:{}},o[e][0].call(n.exports,function(t){return a(o[e][1][t]||t)},n,n.exports,r,o,i,u)}return i[e].exports}for(var s="function"==typeof require&&require,t=0;t<u.length;t++)a(u[t]);return a}({1:[function(t,e,n){"use strict";function r(t,e,n){n=n||2;var r,o,i,u,a,s,c,l=e&&e.length,f=l?e[0]*n:t.length,h=v(t,0,f,n,!0),p=[];if(!h||h.next===h.prev)return p;if(l&&(h=function(t,e,n,r){var o,i,u,a,s=[];for(o=0,i=e.length;o<i;o++)u=e[o]*r,a=o<i-1?e[o+1]*r:t.length,(a=v(t,u,a,r,!1))===a.next&&(a.steiner=!0),s.push(function(t){var e=t,n=t;for(;(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next,e!==t;);return n}(a));for(s.sort(b),o=0;o<s.length;o++)!function(t,e){(e=function(t,e){var n,r=e,o=t.x,i=t.y,u=-1/0;do{if(i<=r.y&&i>=r.next.y&&r.next.y!==r.y){var a=r.x+(i-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(a<=o&&u<a){if((u=a)===o){if(i===r.y)return r;if(i===r.next.y)return r.next}n=r.x<r.next.x?r:r.next}}}while(r=r.next,r!==e);if(!n)return null;if(o===u)return n;var s,c=n,l=n.x,f=n.y,h=1/0;r=n;for(;o>=r.x&&r.x>=l&&o!==r.x&&x(i<f?o:u,i,l,f,i<f?u:o,i,r.x,r.y)&&(s=Math.abs(i-r.y)/(o-r.x),w(r,t)&&(s<h||s===h&&(r.x>n.x||r.x===n.x&&function(t,e){return _(t.prev,t,e.prev)<0&&_(e.next,t,t.next)<0}(n,r)))&&(n=r,h=s)),r=r.next,r!==c;);return n}(t,e))&&(t=O(e,t),d(e,e.next),d(t,t.next))}(s[o],n),n=d(n,n.next);return n}(t,e,h,n)),t.length>80*n){r=i=t[0],o=u=t[1];for(var y=n;y<f;y+=n)(a=t[y])<r&&(r=a),(s=t[y+1])<o&&(o=s),i<a&&(i=a),u<s&&(u=s);c=0!==(c=Math.max(i-r,u-o))?1/c:0}return m(h,p,n,r,o,c),p}function v(t,e,n,r,o){var i,u;if(o===0<E(t,e,n,r))for(i=e;i<n;i+=r)u=a(i,t[i],t[i+1],u);else for(i=n-r;e<=i;i-=r)u=a(i,t[i],t[i+1],u);return u&&l(u,u.next)&&(h(u),u=u.next),u}function d(t,e){if(!t)return t;e=e||t;var n,r=t;do{if(n=!1,r.steiner||!l(r,r.next)&&0!==_(r.prev,r,r.next))r=r.next;else{if(h(r),(r=e=r.prev)===r.next)break;n=!0}}while(n||r!==e);return e}function m(t,e,n,r,o,i,u){if(t){!u&&i&&function(t,e,n,r){for(var o=t;null===o.z&&(o.z=g(o.x,o.y,e,n,r)),o.prevZ=o.prev,o.nextZ=o.next,o=o.next,o!==t;);o.prevZ.nextZ=null,o.prevZ=null,function(t){var e,n,r,o,i,u,a,s,c=1;do{for(n=t,i=t=null,u=0;n;){for(u++,r=n,e=a=0;e<c&&(a++,r=r.nextZ);e++);for(s=c;0<a||0<s&&r;)0!==a&&(0===s||!r||n.z<=r.z)?(n=(o=n).nextZ,a--):(r=(o=r).nextZ,s--),i?i.nextZ=o:t=o,o.prevZ=i,i=o;n=r}}while(i.nextZ=null,c*=2,1<u)}(o)}(t,r,o,i);for(var a,s,c=t;t.prev!==t.next;)if(a=t.prev,s=t.next,i?function(t,e,n,r){var o=t.prev,i=t,u=t.next;if(0<=_(o,i,u))return!1;var a=(o.x<i.x?o.x<u.x?o:u:i.x<u.x?i:u).x,s=(o.y<i.y?o.y<u.y?o:u:i.y<u.y?i:u).y,c=(o.x>i.x?o.x>u.x?o:u:i.x>u.x?i:u).x,l=(o.y>i.y?o.y>u.y?o:u:i.y>u.y?i:u).y,f=g(a,s,e,n,r),h=g(c,l,e,n,r),p=t.prevZ,y=t.nextZ;for(;p&&p.z>=f&&y&&y.z<=h;){if(p!==t.prev&&p!==t.next&&x(o.x,o.y,i.x,i.y,u.x,u.y,p.x,p.y)&&0<=_(p.prev,p,p.next))return!1;if(p=p.prevZ,y!==t.prev&&y!==t.next&&x(o.x,o.y,i.x,i.y,u.x,u.y,y.x,y.y)&&0<=_(y.prev,y,y.next))return!1;y=y.nextZ}for(;p&&p.z>=f;){if(p!==t.prev&&p!==t.next&&x(o.x,o.y,i.x,i.y,u.x,u.y,p.x,p.y)&&0<=_(p.prev,p,p.next))return!1;p=p.prevZ}for(;y&&y.z<=h;){if(y!==t.prev&&y!==t.next&&x(o.x,o.y,i.x,i.y,u.x,u.y,y.x,y.y)&&0<=_(y.prev,y,y.next))return!1;y=y.nextZ}return!0}(t,r,o,i):function(t){var e=t.prev,n=t,r=t.next;if(0<=_(e,n,r))return!1;var o=t.next.next;for(;o!==t.prev;){if(x(e.x,e.y,n.x,n.y,r.x,r.y,o.x,o.y)&&0<=_(o.prev,o,o.next))return!1;o=o.next}return!0}(t))e.push(a.i/n),e.push(t.i/n),e.push(s.i/n),h(t),t=s.next,c=s.next;else if((t=s)===c){u?1===u?m(t=function(t,e,n){var r=t;do{var o=r.prev,i=r.next.next}while(!l(o,i)&&f(o,r,r.next,i)&&w(o,i)&&w(i,o)&&(e.push(o.i/n),e.push(r.i/n),e.push(i.i/n),h(r),h(r.next),r=t=i),r=r.next,r!==t);return d(r)}(d(t),e,n),e,n,r,o,i,2):2===u&&function(t,e,n,r,o,i){var u=t;do{for(var a=u.next.next;a!==u.prev;){if(u.i!==a.i&&function(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){var n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&f(n,n.next,t,e))return!0}while(n=n.next,n!==t);return!1}(t,e)&&(w(t,e)&&w(e,t)&&function(t,e){var n=t,r=!1,o=(t.x+e.x)/2,i=(t.y+e.y)/2;for(;n.y>i!=n.next.y>i&&n.next.y!==n.y&&o<(n.next.x-n.x)*(i-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next,n!==t;);return r}(t,e)&&(_(t.prev,t,e.prev)||_(t,e.prev,e))||l(t,e)&&0<_(t.prev,t,t.next)&&0<_(e.prev,e,e.next))}(u,a)){var s=O(u,a);return u=d(u,u.next),s=d(s,s.next),m(u,e,n,r,o,i),m(s,e,n,r,o,i)}a=a.next}}while((u=u.next)!==t)}(t,e,n,r,o,i):m(d(t),e,n,r,o,i,1);break}}}function b(t,e){return t.x-e.x}function g(t,e,n,r,o){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-n)*o)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-r)*o)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function x(t,e,n,r,o,i,u,a){return 0<=(o-u)*(e-a)-(t-u)*(i-a)&&0<=(t-u)*(r-a)-(n-u)*(e-a)&&0<=(n-u)*(i-a)-(o-u)*(r-a)}function _(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function l(t,e){return t.x===e.x&&t.y===e.y}function f(t,e,n,r){var o=c(_(t,e,n)),i=c(_(t,e,r)),u=c(_(n,r,t)),a=c(_(n,r,e));return o!==i&&u!==a||(0===o&&s(t,n,e)||(0===i&&s(t,r,e)||(0===u&&s(n,t,r)||!(0!==a||!s(n,e,r)))))}function s(t,e,n){return e.x<=Math.max(t.x,n.x)&&e.x>=Math.min(t.x,n.x)&&e.y<=Math.max(t.y,n.y)&&e.y>=Math.min(t.y,n.y)}function c(t){return 0<t?1:t<0?-1:0}function w(t,e){return _(t.prev,t,t.next)<0?0<=_(t,e,t.next)&&0<=_(t,t.prev,e):_(t,e,t.prev)<0||_(t,t.next,e)<0}function O(t,e){var n=new u(t.i,t.x,t.y),r=new u(e.i,e.x,e.y),o=t.next,i=e.prev;return(t.next=e).prev=t,(n.next=o).prev=n,(r.next=n).prev=r,(i.next=r).prev=i,r}function a(t,e,n,r){n=new u(t,e,n);return r?(n.next=r.next,(n.prev=r).next.prev=n,r.next=n):(n.prev=n).next=n,n}function h(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function u(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function E(t,e,n,r){for(var o=0,i=e,u=n-r;i<n;i+=r)o+=(t[u]-t[i])*(t[i+1]+t[u+1]),u=i;return o}e.exports=r,(e.exports.default=r).deviation=function(t,e,n,r){var o=e&&e.length,i=o?e[0]*n:t.length,u=Math.abs(E(t,0,i,n));if(o)for(var a=0,s=e.length;a<s;a++){var c=e[a]*n,l=a<s-1?e[a+1]*n:t.length;u-=Math.abs(E(t,c,l,n))}for(var f=0,a=0;a<r.length;a+=3){var h=r[a]*n,p=r[a+1]*n,y=r[a+2]*n;f+=Math.abs((t[h]-t[y])*(t[1+p]-t[1+h])-(t[h]-t[p])*(t[1+y]-t[1+h]))}return 0===u&&0===f?0:Math.abs((f-u)/u)},r.flatten=function(t){for(var e=t[0][0].length,n={vertices:[],holes:[],dimensions:e},r=0,o=0;o<t.length;o++){for(var i=0;i<t[o].length;i++)for(var u=0;u<e;u++)n.vertices.push(t[o][i][u]);0<o&&(r+=t[o-1].length,n.holes.push(r))}return n}},{}],2:[function(t,e,n){"use strict";function u(t){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var a=Object.create||function(t){function e(){}return e.prototype=t,new e},s=Object.keys||function(t){var e,n=[];for(e in t)Object.prototype.hasOwnProperty.call(t,e)&&n.push(e);return e},r=Function.prototype.bind||function(t){var e=this;return function(){return e.apply(t,arguments)}};function o(){this._events&&Object.prototype.hasOwnProperty.call(this,"_events")||(this._events=a(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0}((e.exports=o).EventEmitter=o).prototype._events=void 0,o.prototype._maxListeners=void 0;var i,c=10;try{var l={};Object.defineProperty&&Object.defineProperty(l,"x",{value:0}),i=0===l.x}catch(t){i=!1}function f(t){return void 0===t._maxListeners?o.defaultMaxListeners:t._maxListeners}function h(t,e,n,r){var o,i;if("function"!=typeof n)throw new TypeError('"listener" argument must be a function');return(o=t._events)?(o.newListener&&(t.emit("newListener",e,n.listener||n),o=t._events),i=o[e]):(o=t._events=a(null),t._eventsCount=0),i?("function"==typeof i?i=o[e]=r?[n,i]:[i,n]:r?i.unshift(n):i.push(n),i.warned||(r=f(t))&&0<r&&i.length>r&&(i.warned=!0,(r=new Error("Possible EventEmitter memory leak detected. "+i.length+' "'+String(e)+'" listeners added. Use emitter.setMaxListeners() to increase limit.')).name="MaxListenersExceededWarning",r.emitter=t,r.type=e,r.count=i.length,"object"===("undefined"==typeof console?"undefined":u(console))&&console.warn&&console.warn("%s: %s",r.name,r.message))):(i=o[e]=n,++t._eventsCount),t}function p(){if(!this.fired)switch(this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length){case 0:return this.listener.call(this.target);case 1:return this.listener.call(this.target,arguments[0]);case 2:return this.listener.call(this.target,arguments[0],arguments[1]);case 3:return this.listener.call(this.target,arguments[0],arguments[1],arguments[2]);default:for(var t=new Array(arguments.length),e=0;e<t.length;++e)t[e]=arguments[e];this.listener.apply(this.target,t)}}function y(t,e,n){t={fired:!1,wrapFn:void 0,target:t,type:e,listener:n},e=r.call(p,t);return e.listener=n,t.wrapFn=e}function v(t,e,n){t=t._events;if(!t)return[];e=t[e];return e?"function"==typeof e?n?[e.listener||e]:[e]:n?function(t){for(var e=new Array(t.length),n=0;n<e.length;++n)e[n]=t[n].listener||t[n];return e}(e):m(e,e.length):[]}function d(t){var e=this._events;if(e){t=e[t];if("function"==typeof t)return 1;if(t)return t.length}return 0}function m(t,e){for(var n=new Array(e),r=0;r<e;++r)n[r]=t[r];return n}i?Object.defineProperty(o,"defaultMaxListeners",{enumerable:!0,get:function(){return c},set:function(t){if("number"!=typeof t||t<0||t!=t)throw new TypeError('"defaultMaxListeners" must be a positive number');c=t}}):o.defaultMaxListeners=c,o.prototype.setMaxListeners=function(t){if("number"!=typeof t||t<0||isNaN(t))throw new TypeError('"n" argument must be a positive number');return this._maxListeners=t,this},o.prototype.getMaxListeners=function(){return f(this)},o.prototype.emit=function(t){var e,n,r,o,i="error"===t,u=this._events;if(u)i=i&&null==u.error;else if(!i)return!1;if(i){if(1<arguments.length&&(e=arguments[1]),e instanceof Error)throw e;i=new Error('Unhandled "error" event. ('+e+")");throw i.context=e,i}if(!(n=u[t]))return!1;var a,s="function"==typeof n;switch(a=arguments.length){case 1:!function(t,e){if(s)t.call(e);else for(var n=t.length,r=m(t,n),o=0;o<n;++o)r[o].call(e)}(n,this);break;case 2:!function(t,e,n,r){if(e)t.call(n,r);else for(var o=t.length,i=m(t,o),u=0;u<o;++u)i[u].call(n,r)}(n,s,this,arguments[1]);break;case 3:!function(t,e,n,r,o){if(e)t.call(n,r,o);else for(var i=t.length,u=m(t,i),a=0;a<i;++a)u[a].call(n,r,o)}(n,s,this,arguments[1],arguments[2]);break;case 4:!function(t,e,n,r,o,i){if(e)t.call(n,r,o,i);else for(var u=t.length,a=m(t,u),s=0;s<u;++s)a[s].call(n,r,o,i)}(n,s,this,arguments[1],arguments[2],arguments[3]);break;default:for(r=new Array(a-1),o=1;o<a;o++)r[o-1]=arguments[o];!function(t,e,n){if(s)t.apply(e,n);else for(var r=t.length,o=m(t,r),i=0;i<r;++i)o[i].apply(e,n)}(n,this,r)}return!0},o.prototype.on=o.prototype.addListener=function(t,e){return h(this,t,e,!1)},o.prototype.prependListener=function(t,e){return h(this,t,e,!0)},o.prototype.once=function(t,e){if("function"!=typeof e)throw new TypeError('"listener" argument must be a function');return this.on(t,y(this,t,e)),this},o.prototype.prependOnceListener=function(t,e){if("function"!=typeof e)throw new TypeError('"listener" argument must be a function');return this.prependListener(t,y(this,t,e)),this},o.prototype.removeListener=function(t,e){var n,r,o,i,u;if("function"!=typeof e)throw new TypeError('"listener" argument must be a function');if(!(r=this._events))return this;if(!(n=r[t]))return this;if(n===e||n.listener===e)0==--this._eventsCount?this._events=a(null):(delete r[t],r.removeListener&&this.emit("removeListener",t,n.listener||e));else if("function"!=typeof n){for(o=-1,i=n.length-1;0<=i;i--)if(n[i]===e||n[i].listener===e){u=n[i].listener,o=i;break}if(o<0)return this;0===o?n.shift():function(t){for(var e=o,n=e+1,r=t.length;n<r;e+=1,n+=1)t[e]=t[n];t.pop()}(n),1===n.length&&(r[t]=n[0]),r.removeListener&&this.emit("removeListener",t,u||e)}return this},o.prototype.removeAllListeners=function(t){var e,n=this._events;if(!n)return this;if(!n.removeListener)return 0===arguments.length?(this._events=a(null),this._eventsCount=0):n[t]&&(0==--this._eventsCount?this._events=a(null):delete n[t]),this;if(0===arguments.length){for(var r,o=s(n),i=0;i<o.length;++i)"removeListener"!==(r=o[i])&&this.removeAllListeners(r);return this.removeAllListeners("removeListener"),this._events=a(null),this._eventsCount=0,this}if("function"==typeof(e=n[t]))this.removeListener(t,e);else if(e)for(i=e.length-1;0<=i;i--)this.removeListener(t,e[i]);return this},o.prototype.listeners=function(t){return v(this,t,!0)},o.prototype.rawListeners=function(t){return v(this,t,!1)},o.listenerCount=function(t,e){return"function"==typeof t.listenerCount?t.listenerCount(e):d.call(t,e)},o.prototype.listenerCount=d,o.prototype.eventNames=function(){return 0<this._eventsCount?Reflect.ownKeys(this._events):[]}},{}],3:[function(t,e,n){"use strict";t=t("./_getNative")(t("./_root"),"DataView");e.exports=t},{"./_getNative":59,"./_root":95}],4:[function(t,e,n){"use strict";var r=t("./_hashClear"),o=t("./_hashDelete"),i=t("./_hashGet"),u=t("./_hashHas"),t=t("./_hashSet");function a(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}a.prototype.clear=r,a.prototype.delete=o,a.prototype.get=i,a.prototype.has=u,a.prototype.set=t,e.exports=a},{"./_hashClear":65,"./_hashDelete":66,"./_hashGet":67,"./_hashHas":68,"./_hashSet":69}],5:[function(t,e,n){"use strict";var r=t("./_listCacheClear"),o=t("./_listCacheDelete"),i=t("./_listCacheGet"),u=t("./_listCacheHas"),t=t("./_listCacheSet");function a(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}a.prototype.clear=r,a.prototype.delete=o,a.prototype.get=i,a.prototype.has=u,a.prototype.set=t,e.exports=a},{"./_listCacheClear":76,"./_listCacheDelete":77,"./_listCacheGet":78,"./_listCacheHas":79,"./_listCacheSet":80}],6:[function(t,e,n){"use strict";t=t("./_getNative")(t("./_root"),"Map");e.exports=t},{"./_getNative":59,"./_root":95}],7:[function(t,e,n){"use strict";var r=t("./_mapCacheClear"),o=t("./_mapCacheDelete"),i=t("./_mapCacheGet"),u=t("./_mapCacheHas"),t=t("./_mapCacheSet");function a(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}a.prototype.clear=r,a.prototype.delete=o,a.prototype.get=i,a.prototype.has=u,a.prototype.set=t,e.exports=a},{"./_mapCacheClear":81,"./_mapCacheDelete":82,"./_mapCacheGet":83,"./_mapCacheHas":84,"./_mapCacheSet":85}],8:[function(t,e,n){"use strict";t=t("./_getNative")(t("./_root"),"Promise");e.exports=t},{"./_getNative":59,"./_root":95}],9:[function(t,e,n){"use strict";t=t("./_getNative")(t("./_root"),"Set");e.exports=t},{"./_getNative":59,"./_root":95}],10:[function(t,e,n){"use strict";var r=t("./_MapCache"),o=t("./_setCacheAdd"),t=t("./_setCacheHas");function i(t){var e=-1,n=null==t?0:t.length;for(this.__data__=new r;++e<n;)this.add(t[e])}i.prototype.add=i.prototype.push=o,i.prototype.has=t,e.exports=i},{"./_MapCache":7,"./_setCacheAdd":96,"./_setCacheHas":97}],11:[function(t,e,n){"use strict";var r=t("./_ListCache"),o=t("./_stackClear"),i=t("./_stackDelete"),u=t("./_stackGet"),a=t("./_stackHas"),t=t("./_stackSet");function s(t){t=this.__data__=new r(t);this.size=t.size}s.prototype.clear=o,s.prototype.delete=i,s.prototype.get=u,s.prototype.has=a,s.prototype.set=t,e.exports=s},{"./_ListCache":5,"./_stackClear":99,"./_stackDelete":100,"./_stackGet":101,"./_stackHas":102,"./_stackSet":103}],12:[function(t,e,n){"use strict";t=t("./_root").Symbol;e.exports=t},{"./_root":95}],13:[function(t,e,n){"use strict";t=t("./_root").Uint8Array;e.exports=t},{"./_root":95}],14:[function(t,e,n){"use strict";t=t("./_getNative")(t("./_root"),"WeakMap");e.exports=t},{"./_getNative":59,"./_root":95}],15:[function(t,e,n){"use strict";e.exports=function(t,e){for(var n=-1,r=null==t?0:t.length,o=0,i=[];++n<r;){var u=t[n];e(u,n,t)&&(i[o++]=u)}return i}},{}],16:[function(t,e,n){"use strict";var l=t("./_baseTimes"),f=t("./isArguments"),h=t("./isArray"),p=t("./isBuffer"),y=t("./_isIndex"),v=t("./isTypedArray"),d=Object.prototype.hasOwnProperty;e.exports=function(t,e){var n,r=h(t),o=!r&&f(t),i=!r&&!o&&p(t),u=!r&&!o&&!i&&v(t),a=r||o||i||u,s=a?l(t.length,String):[],c=s.length;for(n in t)!e&&!d.call(t,n)||a&&("length"==n||i&&("offset"==n||"parent"==n)||u&&("buffer"==n||"byteLength"==n||"byteOffset"==n)||y(n,c))||s.push(n);return s}},{"./_baseTimes":43,"./_isIndex":70,"./isArguments":115,"./isArray":116,"./isBuffer":118,"./isTypedArray":124}],17:[function(t,e,n){"use strict";e.exports=function(t,e){for(var n=-1,r=null==t?0:t.length,o=Array(r);++n<r;)o[n]=e(t[n],n,t);return o}},{}],18:[function(t,e,n){"use strict";e.exports=function(t,e){for(var n=-1,r=e.length,o=t.length;++n<r;)t[o+n]=e[n];return t}},{}],19:[function(t,e,n){"use strict";e.exports=function(t,e){for(var n=-1,r=null==t?0:t.length;++n<r;)if(e(t[n],n,t))return!0;return!1}},{}],20:[function(t,e,n){"use strict";var r=t("./eq");e.exports=function(t,e){for(var n=t.length;n--;)if(r(t[n][0],e))return n;return-1}},{"./eq":110}],21:[function(t,e,n){"use strict";e.exports=function(t,e,n){return t==t&&(void 0!==n&&(t=t<=n?t:n),void 0!==e&&(t=e<=t?t:e)),t}},{}],22:[function(t,e,n){"use strict";var r=t("./_baseForOwn"),r=t("./_createBaseEach")(r);e.exports=r},{"./_baseForOwn":24,"./_createBaseEach":50}],23:[function(t,e,n){"use strict";t=t("./_createBaseFor")();e.exports=t},{"./_createBaseFor":51}],24:[function(t,e,n){"use strict";var r=t("./_baseFor"),o=t("./keys");e.exports=function(t,e){return t&&r(t,e,o)}},{"./_baseFor":23,"./keys":125}],25:[function(t,e,n){"use strict";var o=t("./_castPath"),i=t("./_toKey");e.exports=function(t,e){for(var n=0,r=(e=o(e,t)).length;null!=t&&n<r;)t=t[i(e[n++])];return n&&n==r?t:void 0}},{"./_castPath":48,"./_toKey":105}],26:[function(t,e,n){"use strict";var r=t("./_arrayPush"),o=t("./isArray");e.exports=function(t,e,n){return e=e(t),o(t)?e:r(e,n(t))}},{"./_arrayPush":18,"./isArray":116}],27:[function(t,e,n){"use strict";var r=t("./_Symbol"),o=t("./_getRawTag"),i=t("./_objectToString"),u=r?r.toStringTag:void 0;e.exports=function(t){return null==t?void 0===t?"[object Undefined]":"[object Null]":(u&&u in Object(t)?o:i)(t)}},{"./_Symbol":12,"./_getRawTag":60,"./_objectToString":93}],28:[function(t,e,n){"use strict";e.exports=function(t,e){return null!=t&&e in Object(t)}},{}],29:[function(t,e,n){"use strict";var r=t("./_baseGetTag"),o=t("./isObjectLike");e.exports=function(t){return o(t)&&"[object Arguments]"==r(t)}},{"./_baseGetTag":27,"./isObjectLike":122}],30:[function(t,e,n){"use strict";var u=t("./_baseIsEqualDeep"),a=t("./isObjectLike");e.exports=function t(e,n,r,o,i){return e===n||(null==e||null==n||!a(e)&&!a(n)?e!=e&&n!=n:u(e,n,r,o,t,i))}},{"./_baseIsEqualDeep":31,"./isObjectLike":122}],31:[function(t,e,n){"use strict";var f=t("./_Stack"),h=t("./_equalArrays"),p=t("./_equalByTag"),y=t("./_equalObjects"),v=t("./_getTag"),d=t("./isArray"),m=t("./isBuffer"),b=t("./isTypedArray"),g="[object Arguments]",x="[object Array]",_="[object Object]",w=Object.prototype.hasOwnProperty;e.exports=function(t,e,n,r,o,i){var u=d(t),a=d(e),s=u?x:v(t),c=a?x:v(e),l=(s=s==g?_:s)==_,a=(c=c==g?_:c)==_;if((c=s==c)&&m(t)){if(!m(e))return!1;l=!(u=!0)}if(c&&!l)return i=i||new f,u||b(t)?h(t,e,n,r,o,i):p(t,e,s,n,r,o,i);if(!(1&n)){l=l&&w.call(t,"__wrapped__"),a=a&&w.call(e,"__wrapped__");if(l||a)return o(l?t.value():t,a?e.value():e,n,r,i=i||new f)}return!!c&&(i=i||new f,y(t,e,n,r,o,i))}},{"./_Stack":11,"./_equalArrays":52,"./_equalByTag":53,"./_equalObjects":54,"./_getTag":62,"./isArray":116,"./isBuffer":118,"./isTypedArray":124}],32:[function(t,e,n){"use strict";var p=t("./_Stack"),y=t("./_baseIsEqual");e.exports=function(t,e,n,r){var o=n.length,i=o,u=!r;if(null==t)return!i;for(t=Object(t);o--;){var a=n[o];if(u&&a[2]?a[1]!==t[a[0]]:!(a[0]in t))return!1}for(;++o<i;){var s=(a=n[o])[0],c=t[s],l=a[1];if(u&&a[2]){if(void 0===c&&!(s in t))return!1}else{var f,h=new p;if(r&&(f=r(c,l,s,t,e,h)),!(void 0===f?y(l,c,3,r,h):f))return!1}}return!0}},{"./_Stack":11,"./_baseIsEqual":30}],33:[function(t,e,n){"use strict";var r=t("./isFunction"),o=t("./_isMasked"),i=t("./isObject"),u=t("./_toSource"),a=/^\[object .+?Constructor\]$/,s=Function.prototype,t=Object.prototype,s=s.toString,t=t.hasOwnProperty,c=RegExp("^"+s.call(t).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");e.exports=function(t){return!(!i(t)||o(t))&&(r(t)?c:a).test(u(t))}},{"./_isMasked":73,"./_toSource":106,"./isFunction":119,"./isObject":121}],34:[function(t,e,n){"use strict";var r=t("./_baseGetTag"),o=t("./isLength"),i=t("./isObjectLike"),u={};u["[object Float32Array]"]=u["[object Float64Array]"]=u["[object Int8Array]"]=u["[object Int16Array]"]=u["[object Int32Array]"]=u["[object Uint8Array]"]=u["[object Uint8ClampedArray]"]=u["[object Uint16Array]"]=u["[object Uint32Array]"]=!0,u["[object Arguments]"]=u["[object Array]"]=u["[object ArrayBuffer]"]=u["[object Boolean]"]=u["[object DataView]"]=u["[object Date]"]=u["[object Error]"]=u["[object Function]"]=u["[object Map]"]=u["[object Number]"]=u["[object Object]"]=u["[object RegExp]"]=u["[object Set]"]=u["[object String]"]=u["[object WeakMap]"]=!1,e.exports=function(t){return i(t)&&o(t.length)&&!!u[r(t)]}},{"./_baseGetTag":27,"./isLength":120,"./isObjectLike":122}],35:[function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var o=t("./_baseMatches"),i=t("./_baseMatchesProperty"),u=t("./identity"),a=t("./isArray"),s=t("./property");e.exports=function(t){return"function"==typeof t?t:null==t?u:"object"==r(t)?a(t)?i(t[0],t[1]):o(t):s(t)}},{"./_baseMatches":39,"./_baseMatchesProperty":40,"./identity":114,"./isArray":116,"./property":130}],36:[function(t,e,n){"use strict";var r=t("./_isPrototype"),o=t("./_nativeKeys"),i=Object.prototype.hasOwnProperty;e.exports=function(t){if(!r(t))return o(t);var e,n=[];for(e in Object(t))i.call(t,e)&&"constructor"!=e&&n.push(e);return n}},{"./_isPrototype":74,"./_nativeKeys":90}],37:[function(t,e,n){"use strict";var o=t("./isObject"),i=t("./_isPrototype"),u=t("./_nativeKeysIn"),a=Object.prototype.hasOwnProperty;e.exports=function(t){if(!o(t))return u(t);var e,n=i(t),r=[];for(e in t)("constructor"!=e||!n&&a.call(t,e))&&r.push(e);return r}},{"./_isPrototype":74,"./_nativeKeysIn":91,"./isObject":121}],38:[function(t,e,n){"use strict";var u=t("./_baseEach"),a=t("./isArrayLike");e.exports=function(t,r){var o=-1,i=a(t)?Array(t.length):[];return u(t,function(t,e,n){i[++o]=r(t,e,n)}),i}},{"./_baseEach":22,"./isArrayLike":117}],39:[function(t,e,n){"use strict";var r=t("./_baseIsMatch"),o=t("./_getMatchData"),i=t("./_matchesStrictComparable");e.exports=function(e){var n=o(e);return 1==n.length&&n[0][2]?i(n[0][0],n[0][1]):function(t){return t===e||r(t,e,n)}}},{"./_baseIsMatch":32,"./_getMatchData":58,"./_matchesStrictComparable":87}],40:[function(t,e,n){"use strict";var o=t("./_baseIsEqual"),i=t("./get"),u=t("./hasIn"),a=t("./_isKey"),s=t("./_isStrictComparable"),c=t("./_matchesStrictComparable"),l=t("./_toKey");e.exports=function(n,r){return a(n)&&s(r)?c(l(n),r):function(t){var e=i(t,n);return void 0===e&&e===r?u(t,n):o(r,e,3)}}},{"./_baseIsEqual":30,"./_isKey":71,"./_isStrictComparable":75,"./_matchesStrictComparable":87,"./_toKey":105,"./get":112,"./hasIn":113}],41:[function(t,e,n){"use strict";e.exports=function(e){return function(t){return null==t?void 0:t[e]}}},{}],42:[function(t,e,n){"use strict";var r=t("./_baseGet");e.exports=function(e){return function(t){return r(t,e)}}},{"./_baseGet":25}],43:[function(t,e,n){"use strict";e.exports=function(t,e){for(var n=-1,r=Array(t);++n<t;)r[n]=e(n);return r}},{}],44:[function(t,e,n){"use strict";var r=t("./_Symbol"),o=t("./_arrayMap"),i=t("./isArray"),u=t("./isSymbol"),a=1/0,r=r?r.prototype:void 0,s=r?r.toString:void 0;e.exports=function t(e){if("string"==typeof e)return e;if(i(e))return o(e,t)+"";if(u(e))return s?s.call(e):"";var n=e+"";return"0"==n&&1/e==-a?"-0":n}},{"./_Symbol":12,"./_arrayMap":17,"./isArray":116,"./isSymbol":123}],45:[function(t,e,n){"use strict";e.exports=function(e){return function(t){return e(t)}}},{}],46:[function(t,e,n){"use strict";e.exports=function(t,e){return t.has(e)}},{}],47:[function(t,e,n){"use strict";var r=t("./identity");e.exports=function(t){return"function"==typeof t?t:r}},{"./identity":114}],48:[function(t,e,n){"use strict";var r=t("./isArray"),o=t("./_isKey"),i=t("./_stringToPath"),u=t("./toString");e.exports=function(t,e){return r(t)?t:o(t,e)?[t]:i(u(t))}},{"./_isKey":71,"./_stringToPath":104,"./isArray":116,"./toString":135}],49:[function(t,e,n){"use strict";t=t("./_root")["__core-js_shared__"];e.exports=t},{"./_root":95}],50:[function(t,e,n){"use strict";var a=t("./isArrayLike");e.exports=function(i,u){return function(t,e){if(null==t)return t;if(!a(t))return i(t,e);for(var n=t.length,r=u?n:-1,o=Object(t);(u?r--:++r<n)&&!1!==e(o[r],r,o););return t}}},{"./isArrayLike":117}],51:[function(t,e,n){"use strict";e.exports=function(s){return function(t,e,n){for(var r=-1,o=Object(t),i=n(t),u=i.length;u--;){var a=i[s?u:++r];if(!1===e(o[a],a,o))break}return t}}},{}],52:[function(t,e,n){"use strict";var d=t("./_SetCache"),m=t("./_arraySome"),b=t("./_cacheHas");e.exports=function(t,e,n,r,o,i){var u=1&n,a=t.length,s=e.length;if(a!=s&&!(u&&a<s))return!1;var c=i.get(t),s=i.get(e);if(c&&s)return c==e&&s==t;var l=-1,f=!0,h=2&n?new d:void 0;for(i.set(t,e),i.set(e,t);++l<a;){var p,y=t[l],v=e[l];if(r&&(p=u?r(v,y,l,e,t,i):r(y,v,l,t,e,i)),void 0!==p){if(p)continue;f=!1;break}if(h){if(!m(e,function(t,e){if(!b(h,e)&&(y===t||o(y,t,n,r,i)))return h.push(e)})){f=!1;break}}else if(y!==v&&!o(y,v,n,r,i)){f=!1;break}}return i.delete(t),i.delete(e),f}},{"./_SetCache":10,"./_arraySome":19,"./_cacheHas":46}],53:[function(t,e,n){"use strict";var r=t("./_Symbol"),c=t("./_Uint8Array"),l=t("./eq"),f=t("./_equalArrays"),h=t("./_mapToArray"),p=t("./_setToArray"),r=r?r.prototype:void 0,y=r?r.valueOf:void 0;e.exports=function(t,e,n,r,o,i,u){switch(n){case"[object DataView]":if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case"[object ArrayBuffer]":return t.byteLength==e.byteLength&&i(new c(t),new c(e))?!0:!1;case"[object Boolean]":case"[object Date]":case"[object Number]":return l(+t,+e);case"[object Error]":return t.name==e.name&&t.message==e.message;case"[object RegExp]":case"[object String]":return t==e+"";case"[object Map]":var a=h;case"[object Set]":var s=1&r,a=a||p;if(t.size!=e.size&&!s)return!1;s=u.get(t);if(s)return s==e;r|=2,u.set(t,e);a=f(a(t),a(e),r,o,i,u);return u.delete(t),a;case"[object Symbol]":if(y)return y.call(t)==y.call(e)}return!1}},{"./_Symbol":12,"./_Uint8Array":13,"./_equalArrays":52,"./_mapToArray":86,"./_setToArray":98,"./eq":110}],54:[function(t,e,n){"use strict";var b=t("./_getAllKeys"),g=Object.prototype.hasOwnProperty;e.exports=function(t,e,n,r,o,i){var u=1&n,a=b(t),s=a.length;if(s!=b(e).length&&!u)return!1;for(var c=s;c--;){var l=a[c];if(!(u?l in e:g.call(e,l)))return!1}var f=i.get(t),h=i.get(e);if(f&&h)return f==e&&h==t;var p=!0;i.set(t,e),i.set(e,t);for(var y=u;++c<s;){var v,d=t[l=a[c]],m=e[l];if(r&&(v=u?r(m,d,l,e,t,i):r(d,m,l,t,e,i)),!(void 0===v?d===m||o(d,m,n,r,i):v)){p=!1;break}y=y||"constructor"==l}return!p||y||(f=t.constructor)!=(h=e.constructor)&&"constructor"in t&&"constructor"in e&&!("function"==typeof f&&f instanceof f&&"function"==typeof h&&h instanceof h)&&(p=!1),i.delete(t),i.delete(e),p}},{"./_getAllKeys":56}],55:[function(t,r,e){(function(n){(function(){"use strict";function e(t){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var t="object"==(void 0===n?"undefined":e(n))&&n&&n.Object===Object&&n;r.exports=t}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],56:[function(t,e,n){"use strict";var r=t("./_baseGetAllKeys"),o=t("./_getSymbols"),i=t("./keys");e.exports=function(t){return r(t,i,o)}},{"./_baseGetAllKeys":26,"./_getSymbols":61,"./keys":125}],57:[function(t,e,n){"use strict";var r=t("./_isKeyable");e.exports=function(t,e){return t=t.__data__,r(e)?t["string"==typeof e?"string":"hash"]:t.map}},{"./_isKeyable":72}],58:[function(t,e,n){"use strict";var i=t("./_isStrictComparable"),u=t("./keys");e.exports=function(t){for(var e=u(t),n=e.length;n--;){var r=e[n],o=t[r];e[n]=[r,o,i(o)]}return e}},{"./_isStrictComparable":75,"./keys":125}],59:[function(t,e,n){"use strict";var r=t("./_baseIsNative"),o=t("./_getValue");e.exports=function(t,e){return e=o(t,e),r(e)?e:void 0}},{"./_baseIsNative":33,"./_getValue":63}],60:[function(t,e,n){"use strict";var r=t("./_Symbol"),t=Object.prototype,i=t.hasOwnProperty,u=t.toString,a=r?r.toStringTag:void 0;e.exports=function(t){var e=i.call(t,a),n=t[a];try{var r=!(t[a]=void 0)}catch(t){}var o=u.call(t);return r&&(e?t[a]=n:delete t[a]),o}},{"./_Symbol":12}],61:[function(t,e,n){"use strict";var r=t("./_arrayFilter"),t=t("./stubArray"),o=Object.prototype.propertyIsEnumerable,i=Object.getOwnPropertySymbols,t=i?function(e){return null==e?[]:(e=Object(e),r(i(e),function(t){return o.call(e,t)}))}:t;e.exports=t},{"./_arrayFilter":15,"./stubArray":131}],62:[function(t,e,n){"use strict";var r=t("./_DataView"),o=t("./_Map"),i=t("./_Promise"),u=t("./_Set"),a=t("./_WeakMap"),s=t("./_baseGetTag"),c=t("./_toSource"),l="[object Map]",f="[object Promise]",h="[object Set]",p="[object WeakMap]",y="[object DataView]",v=c(r),d=c(o),m=c(i),b=c(u),g=c(a),t=s;(r&&t(new r(new ArrayBuffer(1)))!=y||o&&t(new o)!=l||i&&t(i.resolve())!=f||u&&t(new u)!=h||a&&t(new a)!=p)&&(t=function(t){var e=s(t),t="[object Object]"==e?t.constructor:void 0,t=t?c(t):"";if(t)switch(t){case v:return y;case d:return l;case m:return f;case b:return h;case g:return p}return e}),e.exports=t},{"./_DataView":3,"./_Map":6,"./_Promise":8,"./_Set":9,"./_WeakMap":14,"./_baseGetTag":27,"./_toSource":106}],63:[function(t,e,n){"use strict";e.exports=function(t,e){return null==t?void 0:t[e]}},{}],64:[function(t,e,n){"use strict";var a=t("./_castPath"),s=t("./isArguments"),c=t("./isArray"),l=t("./_isIndex"),f=t("./isLength"),h=t("./_toKey");e.exports=function(t,e,n){for(var r=-1,o=(e=a(e,t)).length,i=!1;++r<o;){var u=h(e[r]);if(!(i=null!=t&&n(t,u)))break;t=t[u]}return i||++r!=o?i:!!(o=null==t?0:t.length)&&f(o)&&l(u,o)&&(c(t)||s(t))}},{"./_castPath":48,"./_isIndex":70,"./_toKey":105,"./isArguments":115,"./isArray":116,"./isLength":120}],65:[function(t,e,n){"use strict";var r=t("./_nativeCreate");e.exports=function(){this.__data__=r?r(null):{},this.size=0}},{"./_nativeCreate":89}],66:[function(t,e,n){"use strict";e.exports=function(t){return t=this.has(t)&&delete this.__data__[t],this.size-=t?1:0,t}},{}],67:[function(t,e,n){"use strict";var r=t("./_nativeCreate"),o=Object.prototype.hasOwnProperty;e.exports=function(t){var e=this.__data__;if(r){var n=e[t];return"__lodash_hash_undefined__"===n?void 0:n}return o.call(e,t)?e[t]:void 0}},{"./_nativeCreate":89}],68:[function(t,e,n){"use strict";var r=t("./_nativeCreate"),o=Object.prototype.hasOwnProperty;e.exports=function(t){var e=this.__data__;return r?void 0!==e[t]:o.call(e,t)}},{"./_nativeCreate":89}],69:[function(t,e,n){"use strict";var r=t("./_nativeCreate");e.exports=function(t,e){var n=this.__data__;return this.size+=this.has(t)?0:1,n[t]=r&&void 0===e?"__lodash_hash_undefined__":e,this}},{"./_nativeCreate":89}],70:[function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var o=/^(?:0|[1-9]\d*)$/;e.exports=function(t,e){var n=r(t);return!!(e=null==e?9007199254740991:e)&&("number"==n||"symbol"!=n&&o.test(t))&&-1<t&&t%1==0&&t<e}},{}],71:[function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var o=t("./isArray"),i=t("./isSymbol"),u=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,a=/^\w*$/;e.exports=function(t,e){if(o(t))return!1;var n=r(t);return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=t&&!i(t))||(a.test(t)||!u.test(t)||null!=e&&t in Object(e))}},{"./isArray":116,"./isSymbol":123}],72:[function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}e.exports=function(t){var e=r(t);return"string"==e||"number"==e||"symbol"==e||"boolean"==e?"__proto__"!==t:null===t}},{}],73:[function(t,e,n){"use strict";var t=t("./_coreJsData"),r=(t=/[^.]+$/.exec(t&&t.keys&&t.keys.IE_PROTO||""))?"Symbol(src)_1."+t:"";e.exports=function(t){return!!r&&r in t}},{"./_coreJsData":49}],74:[function(t,e,n){"use strict";var r=Object.prototype;e.exports=function(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||r)}},{}],75:[function(t,e,n){"use strict";var r=t("./isObject");e.exports=function(t){return t==t&&!r(t)}},{"./isObject":121}],76:[function(t,e,n){"use strict";e.exports=function(){this.__data__=[],this.size=0}},{}],77:[function(t,e,n){"use strict";var r=t("./_assocIndexOf"),o=Array.prototype.splice;e.exports=function(t){var e=this.__data__;return!((t=r(e,t))<0)&&(t==e.length-1?e.pop():o.call(e,t,1),--this.size,!0)}},{"./_assocIndexOf":20}],78:[function(t,e,n){"use strict";var r=t("./_assocIndexOf");e.exports=function(t){var e=this.__data__;return(t=r(e,t))<0?void 0:e[t][1]}},{"./_assocIndexOf":20}],79:[function(t,e,n){"use strict";var r=t("./_assocIndexOf");e.exports=function(t){return-1<r(this.__data__,t)}},{"./_assocIndexOf":20}],80:[function(t,e,n){"use strict";var o=t("./_assocIndexOf");e.exports=function(t,e){var n=this.__data__,r=o(n,t);return r<0?(++this.size,n.push([t,e])):n[r][1]=e,this}},{"./_assocIndexOf":20}],81:[function(t,e,n){"use strict";var r=t("./_Hash"),o=t("./_ListCache"),i=t("./_Map");e.exports=function(){this.size=0,this.__data__={hash:new r,map:new(i||o),string:new r}}},{"./_Hash":4,"./_ListCache":5,"./_Map":6}],82:[function(t,e,n){"use strict";var r=t("./_getMapData");e.exports=function(t){return t=r(this,t).delete(t),this.size-=t?1:0,t}},{"./_getMapData":57}],83:[function(t,e,n){"use strict";var r=t("./_getMapData");e.exports=function(t){return r(this,t).get(t)}},{"./_getMapData":57}],84:[function(t,e,n){"use strict";var r=t("./_getMapData");e.exports=function(t){return r(this,t).has(t)}},{"./_getMapData":57}],85:[function(t,e,n){"use strict";var o=t("./_getMapData");e.exports=function(t,e){var n=o(this,t),r=n.size;return n.set(t,e),this.size+=n.size==r?0:1,this}},{"./_getMapData":57}],86:[function(t,e,n){"use strict";e.exports=function(t){var n=-1,r=Array(t.size);return t.forEach(function(t,e){r[++n]=[e,t]}),r}},{}],87:[function(t,e,n){"use strict";e.exports=function(e,n){return function(t){return null!=t&&(t[e]===n&&(void 0!==n||e in Object(t)))}}},{}],88:[function(t,e,n){"use strict";var r=t("./memoize");e.exports=function(t){var e=(t=r(t,function(t){return 500===e.size&&e.clear(),t})).cache;return t}},{"./memoize":128}],89:[function(t,e,n){"use strict";t=t("./_getNative")(Object,"create");e.exports=t},{"./_getNative":59}],90:[function(t,e,n){"use strict";t=t("./_overArg")(Object.keys,Object);e.exports=t},{"./_overArg":94}],91:[function(t,e,n){"use strict";e.exports=function(t){var e=[];if(null!=t)for(var n in Object(t))e.push(n);return e}},{}],92:[function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var t=t("./_freeGlobal"),n="object"==(void 0===n?"undefined":r(n))&&n&&!n.nodeType&&n,o=n&&"object"==(void 0===e?"undefined":r(e))&&e&&!e.nodeType&&e,i=o&&o.exports===n&&t.process,t=function(){try{var t=o&&o.require&&o.require("util").types;return t?t:i&&i.binding&&i.binding("util")}catch(t){}}();e.exports=t},{"./_freeGlobal":55}],93:[function(t,e,n){"use strict";var r=Object.prototype.toString;e.exports=function(t){return r.call(t)}},{}],94:[function(t,e,n){"use strict";e.exports=function(e,n){return function(t){return e(n(t))}}},{}],95:[function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var o=t("./_freeGlobal"),t="object"==("undefined"==typeof self?"undefined":r(self))&&self&&self.Object===Object&&self,t=o||t||Function("return this")();e.exports=t},{"./_freeGlobal":55}],96:[function(t,e,n){"use strict";e.exports=function(t){return this.__data__.set(t,"__lodash_hash_undefined__"),this}},{}],97:[function(t,e,n){"use strict";e.exports=function(t){return this.__data__.has(t)}},{}],98:[function(t,e,n){"use strict";e.exports=function(t){var e=-1,n=Array(t.size);return t.forEach(function(t){n[++e]=t}),n}},{}],99:[function(t,e,n){"use strict";var r=t("./_ListCache");e.exports=function(){this.__data__=new r,this.size=0}},{"./_ListCache":5}],100:[function(t,e,n){"use strict";e.exports=function(t){var e=this.__data__,t=e.delete(t);return this.size=e.size,t}},{}],101:[function(t,e,n){"use strict";e.exports=function(t){return this.__data__.get(t)}},{}],102:[function(t,e,n){"use strict";e.exports=function(t){return this.__data__.has(t)}},{}],103:[function(t,e,n){"use strict";var o=t("./_ListCache"),i=t("./_Map"),u=t("./_MapCache");e.exports=function(t,e){var n=this.__data__;if(n instanceof o){var r=n.__data__;if(!i||r.length<199)return r.push([t,e]),this.size=++n.size,this;n=this.__data__=new u(r)}return n.set(t,e),this.size=n.size,this}},{"./_ListCache":5,"./_Map":6,"./_MapCache":7}],104:[function(t,e,n){"use strict";var t=t("./_memoizeCapped"),r=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,i=/\\(\\)?/g,t=t(function(t){var o=[];return 46===t.charCodeAt(0)&&o.push(""),t.replace(r,function(t,e,n,r){o.push(n?r.replace(i,"$1"):e||t)}),o});e.exports=t},{"./_memoizeCapped":88}],105:[function(t,e,n){"use strict";var r=t("./isSymbol");e.exports=function(t){if("string"==typeof t||r(t))return t;var e=t+"";return"0"==e&&1/t==-1/0?"-0":e}},{"./isSymbol":123}],106:[function(t,e,n){"use strict";var r=Function.prototype.toString;e.exports=function(t){if(null!=t){try{return r.call(t)}catch(t){}try{return t+""}catch(t){}}return""}},{}],107:[function(t,e,n){"use strict";var r=t("./_baseClamp"),o=t("./toNumber");e.exports=function(t,e,n){return void 0===n&&(n=e,e=void 0),void 0!==n&&(n=(n=o(n))==n?n:0),void 0!==e&&(e=(e=o(e))==e?e:0),r(o(t),e,n)}},{"./_baseClamp":21,"./toNumber":134}],108:[function(t,e,n){"use strict";var b=t("./isObject"),g=t("./now"),x=t("./toNumber"),_=Math.max,w=Math.min;e.exports=function(r,n,t){var o,i,u,a,s,c,l=0,f=!1,h=!1,e=!0;if("function"!=typeof r)throw new TypeError("Expected a function");function p(t){var e=o,n=i;return o=i=void 0,l=t,a=r.apply(n,e)}function y(t){var e=t-c;return void 0===c||n<=e||e<0||h&&u<=t-l}function v(){var t,e=g();if(y(e))return d(e);s=setTimeout(v,(e=n-((t=e)-c),h?w(e,u-(t-l)):e))}function d(t){return s=void 0,e&&o?p(t):(o=i=void 0,a)}function m(){var t=g(),e=y(t);if(o=arguments,i=this,c=t,e){if(void 0===s)return l=e=c,s=setTimeout(v,n),f?p(e):a;if(h)return clearTimeout(s),s=setTimeout(v,n),p(c)}return void 0===s&&(s=setTimeout(v,n)),a}return n=x(n)||0,b(t)&&(f=!!t.leading,h="maxWait"in t,u=h?_(x(t.maxWait)||0,n):u,e="trailing"in t?!!t.trailing:e),m.cancel=function(){void 0!==s&&clearTimeout(s),o=c=i=s=void(l=0)},m.flush=function(){return void 0===s?a:d(g())},m}},{"./isObject":121,"./now":129,"./toNumber":134}],109:[function(t,e,n){"use strict";e.exports=function(t,e){return null==t||t!=t?e:t}},{}],110:[function(t,e,n){"use strict";e.exports=function(t,e){return t===e||t!=t&&e!=e}},{}],111:[function(t,e,n){"use strict";var r=t("./_baseFor"),o=t("./_castFunction"),i=t("./keysIn");e.exports=function(t,e){return null==t?t:r(t,o(e),i)}},{"./_baseFor":23,"./_castFunction":47,"./keysIn":126}],112:[function(t,e,n){"use strict";var r=t("./_baseGet");e.exports=function(t,e,n){return void 0===(e=null==t?void 0:r(t,e))?n:e}},{"./_baseGet":25}],113:[function(t,e,n){"use strict";var r=t("./_baseHasIn"),o=t("./_hasPath");e.exports=function(t,e){return null!=t&&o(t,e,r)}},{"./_baseHasIn":28,"./_hasPath":64}],114:[function(t,e,n){"use strict";e.exports=function(t){return t}},{}],115:[function(t,e,n){"use strict";var r=t("./_baseIsArguments"),o=t("./isObjectLike"),t=Object.prototype,i=t.hasOwnProperty,u=t.propertyIsEnumerable,r=r(function(){return arguments}())?r:function(t){return o(t)&&i.call(t,"callee")&&!u.call(t,"callee")};e.exports=r},{"./_baseIsArguments":29,"./isObjectLike":122}],116:[function(t,e,n){"use strict";var r=Array.isArray;e.exports=r},{}],117:[function(t,e,n){"use strict";var r=t("./isFunction"),o=t("./isLength");e.exports=function(t){return null!=t&&o(t.length)&&!r(t)}},{"./isFunction":119,"./isLength":120}],118:[function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var o=t("./_root"),i=t("./stubFalse"),t="object"==(void 0===n?"undefined":r(n))&&n&&!n.nodeType&&n,n=t&&"object"==(void 0===e?"undefined":r(e))&&e&&!e.nodeType&&e,o=n&&n.exports===t?o.Buffer:void 0,i=(o?o.isBuffer:void 0)||i;e.exports=i},{"./_root":95,"./stubFalse":132}],119:[function(t,e,n){"use strict";var r=t("./_baseGetTag"),o=t("./isObject");e.exports=function(t){return!!o(t)&&("[object Function]"==(t=r(t))||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t)}},{"./_baseGetTag":27,"./isObject":121}],120:[function(t,e,n){"use strict";e.exports=function(t){return"number"==typeof t&&-1<t&&t%1==0&&t<=9007199254740991}},{}],121:[function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}e.exports=function(t){var e=r(t);return null!=t&&("object"==e||"function"==e)}},{}],122:[function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}e.exports=function(t){return null!=t&&"object"==r(t)}},{}],123:[function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var o=t("./_baseGetTag"),i=t("./isObjectLike");e.exports=function(t){return"symbol"==r(t)||i(t)&&"[object Symbol]"==o(t)}},{"./_baseGetTag":27,"./isObjectLike":122}],124:[function(t,e,n){"use strict";var r=t("./_baseIsTypedArray"),o=t("./_baseUnary"),t=t("./_nodeUtil"),t=t&&t.isTypedArray,r=t?o(t):r;e.exports=r},{"./_baseIsTypedArray":34,"./_baseUnary":45,"./_nodeUtil":92}],125:[function(t,e,n){"use strict";var r=t("./_arrayLikeKeys"),o=t("./_baseKeys"),i=t("./isArrayLike");e.exports=function(t){return(i(t)?r:o)(t)}},{"./_arrayLikeKeys":16,"./_baseKeys":36,"./isArrayLike":117}],126:[function(t,e,n){"use strict";var r=t("./_arrayLikeKeys"),o=t("./_baseKeysIn"),i=t("./isArrayLike");e.exports=function(t){return i(t)?r(t,!0):o(t)}},{"./_arrayLikeKeys":16,"./_baseKeysIn":37,"./isArrayLike":117}],127:[function(t,e,n){"use strict";var r=t("./_arrayMap"),o=t("./_baseIteratee"),i=t("./_baseMap"),u=t("./isArray");e.exports=function(t,e){return(u(t)?r:i)(t,o(e,3))}},{"./_arrayMap":17,"./_baseIteratee":35,"./_baseMap":38,"./isArray":116}],128:[function(t,e,n){"use strict";var u=t("./_MapCache"),a="Expected a function";function s(r,o){if("function"!=typeof r||null!=o&&"function"!=typeof o)throw new TypeError(a);function i(){var t=arguments,e=o?o.apply(this,t):t[0],n=i.cache;return n.has(e)?n.get(e):(t=r.apply(this,t),i.cache=n.set(e,t)||n,t)}return i.cache=new(s.Cache||u),i}s.Cache=u,e.exports=s},{"./_MapCache":7}],129:[function(t,e,n){"use strict";var r=t("./_root");e.exports=function(){return r.Date.now()}},{"./_root":95}],130:[function(t,e,n){"use strict";var r=t("./_baseProperty"),o=t("./_basePropertyDeep"),i=t("./_isKey"),u=t("./_toKey");e.exports=function(t){return i(t)?r(u(t)):o(t)}},{"./_baseProperty":41,"./_basePropertyDeep":42,"./_isKey":71,"./_toKey":105}],131:[function(t,e,n){"use strict";e.exports=function(){return[]}},{}],132:[function(t,e,n){"use strict";e.exports=function(){return!1}},{}],133:[function(t,e,n){"use strict";var i=t("./debounce"),u=t("./isObject");e.exports=function(t,e,n){var r=!0,o=!0;if("function"!=typeof t)throw new TypeError("Expected a function");return u(n)&&(r="leading"in n?!!n.leading:r,o="trailing"in n?!!n.trailing:o),i(t,e,{leading:r,maxWait:e,trailing:o})}},{"./debounce":108,"./isObject":121}],134:[function(t,e,n){"use strict";var r=t("./isObject"),o=t("./isSymbol"),i=/^\s+|\s+$/g,u=/^[-+]0x[0-9a-f]+$/i,a=/^0b[01]+$/i,s=/^0o[0-7]+$/i,c=parseInt;e.exports=function(t){if("number"==typeof t)return t;if(o(t))return NaN;if(r(t)&&(e="function"==typeof t.valueOf?t.valueOf():t,t=r(e)?e+"":e),"string"!=typeof t)return 0===t?t:+t;t=t.replace(i,"");var e=a.test(t);return e||s.test(t)?c(t.slice(2),e?2:8):u.test(t)?NaN:+t}},{"./isObject":121,"./isSymbol":123}],135:[function(t,e,n){"use strict";var r=t("./_baseToString");e.exports=function(t){return null==t?"":r(t)}},{"./_baseToString":44}],136:[function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var o,i;i=function(){function p(t,e,n){var r=t[e];t[e]=t[n],t[n]=r}function c(t,e){return t<e?-1:e<t?1:0}function t(t){void 0===t&&(t=9),this._maxEntries=Math.max(4,t),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()}function y(t,e){v(t,0,t.children.length,e,t)}function v(t,e,n,r,o){(o=o||b(null)).minX=1/0,o.minY=1/0,o.maxX=-1/0,o.maxY=-1/0;for(var i=e;i<n;i++){var u=t.children[i];h(o,t.leaf?r(u):u)}return o}function h(t,e){return t.minX=Math.min(t.minX,e.minX),t.minY=Math.min(t.minY,e.minY),t.maxX=Math.max(t.maxX,e.maxX),t.maxY=Math.max(t.maxY,e.maxY),t}function i(t,e){return t.minX-e.minX}function u(t,e){return t.minY-e.minY}function d(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function m(t){return t.maxX-t.minX+(t.maxY-t.minY)}function l(t,e){return t.minX<=e.minX&&t.minY<=e.minY&&e.maxX<=t.maxX&&e.maxY<=t.maxY}function s(t,e){return e.minX<=t.maxX&&e.minY<=t.maxY&&e.maxX>=t.minX&&e.maxY>=t.minY}function b(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function g(t,e,n,r,o){for(var i,u,a,s=[e,n];s.length;)(n=s.pop())-(e=s.pop())<=r||(i=e+Math.ceil((n-e)/r/2)*r,a=o,function t(e,n,r,o,i){for(;r<o;){var u,a,s,c;600<o-r&&(u=o-r+1,a=n-r+1,c=Math.log(u),s=.5*Math.exp(2*c/3),c=.5*Math.sqrt(c*s*(u-s)/u)*(a-u/2<0?-1:1),t(e,n,Math.max(r,Math.floor(n-a*s/u+c)),Math.min(o,Math.floor(n+(u-a)*s/u+c)),i));var l=e[n],f=r,h=o;for(p(e,r,n),0<i(e[o],l)&&p(e,r,o);f<h;){for(p(e,f,h),f++,h--;i(e[f],l)<0;)f++;for(;0<i(e[h],l);)h--}0===i(e[r],l)?p(e,r,h):p(e,++h,o),h<=n&&(r=h+1),n<=h&&(o=h-1)}}(u=t,i,e||0,n||u.length-1,a||c),s.push(e,i,i,n))}return t.prototype.all=function(){return this._all(this.data,[])},t.prototype.search=function(t){var e=this.data,n=[];if(!s(t,e))return n;for(var r=this.toBBox,o=[];e;){for(var i=0;i<e.children.length;i++){var u=e.children[i],a=e.leaf?r(u):u;s(t,a)&&(e.leaf?n.push(u):l(t,a)?this._all(u,n):o.push(u))}e=o.pop()}return n},t.prototype.collides=function(t){var e=this.data;if(!s(t,e))return!1;for(var n=[];e;){for(var r=0;r<e.children.length;r++){var o=e.children[r],i=e.leaf?this.toBBox(o):o;if(s(t,i)){if(e.leaf||l(t,i))return!0;n.push(o)}}e=n.pop()}return!1},t.prototype.load=function(t){if(!t||!t.length)return this;if(t.length<this._minEntries){for(var e=0;e<t.length;e++)this.insert(t[e]);return this}var n,r=this._build(t.slice(),0,t.length-1,0);return this.data.children.length?this.data.height===r.height?this._splitRoot(this.data,r):(this.data.height<r.height&&(n=this.data,this.data=r,r=n),this._insert(r,this.data.height-r.height-1,!0)):this.data=r,this},t.prototype.insert=function(t){return t&&this._insert(t,this.data.height-1),this},t.prototype.clear=function(){return this.data=b([]),this},t.prototype.remove=function(t,e){if(!t)return this;for(var n,r,o,i=this.data,u=this.toBBox(t),a=[],s=[];i||a.length;){if(i||(i=a.pop(),r=a[a.length-1],n=s.pop(),o=!0),i.leaf){var c=function(t,e,n){if(!n)return e.indexOf(t);for(var r=0;r<e.length;r++)if(n(t,e[r]))return r;return-1}(t,i.children,e);if(-1!==c)return i.children.splice(c,1),a.push(i),this._condense(a),this}o||i.leaf||!l(i,u)?r?(n++,i=r.children[n],o=!1):i=null:(a.push(i),s.push(n),n=0,i=(r=i).children[0])}return this},t.prototype.toBBox=function(t){return t},t.prototype.compareMinX=function(t,e){return t.minX-e.minX},t.prototype.compareMinY=function(t,e){return t.minY-e.minY},t.prototype.toJSON=function(){return this.data},t.prototype.fromJSON=function(t){return this.data=t,this},t.prototype._all=function(t,e){for(var n=[];t;)t.leaf?e.push.apply(e,t.children):n.push.apply(n,t.children),t=n.pop();return e},t.prototype._build=function(t,e,n,r){var o,i=n-e+1,u=this._maxEntries;if(i<=u)return y(o=b(t.slice(e,n+1)),this.toBBox),o;r||(r=Math.ceil(Math.log(i)/Math.log(u)),u=Math.ceil(i/Math.pow(u,r-1))),(o=b([])).leaf=!1,o.height=r;var a=Math.ceil(i/u),s=a*Math.ceil(Math.sqrt(u));g(t,e,n,s,this.compareMinX);for(var c=e;c<=n;c+=s){var l=Math.min(c+s-1,n);g(t,c,l,a,this.compareMinY);for(var f=c;f<=l;f+=a){var h=Math.min(f+a-1,l);o.children.push(this._build(t,f,h,r-1))}}return y(o,this.toBBox),o},t.prototype._chooseSubtree=function(t,e,n,r){for(;r.push(e),!e.leaf&&r.length-1!==n;){for(var o=1/0,i=1/0,u=void 0,a=0;a<e.children.length;a++){var s=e.children[a],c=d(s),l=(l=t,f=s,(Math.max(f.maxX,l.maxX)-Math.min(f.minX,l.minX))*(Math.max(f.maxY,l.maxY)-Math.min(f.minY,l.minY))-c);l<i?(i=l,o=c<o?c:o,u=s):l===i&&c<o&&(o=c,u=s)}e=u||e.children[0]}var l,f;return e},t.prototype._insert=function(t,e,n){var r=n?t:this.toBBox(t),o=[],n=this._chooseSubtree(r,this.data,e,o);for(n.children.push(t),h(n,r);0<=e&&o[e].children.length>this._maxEntries;)this._split(o,e),e--;this._adjustParentBBoxes(r,o,e)},t.prototype._split=function(t,e){var n=t[e],r=n.children.length,o=this._minEntries;this._chooseSplitAxis(n,o,r);r=this._chooseSplitIndex(n,o,r),r=b(n.children.splice(r,n.children.length-r));r.height=n.height,r.leaf=n.leaf,y(n,this.toBBox),y(r,this.toBBox),e?t[e-1].children.push(r):this._splitRoot(n,r)},t.prototype._splitRoot=function(t,e){this.data=b([t,e]),this.data.height=t.height+1,this.data.leaf=!1,y(this.data,this.toBBox)},t.prototype._chooseSplitIndex=function(t,e,n){for(var r,o,i,u,a,s,c=1/0,l=1/0,f=e;f<=n-e;f++){var h=v(t,0,f,this.toBBox),p=v(t,f,n,this.toBBox),y=(o=h,i=p,0,u=Math.max(o.minX,i.minX),y=Math.max(o.minY,i.minY),a=Math.min(o.maxX,i.maxX),s=Math.min(o.maxY,i.maxY),Math.max(0,a-u)*Math.max(0,s-y)),p=d(h)+d(p);y<c?(c=y,r=f,l=p<l?p:l):y===c&&p<l&&(l=p,r=f)}return r||n-e},t.prototype._chooseSplitAxis=function(t,e,n){var r=t.leaf?this.compareMinX:i,o=t.leaf?this.compareMinY:u;this._allDistMargin(t,e,n,r)<this._allDistMargin(t,e,n,o)&&t.children.sort(r)},t.prototype._allDistMargin=function(t,e,n,r){t.children.sort(r);for(var o=this.toBBox,i=v(t,0,e,o),u=v(t,n-e,n,o),a=m(i)+m(u),s=e;s<n-e;s++){var c=t.children[s];h(i,t.leaf?o(c):c),a+=m(i)}for(var l=n-e-1;e<=l;l--){var f=t.children[l];h(u,t.leaf?o(f):f),a+=m(u)}return a},t.prototype._adjustParentBBoxes=function(t,e,n){for(var r=n;0<=r;r--)h(e[r],t)},t.prototype._condense=function(t){for(var e=t.length-1,n=void 0;0<=e;e--)0===t[e].children.length?0<e?(n=t[e-1].children).splice(n.indexOf(t[e]),1):this.clear():y(t[e],this.toBBox)},t},"object"==((o=void 0)===n?"undefined":r(n))&&void 0!==e?e.exports=i():(o=o||self).RBush=i()},{}],137:[function(t,e,n){"use strict";function r(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:Date.now();!function(t){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}(this),this.target=t,this.timestamp=e}e.exports=r},{}],138:[function(t,e,n){"use strict";function o(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var r=function(){function e(t){!function(t){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this),this.plot=t}var t,n,r;return t=e,(n=[{key:"broadcast",value:function(r){var o=this;this.plot.on(r,function(t){for(var e=o.plot.getSortedLayers(),n=e.length-1;0<=n;n--)e[n].isHidden()||e[n].emit(r,t)})}}])&&o(t.prototype,n),r&&o(t,r),e}();e.exports=r},{}],139:[function(t,e,n){"use strict";function o(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function r(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function u(t,e,n){return new i(t,n.originalEvent,{x:n.pos.x,y:n.pos.y},{x:n.px.x,y:n.px.y},e)}var a=t("./EventType"),i=t("./MouseEvent"),l=(r(t={},a.MOUSE_MOVE,function(t,e,n,r){var o=[],i=t.prevMouseover;return r?(i&&i.data!==r&&(i.target.unhighlight(),o.push({type:a.MOUSE_OUT,event:u(i.target,i.data,i)})),o.push({type:a.MOUSE_MOVE,event:u(e,r,n)}),t.plot.getContainer().style.cursor="pointer",e.highlight(r),i&&i.data===r||o.push({type:a.MOUSE_OVER,event:u(e,r,n)}),t.prevMouseover=o[o.length-1].event):i&&(t.plot.getContainer().style.cursor="inherit",i.target.unhighlight(),o.push({type:a.MOUSE_OUT,event:u(i.target,i.data,i)}),t.prevMouseover=null),o}),r(t,a.MOUSE_UP,function(t,e,n,r){return r?[{type:a.MOUSE_UP,event:u(e,r,n)}]:[]}),r(t,a.MOUSE_DOWN,function(t,e,n,r){return r?[{type:a.MOUSE_DOWN,event:u(e,r,n)}]:[]}),r(t,a.CLICK,function(t,e,n,r){var o=n.originalEvent.ctrlKey||n.originalEvent.metaKey;if(r){e.isSelected(r)?o&&e.unselect(r):(o||(t.prevClick.forEach(function(t){t.target.unselectAll()}),t.prevClick=[]),e.select(r,o));n={type:a.CLICK,event:u(e,r,n)};return t.prevClick.push(n.event),[n]}if(0<t.prevClick.length){if(o)return[];t.prevClick.forEach(function(t){t.target.unselectAll()}),t.prevClick=[]}return[]}),r(t,a.DBL_CLICK,function(t,e,n,r){return r?[{type:a.DBL_CLICK,event:u(e,r,n)}]:[]}),t),t=function(){function e(t){!function(t){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this),this.plot=t,this.prevClick=[],this.prevMouseover=null}var t,n,r;return t=e,(n=[{key:"delegate",value:function(t){var s=this,c=l[t];if(!c)throw"Delegation for event type ".concat(t," is not supported");this.plot.on(t,function(t){for(var e=s.plot.getSortedLayers(),n=null,r=null,o=e.length-1;0<=o;o--)if(!e[o].isHidden()&&(n=e[o].pick(t.pos))){r=e[o];break}for(var i=c(s,r,t,n),u=0;u<i.length;u++){var a=i[u];a.event.target.emit(a.type,a.event)}})}}])&&o(t.prototype,n),r&&o(t,r),e}();e.exports=t},{"./EventType":140,"./MouseEvent":141}],140:[function(t,e,n){"use strict";e.exports={CLICK:"click",DBL_CLICK:"dblclick",MOUSE_DOWN:"mousedown",MOUSE_UP:"mouseup",MOUSE_MOVE:"mousemove",MOUSE_OVER:"mouseover",MOUSE_OUT:"mouseout",PAN_START:"panstart",PAN:"pan",PAN_END:"panend",ZOOM_START:"zoomstart",ZOOM:"zoom",ZOOM_END:"zoomend",FRAME:"frame",RESIZE:"resize",CELL_UPDATE:"cellupdate",REFRESH:"refresh",TILE_REQUEST:"tilerequest",TILE_FAILURE:"tilefailure",TILE_ADD:"tileadd",TILE_DISCARD:"tilediscard",TILE_REMOVE:"tileremove",LOAD:"load"}},{}],141:[function(t,e,n){"use strict";function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function r(t,e){return(r=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function a(n){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=i(n);return t=r?(t=i(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments),e=this,!(t=t)||"object"!==o(t)&&"function"!=typeof t?function(t){if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}}function i(t){return(i=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var s=t("./Event"),t=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&r(t,e)}(u,s);var i=a(u);function u(t,e,n,r){var o=4<arguments.length&&void 0!==arguments[4]?arguments[4]:null;return function(t){if(!(t instanceof u))throw new TypeError("Cannot call a class as a function")}(this),(t=i.call(this,t)).originalEvent=e,t.pos=n,t.px=r,t.data=o,t}return u}();e.exports=t},{"./Event":137}],142:[function(t,e,n){"use strict";function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function i(t,e){return(i=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function u(n){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=a(n);return t=r?(t=a(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments),e=this,!(t=t)||"object"!==o(t)&&"function"!=typeof t?function(t){if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}}function a(t){return(a=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var s=t("./Event"),t=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&i(t,e)}(o,s);var r=u(o);function o(t,e,n){return function(t){if(!(t instanceof o))throw new TypeError("Cannot call a class as a function")}(this),(t=r.call(this,t)).oldSize=e,t.newSize=n,t}return o}();e.exports=t},{"./Event":137}],143:[function(t,e,n){"use strict";function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function i(t,e){return(i=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function u(n){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=a(n);return t=r?(t=a(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments),e=this,!(t=t)||"object"!==o(t)&&"function"!=typeof t?function(t){if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}}function a(t){return(a=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var s=t("./Event"),t=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&i(t,e)}(r,s);var n=u(r);function r(t,e){return function(t){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}(this),(t=n.call(this,t)).tile=e,t}return r}();e.exports=t},{"./Event":137}],144:[function(t,e,n){"use strict";var r=t("./event/EventType");e.exports={CLICK:r.CLICK,DBL_CLICK:r.DBL_CLICK,MOUSE_DOWN:r.MOUSE_DOWN,MOUSE_UP:r.MOUSE_UP,MOUSE_MOVE:r.MOUSE_MOVE,MOUSE_OVER:r.MOUSE_OVER,MOUSE_OUT:r.MOUSE_OUT,PAN_START:r.PAN_START,PAN:r.PAN,PAN_END:r.PAN_END,ZOOM_START:r.ZOOM_START,ZOOM:r.ZOOM,ZOOM_END:r.ZOOM_END,RESIZE:r.RESIZE,FRAME:r.FRAME,REFRESH:r.REFRESH,TILE_REQUEST:r.TILE_REQUEST,TILE_FAILURE:r.TILE_FAILURE,TILE_ADD:r.TILE_ADD,TILE_DISCARD:r.TILE_DISCARD,TILE_REMOVE:r.TILE_REMOVE,CELL_UPDATE:r.CELL_UPDATE,Event:t("./event/Event"),MouseEvent:t("./event/MouseEvent"),ResizeEvent:t("./event/ResizeEvent"),TileEvent:t("./event/TileEvent"),Bounds:t("./geometry/Bounds"),RTree:t("./geometry/RTree"),RTreePyramid:t("./geometry/RTreePyramid"),CircleCollidable:t("./geometry/CircleCollidable"),RectangleCollidable:t("./geometry/RectangleCollidable"),RingCollidable:t("./geometry/RingCollidable"),Plot:t("./plot/Plot"),Layer:t("./layer/Layer"),TileLayer:t("./layer/tile/TileLayer"),Overlay:t("./layer/overlay/Overlay"),PointOverlay:t("./layer/overlay/PointOverlay"),PolylineOverlay:t("./layer/overlay/PolylineOverlay"),PolygonOverlay:t("./layer/overlay/PolygonOverlay"),Renderer:t("./renderer/Renderer"),TileRenderer:t("./renderer/tile/TileRenderer"),WebGLTileRenderer:t("./renderer/tile/WebGLTileRenderer"),ImageTileRenderer:t("./renderer/tile/sample/ImageTileRenderer"),InteractiveTileRenderer:t("./renderer/tile/sample/InteractiveTileRenderer"),PointTileRenderer:t("./renderer/tile/sample/PointTileRenderer"),InstancedTileRenderer:t("./renderer/tile/sample/InstancedTileRenderer"),OverlayRenderer:t("./renderer/overlay/OverlayRenderer"),WebGLOverlayRenderer:t("./renderer/overlay/WebGLOverlayRenderer"),PointOverlayRenderer:t("./renderer/overlay/sample/PointOverlayRenderer"),PolylineOverlayRenderer:t("./renderer/overlay/sample/PolylineOverlayRenderer"),PolygonOverlayRenderer:t("./renderer/overlay/sample/PolygonOverlayRenderer"),Shader:t("./webgl/shader/Shader"),Texture:t("./webgl/texture/Texture"),TextureArray:t("./webgl/texture/TextureArray"),VertexAtlas:t("./webgl/vertex/VertexAtlas"),VertexBuffer:t("./webgl/vertex/VertexBuffer"),IndexBuffer:t("./webgl/vertex/IndexBuffer"),loadBuffer:t("./util/loadBuffer"),loadImage:t("./util/loadImage")}},{"./event/Event":137,"./event/EventType":140,"./event/MouseEvent":141,"./event/ResizeEvent":142,"./event/TileEvent":143,"./geometry/Bounds":145,"./geometry/CircleCollidable":146,"./geometry/RTree":147,"./geometry/RTreePyramid":148,"./geometry/RectangleCollidable":149,"./geometry/RingCollidable":150,"./layer/Layer":151,"./layer/overlay/Overlay":152,"./layer/overlay/PointOverlay":153,"./layer/overlay/PolygonOverlay":154,"./layer/overlay/PolylineOverlay":155,"./layer/tile/TileLayer":158,"./plot/Plot":162,"./renderer/Renderer":172,"./renderer/overlay/OverlayRenderer":173,"./renderer/overlay/WebGLOverlayRenderer":174,"./renderer/overlay/sample/PointOverlayRenderer":175,"./renderer/overlay/sample/PolygonOverlayRenderer":176,"./renderer/overlay/sample/PolylineOverlayRenderer":177,"./renderer/tile/TileRenderer":179,"./renderer/tile/WebGLTileRenderer":180,"./renderer/tile/sample/ImageTileRenderer":181,"./renderer/tile/sample/InstancedTileRenderer":182,"./renderer/tile/sample/InteractiveTileRenderer":183,"./renderer/tile/sample/PointTileRenderer":184,"./util/loadBuffer":188,"./util/loadImage":189,"./webgl/shader/Shader":191,"./webgl/texture/Texture":194,"./webgl/texture/TextureArray":195,"./webgl/vertex/IndexBuffer":196,"./webgl/vertex/VertexAtlas":197,"./webgl/vertex/VertexBuffer":198}],145:[function(t,e,n){"use strict";function r(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function v(t,e,n){var r=0;return e<t.left?r|=1:e>t.right&&(r|=2),n<t.bottom?r|=4:n>t.top&&(r|=8),r}function a(t,e,n){for(var r=e.x,o=e.y,i=n.x,u=n.y,a=v(t,r,o),s=v(t,i,u),c=!1,l=0;l<8;){if(!(a|s)){c=!0;break}if(a&s)break;var f=void 0,h=0,p=a||s;8&p?(f=r+(i-r)*(t.top-o)/(u-o),h=t.top):4&p?(f=r+(i-r)*(t.bottom-o)/(u-o),h=t.bottom):f=2&p?(h=o+(u-o)*(t.right-r)/(i-r),t.right):(h=o+(u-o)*(t.left-r)/(i-r),t.left),p===a?a=v(t,r=f,o=h):s=v(t,i=f,u=h),l++}return c?[{x:r,y:o},{x:i,y:u}]:null}var o=function(){function o(t,e,n,r){!function(t){if(!(t instanceof o))throw new TypeError("Cannot call a class as a function")}(this),this.left=t,this.right=e,this.bottom=n,this.top=r}var t,e,n;return t=o,(e=[{key:"getWidth",value:function(){return this.right-this.left}},{key:"getHeight",value:function(){return this.top-this.bottom}},{key:"extend",value:function(t){void 0!==t.left&&void 0!==t.right&&void 0!==t.bottom&&void 0!==t.top?(t.left<this.left&&(this.left=t.left),t.right>this.right&&(this.right=t.right),t.bottom<this.bottom&&(this.bottom=t.bottom),t.top>this.top&&(this.top=t.top)):(t.x<this.left&&(this.left=t.x),t.x>this.right&&(this.right=t.x),t.y<this.bottom&&(this.bottom=t.y),t.y>this.top&&(this.top=t.y))}},{key:"getCenter",value:function(){return{x:this.left+this.getWidth()/2,y:this.bottom+this.getHeight()/2}}},{key:"equals",value:function(t){return this.left===t.left&&this.right===t.right&&this.bottom===t.bottom&&this.top===t.top}},{key:"overlaps",value:function(t){return!(this.left>t.right||this.right<t.left||this.top<t.bottom||this.bottom>t.top)}},{key:"intersection",value:function(t){if(this.overlaps(t))return new o(Math.max(this.left,t.left),Math.min(this.right,t.right),Math.max(this.bottom,t.bottom),Math.min(this.top,t.top))}},{key:"clipLine",value:function(t){return t&&2===t.length?a(this,t[0],t[1]):null}},{key:"clipPolyline",value:function(t){if(!t||t.length<2)return null;for(var e=[],n=[],r=1;r<t.length;r++){var o=t[r-1],i=t[r],u=a(this,o,i);u&&(o=u[0],u=u[1],n.push(o),(u.x!==i.x&&u.y!==i.y||r===t.length-1)&&(n.push(u),e.push(n),n=[]))}return 0<e.length?e:null}},{key:"clipPoints",value:function(t){if(!t)return null;for(var e=[],n=0;n<t.length;n++){var r=t[n];r.x>=this.left&&r.x<=this.right&&r.y>=this.bottom&&r.y<=this.top&&e.push(r)}return 0<e.length?e:null}},{key:"clipPolygon",value:function(t){return!t||t.length<3?null:function(t,e){for(var n,r=1;r<=8;r*=2){n=[];for(var o=e[e.length-1],i=!(v(t,o.x,o.y)&r),u=0;u<e.length;u++){var a,s,c,l,f,h,p=e[u],y=!(v(t,p.x,p.y)&r);y!==i&&(a=o.x,s=o.y,c=p.x,l=p.y,f=void 0,h=0,8&r?(f=a+(c-a)*(t.top-s)/(l-s),h=t.top):4&r?(f=a+(c-a)*(t.bottom-s)/(l-s),h=t.bottom):f=2&r?(h=s+(l-s)*(t.right-a)/(c-a),t.right):(h=s+(l-s)*(t.left-a)/(c-a),t.left),n.push({x:f,y:h})),y&&n.push(p),o=p,i=y}if(!(e=n).length)break}return 0<n.length?n:null}(this,t)}}])&&r(t.prototype,e),n&&r(t,n),o}();e.exports=o},{}],146:[function(t,e,n){"use strict";function r(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var u=t("lodash/clamp"),t=function(){function a(t,e,n,r,o,i,u){!function(t){if(!(t instanceof a))throw new TypeError("Cannot call a class as a function")}(this),this.x=t,this.y=e,this.radius=n,this.minX=t+r-n,this.maxX=t+r+n,this.minY=e+o-n,this.maxY=e+o+n,this.tile=i,this.data=u}var t,e,n;return t=a,(e=[{key:"testPoint",value:function(t,e){t=.5*(this.minX+this.maxX)-t,e=.5*(this.minY+this.maxY)-e;return t*t+e*e<=this.radius*this.radius}},{key:"testRectangle",value:function(t,e,n,r){var o=.5*(this.minX+this.maxX),i=.5*(this.minY+this.maxY),e=o-u(o,t,e),r=i-u(i,n,r);return e*e+r*r<this.radius*this.radius}}])&&r(t.prototype,e),n&&r(t,n),a}();e.exports=t},{"lodash/clamp":107}],147:[function(t,e,n){"use strict";function o(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var i=t("rbush"),u=t("lodash/defaultTo"),t=function(){function e(t){!function(t){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this),this.tree=new i(u(t.nodeCapacity,32))}var t,n,r;return t=e,(n=[{key:"insert",value:function(t){this.tree.load(t)}},{key:"remove",value:function(t){for(var e=this.tree,n=0;n<t.length;n++)e.remove(t[n])}},{key:"searchPoint",value:function(t,e){var n=this.tree.search({minX:t,maxX:t,minY:e,maxY:e});if(0===n.length)return null;for(var r=0;r<n.length;r++){var o=n[r];if(o.testPoint(t,e))return o}return null}},{key:"searchRectangle",value:function(t,e,n,r){var o=this.tree.search({minX:t,maxX:e,minY:n,maxY:r});if(0===o.length)return null;for(var i=0;i<o.length;i++){var u=o[i];if(u.testRectangle(t,e,n,r))return u}return null}}])&&o(t.prototype,n),r&&o(t,r),e}();e.exports=t},{"lodash/defaultTo":109,rbush:136}],148:[function(t,e,n){"use strict";function o(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var i=t("lodash/defaultTo"),u=t("./RTree"),t=function(){function e(t){!function(t){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this),this.trees=new Map,this.collidables=new Map,this.nodeCapacity=i(t.nodeCapacity,32)}var t,n,r;return t=e,(n=[{key:"insert",value:function(t,e){return this.trees.has(t.z)||this.trees.set(t.z,new u({nodeCapacity:this.nodeCapacity})),this.trees.get(t.z).insert(e),this.collidables.set(t.hash,e),this}},{key:"remove",value:function(t){var e=this.collidables.get(t.hash);return this.trees.get(t.z).remove(e),this.collidables.delete(t.hash),this}},{key:"searchPoint",value:function(t,e,n,r){var o=Math.round(n),i=this.trees.get(o);if(!i)return null;n=Math.pow(2,o-n),t=t*r*n,n*=e*r;return i.searchPoint(t,n)}},{key:"searchRectangle",value:function(t,e,n,r,o,i){var u=Math.round(o),a=this.trees.get(u);if(!a)return null;o=Math.pow(2,u-o),t=t*i*o,e=e*i*o,n=n*i*o,o*=r*i;return a.searchRectangle(t,e,n,o)}}])&&o(t.prototype,n),r&&o(t,r),e}();e.exports=t},{"./RTree":147,"lodash/defaultTo":109}],149:[function(t,e,n){"use strict";function r(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var o=function(){function s(t,e,n,r,o,i,u,a){!function(t){if(!(t instanceof s))throw new TypeError("Cannot call a class as a function")}(this),this.minX=t+o,this.maxX=e+o,this.minY=n+i,this.maxY=r+i,this.tile=u,this.data=a}var t,e,n;return t=s,(e=[{key:"testPoint",value:function(t,e){return!0}},{key:"testRectangle",value:function(t,e,n,r){return!0}}])&&r(t.prototype,e),n&&r(t,n),s}();e.exports=o},{}],150:[function(t,e,n){"use strict";function r(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var l=t("lodash/clamp"),t=function(){function s(t,e,n,r,o,i,u,a){!function(t){if(!(t instanceof s))throw new TypeError("Cannot call a class as a function")}(this),this.x=t,this.y=e,this.radius=n;r=.5*(this.width=r);this.minX=t+o-n-r,this.maxX=t+o+n+r,this.minY=e+i-n-r,this.maxY=e+i+n+r,this.tile=u,this.data=a}var t,e,n;return t=s,(e=[{key:"testPoint",value:function(t,e){var n=.5*(this.minX+this.maxX)-t,t=.5*(this.minY+this.maxY)-e,e=n*n+t*t,n=.5*this.width,t=this.radius-n,n=this.radius+n;return e<=n*n&&t*t<=e}},{key:"testRectangle",value:function(t,e,n,r){var o=.5*(this.minX+this.maxX),i=.5*(this.minY+this.maxY),u=Math.abs(o-t)<Math.abs(o-e)?e:t,a=o-u,s=i-(Math.abs(i-n)<Math.abs(i-r)?r:n),c=.5*this.width,u=this.radius-c;if(a*a+s*s<u*u)return!1;e=o-l(o,t,e),r=i-l(i,n,r),c=this.radius+c;return e*e+r*r<c*c}}])&&r(t.prototype,e),n&&r(t,n),s}();e.exports=t},{"lodash/clamp":107}],151:[function(t,e,n){"use strict";function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function u(t,e){return(u=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function a(n){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=s(n);return t=r?(t=s(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments),e=this,!(t=t)||"object"!==o(t)&&"function"!=typeof t?function(t){if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}}function s(t){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var c=t("lodash/clamp"),l=t("lodash/defaultTo"),f=t("events"),h=t("../event/Event"),p=t("../event/EventType"),t=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&u(t,e)}(o,f);var t,e,n,r=a(o);function o(){var t,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return function(t){if(!(t instanceof o))throw new TypeError("Cannot call a class as a function")}(this),(t=r.call(this)).opacity=l(e.opacity,1),t.hidden=l(e.hidden,!1),t.zIndex=l(e.zIndex,0),t.renderer=l(e.renderer,null),t.highlighted=null,t.selected=[],t.plot=null,t}return t=o,(e=[{key:"onAdd",value:function(t){if(!t)throw"No plot argument provided";return this.plot=t,this.plot.setDirty(),this.renderer&&this.renderer.onAdd(this),this}},{key:"onRemove",value:function(t){if(!t)throw"No plot argument provided";return this.renderer&&this.renderer.onRemove(this),this.clear(),this.plot.setDirty(),this.plot=null,this}},{key:"setRenderer",value:function(t){if(!t)throw"No renderer argument provided";return this.renderer&&this.plot&&this.renderer.onRemove(this),this.renderer=t,this.plot&&this.renderer.onAdd(this),this}},{key:"removeRenderer",value:function(){if(!this.renderer)throw"No renderer is currently attached to the layer";return this.plot&&this.renderer.onRemove(this),this.renderer=null,this}},{key:"getRenderer",value:function(){return this.renderer}},{key:"setOpacity",value:function(t){return t=c(t,0,1),this.opacity!==t&&(this.opacity=t,this.plot&&this.plot.setDirty()),this}},{key:"getOpacity",value:function(){return this.opacity}},{key:"setZIndex",value:function(t){return this.zIndex!==t&&(this.zIndex=t,this.plot&&this.plot.setDirty()),this}},{key:"getZIndex",value:function(){return this.zIndex}},{key:"show",value:function(){return this.hidden&&(this.hidden=!1,this.plot&&this.plot.setDirty()),this}},{key:"hide",value:function(){return this.hidden||(this.hidden=!0,this.renderer&&this.renderer.clear(),this.plot&&this.plot.setDirty()),this}},{key:"isHidden",value:function(){return this.hidden}},{key:"pick",value:function(t){return this.renderer?this.renderer.pick(t):null}},{key:"highlight",value:function(t){return this.highlighted!==t&&(this.highlighted=t,this.plot&&this.plot.setDirty()),this}},{key:"unhighlight",value:function(){return null!==this.highlighted&&(this.highlighted=null,this.plot&&this.plot.setDirty()),this}},{key:"getHighlighted",value:function(){return this.highlighted}},{key:"isHighlighted",value:function(t){return this.highlighted===t}},{key:"select",value:function(t,e){var n=!1;return e?-1===this.selected.indexOf(t)&&(this.selected.push(t),n=!0):1===this.selected.length&&this.selected[0]===t||(this.selected=[t],n=!0),this.plot&&n&&this.plot.setDirty(),this}},{key:"unselect",value:function(t){t=this.selected.indexOf(t);return-1!==t&&(this.selected.splice(t,1),this.plot&&this.plot.setDirty()),this}},{key:"unselectAll",value:function(){return 0<this.selected.length&&(this.selected=[],this.plot&&this.plot.setDirty()),this}},{key:"getSelected",value:function(){return this.selected}},{key:"isSelected",value:function(t){return-1!==this.selected.indexOf(t)}},{key:"draw",value:function(t){return this.renderer&&this.renderer.draw(t),this}},{key:"clear",value:function(){return(this.highlighted||0<this.selected.length)&&(this.highlighted=null,this.selected=[]),this.renderer&&this.renderer.clear(),this.plot&&this.plot.setDirty(),this}},{key:"refresh",value:function(){return this.clear(),this.emit(p.REFRESH,new h(this)),this}}])&&i(t.prototype,e),n&&i(t,n),o}();e.exports=t},{"../event/Event":137,"../event/EventType":140,events:2,"lodash/clamp":107,"lodash/defaultTo":109}],152:[function(t,e,n){"use strict";function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function u(t,e,n){return(u="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){t=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=c(t)););return t}(t,e);if(t){e=Object.getOwnPropertyDescriptor(t,e);return e.get?e.get.call(n):e.value}})(t,e,n||t)}function a(t,e){return(a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function s(n){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=c(n);return t=r?(t=c(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments),e=this,!(t=t)||"object"!==o(t)&&"function"!=typeof t?function(t){if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}}function c(t){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var l=t("../../event/EventType"),f=t("../Layer"),h=Symbol(),p=Symbol(),t=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&a(t,e)}(o,f);var t,e,n,r=s(o);function o(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return function(t){if(!(t instanceof o))throw new TypeError("Cannot call a class as a function")}(this),(t=r.call(this,t))[p]=null,t[h]=null,t}return t=o,(e=[{key:"onAdd",value:function(t){var e=this;return u(c(o.prototype),"onAdd",this).call(this,t),this.refresh(),this[h]=function(){e.refresh()},this.plot.on(l.CELL_UPDATE,this[h]),this}},{key:"onRemove",value:function(t){return this[p]=null,this.plot.removeListener(l.CELL_UPDATE,this[h]),this[h]=null,u(c(o.prototype),"onRemove",this).call(this,t),this}},{key:"enable",value:function(){return this.show(),this}},{key:"disable",value:function(){return this.hide(),this}},{key:"isDisabled",value:function(){return this.isHidden()}},{key:"refresh",value:function(){return this.plot&&(this[p]=this.clipGeometry(this.plot.cell)),u(c(o.prototype),"refresh",this).call(this),this}},{key:"clipGeometry",value:function(t){throw"`clipGeometry` must be overridden"}},{key:"getClippedGeometry",value:function(){return this[p]}}])&&i(t.prototype,e),n&&i(t,n),o}();e.exports=t},{"../../event/EventType":140,"../Layer":151}],153:[function(t,e,n){"use strict";function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function u(t,e){return(u=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function a(n){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=s(n);return t=r?(t=s(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments),e=this,!(t=t)||"object"!==o(t)&&"function"!=typeof t?function(t){if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}}function s(t){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var c=t("./Overlay"),t=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&u(t,e)}(o,c);var t,e,n,r=a(o);function o(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return function(t){if(!(t instanceof o))throw new TypeError("Cannot call a class as a function")}(this),(t=r.call(this,t)).points=new Map,t}return t=o,(e=[{key:"addPoints",value:function(t,e){return this.points.set(t,e),this.plot&&this.refresh(),this}},{key:"removePoints",value:function(t){return this.points.delete(t),this.plot&&this.refresh(),this}},{key:"clearPoints",value:function(){return this.clear(),this.points=new Map,this.plot&&this.refresh(),this}},{key:"clipGeometry",value:function(t){return r=t,t=this.points,o=[],t.forEach(function(t){var e=r.bounds.clipPoints(t);if(e)for(var n=0;n<e.length;n++)o.push(r.project(e[n]))}),o;var r,o}}])&&i(t.prototype,e),n&&i(t,n),o}();e.exports=t},{"./Overlay":152}],154:[function(t,e,n){"use strict";function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function u(t,e){return(u=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function a(n){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=s(n);return t=r?(t=s(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments),e=this,!(t=t)||"object"!==o(t)&&"function"!=typeof t?function(t){if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}}function s(t){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var c=t("./Overlay"),t=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&u(t,e)}(o,c);var t,e,n,r=a(o);function o(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return function(t){if(!(t instanceof o))throw new TypeError("Cannot call a class as a function")}(this),(t=r.call(this,t)).polygons=new Map,t}return t=o,(e=[{key:"addPolygon",value:function(t,e){return this.polygons.set(t,e),this.plot&&this.refresh(),this}},{key:"removePolygon",value:function(t){return this.polygons.delete(t),this.plot&&this.refresh(),this}},{key:"clearPolygons",value:function(){return this.clear(),this.polygons=new Map,this.plot&&this.refresh(),this}},{key:"clipGeometry",value:function(t){return o=t,t=this.polygons,i=[],t.forEach(function(t){var e=o.bounds.clipPolygon(t);if(e){for(var n=new Array(e.length),r=0;r<e.length;r++)n[r]=o.project(e[r]);i.push(n)}}),i;var o,i}}])&&i(t.prototype,e),n&&i(t,n),o}();e.exports=t},{"./Overlay":152}],155:[function(t,e,n){"use strict";function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function u(t,e){return(u=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function a(n){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=s(n);return t=r?(t=s(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments),e=this,!(t=t)||"object"!==o(t)&&"function"!=typeof t?function(t){if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}}function s(t){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var c=t("./Overlay"),t=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&u(t,e)}(o,c);var t,e,n,r=a(o);function o(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return function(t){if(!(t instanceof o))throw new TypeError("Cannot call a class as a function")}(this),(t=r.call(this,t)).polylines=new Map,t}return t=o,(e=[{key:"addPolyline",value:function(t,e){return this.polylines.set(t,e),this.plot&&this.refresh(),this}},{key:"removePolyline",value:function(t){return this.polylines.delete(t),this.plot&&this.refresh(),this}},{key:"clearPolylines",value:function(){return this.clear(),this.polylines=new Map,this.plot&&this.refresh(),this}},{key:"clipGeometry",value:function(t){return i=t,t=this.polylines,u=[],t.forEach(function(t){var e=i.bounds.clipPolyline(t);if(e)for(var n=0;n<e.length;n++){for(var r=e[n],o=0;o<r.length;o++)r[o]=i.project(r[o]);u.push(r)}}),u;var i,u}}])&&i(t.prototype,e),n&&i(t,n),o}();e.exports=t},{"./Overlay":152}],156:[function(t,e,n){"use strict";function r(t){!function(t){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}(this),this.coord=t,this.uid=i=(i+1)%o,this.data=null,this.err=null}var o=Math.pow(2,53)-1,i=1;e.exports=r},{}],157:[function(t,e,n){"use strict";function r(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function o(t,e){return(t%e+e)%e}var i=function(){function u(t,e,n){!function(t){if(!(t instanceof u))throw new TypeError("Cannot call a class as a function")}(this),this.z=t,this.x=e,this.y=n,this.hash="".concat(this.z,":").concat(this.x,":").concat(this.y)}var t,e,n;return t=u,(e=[{key:"xyz",value:function(){var t=Math.pow(2,this.z);return"".concat(this.z,"/").concat(this.x,"/").concat(t-1-this.y)}},{key:"tms",value:function(){return"".concat(this.z,"/").concat(this.x,"/").concat(this.y)}},{key:"equals",value:function(t){return this.z===t.z&&this.x===t.x&&this.y===t.y}},{key:"getAncestor",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:1,e=Math.pow(2,t);return new u(this.z-t,Math.floor(this.x/e),Math.floor(this.y/e))}},{key:"getDescendants",value:function(){for(var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:1,e=Math.pow(2,t),n=new Array(e*e),r=0;r<e;r++)for(var o=r*e,i=0;i<e;i++)n[o+i]=new u(this.z+t,this.x*e+r,this.y*e+i);return n}},{key:"isAncestorOf",value:function(t){if(this.z>=t.z)return!1;var e=t.z-this.z,n=Math.pow(2,e),e=Math.floor(t.x/n);if(this.x!==e)return!1;n=Math.floor(t.y/n);return this.y===n}},{key:"isDescendantOf",value:function(t){return t.isAncestorOf(this)}},{key:"normalize",value:function(){var t=Math.pow(2,this.z);return new u(this.z,o(this.x,t),o(this.y,t))}},{key:"getPosition",value:function(){var t=Math.pow(2,this.z);return{x:this.x/t,y:this.y/t}}},{key:"getCenter",value:function(){var t=Math.pow(2,this.z);return{x:(this.x+.5)/t,y:(this.y+.5)/t}}}])&&r(t.prototype,e),n&&r(t,n),u}();e.exports=i},{}],158:[function(t,e,n){"use strict";function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function u(t,e,n){return(u="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){t=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=l(t)););return t}(t,e);if(t){e=Object.getOwnPropertyDescriptor(t,e);return e.get?e.get.call(n):e.value}})(t,e,n||t)}function a(t,e){return(a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function s(n){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=l(n);return t=r?(t=l(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments),e=this,!(t=t)||"object"!==o(t)&&"function"!=typeof t?c(e):t}}function c(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function l(t){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function f(t){var e=t.plot.getTargetVisibleCoords();t.requestTiles(e)}var h=t("lodash/defaultTo"),p=t("../Layer"),y=t("./TilePyramid"),t=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&a(t,e)}(o,p);var t,e,n,r=s(o);function o(){var t,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return function(t){if(!(t instanceof o))throw new TypeError("Cannot call a class as a function")}(this),(t=r.call(this,e)).muted=h(e.muted,!1),t.pyramid=new y(c(t),e),t}return t=o,(e=[{key:"onAdd",value:function(t){return u(l(o.prototype),"onAdd",this).call(this,t),this.isMuted()||f(this),this}},{key:"onRemove",value:function(t){return this.pyramid.clear(),u(l(o.prototype),"onRemove",this).call(this,t),this}},{key:"getPyramid",value:function(){return this.pyramid}},{key:"hide",value:function(){return u(l(o.prototype),"hide",this).call(this),this}},{key:"mute",value:function(){return this.muted=!0,this}},{key:"unmute",value:function(){return this.isMuted()&&(this.muted=!1,this.plot&&f(this)),this}},{key:"isMuted",value:function(){return this.muted}},{key:"enable",value:function(){return this.show(),this.unmute(),this}},{key:"disable",value:function(){return this.hide(),this.mute(),this}},{key:"isDisabled",value:function(){return this.isMuted()&&this.isHidden()}},{key:"refresh",value:function(){return this.pyramid.clear(),this.plot&&!this.isMuted()&&f(this),u(l(o.prototype),"refresh",this).call(this),this}},{key:"requestTile",value:function(t,e){e(null,null)}},{key:"requestTiles",value:function(t){return this.isMuted()||this.pyramid.requestTiles(t),this}}])&&i(t.prototype,e),n&&i(t,n),o}();e.exports=t},{"../Layer":151,"./TilePyramid":160,"lodash/defaultTo":109}],159:[function(t,e,n){"use strict";function o(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var r=function(){function r(t,e,n){!function(t){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}(this),this.target=t,this.tile=e,this.relative=n}var t,e,n;return t=r,n=[{key:"fromTile",value:function(t){return new r(t,t,null)}},{key:"fromAncestor",value:function(t,e,n){return new r(t,e,n)}},{key:"fromDescendant",value:function(t,e){return new r(t,e,null)}}],(e=null)&&o(t.prototype,e),n&&o(t,n),r}();e.exports=r},{}],160:[function(t,e,n){"use strict";function o(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function l(t){0===t.pending.size&&t.emitLoad(new h(t.layer,null))}var i=t("lodash/defaultTo"),u=t("lodash/throttle"),f=t("../../event/EventType"),h=t("../../event/TileEvent"),a=t("../../util/LRUCache"),p=t("./Tile"),y=t("./TilePartial"),s=256,c=4,v=200,d=function(t,e){if(e.coord.z<t.numPersistentLevels){if(!t.persistents.has(e.coord.hash))throw"Tile of coord ".concat(e.coord.hash," does not exists in the pyramid");t.persistents.delete(e.coord.hash)}var n=t.levels.get(e.coord.z);n.splice(n.indexOf(e),1),0===n.length&&t.levels.delete(e.coord.z),t.layer.emit(f.TILE_REMOVE,new h(t.layer,e))},t=function(){function r(t){var e=this,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};if(!function(t){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}(this),!t)throw"No layer parameter provided";this.cacheSize=i(n.cacheSize,s),this.numPersistentLevels=i(n.numPersistentLevels,c),this.layer=t,this.levels=new Map,this.persistents=new Map,this.pending=new Map,this.stale=new Map,this.tiles=new a({capacity:this.cacheSize,onRemove:function(t){d(e,t)}}),this.emitLoad=u(function(t){e.layer.emit(f.LOAD,t)},v)}var t,e,n;return t=r,(e=[{key:"getCapacity",value:function(){return this.cacheSize+(t=this.numPersistentLevels,1/3*(Math.pow(4,t)-1));var t}},{key:"clear",value:function(){var o=this;this.pending.forEach(function(t){var e,n,r;e=o,r=(n=t).coord.hash,(t=e.stale.get(r))||(t=new Map,e.stale.set(r,t)),t.set(n.uid,!0)}),this.pending=new Map,this.persistents.forEach(function(t){d(o,t)}),this.persistents.clear(),this.tiles.clear()}},{key:"has",value:function(t){return(t.z<this.numPersistentLevels?this.persistents:this.tiles).has(t.hash)}},{key:"forEach",value:function(t){this.persistents.forEach(t),this.tiles.forEach(t)}},{key:"isPending",value:function(t){return this.pending.has(t.hash)}},{key:"get",value:function(t){return(t.z<this.numPersistentLevels?this.persistents:this.tiles).get(t.hash)}},{key:"getAncestor",value:function(t,e){e=t.getAncestor(e);return this.get(e)}},{key:"getDescendants",value:function(t,e){for(var n=t.getDescendants(e),r=!1,o=0;o<n.length;o++)if(this.has(n[o])){r=!0;break}if(r){for(var i=new Array(n.length),u=0;u<n.length;u++){var a=n[u];i[u]=this.get(a)||a}return i}}},{key:"requestTiles",value:function(t){var e,n,r,o,a=this,i=t.map(function(t){return{coord:t,ncoord:t.normalize()}});r=i,e=new Map,i=r.filter(function(t){t=t.ncoord.hash;return!e.has(t)&&e.set(t,!0)}),n=this,i=i.filter(function(t){return!n.get(t.ncoord)&&!n.isPending(t.ncoord)}),t=this.layer.plot,r=i,o=t.getTargetViewportCenter(),r.sort(function(t,e){var n=t.coord.getCenter(),r=e.coord.getCenter(),t=o.x-n.x,e=o.y-n.y,n=o.x-r.x,r=o.y-r.y;return t*t+e*e-(n*n+r*r)});for(var s=(i=r).map(function(t){t=new p(t.ncoord);return a.pending.set(t.coord.hash,t),t}),u=function(t){var u=s[t];a.layer.emit(f.TILE_REQUEST,new h(a.layer,u)),a.layer.requestTile(u.coord,function(t,e){var n,r,o,i,o=(n=a,o=(r=u).coord.hash,!(!(i=n.stale.get(o))||!i.has(r.uid))&&(i.delete(r.uid),0===i.size&&n.stale.delete(o),!0));return o||a.pending.delete(u.coord.hash),null!==t?(u.err=t,a.layer.emit(f.TILE_FAILURE,new h(a.layer,u)),void(o||l(a))):(u.data=e,o||function(t,e){t=t.layer.plot;return!t||!t.getTargetViewport().isInView(e.coord,t.wraparound)}(a,u)?(a.layer.emit(f.TILE_DISCARD,new h(a.layer,u)),void(o||l(a))):(function(t,e){if(e.coord.z<t.numPersistentLevels){if(t.persistents.has(e.coord.hash))throw"Tile of coord ".concat(e.coord.hash," already exists in the pyramid");t.persistents.set(e.coord.hash,e)}else{if(t.tiles.has(e.coord.hash))throw"Tile of coord ".concat(e.coord.hash," already exists in the pyramid");t.tiles.set(e.coord.hash,e)}t.levels.has(e.coord.z)||t.levels.set(e.coord.z,[]),t.levels.get(e.coord.z).push(e),t.layer.emit(f.TILE_ADD,new h(t.layer,e))}(a,u),l(a),void a.layer.plot.setDirty()))})},c=0;c<s.length;c++)u(c)}},{key:"getAvailableLOD",value:function(t){var e=this.get(t);if(e)return[y.fromTile(e)];var n=t.z,r=[];this.levels.forEach(function(t,e){e!==n&&r.push(e)}),r.sort(function(t,e){return(n<t?t-n:n-t-.5)-(n<e?e-n:n-e-.5)});for(var o=[],i=[],u=t,a=r.shift();void 0!==u&&void 0!==a;){if(a<u.z){var s=u.z-a,s=this.getAncestor(u,s);if(s){o.push(y.fromAncestor(t,s,u)),u=i.shift();continue}}else if(a-n<4){var s=a-u.z,c=this.getDescendants(u,s);if(c){for(var l=0;l<c.length;l++){var f=c[l];f.coord?o.push(y.fromDescendant(t,f)):i.push(f)}u=i.shift()}}a=r.shift()}return 0<o.length?o:void 0}}])&&o(t.prototype,e),n&&o(t,n),r}();e.exports=t},{"../../event/EventType":140,"../../event/TileEvent":143,"../../util/LRUCache":186,"./Tile":156,"./TilePartial":159,"lodash/defaultTo":109,"lodash/throttle":133}],161:[function(t,e,n){"use strict";function r(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var u=t("../geometry/Bounds"),a=Math.pow(2,16)/2,t=function(){function i(t,e,n){!function(t){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this);var r=a/n,o={x:e.x-r,y:e.y-r};this.zoom=t,this.halfSize=r,this.center=e,this.offset=o,this.extent=n,this.bounds=new u(e.x-r,e.x+r,e.y-r,e.y+r)}var t,e,n;return t=i,(e=[{key:"project",value:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:this.zoom,e=Math.pow(2,e-this.zoom)*this.extent;return{x:(t.x-this.offset.x)*e,y:(t.y-this.offset.y)*e}}},{key:"unproject",value:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:this.zoom,e=Math.pow(2,e-this.zoom)*this.extent;return{x:t.x/e+this.offset.x,y:t.y/e+this.offset.y}}}])&&r(t.prototype,e),n&&r(t,n),i}();e.exports=t},{"../geometry/Bounds":145}],162:[function(t,e,n){"use strict";function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function r(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function a(t,e){return(a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function s(n){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=i(n);return t=r?(t=i(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments),e=this,!(t=t)||"object"!==o(t)&&"function"!=typeof t?c(e):t}}function c(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function i(t){return(i=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var l=t("lodash/clamp"),f=t("lodash/defaultTo"),h=t("lodash/throttle"),p=t("events"),y=t("../event/EventType"),v=t("../event/EventBroadcaster"),d=t("../event/EventDelegator"),m=t("../event/Event"),b=t("../event/ResizeEvent"),g=t("../webgl/RenderBuffer"),x=t("./handler/ClickHandler"),_=t("./handler/MouseHandler"),w=t("./handler/PanHandler"),O=t("./handler/ZoomHandler"),u=t("./Cell"),E=t("./Viewport"),T=100,S=200,P=400,R=24,k=Symbol(),A=Symbol(),j=Symbol(),M=Symbol(),C=Symbol(),L=Symbol(),D=Symbol(),z=Symbol(),I=function(){var e=this.getTargetVisibleCoords();return this.layers.forEach(function(t){t.requestTiles&&t.requestTiles(e)}),this},U=function(t){var e=t.getTargetZoom(),n=t.getTargetViewportCenter(),r=t.getTargetPixelExtent(),o=t.getViewportPixelSize(),e=new u(e,n,r),n=!1;!t.cell||1<=Math.abs(t.cell.zoom-e.zoom)?n=!0:(r=t.cell.halfSize-o.width/t.cell.extent,o=t.cell.halfSize-o.height/t.cell.extent,(Math.abs(e.center.x-t.cell.center.x)>r||Math.abs(e.center.y-t.cell.center.y)>o)&&(n=!0)),n&&(t.cell=e,t.emit(y.CELL_UPDATE,new m(e)))},B=function t(e){var n,r,o,i,u,a,s=Date.now();e.emit(y.FRAME,new m(e,s)),i={width:(n=e).container.offsetWidth,height:n.container.offsetHeight},u=n.getViewportPixelSize(),o=n.viewport.getCenter(),u.width===i.width&&u.height===i.height&&n.pixelRatio===window.devicePixelRatio||(n.pixelRatio=window.devicePixelRatio,n.canvas.style.width=i.width+"px",n.canvas.style.height=i.height+"px",n.canvas.width=i.width*n.pixelRatio,n.canvas.height=i.height*n.pixelRatio,n.renderBuffer&&n.renderBuffer.resize(i.width*n.pixelRatio,i.height*n.pixelRatio),r=n.getPixelExtent(),n.viewport.width=i.width/r,n.viewport.height=i.height/r,n.viewport.centerOn(o),n.resizeRequest(),n.setDirty(),n.emit(y.RESIZE,new b(n,u,i))),e.dirtyChecking&&!e.isDirty()||(e.clearDirty(),e.isZooming()&&e.zoomAnimation.update(s)&&(e.zoomAnimation=null),e.isPanning()&&(e.panAnimation.update(s)&&(e.panAnimation=null),e.panRequest()),(u=e).wraparound&&(a=Math.ceil(+u.viewport.width),1<u.viewport.x&&(u.viewport.x-=a,u.isPanning()&&(u.panAnimation.start.x-=a)),u.viewport.x+u.viewport.width<0&&(u.viewport.x+=a,u.isPanning()&&(u.panAnimation.start.x+=a))),U(e),(u=(i=e).getRenderingContext())&&(u.clearColor(0,0,0,0),u.clear(u.COLOR_BUFFER_BIT),a=i.getViewportPixelSize(),u.viewport(0,0,a.width*i.pixelRatio,a.height*i.pixelRatio)),e.getSortedLayers().forEach(function(t){t.isHidden()||t.draw(s)})),e.frameRequest=requestAnimationFrame(function(){t(e)})},t=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&a(t,e)}(u,p);var t,e,n,i=s(u);function u(t){var e,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};if(!function(t){if(!(t instanceof u))throw new TypeError("Cannot call a class as a function")}(this),(e=i.call(this)).container=document.querySelector(t),!e.container)throw"Element could not be found for selector ".concat(t);if(e.pixelRatio=window.devicePixelRatio,e.canvas=document.createElement("canvas"),e.canvas.style.width="".concat(e.container.offsetWidth,"px"),e.canvas.style.height="".concat(e.container.offsetHeight,"px"),e.canvas.width=e.container.offsetWidth*e.pixelRatio,e.canvas.height=e.container.offsetHeight*e.pixelRatio,e.container.appendChild(e.canvas),e.ctx=e.canvas.getContext("webgl",n.contextAttributes)||e.canvas.getContext("experimental-webgl",n.contextAttributes),!e.ctx&&!n.noContext)throw"Unable to create a WebGLRenderingContext, please ensure your browser supports WebGL";e.ctx?e.renderBuffer=new g(e.ctx,e.canvas.width,e.canvas.height):e.renderBuffer=null,e.tileSize=f(n.tileSize,256),e.minZoom=f(n.minZoom,0),e.maxZoom=f(n.maxZoom,R),e.zoom=f(n.zoom,0),e.zoom=l(e.zoom,e.minZoom,e.maxZoom);var r=Math.pow(2,e.zoom),o=e.canvas.offsetWidth/r,t=e.canvas.offsetHeight/r;e.viewport=new E(0,0,o,t);r=f(n.center,{x:.5,y:.5});e.viewport.centerOn(r),e.cell=null,U(c(e)),e.wraparound=f(n.wraparound,!1);o=f(n.panThrottle,T),t=f(n.resizeThrottle,S),r=f(n.zoomThrottle,P);return e.panRequest=h(I,o,{leading:!1}),e.resizeRequest=h(I,t,{leading:!1}),e.zoomRequest=h(I,r,{leading:!1}),e.layers=[],e.frameRequest=null,e[C]=new Map,e[C].set(k,new x(c(e),n)),e[C].set(A,new _(c(e),n)),e[C].set(j,new w(c(e),n)),e[C].set(M,new O(c(e),n)),e[C].forEach(function(t){t.enable()}),e[L]=new d(c(e)),e[L].delegate(y.CLICK),e[L].delegate(y.DBL_CLICK),e[L].delegate(y.MOUSE_MOVE),e[L].delegate(y.MOUSE_UP),e[L].delegate(y.MOUSE_DOWN),e[D]=new v(c(e)),e[D].broadcast(y.ZOOM_START),e[D].broadcast(y.ZOOM),e[D].broadcast(y.ZOOM_END),e[D].broadcast(y.PAN_START),e[D].broadcast(y.PAN),e[D].broadcast(y.PAN_END),e.dirtyChecking=f(n.dirtyChecking,!0),e[z]=!0,B(c(e)),e}return t=u,(e=[{key:"destroy",value:function(){var e=this;return cancelAnimationFrame(this.frameRequest),this.frameRequest=null,this[C].forEach(function(t){t.disable()}),this.layers.forEach(function(t){e.remove(t)}),this.ctx=null,this.container.removeChild(this.canvas),this.canvas=null,this.container=null,this.renderBuffer=null,this}},{key:"setDirty",value:function(){this[z]=!0}},{key:"isDirty",value:function(){return this[z]||this.isPanning()||this.isZooming()}},{key:"clearDirty",value:function(){this[z]=!1}},{key:"add",value:function(t){if(!t)throw"No argument provided";if(-1!==this.layers.indexOf(t))throw"Provided layer is already attached to the plot";return this.layers.push(t),t.onAdd(this),this.setDirty(),this}},{key:"remove",value:function(t){if(!t)throw"No argument provided";var e=this.layers.indexOf(t);if(-1===e)throw"Provided layer is not attached to the plot";return this.layers.splice(e,1),t.onRemove(this),this.setDirty(),this}},{key:"getRenderingContext",value:function(){return this.ctx}},{key:"getSortedLayers",value:function(){return this.layers.sort(function(t,e){return t.getZIndex()-e.getZIndex()})}},{key:"getZoom",value:function(){return this.zoom}},{key:"getTargetZoom",value:function(){return this.isZooming()?this.zoomAnimation.targetZoom:this.zoom}},{key:"getViewport",value:function(){return this.viewport}},{key:"getTargetViewport",value:function(){return this.isZooming()?this.zoomAnimation.targetViewport:this.viewport}},{key:"getViewportPosition",value:function(){return this.viewport.getPosition()}},{key:"getTargetViewportPosition",value:function(){return this.getTargetViewport().getPosition()}},{key:"getViewportCenter",value:function(){return this.viewport.getCenter()}},{key:"getTargetViewportCenter",value:function(){return this.getTargetViewport().getCenter()}},{key:"getTargetVisibleCoords",value:function(){var t=Math.round(this.getTargetZoom());return this.getTargetViewport().getVisibleCoords(t,this.wraparound)}},{key:"getVisibleCoords",value:function(){var t=Math.round(this.zoom);return this.viewport.getVisibleCoords(t,this.wraparound)}},{key:"getPixelExtent",value:function(){return Math.pow(2,this.zoom)*this.tileSize}},{key:"getTargetPixelExtent",value:function(){return Math.pow(2,this.getTargetZoom())*this.tileSize}},{key:"getViewportPixelSize",value:function(){return this.viewport.getPixelSize(this.zoom,this.tileSize)}},{key:"getTargetViewportPixelSize",value:function(){return this.getTargetViewport().getPixelSize(this.zoom,this.tileSize)}},{key:"getViewportPixelOffset",value:function(){return this.viewport.getPixelOffset(this.zoom,this.tileSize)}},{key:"getTargetViewportPixelOffset",value:function(){return this.getTargetViewport().getPixelOffset(this.zoom,this.tileSize)}},{key:"mouseToPlotCoord",value:function(t){var e=this.getPixelExtent(),n=this.getViewportPixelSize(),r=this.getContainer().getBoundingClientRect(),o=t.pageX-r.left,r=t.pageY-r.top;return{x:this.viewport.x+o/e,y:this.viewport.y+(n.height-r)/e}}},{key:"mouseToViewportPixel",value:function(t){var e=this.getViewportPixelSize(),n=this.getContainer().getBoundingClientRect(),r=t.pageX-n.left,n=t.pageY-n.top;return{x:r,y:e.height-n}}},{key:"viewportPixelToPlotCoord",value:function(t){var e=this.getPixelExtent();return{x:t.x/e,y:t.y/e}}},{key:"plotCoordToViewportPixel",value:function(t){var e=this.plot.getPixelExtent();return{x:t.x*e,y:t.y*e}}},{key:"getOrthoMatrix",value:function(){var t=this.getViewportPixelSize(),e=t.width,n=t.height,r=1/(0-e),o=1/(0-n),t=new Float32Array(16);return t[0]=-2*r,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*o,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=-1,t[11]=0,t[12]=(0+e)*r,t[13]=(n+0)*o,t[14]=-0,t[15]=1,t}},{key:"panTo",value:function(t){var e=!(1<arguments.length&&void 0!==arguments[1])||arguments[1];return this.cancelPan(),this.cancelZoom(),this[C].get(j).panTo(t,e),this.setDirty(),this}},{key:"zoomTo",value:function(t){var e=!(1<arguments.length&&void 0!==arguments[1])||arguments[1];return this.cancelPan(),this.cancelZoom(),this[C].get(M).zoomTo(t,e),this.setDirty(),this}},{key:"zoomToPosition",value:function(t,e){var n=!(2<arguments.length&&void 0!==arguments[2])||arguments[2];return this.cancelPan(),this.cancelZoom(),this[C].get(M).zoomToPosition(t,e,n),this.setDirty(),this}},{key:"fitToBounds",value:function(t){var e=this.getTargetZoom(),n=this.getTargetViewport(),r=n.width/t.getWidth(),n=n.height/t.getHeight(),n=Math.min(r,n),e=Math.log2(n)+e,e=l(e,this.minZoom,this.maxZoom);this.continuousZoom||(e=Math.floor(e));t=t.getCenter();return this.zoomTo(e,!1),this.panTo(t,!1),this.setDirty(),this}},{key:"isPanning",value:function(){return!!this.panAnimation}},{key:"isZooming",value:function(){return!!this.zoomAnimation}},{key:"cancelPan",value:function(){return!!this.isPanning()&&(this.panAnimation.cancel(),!(this.panAnimation=null))}},{key:"cancelZoom",value:function(){return!!this.isZooming()&&(this.zoomAnimation.cancel(),!(this.zoomAnimation=null))}},{key:"enablePanning",value:function(){this[C].get(j).enable()}},{key:"disablePanning",value:function(){this[C].get(j).disable()}},{key:"enableZooming",value:function(){this[C].get(M).enable()}},{key:"disableZooming",value:function(){this[C].get(M).disable()}},{key:"getHighlighted",value:function(){for(var t=this.layers,e=0;e<t.length;e++){var n=t[e].getHighlighted();if(n)return n}return null}},{key:"isHighlighted",value:function(t){for(var e=this.layers,n=0;n<e.length;n++)if(e[n].isHighlighted(t))return!0;return!1}},{key:"getSelected",value:function(){for(var t=[],e=this.layers,n=0;n<e.length;n++)for(var r=e[n].getSelected(),o=0;o<r.length;o++)t.push(r[o]);return t}},{key:"isSelected",value:function(t){for(var e=this.layers,n=0;n<e.length;n++)if(e[n].isSelected(t))return!0;return!1}},{key:"getContainer",value:function(){return this.container}}])&&r(t.prototype,e),n&&r(t,n),u}();e.exports=t},{"../event/Event":137,"../event/EventBroadcaster":138,"../event/EventDelegator":139,"../event/EventType":140,"../event/ResizeEvent":142,"../webgl/RenderBuffer":190,"./Cell":161,"./Viewport":163,"./handler/ClickHandler":167,"./handler/MouseHandler":169,"./handler/PanHandler":170,"./handler/ZoomHandler":171,events:2,"lodash/clamp":107,"lodash/defaultTo":109,"lodash/throttle":133}],163:[function(t,e,n){"use strict";function r(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function u(t,e,n){var r=t.getTileBounds(e),o=Math.pow(2,e)-1,t=new a(n?-1/0:0,n?1/0:o,0,o);if(r.overlaps(t)){e=n?r.left:Math.max(0,r.left),t=n?r.right:Math.min(o,r.right),n=Math.max(0,r.bottom),r=Math.min(o,r.top);return new a(e,t,n,r)}}function o(t,e,n,r){return t<=r&&r<=e||(r<t?r+Math.ceil((t-r)/n)*n<=e:t<=r-Math.ceil((r-e)/n)*n)}var a=t("../geometry/Bounds"),s=t("../layer/tile/TileCoord"),t=function(){function i(t,e,n,r){!function(t){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this),this.x=t,this.y=e,this.width=n,this.height=r}var t,e,n;return t=i,(e=[{key:"getTileBounds",value:function(t){t=1/Math.pow(2,t);return new a(Math.floor(this.x/t),Math.ceil((this.x+this.width)/t)-1,Math.floor(this.y/t),Math.ceil((this.y+this.height)/t)-1)}},{key:"getVisibleCoords",value:function(t){var e=u(this,t,1<arguments.length&&void 0!==arguments[1]&&arguments[1]);if(!e)return[];for(var n=[],r=e.left;r<=e.right;r++)for(var o=e.bottom;o<=e.top;o++)n.push(new s(t,r,o));return n}},{key:"isInView",value:function(t){var e=1<arguments.length&&void 0!==arguments[1]&&arguments[1],n=u(this,t.z,e);if(!n)return!1;e=Math.pow(2,t.z);return o(n.left,n.right,e,t.x)&&o(n.bottom,n.top,e,t.y)}},{key:"zoomToPos",value:function(t,e,n){var r=!(3<arguments.length&&void 0!==arguments[3])||arguments[3],o=Math.pow(2,e-t),e=this.width/o,t=this.height/o,t=new i(n.x-(n.x-this.x)/o,n.y-(n.y-this.y)/o,e,t);return r||t.centerOn(n),t}},{key:"getPosition",value:function(){return{x:this.x,y:this.y}}},{key:"getCenter",value:function(){return{x:this.x+this.width/2,y:this.y+this.height/2}}},{key:"getPixelSize",value:function(t,e){e=Math.pow(2,t)*e;return{width:Math.round(this.width*e),height:Math.round(this.height*e)}}},{key:"getPixelOffset",value:function(t,e){e=Math.pow(2,t)*e;return{x:this.x*e,y:this.y*e}}},{key:"centerOn",value:function(t){this.x=t.x-this.width/2,this.y=t.y-this.height/2}}])&&r(t.prototype,e),n&&r(t,n),i}();e.exports=t},{"../geometry/Bounds":145,"../layer/tile/TileCoord":157}],164:[function(t,e,n){"use strict";function o(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var r=function(){function e(t){!function(t){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this),this.timestamp=Date.now(),this.duration=t.duration,this.plot=t.plot}var t,n,r;return t=e,(n=[{key:"getT",value:function(t){return 0<this.duration?Math.min(1,(t-this.timestamp)/this.duration):1}},{key:"update",value:function(t){return!0}},{key:"cancel",value:function(){}},{key:"finish",value:function(){}}])&&o(t.prototype,n),r&&o(t,r),e}();e.exports=r},{}],165:[function(t,e,n){"use strict";function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function u(t,e){return(u=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function a(n){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=s(n);return t=r?(t=s(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments),e=this,!(t=t)||"object"!==o(t)&&"function"!=typeof t?function(t){if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}}function s(t){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var c=t("../../event/EventType"),l=t("../../event/Event"),f=t("./Animation"),t=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&u(t,e)}(o,f);var t,e,n,r=a(o);function o(){var t,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return function(t){if(!(t instanceof o))throw new TypeError("Cannot call a class as a function")}(this),(t=r.call(this,e)).start=e.start,t.delta=e.delta,t.end={x:t.start.x+t.delta.x,y:t.start.y+t.delta.y},t.easing=e.easing,t}return t=o,(e=[{key:"update",value:function(t){var e=this.getT(t),n=1-Math.pow(1-e,1/this.easing),t=this.plot;t.viewport.x=this.start.x+this.delta.x*n,t.viewport.y=this.start.y+this.delta.y*n;n=new l(t);return e<1?(t.emit(c.PAN,n),!1):(t.emit(c.PAN_END,n),!0)}},{key:"cancel",value:function(){var t=this.plot;t.emit(c.PAN_END,new l(t))}},{key:"finish",value:function(){var t=this.plot;t.viewport.x=this.end.x,t.viewport.y=this.end.y,t.emit(c.PAN_END,new l(t))}}])&&i(t.prototype,e),n&&i(t,n),o}();e.exports=t},{"../../event/Event":137,"../../event/EventType":140,"./Animation":164}],166:[function(t,e,n){"use strict";function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function u(t,e){return(u=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function a(n){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=s(n);return t=r?(t=s(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments),e=this,!(t=t)||"object"!==o(t)&&"function"!=typeof t?function(t){if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}}function s(t){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var c=t("../../event/EventType"),l=t("../../event/Event"),f=t("./Animation"),t=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&u(t,e)}(o,f);var t,e,n,r=a(o);function o(){var t,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return function(t){if(!(t instanceof o))throw new TypeError("Cannot call a class as a function")}(this),(t=r.call(this,e)).prevZoom=e.prevZoom,t.targetZoom=e.targetZoom,t.prevViewport=e.prevViewport,t.targetViewport=e.targetViewport,t.targetPos=e.targetPos,t}return t=o,(e=[{key:"update",value:function(t){var e=this.getT(t),n=this.targetZoom-this.prevZoom,t=this.prevZoom+n*e,n=this.plot;n.zoom=t,n.viewport=this.prevViewport.zoomToPos(this.prevZoom,n.zoom,this.targetPos);t=new l(n);return e<1?(n.emit(c.ZOOM,t),!1):(n.emit(c.ZOOM_END,t),!0)}},{key:"cancel",value:function(){var t=this.plot;t.continuousZoom||(t.zoom=Math.round(t.zoom),t.viewport=this.prevViewport.zoomToPos(this.prevZoom,t.zoom,this.targetPos));var e=new l(t);t.emit(c.ZOOM_END,e)}},{key:"finish",value:function(){var t=this.plot;t.zoom=this.targetZoom,t.viewport=this.targetViewport;var e=new l(t);t.emit(c.ZOOM_END,e)}}])&&i(t.prototype,e),n&&i(t,n),o}();e.exports=t},{"../../event/Event":137,"../../event/EventType":140,"./Animation":164}],167:[function(t,e,n){"use strict";function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function a(t,e,n){return(a="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){t=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=l(t)););return t}(t,e);if(t){e=Object.getOwnPropertyDescriptor(t,e);return e.get?e.get.call(n):e.value}})(t,e,n||t)}function s(t,e){return(s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function c(n){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=l(n);return t=r?(t=l(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments),e=this,!(t=t)||"object"!==o(t)&&"function"!=typeof t?function(t){if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}}function l(t){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function f(t,e,n){return new r(e,n,t.mouseToPlot(n),t.mouseToViewPx(n))}var h=t("../../event/EventType"),r=t("../../event/MouseEvent"),p=t("./DOMHandler"),t=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&s(t,e)}(u,p);var t,e,n,r=c(u);function u(t){return function(t){if(!(t instanceof u))throw new TypeError("Cannot call a class as a function")}(this),r.call(this,t)}return t=u,(e=[{key:"enable",value:function(){var r=this;if(this.enabled)return this;var o=this.plot,i=null;this.mousedown=function(t){i=r.mouseToViewPx(t)},this.mouseup=function(t){var e,n;i&&(n=r.mouseToViewPx(t),(e=i.x-n.x)*e+(n=i.y-n.y)*n<225&&(o.setDirty(),t.preventDefault(),r.plot.emit(h.CLICK,f(r,o,t))),i=null)},this.dblclick=function(t){o.setDirty(),t.preventDefault(),r.plot.emit(h.DBL_CLICK,f(r,o,t))};var t=o.getContainer();return t.addEventListener("mousedown",this.mousedown),t.addEventListener("mouseup",this.mouseup),t.addEventListener("dblclick",this.dblclick),a(l(u.prototype),"enable",this).call(this)}},{key:"disable",value:function(){if(!this.enabled)return this;var t=this.plot.getContainer();return t.removeEventListener("mousedown",this.mousedown),t.removeEventListener("mouseup",this.mouseup),t.removeEventListener("dblclick",this.dblclick),this.mousedown=null,this.mouseup=null,this.dblclick=null,a(l(u.prototype),"disable",this).call(this)}}])&&i(t.prototype,e),n&&i(t,n),u}();e.exports=t},{"../../event/EventType":140,"../../event/MouseEvent":141,"./DOMHandler":168}],168:[function(t,e,n){"use strict";function o(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var r=function(){function e(t){!function(t){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this),this.plot=t,this.enabled=!1}var t,n,r;return t=e,(n=[{key:"enable",value:function(){return this.enabled=!0,this}},{key:"disable",value:function(){return this.enabled=!1,this}},{key:"mouseToPlot",value:function(t){return this.plot.mouseToPlotCoord(t)}},{key:"mouseToViewPx",value:function(t){return this.plot.mouseToViewportPixel(t)}},{key:"viewPxToPlot",value:function(t){return this.plot.viewportPixelToPlotCoord(t)}},{key:"plotToViewPx",value:function(t){return this.plot.plotCoordToViewportPixel(t)}},{key:"isLeftButton",value:function(t){return t.which?1===t.which:0===t.button}},{key:"isMiddleButton",value:function(t){return t.which?2===t.which:1===t.button}},{key:"isRightButton",value:function(t){return t.which?3===t.which:2===t.button}}])&&o(t.prototype,n),r&&o(t,r),e}();e.exports=r},{}],169:[function(t,e,n){"use strict";function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function u(t,e,n){return(u="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){t=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=c(t)););return t}(t,e);if(t){e=Object.getOwnPropertyDescriptor(t,e);return e.get?e.get.call(n):e.value}})(t,e,n||t)}function a(t,e){return(a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function s(n){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=c(n);return t=r?(t=c(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments),e=this,!(t=t)||"object"!==o(t)&&"function"!=typeof t?function(t){if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}}function c(t){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function l(t,e,n){return new r(e,n,t.mouseToPlot(n),t.mouseToViewPx(n))}var f=t("../../event/EventType"),r=t("../../event/MouseEvent"),h=t("./DOMHandler"),t=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&a(t,e)}(o,h);var t,e,n,r=s(o);function o(t){return function(t){if(!(t instanceof o))throw new TypeError("Cannot call a class as a function")}(this),r.call(this,t)}return t=o,(e=[{key:"enable",value:function(){var e=this;if(this.enabled)return this;var n=this.plot;this.mousedown=function(t){n.setDirty(),t.preventDefault(),n.emit(f.MOUSE_DOWN,l(e,n,t))},this.mouseup=function(t){n.setDirty(),t.preventDefault(),n.emit(f.MOUSE_UP,l(e,n,t))},this.mousemove=function(t){n.setDirty(),t.preventDefault(),n.emit(f.MOUSE_MOVE,l(e,n,t))},this.mouseover=function(t){n.setDirty(),t.preventDefault(),n.emit(f.MOUSE_OVER,l(e,n,t))},this.mouseout=function(t){n.setDirty(),t.preventDefault(),n.emit(f.MOUSE_OUT,l(e,n,t))},this.wheel=function(t){n.setDirty(),t.preventDefault()};var t=n.getContainer();return t.addEventListener("pointerdown",this.mousedown),t.addEventListener("pointerup",this.mouseup),t.addEventListener("pointermove",this.mousemove),t.addEventListener("mouseover",this.mouseover),t.addEventListener("mouseout",this.mouseout),t.addEventListener("wheel",this.wheel),u(c(o.prototype),"enable",this).call(this)}},{key:"disable",value:function(){if(!this.enabled)return this;var t=this.plot.getContainer();return t.removeEventListener("pointerdown",this.mousedown),t.removeEventListener("pointerup",this.mouseup),t.removeEventListener("pointermove",this.mousemove),t.removeEventListener("mouseover",this.mouseover),t.removeEventListener("mouseout",this.mouseout),t.removeEventListener("wheel",this.wheel),this.mousedown=null,this.mouseup=null,this.mousemove=null,this.mouseover=null,this.mouseout=null,this.wheel=null,u(c(o.prototype),"disable",this).call(this)}}])&&i(t.prototype,e),n&&i(t,n),o}();e.exports=t},{"../../event/EventType":140,"../../event/MouseEvent":141,"./DOMHandler":168}],170:[function(t,e,n){"use strict";function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function p(t,e,n){return(p="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){t=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=y(t)););return t}(t,e);if(t){e=Object.getOwnPropertyDescriptor(t,e);return e.get?e.get.call(n):e.value}})(t,e,n||t)}function u(t,e){return(u=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function a(n){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=y(n);return t=r?(t=y(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments),e=this,!(t=t)||"object"!==o(t)&&"function"!=typeof t?function(t){if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}}function y(t){return(y=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function v(t,e){t.isZooming()||(t.viewport.x+=e.x,t.viewport.y+=e.y,t.panRequest(),t.emit(m.PAN,new b(t)))}var s=t("lodash/defaultTo"),d=t("../animation/PanAnimation"),m=t("../../event/EventType"),b=t("../../event/Event"),c=t("./DOMHandler"),l=!0,f=.2,h=3400,t=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&u(t,e)}(o,c);var t,e,n,r=a(o);function o(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return function(t){if(!(t instanceof o))throw new TypeError("Cannot call a class as a function")}(this),(t=r.call(this,t)).inertia=s(e.inertia,l),t.inertiaEasing=s(e.inertiaEasing,f),t.inertiaDeceleration=s(e.inertiaDeceleration,h),t}return t=o,(e=[{key:"enable",value:function(){var u=this;if(this.enabled)return this;var a=this.plot,s=!1,c=null,l=null,f=[],h=[];return this.mousedown=function(t){u.isLeftButton(t)&&(s=!0,c=u.mouseToViewPx(t),l=Date.now(),u.inertia&&(a.panAnimation=null,f=[],h=[]))},this.mousemove=function(t){var e,n;s&&(e=u.mouseToViewPx(t),n=Date.now(),0===f.length&&a.emit(m.PAN_START,new b(a)),u.inertia&&(f.push(e),h.push(n),50<n-h[0]&&(f.shift(),h.shift())),t={x:c.x-e.x,y:c.y-e.y},v(a,u.viewPxToPlot(t)),l=n,c=e)},this.mouseup=function(t){if(s=!1,!a.isZooming()&&u.isLeftButton(t)&&0!==f.length)if(u.inertia){for(var e,n,r,o,i=Date.now();50<i-h[0];)f.shift(),h.shift();h.length<2?a.emit(m.PAN_END,new b(a)):(o=u.inertiaDeceleration,e=u.inertiaEasing,r=c.x-f[0].x,n=c.y-f[0].y,r=r*(e/(t=(l-h[0]||1)/1e3)),t=n*(e/t),o=Math.sqrt(r*r+t*t)/(o*e),t={x:Math.round(r*(-o/2)),y:Math.round(t*(-o/2))},a.panAnimation=new d({plot:a,start:a.getViewportPosition(),delta:u.viewPxToPlot(t),easing:e,duration:1e3*o}))}else a.emit(m.PAN_END,new b(a))},a.getContainer().addEventListener("pointerdown",this.mousedown),document.addEventListener("pointermove",this.mousemove),document.addEventListener("pointerup",this.mouseup),p(y(o.prototype),"enable",this).call(this)}},{key:"disable",value:function(){return this.enabled?(this.plot.getContainer().removeEventListener("pointerdown",this.mousedown),document.removeEventListener("pointermove",this.mousemove),document.removeEventListener("pointerup",this.mouseup),this.mousedown=null,this.mousemove=null,this.mouseup=null,p(y(o.prototype),"disable",this).call(this)):this}},{key:"panTo",value:function(t){var e=!(1<arguments.length&&void 0!==arguments[1])||arguments[1],n=this.plot,r=n.getViewportCenter(),r={x:t.x-r.x,y:t.y-r.y};e?(n.emit(m.PAN_START,new b(n)),n.panAnimation=new d({plot:n,start:n.getViewportPosition(),delta:r,easing:this.inertiaEasing,duration:800})):(n.emit(m.PAN_START,new b(n)),v(n,r),n.emit(m.PAN_END,new b(n)))}}])&&i(t.prototype,e),n&&i(t,n),o}();e.exports=t},{"../../event/Event":137,"../../event/EventType":140,"../animation/PanAnimation":165,"./DOMHandler":168,"lodash/defaultTo":109}],171:[function(t,e,n){"use strict";function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function f(t,e,n){return(f="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){t=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=h(t)););return t}(t,e);if(t){e=Object.getOwnPropertyDescriptor(t,e);return e.get?e.get.call(n):e.value}})(t,e,n||t)}function u(t,e){return(u=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function a(n){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=h(n);return t=r?(t=h(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments),e=this,!(t=t)||"object"!==o(t)&&"function"!=typeof t?function(t){if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}}function h(t){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function p(t,e,n,r){var o=!(4<arguments.length&&void 0!==arguments[4])||arguments[4];console.log(n);var i=function(t,e,n,r,o){t=n?n.targetZoom+t:e+t;return s(t,r,o)}(n,t.zoom,t.zoomAnimation,t.minZoom,t.maxZoom),u=t.viewport.zoomToPos(t.zoom,i,e,o),n=t.getTargetZoom(),o=t.getTargetViewport();i===n&&u.x===o.x&&u.y===o.y||(t.panAnimation=null,0<r&&(t.zoomAnimation=new m({plot:t,duration:r,prevZoom:t.zoom,targetZoom:i,prevViewport:new b(t.viewport.x,t.viewport.y,t.viewport.width,t.viewport.height),targetViewport:u,targetPos:e})),t.emit(l.ZOOM_START,new d(t)),0===r&&(t.zoom=i,t.viewport=u,t.emit(l.ZOOM_END,new d(t))),t.zoomRequest())}function y(t,e,n,r,o){var i,u,a;0!==r&&(i=function(t,e,n,r){n=t/n;return e||(n=0<t?Math.ceil(n):Math.floor(n)),s(n,-r,r)}(r,o,t.deltaPerZoom,t.maxConcurrentZooms),u=t.zoomDuration,o&&(a=e.zoomAnimation,t=r,o=Date.now(),r=o-T,T=o,t%4.000244140625!=0&&(Math.abs(t)<4||(!a||0===a.duration)&&r<40))&&(u=0),p(e,n,i,u))}var s=t("lodash/clamp"),c=t("lodash/defaultTo"),v=t("../../util/Browser"),l=t("../../event/EventType"),d=t("../../event/Event"),m=t("../animation/ZoomAnimation"),b=t("../Viewport"),g=t("./DOMHandler"),x=300,_=250,w=4,O=100,E=!1,T=Date.now(),t=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&u(t,e)}(l,g);var t,e,n,r=a(l);function l(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return function(t){if(!(t instanceof l))throw new TypeError("Cannot call a class as a function")}(this),(t=r.call(this,t)).continuousZoom=c(e.continuousZoom,E),t.zoomDuration=c(e.zoomDuration,_),t.maxConcurrentZooms=c(e.maxConcurrentZooms,w),t.deltaPerZoom=c(e.deltaPerZoom,x),t.zoomDebounce=c(e.zoomDebounce,O),t}return t=l,(e=[{key:"enable",value:function(){var i=this;if(this.enabled)return this;var u=this.plot,r=0,o=null,a=null;this.dblclick=function(t){t=i.mouseToPlot(t);p(u,t,1,i.zoomDuration)},this.wheel=function(t){var e,n,n=(e=u,0===(n=t).deltaMode?v.firefox?-n.deltaY/e.pixelRatio:-n.deltaY:1===n.deltaMode?20*-n.deltaY:60*-n.deltaY);!i.continuousZoom&&Math.abs(n)<4||(r+=n,i.continuousZoom?(n=i.mouseToPlot(t),y(i,u,n,r,!0),r=0):(a=t,o=o||setTimeout(function(){var t=i.mouseToPlot(a);y(i,u,t,r,!1),r=0,a=o=null},i.zoomDebounce)),t.preventDefault(),t.stopPropagation())};var s=new Array,c=-1;this.pointerdown=function(t){var e;s.push(t),console.log(s),2===s.length&&(e=s[0].clientX-s[1].clientX,t=s[0].clientY-s[1].clientY,c=Math.sqrt(e*e+t*t))},this.pointermove=function(t){for(var e,n,r,o=0;o<s.length;o++)if(t.pointerId===s[o].pointerId){s[o]=t;break}2===s.length&&(e=s[0].clientX-s[1].clientX,r=s[0].clientY-s[1].clientY,n=Math.sqrt(e*e+r*r),r=i.mouseToPlot({pageX:s[0].pageX+e/2,pageY:s[0].pageY+r/2}),console.log("Zooming detla = ".concat(Math.log2(c/n))),p(u,r,Math.log2(c/n),0),c=n)},this.pointerup=function(t){for(var e=0;e<s.length;e++)s[e].pointerId===t.pointerId&&s.splice(e,1)};var t=u.getContainer();return t.addEventListener("dblclick",this.dblclick),t.addEventListener("wheel",this.wheel),t.addEventListener("pointerdown",this.pointerdown),t.addEventListener("pointermove",this.pointermove),t.addEventListener("pointerup",this.pointerup),f(h(l.prototype),"enable",this).call(this)}},{key:"disable",value:function(){if(!this.enabled)return this;var t=this.plot.getContainer();return t.removeEventListener("dblclick",this.dblclick),t.removeEventListener("wheel",this.wheel),t.removeEventListener("pointerdown",this.pointerdown),t.removeEventListener("pointermove",this.pointermove),t.removeEventListener("pointerup",this.pointerup),this.dblclick=null,this.wheel=null,f(h(l.prototype),"disable",this).call(this)}},{key:"zoomTo",value:function(t){var e=!(1<arguments.length&&void 0!==arguments[1])||arguments[1],n=this.plot,r=this.plot.getViewportCenter(),t=t-n.zoom;p(n,r,t,e?this.zoomDuration:0)}},{key:"zoomToPosition",value:function(t,e){var n=!(2<arguments.length&&void 0!==arguments[2])||arguments[2],r=this.plot,t=t-r.zoom,n=n?this.zoomDuration:0;p(r,e,t,n,!1)}}])&&i(t.prototype,e),n&&i(t,n),l}();e.exports=t},{"../../event/Event":137,"../../event/EventType":140,"../../util/Browser":185,"../Viewport":163,"../animation/ZoomAnimation":166,"./DOMHandler":168,"lodash/clamp":107,"lodash/defaultTo":109}],172:[function(t,e,n){"use strict";function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function u(t,e){return(u=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function a(n){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=s(n);return t=r?(t=s(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments),e=this,!(t=t)||"object"!==o(t)&&"function"!=typeof t?function(t){if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}}function s(t){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var c=t("events"),t=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&u(t,e)}(o,c);var t,e,n,r=a(o);function o(){return function(t){if(!(t instanceof o))throw new TypeError("Cannot call a class as a function")}(this),r.call(this)}return t=o,(e=[{key:"onAdd",value:function(t){return this}},{key:"onRemove",value:function(t){return this}},{key:"pick",value:function(t){return null}},{key:"clear",value:function(){return this}},{key:"draw",value:function(t){return this}}])&&i(t.prototype,e),n&&i(t,n),o}();e.exports=t},{events:2}],173:[function(t,e,n){"use strict";function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function u(t,e){return(u=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function a(n){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=s(n);return t=r?(t=s(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments),e=this,!(t=t)||"object"!==o(t)&&"function"!=typeof t?function(t){if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}}function s(t){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var c=t("../Renderer"),t=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&u(t,e)}(o,c);var t,e,n,r=a(o);function o(){var t;return function(t){if(!(t instanceof o))throw new TypeError("Cannot call a class as a function")}(this),(t=r.call(this)).overlay=null,t}return t=o,(e=[{key:"onAdd",value:function(t){if(!t)throw"No overlay provided as argument";return this.overlay=t,this}},{key:"onRemove",value:function(t){if(!t)throw"No overlay provided as argument";return this.overlay=null,this}}])&&i(t.prototype,e),n&&i(t,n),o}();e.exports=t},{"../Renderer":172}],174:[function(t,e,n){"use strict";function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function u(t,e,n){return(u="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){t=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=c(t)););return t}(t,e);if(t){e=Object.getOwnPropertyDescriptor(t,e);return e.get?e.get.call(n):e.value}})(t,e,n||t)}function a(t,e){return(a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function s(n){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=c(n);return t=r?(t=c(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments),e=this,!(t=t)||"object"!==o(t)&&"function"!=typeof t?function(t){if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}}function c(t){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var l=t("../../webgl/shader/Shader"),f=t("../../event/EventType"),h=t("./OverlayRenderer"),p=Symbol(),t=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&a(t,e)}(o,h);var t,e,n,r=s(o);function o(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return function(t){if(!(t instanceof o))throw new TypeError("Cannot call a class as a function")}(this),(t=r.call(this,t)).gl=null,t[p]=null,t}return t=o,(e=[{key:"onAdd",value:function(t){var e=this;return u(c(o.prototype),"onAdd",this).call(this,t),this.gl=this.overlay.plot.getRenderingContext(),this.refreshBuffers(),this[p]=function(){e.refreshBuffers()},this.overlay.on(f.REFRESH,this[p]),this}},{key:"onRemove",value:function(t){return this.overlay.removeListener(f.REFRESH,this[p]),this[p]=null,this.gl=null,u(c(o.prototype),"onRemove",this).call(this,t),this}},{key:"refreshBuffers",value:function(){throw"`refreshBuffers` must be overridden"}},{key:"createShader",value:function(t){return new l(this.gl,t)}},{key:"getOrthoMatrix",value:function(){return this.overlay.plot.getOrthoMatrix()}}])&&i(t.prototype,e),n&&i(t,n),o}();e.exports=t},{"../../event/EventType":140,"../../webgl/shader/Shader":191,"./OverlayRenderer":173}],175:[function(t,e,n){"use strict";function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function u(t,e,n){return(u="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){t=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=c(t)););return t}(t,e);if(t){e=Object.getOwnPropertyDescriptor(t,e);return e.get?e.get.call(n):e.value}})(t,e,n||t)}function a(t,e){return(a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function s(n){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=c(n);return t=r?(t=c(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments),e=this,!(t=t)||"object"!==o(t)&&"function"!=typeof t?function(t){if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}}function c(t){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function l(t,e){var n=function(t){for(var e=new Float32Array(2*t.length),n=0;n<t.length;n++){var r=t[n];e[2*n]=r.x,e[2*n+1]=r.y}return e}(e);return new r(t,n,{0:{size:2,type:"FLOAT"}},{mode:"POINTS",count:e.length})}var f=t("lodash/defaultTo"),r=t("../../../webgl/vertex/VertexBuffer"),h=t("../WebGLOverlayRenderer"),p={vert:"\n\t\tprecision highp float;\n\t\tattribute vec2 aPosition;\n\t\tattribute vec2 aNormal;\n\t\tuniform vec2 uViewOffset;\n\t\tuniform float uScale;\n\t\tuniform float uLineWidth;\n\t\tuniform float uPixelRatio;\n\t\tuniform float uPointRadius;\n\t\tuniform mat4 uProjectionMatrix;\n\t\tvoid main() {\n\t\t\tvec2 wPosition = (aPosition * uScale) - uViewOffset;\n\t\t\tgl_Position = uProjectionMatrix * vec4(wPosition, 0.0, 1.0);\n\t\t\tgl_PointSize = uPointRadius * 2.0 * uPixelRatio;\n\t\t}\n\t\t",frag:"\n\t\t#ifdef GL_OES_standard_derivatives\n\t\t\t#extension GL_OES_standard_derivatives : enable\n\t\t#endif\n\t\tprecision highp float;\n\t\tuniform vec4 uPointColor;\n\t\tuniform float uOpacity;\n\t\tvoid main() {\n\t\t\tvec2 cxy = 2.0 * gl_PointCoord - 1.0;\n\t\t\tfloat radius = dot(cxy, cxy);\n\t\t\tfloat alpha = 1.0;\n\t\t\t#ifdef GL_OES_standard_derivatives\n\t\t\t\tfloat delta = fwidth(radius);\n\t\t\t\talpha = 1.0 - smoothstep(1.0 - delta, 1.0 + delta, radius);\n\t\t\t#else\n\t\t\t\tif (radius > 1.0) {\n\t\t\t\t\tdiscard;\n\t\t\t\t}\n\t\t\t#endif\n\t\t\tgl_FragColor = vec4(uPointColor.rgb, uPointColor.a * alpha * uOpacity);\n\t\t}\n\t\t"},t=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&a(t,e)}(o,h);var t,e,n,r=s(o);function o(){var t,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return function(t){if(!(t instanceof o))throw new TypeError("Cannot call a class as a function")}(this),(t=r.call(this,e)).pointColor=f(e.pointColor,[1,0,1,1]),t.pointRadius=f(e.pointRadius,4),t.shader=null,t.ext=null,t.points=null,t}return t=o,(e=[{key:"onAdd",value:function(t){return u(c(o.prototype),"onAdd",this).call(this,t),this.ext=this.gl.getExtension("OES_standard_derivatives"),this.shader=this.createShader(p),this}},{key:"onRemove",value:function(t){return this.shader=null,this.ext=null,this.points=null,u(c(o.prototype),"onRemove",this).call(this,t),this}},{key:"refreshBuffers",value:function(){var t=this.overlay.getClippedGeometry();t&&0<t.length?this.points=l(this.gl,t):this.points=null}},{key:"draw",value:function(){if(!this.points)return this;var t=this.gl,e=this.shader,n=this.points,r=this.overlay.plot,o=r.cell,i=this.getOrthoMatrix(),u=Math.pow(2,r.zoom-o.zoom),a=this.overlay.opacity,o=o.project(r.viewport,r.zoom);return t.enable(t.BLEND),t.blendFunc(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA),e.use(),e.setUniform("uProjectionMatrix",i),e.setUniform("uViewOffset",[o.x,o.y]),e.setUniform("uScale",u),e.setUniform("uPointColor",this.pointColor),e.setUniform("uPointRadius",this.pointRadius),e.setUniform("uPixelRatio",r.pixelRatio),e.setUniform("uOpacity",a),n.bind(),n.draw(),this}}])&&i(t.prototype,e),n&&i(t,n),o}();e.exports=t},{"../../../webgl/vertex/VertexBuffer":198,"../WebGLOverlayRenderer":174,"lodash/defaultTo":109}],176:[function(t,e,n){"use strict";function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function u(t,e,n){return(u="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){t=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=c(t)););return t}(t,e);if(t){e=Object.getOwnPropertyDescriptor(t,e);return e.get?e.get.call(n):e.value}})(t,e,n||t)}function a(t,e){return(a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function s(n){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=c(n);return t=r?(t=c(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments),e=this,!(t=t)||"object"!==o(t)&&"function"!=typeof t?function(t){if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}}function c(t){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function l(t,e){var n=function(t){for(var e=new Float32Array(2*t.length),n=0;n<t.length;n++)e[2*n]=t[n].x,e[2*n+1]=t[n].y;return e}(e),r=f(n),e=new p(t.gl,n,{0:{size:2,type:"FLOAT"}}),n=n.length<Math.pow(2,16);return{vertex:e,index:new y(t.gl,new(n?Uint16Array:Uint32Array)(r),{mode:"TRIANGLES",type:n?"UNSIGNED_SHORT":"UNSIGNED_INT",count:r.length})}}var f=t("earcut"),h=t("lodash/defaultTo"),p=t("../../../webgl/vertex/VertexBuffer"),y=t("../../../webgl/vertex/IndexBuffer"),v=t("../WebGLOverlayRenderer"),d={vert:"\n\t\tprecision highp float;\n\t\tattribute vec2 aPosition;\n\t\tuniform vec2 uViewOffset;\n\t\tuniform float uScale;\n\t\tuniform mat4 uProjectionMatrix;\n\t\tvoid main() {\n\t\t\tvec2 wPosition = (aPosition * uScale) - uViewOffset;\n\t\t\tgl_Position = uProjectionMatrix * vec4(wPosition, 0.0, 1.0);\n\t\t}\n\t\t",frag:"\n\t\tprecision highp float;\n\t\tuniform vec4 uPolygonColor;\n\t\tuniform float uOpacity;\n\t\tvoid main() {\n\t\t\tgl_FragColor = vec4(uPolygonColor.rgb, uPolygonColor.a * uOpacity);\n\t\t}\n\t\t"},t=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&a(t,e)}(o,v);var t,e,n,r=s(o);function o(){var t,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return function(t){if(!(t instanceof o))throw new TypeError("Cannot call a class as a function")}(this),(t=r.call(this,e)).polygonColor=h(e.polygonColor,[1,.4,.1,.8]),t.shader=null,t.polygons=null,t}return t=o,(e=[{key:"onAdd",value:function(t){return u(c(o.prototype),"onAdd",this).call(this,t),this.shader=this.createShader(d),this}},{key:"onRemove",value:function(t){return u(c(o.prototype),"onRemove",this).call(this,t),this.shader=null,this}},{key:"refreshBuffers",value:function(){var e=this,t=this.overlay.getClippedGeometry();this.polygons=t?t.map(function(t){return l(e,t)}):null}},{key:"draw",value:function(){if(!this.polygons)return this;var t=this.gl,e=this.shader,n=this.polygons,r=this.overlay.plot,o=r.cell,i=this.getOrthoMatrix(),u=Math.pow(2,r.zoom-o.zoom),a=this.overlay.opacity,r=o.project(r.viewport,r.zoom);return t.enable(t.BLEND),t.blendFunc(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA),e.use(),e.setUniform("uProjectionMatrix",i),e.setUniform("uViewOffset",[r.x,r.y]),e.setUniform("uScale",u),e.setUniform("uPolygonColor",this.polygonColor),e.setUniform("uOpacity",a),n.forEach(function(t){t.vertex.bind(),t.index.draw()}),this}}])&&i(t.prototype,e),n&&i(t,n),o}();e.exports=t},{"../../../webgl/vertex/IndexBuffer":196,"../../../webgl/vertex/VertexBuffer":198,"../WebGLOverlayRenderer":174,earcut:1,"lodash/defaultTo":109}],177:[function(t,e,n){"use strict";function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function u(t,e,n){return(u="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){t=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=c(t)););return t}(t,e);if(t){e=Object.getOwnPropertyDescriptor(t,e);return e.get?e.get.call(n):e.value}})(t,e,n||t)}function a(t,e){return(a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function s(n){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=c(n);return t=r?(t=c(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments),e=this,!(t=t)||"object"!==o(t)&&"function"!=typeof t?function(t){if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}}function c(t){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function d(t,e){return{x:t.x*e,y:t.y*e}}function m(t){return{x:-t.y,y:t.x}}function b(t){return{x:-t.x,y:-t.y}}function g(t){return Math.sqrt(t.x*t.x+t.y*t.y)}function x(t){var e=Math.sqrt(t.x*t.x+t.y*t.y);return{x:t.x/e,y:t.y/e}}function _(t,e){return{x:t.x+e.x,y:t.y+e.y}}function w(t,e){return{x:t.x-e.x,y:t.y-e.y}}function f(t,e){return d(_(t,e),.5)}var l=t("lodash/defaultTo"),r=t("../../../webgl/vertex/VertexBuffer"),h=t("../WebGLOverlayRenderer"),p={vert:"\n\t\tprecision highp float;\n\t\tattribute vec2 aPosition;\n\t\tattribute vec2 aNormal;\n\t\tuniform vec2 uViewOffset;\n\t\tuniform float uScale;\n\t\tuniform float uLineWidth;\n\t\tuniform mat4 uProjectionMatrix;\n\t\tvoid main() {\n\t\t\tvec2 wPosition = (aPosition * uScale) - uViewOffset + aNormal * uLineWidth;\n\t\t\tgl_Position = uProjectionMatrix * vec4(wPosition, 0.0, 1.0);\n\t\t}\n\t\t",frag:"\n\t\tprecision highp float;\n\t\tuniform vec4 uLineColor;\n\t\tuniform float uOpacity;\n\t\tvoid main() {\n\t\t\tgl_FragColor = vec4(uLineColor.rgb, uLineColor.a * uOpacity);\n\t\t}\n\t\t"},O=1e-6,E=function(t,e,n,r,o,i){var n=Math.atan2(n.y-t.y,n.x-t.x),e=Math.atan2(e.y-t.y,e.x-t.x),u=n;n<e?e-n>=Math.PI-O&&(e-=2*Math.PI):n-e>=Math.PI-O&&(n-=2*Math.PI);n=e-n;Math.abs(n)>=Math.PI-O&&Math.abs(n)<=Math.PI+O&&(0===(r=w(t,r)).x?0<r.y&&(n=-n):r.x>=-O&&(n=-n));for(var a=Math.ceil(16*Math.abs(n/Math.PI)),s=n/a,c={x:0,y:0},l=0;l<a;l++){var f={x:Math.cos(u+s*l),y:Math.sin(u+s*l)},h={x:Math.cos(u+s*(1+l)),y:Math.sin(u+s*(1+l))};o.push(t),o.push(t),o.push(t),i.push(c),i.push(f),i.push(h)}};function y(t,e,n,r,o,i){var u=w(e,t),a=w(n,e),u=m(u),a=m(a);s=t,l=n,0<((p=e).x-s.x)*(l.y-s.y)-(l.x-s.x)*(p.y-s.y)&&(u=b(u),a=b(a)),u=x(u),a=x(a),u=d(u,i),a=d(a,i);var s=(y=_(u,t),c=_(u,e),h=_(a,n),v=_(a,e),f=c.y-y.y,l=y.x-c.x,p=v.y-h.y,c=h.x-v.x,-O<(v=f*c-p*l)&&v<O?null:(y=f*y.x+l*y.y,h=p*h.x+c*h.y,{x:(c*y-l*h)/v,y:(f*h-p*y)/v})),c=null,l=Number.MAX_VALUE,f=null;s&&(c=w(s,e),l=g(c),f=b(d(c,1/i)));var h=w(t,e),p=g(h),y=w(e,n),v=g(y),s=x(u),i=b(s),h=x(a),y=b(h);p<l||v<l?(r.push(t),r.push(t),r.push(e),o.push(s),o.push(i),o.push(s),r.push(t),r.push(e),r.push(e),o.push(i),o.push(s),o.push(i),E(e,_(e,u),_(e,a),n,r,o),r.push(n),r.push(e),r.push(e),o.push(h),o.push(y),o.push(h),r.push(n),r.push(e),r.push(n),o.push(h),o.push(y)):(r.push(t),r.push(t),r.push(e),o.push(s),o.push(i),o.push(f),r.push(t),r.push(e),r.push(e),o.push(s),o.push(f),o.push(s),r.push(e),r.push(e),r.push(e),o.push(s),o.push({x:0,y:0}),o.push(f),E(e,_(e,u),_(e,a),w(e,c),r,o),r.push(e),r.push(e),r.push(e),o.push({x:0,y:0}),o.push(h),o.push(f),r.push(n),r.push(e),r.push(e),o.push(h),o.push(f),o.push(h),r.push(n),r.push(e),r.push(n),o.push(h),o.push(f)),o.push(y)}function v(t,e){var n=function(t,e){if(t.length<2)throw"A valid polyline must consist of at least 2 points";var n,r,o=e/2,i=[],u=[],a=[],s=!1;if(2===t.length)y(t[0],f(t[0],t[1]),t[1],i,u,o);else{e=t[0],n=t[t.length-1],e.x===n.x&&e.y===n.y&&(r=f(t.shift(),t[0]),t.unshift(r),t.push(r),s=!0);for(var c=0;c<t.length-1;c++)0===c?a.push(t[0]):c===t.length-2?a.push(t[t.length-1]):a.push(f(t[c],t[c+1]));for(var l=1;l<a.length;l++)y(a[l-1],t[l],a[l],i,u,o)}return s||(n=t[0],r=t[1],s=m(w(r,n)),E(n,_(n,s),w(n,s),r,i,u),n=t[t.length-1],r=t[t.length-2],s=m(w(r,n)),E(n,_(n,s),w(n,s),r,i,u)),{positions:i,normals:u}}(e,t.lineWidth),e=function(t,e){for(var n=new Float32Array(4*t.length),r=0;r<t.length;r++){var o=t[r],i=e[r];n[4*r]=o.x,n[4*r+1]=o.y,n[4*r+2]=i.x,n[4*r+3]=i.y}return n}(n.positions,n.normals);return new r(t.gl,e,{0:{size:2,type:"FLOAT",byteOffset:0},1:{size:2,type:"FLOAT",byteOffset:8}},{mode:"TRIANGLES",count:n.positions.length})}t=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&a(t,e)}(o,h);var t,e,n,r=s(o);function o(){var t,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return function(t){if(!(t instanceof o))throw new TypeError("Cannot call a class as a function")}(this),(t=r.call(this,e)).lineColor=l(e.lineColor,[1,.4,.1,.8]),t.lineWidth=l(e.lineWidth,2),t.shader=null,t.lines=null,t}return t=o,(e=[{key:"onAdd",value:function(t){return u(c(o.prototype),"onAdd",this).call(this,t),this.shader=this.createShader(p),this}},{key:"onRemove",value:function(t){return u(c(o.prototype),"onRemove",this).call(this,t),this.shader=null,this}},{key:"refreshBuffers",value:function(){var e=this,t=this.overlay.getClippedGeometry();this.lines=t?t.map(function(t){return v(e,t)}):null}},{key:"draw",value:function(){if(!this.lines)return this;var t=this.gl,e=this.shader,n=this.lines,r=this.overlay.plot,o=r.cell,i=this.getOrthoMatrix(),u=Math.pow(2,r.zoom-o.zoom),a=this.overlay.opacity,r=o.project(r.viewport,r.zoom);return t.enable(t.BLEND),t.blendFunc(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA),e.use(),e.setUniform("uProjectionMatrix",i),e.setUniform("uViewOffset",[r.x,r.y]),e.setUniform("uScale",u),e.setUniform("uLineWidth",this.lineWidth/2),e.setUniform("uLineColor",this.lineColor),e.setUniform("uOpacity",a),n.forEach(function(t){t.bind(),t.draw()}),this}}])&&i(t.prototype,e),n&&i(t,n),o}();e.exports=t},{"../../../webgl/vertex/VertexBuffer":198,"../WebGLOverlayRenderer":174,"lodash/defaultTo":109}],178:[function(t,e,n){"use strict";function r(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function f(t,e){var n=1/Math.pow(2,e.z-t.z);return[e.x*n-t.x,e.y*n-t.y,n,n]}var o=function(){function l(t,e,n,r){!function(t){if(!(t instanceof l))throw new TypeError("Cannot call a class as a function")}(this),this.tile=t,this.hash=t.coord.hash,this.scale=e,this.tileOffset=n,this.uvOffset=r}var t,e,n;return t=l,n=[{key:"fromTile",value:function(t,e,n,r,o){r*=n;return new l(t,n,[e.x*r-o.x,e.y*r-o.y],[0,0,1,1])}},{key:"fromAncestor",value:function(t,e,n,r,o,i,u){var a,s=n*r,c=[0,0];return u===i?(c[0]=e.x*s-o.x,c[1]=e.y*s-o.y):(a=1/Math.pow(2,u.z-i.z),r=u.x*a-i.x,i=u.y*a-i.y,c[0]=(e.x+r)*s-o.x,c[1]=(e.y+i)*s-o.y,n*=a),new l(t,n,c,f(t.coord,u))}},{key:"fromDescendant",value:function(t,e,n,r,o,i){var u=n*r,a=1/Math.pow(2,t.coord.z-i.z),r=t.coord.x*a-i.x,i=t.coord.y*a-i.y;return new l(t,n*a,[(e.x+r)*u-o.x,(e.y+i)*u-o.y],[0,0,1,1])}},{key:"fromAncestorPartial",value:function(t,e,n,r,o){var i=t.tile,u=t.target,a=t.relative,s=n*r,c=[0,0];return a===t.target?(c[0]=e.x*s-o.x,c[1]=e.y*s-o.y):(r=1/Math.pow(2,a.z-u.z),t=a.x*r-u.x,u=a.y*r-u.y,c[0]=(e.x+t)*s-o.x,c[1]=(e.y+u)*s-o.y,n*=r),new l(i,n,c,f(i.coord,a))}},{key:"fromDescendantPartial",value:function(t,e,n,r,o){var i=t.tile,u=t.target,a=n*r,t=1/Math.pow(2,i.coord.z-u.z),r=i.coord.x*t-u.x,u=i.coord.y*t-u.y;return new l(i,n*t,[(e.x+r)*a-o.x,(e.y+u)*a-o.y],[0,0,1,1])}}],(e=[{key:"toCanvas",value:function(t,e){var n=this.uvOffset;n[1]=1-n[2]-n[1];n=this.tileOffset;return n[1]=t.height-n[1]-e*this.scale,this}}])&&r(t.prototype,e),n&&r(t,n),l}();e.exports=o},{}],179:[function(t,e,n){"use strict";function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function u(t,e){return(u=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function a(n){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=s(n);return t=r?(t=s(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments),e=this,!(t=t)||"object"!==o(t)&&"function"!=typeof t?function(t){if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}}function s(t){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var c=t("../../event/EventType"),l=t("../../geometry/RTreePyramid"),f=t("../Renderer"),d=t("./TileRenderable"),h=Symbol(),p=Symbol(),t=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&u(t,e)}(o,f);var t,e,n,r=a(o);function o(){var t;return function(t){if(!(t instanceof o))throw new TypeError("Cannot call a class as a function")}(this),(t=r.call(this))[h]=new Map,t[p]=new Map,t.layer=null,t}return t=o,(e=[{key:"onAdd",value:function(t){if(!t)throw"No layer provided as argument";return this.layer=t,this}},{key:"onRemove",value:function(t){if(!t)throw"No layer provided as argument";return this.layer=null,this}},{key:"createRTreePyramid",value:function(){var o=this,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},i=t.createCollidables;if(!i)throw"`options.createCollidables` argument is missing";function e(t){var e=t.tile,n=e.coord,r=o.layer.plot.tileSize,t=n.x*r,r=n.y*r,r=i(e,t,r);u.insert(n,r)}var u=new l({nodeCapacity:t.nodeCapacity}),t=function(t){u.remove(t.tile.coord)};return this.layer.on(c.TILE_ADD,e),this.layer.on(c.TILE_REMOVE,t),this[h].set(u,e),this[p].set(u,t),u}},{key:"destroyRTreePyramid",value:function(t){this.layer.removeListener(c.TILE_ADD,this[h].get(t)),this.layer.removeListener(c.TILE_REMOVE,this[p].get(t)),this[h].delete(t),this[p].delete(t)}},{key:"getRenderables",value:function(){for(var t=this.layer.plot,e=this.layer.pyramid,n=t.tileSize,r=t.zoom,o=t.getViewportPixelOffset(),i=t.getVisibleCoords(),u=[],a=0;a<i.length;a++){var s=i[a],c=s.normalize(),l=e.get(c);l&&(c=Math.pow(2,r-s.z),c=d.fromTile(l,s,c,n,o),u.push(c))}return u}},{key:"getRenderablesLOD",value:function(){for(var t=this.layer.plot,e=this.layer.pyramid,n=t.tileSize,r=t.zoom,o=t.getViewportPixelOffset(),i=t.getVisibleCoords(),u=[],a=0;a<i.length;a++){var s=i[a],c=s.normalize(),l=Math.pow(2,r-s.z),f=e.getAvailableLOD(c);if(f)for(var h=0;h<f.length;h++){var p=f[h],y=p.tile,v=void 0,v=y.coord.z===s.z?d.fromTile(y,s,l,n,o):y.coord.z<s.z?d.fromAncestorPartial(p,s,l,n,o):d.fromDescendantPartial(p,s,l,n,o);u.push(v)}}return u}}])&&i(t.prototype,e),n&&i(t,n),o}();e.exports=t},{"../../event/EventType":140,"../../geometry/RTreePyramid":148,"../Renderer":172,"./TileRenderable":178}],180:[function(t,e,n){"use strict";function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function u(t,e,n){return(u="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){t=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=c(t)););return t}(t,e);if(t){e=Object.getOwnPropertyDescriptor(t,e);return e.get?e.get.call(n):e.value}})(t,e,n||t)}function a(t,e){return(a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function s(n){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=c(n);return t=r?(t=c(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments),e=this,!(t=t)||"object"!==o(t)&&"function"!=typeof t?function(t){if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}}function c(t){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function l(t,e){t.set(e.coord.hash,e.data)}function f(t,e){t.delete(e.coord.hash)}function h(t,e){t.set(e.coord.hash,e.data,e.data.length/t.stride)}function p(t,e){t.delete(e.coord.hash)}var y=t("lodash/defaultTo"),v=t("../../event/EventType"),d=t("../../webgl/shader/Shader"),m=t("../../webgl/texture/TextureArray"),b=t("../../webgl/vertex/VertexAtlas"),g=t("./TileRenderer"),x=Symbol(),_=Symbol(),t=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&a(t,e)}(o,g);var t,e,n,r=s(o);function o(){var t;return function(t){if(!(t instanceof o))throw new TypeError("Cannot call a class as a function")}(this),(t=r.call(this)).gl=null,t[x]=new Map,t[_]=new Map,t}return t=o,(e=[{key:"onAdd",value:function(t){return u(c(o.prototype),"onAdd",this).call(this,t),this.gl=this.layer.plot.getRenderingContext(),this}},{key:"onRemove",value:function(t){return this.gl=null,u(c(o.prototype),"onRemove",this).call(this,t),this}},{key:"getOrthoMatrix",value:function(){return this.layer.plot.getOrthoMatrix()}},{key:"createShader",value:function(t){return new d(this.gl,t)}},{key:"createTextureArray",value:function(){function t(t){r(n,t.tile)}var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},n=new m(this.gl,{format:e.format,type:e.type,filter:e.filter,invertY:e.invertY,premultiplyAlpha:e.premultiplyAlpha},{numChunks:this.layer.pyramid.getCapacity(),chunkSize:e.chunkSize}),r=y(e.onAdd,l),o=y(e.onRemove,f),e=function(t){o(n,t.tile)};return this.layer.on(v.TILE_ADD,t),this.layer.on(v.TILE_REMOVE,e),this[x].set(n,t),this[_].set(n,e),n}},{key:"destroyTextureArray",value:function(t){this.layer.removeListener(v.TILE_ADD,this[x].get(t)),this.layer.removeListener(v.TILE_REMOVE,this[_].get(t)),this[x].delete(t),this[_].delete(t)}},{key:"createVertexAtlas",value:function(){function t(t){r(n,t.tile)}var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},n=new b(this.gl,e.attributePointers,{numChunks:this.layer.pyramid.getCapacity(),chunkSize:e.chunkSize}),r=y(e.onAdd,h),o=y(e.onRemove,p),e=function(t){o(n,t.tile)};return this.layer.on(v.TILE_ADD,t),this.layer.on(v.TILE_REMOVE,e),this[x].set(n,t),this[_].set(n,e),n}},{key:"destroyVertexAtlas",value:function(t){this.layer.removeListener(v.TILE_ADD,this[x].get(t)),this.layer.removeListener(v.TILE_REMOVE,this[_].get(t)),this[x].delete(t),this[_].delete(t)}}])&&i(t.prototype,e),n&&i(t,n),o}();e.exports=t},{"../../event/EventType":140,"../../webgl/shader/Shader":191,"../../webgl/texture/TextureArray":195,"../../webgl/vertex/VertexAtlas":197,"./TileRenderer":179,"lodash/defaultTo":109}],181:[function(t,e,n){"use strict";function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function u(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function a(t,e,n){return(a="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){t=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=l(t)););return t}(t,e);if(t){e=Object.getOwnPropertyDescriptor(t,e);return e.get?e.get.call(n):e.value}})(t,e,n||t)}function s(t,e){return(s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function c(n){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=l(n);return t=r?(t=l(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments),e=this,!(t=t)||"object"!==o(t)&&"function"!=typeof t?function(t){if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}}function l(t){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var f=t("../../../webgl/vertex/VertexBuffer"),h=t("../WebGLTileRenderer"),p={vert:"\n\t\tprecision highp float;\n\t\tattribute vec2 aPosition;\n\t\tattribute vec2 aTextureCoord;\n\t\tuniform vec4 uTextureCoordOffset;\n\t\tuniform vec2 uTileOffset;\n\t\tuniform float uScale;\n\t\tuniform mat4 uProjectionMatrix;\n\t\tvarying vec2 vTextureCoord;\n\t\tvoid main() {\n\t\t\tvTextureCoord = vec2(\n\t\t\t\tuTextureCoordOffset.x + (aTextureCoord.x * uTextureCoordOffset.z),\n\t\t\t\tuTextureCoordOffset.y + (aTextureCoord.y * uTextureCoordOffset.w));\n\t\t\tvec2 wPosition = (aPosition * uScale) + uTileOffset;\n\t\t\tgl_Position = uProjectionMatrix * vec4(wPosition, 0.0, 1.0);\n\t\t}\n\t\t",frag:"\n\t\tprecision highp float;\n\t\tuniform sampler2D uTextureSampler;\n\t\tuniform float uOpacity;\n\t\tvarying vec2 vTextureCoord;\n\t\tvoid main() {\n\t\t\tvec4 color = texture2D(uTextureSampler, vec2(vTextureCoord.x, 1.0 - vTextureCoord.y));\n\t\t\tgl_FragColor = vec4(color.rgb, color.a * uOpacity);\n\t\t}\n\t\t"},t=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&s(t,e)}(i,h);var t,e,n,r=c(i);function i(){var t;return function(t){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this),(t=r.call(this)).quad=null,t.shader=null,t.array=null,t}return t=i,(e=[{key:"onAdd",value:function(t){var e,n,r,o;return a(l(i.prototype),"onAdd",this).call(this,t),this.quad=(e=this.gl,n=0,r=t.plot.tileSize,(o=new Float32Array(24))[0]=n,o[1]=n,o[2]=r,o[3]=n,o[4]=r,o[5]=r,o[6]=n,o[7]=n,o[8]=r,o[9]=r,o[10]=n,o[11]=r,o[12]=0,o[13]=0,o[14]=1,o[15]=0,o[16]=1,o[17]=1,o[18]=0,o[19]=0,o[20]=1,o[21]=1,o[22]=0,o[23]=1,new f(e,o,{0:{size:2,type:"FLOAT",byteOffset:0},1:{size:2,type:"FLOAT",byteOffset:48}},{count:6})),this.shader=this.createShader(p),this.array=this.createTextureArray({chunkSize:t.plot.tileSize}),this}},{key:"onRemove",value:function(t){return this.destroyTextureArray(this.array),this.array=null,this.quad=null,this.shader=null,a(l(i.prototype),"onRemove",this).call(this,t),this}},{key:"draw",value:function(){var t=this.gl,e=this.shader,n=this.array,r=this.quad,o=this.getRenderablesLOD(),i=this.getOrthoMatrix();e.use(),e.setUniform("uProjectionMatrix",i),e.setUniform("uTextureSampler",0),e.setUniform("uOpacity",this.layer.opacity),t.enable(t.BLEND),t.blendFunc(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA),r.bind();for(var u=0;u<o.length;u++){var a=o[u];n.bind(a.hash,0),e.setUniform("uTextureCoordOffset",a.uvOffset),e.setUniform("uScale",a.scale),e.setUniform("uTileOffset",a.tileOffset),r.draw()}return r.unbind(),this}}])&&u(t.prototype,e),n&&u(t,n),i}();e.exports=t},{"../../../webgl/vertex/VertexBuffer":198,"../WebGLTileRenderer":180}],182:[function(t,e,n){"use strict";function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function u(t,e,n){return(u="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){t=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=c(t)););return t}(t,e);if(t){e=Object.getOwnPropertyDescriptor(t,e);return e.get?e.get.call(n):e.value}})(t,e,n||t)}function a(t,e){return(a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function s(n){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=c(n);return t=r?(t=c(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments),e=this,!(t=t)||"object"!==o(t)&&"function"!=typeof t?function(t){if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}}function c(t){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var l=t("lodash/defaultTo"),f=t("../../../webgl/vertex/VertexBuffer"),h=t("../WebGLTileRenderer"),p={vert:"\n\t\tprecision highp float;\n\t\tattribute vec2 aPosition;\n\t\tattribute vec2 aOffset;\n\t\tattribute float aRadius;\n\t\tuniform vec2 uTileOffset;\n\t\tuniform float uScale;\n\t\tuniform mat4 uProjectionMatrix;\n\t\tvoid main() {\n\t\t\tvec2 wPosition = (aPosition * aRadius) + (aOffset * uScale) + uTileOffset;\n\t\t\tgl_Position = uProjectionMatrix * vec4(wPosition, 0.0, 1.0);\n\t\t}\n\t\t",frag:"\n\t\tprecision highp float;\n\t\tuniform vec4 uColor;\n\t\tvoid main() {\n\t\t\tgl_FragColor = uColor;\n\t\t}\n\t\t"},t=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&a(t,e)}(o,h);var t,e,n,r=s(o);function o(){var t,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return function(t){if(!(t instanceof o))throw new TypeError("Cannot call a class as a function")}(this),(t=r.call(this)).color=l(e.color,[1,.4,.1,.8]),t.shape=null,t.shader=null,t.atlas=null,t}return t=o,(e=[{key:"onAdd",value:function(t){return u(c(o.prototype),"onAdd",this).call(this,t),this.shape=function(t){var e=2*Math.PI/5,n=e/2,r=e/4,o=new Float32Array(24);o[0]=0;for(var i=o[1]=0;i<5;i++){var u=i*e,a=.4*Math.cos(u-r),s=.4*Math.sin(u-r);o[4*i+2]=a,o[4*i+1+2]=s,a=+Math.cos(u+n-r),s=+Math.sin(u+n-r),o[4*i+2+2]=a,o[4*i+3+2]=s}return o[o.length-2]=o[2],o[o.length-1]=o[3],new f(t,o,{0:{size:2,type:"FLOAT"}},{mode:"TRIANGLE_FAN",count:o.length/2})}(this.gl),this.shader=this.createShader(p),this.atlas=this.createVertexAtlas({chunkSize:16384,attributePointers:{1:{size:2,type:"FLOAT"},2:{size:1,type:"FLOAT"}}}),this}},{key:"onRemove",value:function(t){return this.destroyVertexAtlas(this.atlas),this.atlas=null,this.shape=null,this.shader=null,u(c(o.prototype),"onRemove",this).call(this,t),this}},{key:"draw",value:function(){var t=this.gl,e=this.shader,n=this.atlas,r=this.shape,o=this.getRenderables(),i=this.getOrthoMatrix();t.enable(t.BLEND),t.blendFunc(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA),e.use(),e.setUniform("uProjectionMatrix",i),e.setUniform("uColor",this.color),r.bind(),n.bindInstanced();for(var u=0;u<o.length;u++){var a=o[u];e.setUniform("uScale",a.scale),e.setUniform("uTileOffset",a.tileOffset),n.drawInstanced(a.hash,r.mode,r.count)}return n.unbindInstanced(),r.unbind(),this}}])&&i(t.prototype,e),n&&i(t,n),o}();e.exports=t},{"../../../webgl/vertex/VertexBuffer":198,"../WebGLTileRenderer":180,"lodash/defaultTo":109}],183:[function(t,e,n){"use strict";function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function u(t,e,n){return(u="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){t=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=c(t)););return t}(t,e);if(t){e=Object.getOwnPropertyDescriptor(t,e);return e.get?e.get.call(n):e.value}})(t,e,n||t)}function a(t,e){return(a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function s(n){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=c(n);return t=r?(t=c(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments),e=this,!(t=t)||"object"!==o(t)&&"function"!=typeof t?function(t){if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}}function c(t){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function l(t,e,n){for(var r=t.data,o=new Array(r.length/3),i=0;i<r.length;i+=3)o[i/3]=new p(r[i],r[i+1],r[i+2],e,n,t);return o}function f(t,e,n,r,o,i){var u=r.tile.coord,a=Math.pow(2,n.zoom-u.z),s=n.getViewportPixelOffset(),s=[(u.x*n.tileSize+r.x)*a-s.x,(u.y*n.tileSize+r.y)*a-s.y];e.setUniform("uTileOffset",s),e.setUniform("uScale",a),e.setUniform("uColor",o),e.setUniform("uRadiusOffset",i+r.radius),t.bind(),t.draw(),t.unbind()}var h=t("lodash/defaultTo"),p=t("../../../geometry/CircleCollidable"),y=t("../../../webgl/vertex/VertexBuffer"),v=t("../WebGLTileRenderer"),d={vert:"\n\t\tprecision highp float;\n\t\tattribute vec2 aPosition;\n\t\tattribute float aRadius;\n\t\tuniform float uRadiusOffset;\n\t\tuniform vec2 uTileOffset;\n\t\tuniform float uScale;\n\t\tuniform float uPixelRatio;\n\t\tuniform mat4 uProjectionMatrix;\n\t\tvoid main() {\n\t\t\tvec2 wPosition = (aPosition * uScale) + uTileOffset;\n\t\t\tgl_PointSize = (aRadius + uRadiusOffset) * uScale * 2.0 * uPixelRatio;\n\t\t\tgl_Position = uProjectionMatrix * vec4(wPosition, 0.0, 1.0);\n\t\t}\n\t\t",frag:"\n\t\t#ifdef GL_OES_standard_derivatives\n\t\t\t#extension GL_OES_standard_derivatives : enable\n\t\t#endif\n\t\tprecision highp float;\n\t\tuniform vec4 uColor;\n\t\tvoid main() {\n\t\t\tvec2 cxy = 2.0 * gl_PointCoord - 1.0;\n\t\t\tfloat radius = dot(cxy, cxy);\n\t\t\tfloat alpha = 1.0;\n\t\t\t#ifdef GL_OES_standard_derivatives\n\t\t\t\tfloat delta = fwidth(radius);\n\t\t\t\talpha = 1.0 - smoothstep(1.0 - delta, 1.0 + delta, radius);\n\t\t\t#else\n\t\t\t\tif (radius > 1.0) {\n\t\t\t\t\tdiscard;\n\t\t\t\t}\n\t\t\t#endif\n\t\t\tgl_FragColor = vec4(uColor.rgb, uColor.a * alpha);\n\t\t}\n\t\t"},t=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&a(t,e)}(o,v);var t,e,n,r=s(o);function o(){var t,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return function(t){if(!(t instanceof o))throw new TypeError("Cannot call a class as a function")}(this),(t=r.call(this)).color=h(e.color,[1,.4,.1,.8]),t.shader=null,t.point=null,t.tree=null,t.atlas=null,t.ext=null,t}return t=o,(e=[{key:"onAdd",value:function(t){var e;return u(c(o.prototype),"onAdd",this).call(this,t),this.ext=this.gl.getExtension("OES_standard_derivatives"),this.point=(e=this.gl,(t=new Float32Array(2))[0]=0,t[1]=0,new y(e,t,{0:{size:2,type:"FLOAT"}},{mode:"POINTS",count:1})),this.shader=this.createShader(d),this.tree=this.createRTreePyramid({nodeCapacity:32,createCollidables:l}),this.atlas=this.createVertexAtlas({chunkSize:16384,attributePointers:{0:{size:2,type:"FLOAT"},1:{size:1,type:"FLOAT"}}}),this}},{key:"onRemove",value:function(t){return this.destroyVertexAtlas(this.atlas),this.destroyRTreePyramid(this.tree),this.atlas=null,this.shader=null,this.point=null,this.tree=null,this.ext=null,u(c(o.prototype),"onRemove",this).call(this,t),this}},{key:"pick",value:function(t){return this.layer.plot.isZooming()?null:this.tree.searchPoint(t.x,t.y,this.layer.plot.zoom,this.layer.plot.getPixelExtent())}},{key:"draw",value:function(){var e=this,t=this.gl,n=this.layer,r=n.plot,o=this.getOrthoMatrix(),i=this.shader;r.renderBuffer.bind(),r.renderBuffer.clear(),t.enable(t.BLEND),t.blendFunc(t.SRC_ALPHA,t.ONE),i.use(),i.setUniform("uProjectionMatrix",o),i.setUniform("uPixelRatio",r.pixelRatio),function(t,e,n,r){e.setUniform("uColor",r),e.setUniform("uRadiusOffset",0),t.bind();for(var o=0;o<n.length;o++){var i=n[o];e.setUniform("uScale",i.scale),e.setUniform("uTileOffset",i.tileOffset),t.draw(i.hash,"POINTS")}t.unbind()}(this.atlas,i,this.getRenderables(),this.color),n.getSelected().forEach(function(t){f(e.point,i,r,t,e.color,4)});o=n.getHighlighted();return o&&!n.isSelected(o)&&f(this.point,i,r,o,this.color,2),r.renderBuffer.unbind(),r.renderBuffer.blitToScreen(this.layer.opacity),this}}])&&i(t.prototype,e),n&&i(t,n),o}();e.exports=t},{"../../../geometry/CircleCollidable":146,"../../../webgl/vertex/VertexBuffer":198,"../WebGLTileRenderer":180,"lodash/defaultTo":109}],184:[function(t,e,n){"use strict";function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function u(t,e,n){return(u="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){t=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=c(t)););return t}(t,e);if(t){e=Object.getOwnPropertyDescriptor(t,e);return e.get?e.get.call(n):e.value}})(t,e,n||t)}function a(t,e){return(a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function s(n){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=c(n);return t=r?(t=c(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments),e=this,!(t=t)||"object"!==o(t)&&"function"!=typeof t?function(t){if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}}function c(t){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var l=t("lodash/defaultTo"),f=t("../WebGLTileRenderer"),h={vert:"\n\t\tprecision highp float;\n\t\tattribute vec2 aPosition;\n\t\tattribute float aRadius;\n\t\tuniform vec2 uTileOffset;\n\t\tuniform float uScale;\n\t\tuniform float uPixelRatio;\n\t\tuniform mat4 uProjectionMatrix;\n\t\tvoid main() {\n\t\t\tvec2 wPosition = (aPosition * uScale) + uTileOffset;\n\t\t\tgl_PointSize = aRadius * 2.0 * uPixelRatio;\n\t\t\tgl_Position = uProjectionMatrix * vec4(wPosition, 0.0, 1.0);\n\t\t}\n\t\t",frag:"\n\t\t#ifdef GL_OES_standard_derivatives\n\t\t\t#extension GL_OES_standard_derivatives : enable\n\t\t#endif\n\t\tprecision highp float;\n\t\tuniform vec4 uColor;\n\t\tvoid main() {\n\t\t\tvec2 cxy = 2.0 * gl_PointCoord - 1.0;\n\t\t\tfloat radius = dot(cxy, cxy);\n\t\t\tfloat alpha = 1.0;\n\t\t\t#ifdef GL_OES_standard_derivatives\n\t\t\t\tfloat delta = fwidth(radius);\n\t\t\t\talpha = 1.0 - smoothstep(1.0 - delta, 1.0 + delta, radius);\n\t\t\t#else\n\t\t\t\tif (radius > 1.0) {\n\t\t\t\t\tdiscard;\n\t\t\t\t}\n\t\t\t#endif\n\t\t\tgl_FragColor = vec4(uColor.rgb, uColor.a * alpha);\n\t\t}\n\t\t"},t=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&a(t,e)}(o,f);var t,e,n,r=s(o);function o(){var t,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return function(t){if(!(t instanceof o))throw new TypeError("Cannot call a class as a function")}(this),(t=r.call(this)).color=l(e.color,[1,.4,.1,.8]),t.shader=null,t.atlas=null,t.ext=null,t}return t=o,(e=[{key:"onAdd",value:function(t){return u(c(o.prototype),"onAdd",this).call(this,t),this.ext=this.gl.getExtension("OES_standard_derivatives"),this.shader=this.createShader(h),this.atlas=this.createVertexAtlas({chunkSize:16384,attributePointers:{0:{size:2,type:"FLOAT"},1:{size:1,type:"FLOAT"}}}),this}},{key:"onRemove",value:function(t){return this.destroyVertexAtlas(this.atlas),this.atlas=null,this.shader=null,this.ext=null,u(c(o.prototype),"onRemove",this).call(this,t),this}},{key:"draw",value:function(){var t=this.gl,e=this.shader,n=this.atlas,r=this.layer.plot,o=this.getRenderables(),i=this.getOrthoMatrix();r.renderBuffer.bind(),r.renderBuffer.clear(),t.enable(t.BLEND),t.blendFunc(t.SRC_ALPHA,t.ONE),e.use(),e.setUniform("uProjectionMatrix",i),e.setUniform("uColor",this.color),e.setUniform("uPixelRatio",r.pixelRatio),n.bind();for(var u=0;u<o.length;u++){var a=o[u];e.setUniform("uScale",a.scale),e.setUniform("uTileOffset",a.tileOffset),n.draw(a.hash,"POINTS")}return n.unbind(),r.renderBuffer.unbind(),r.renderBuffer.blitToScreen(this.layer.opacity),this}}])&&i(t.prototype,e),n&&i(t,n),o}();e.exports=t},{"../WebGLTileRenderer":180,"lodash/defaultTo":109}],185:[function(t,e,n){"use strict";var r=(navigator&&navigator.userAgent||"").toLowerCase(),o=(navigator&&navigator.vendor||"").toLowerCase();e.exports={firefox:!!r.match(/(?:firefox|fxios)\/(\d+)/),chrome:!!(/google inc/.test(o)?r.match(/(?:chrome|crios)\/(\d+)/):null),ie:!!r.match(/(?:msie |trident.+?; rv:)(\d+)/),edge:!!r.match(/edge\/(\d+)/),opera:!!r.match(/(?:^opera.+?version|opr)\/(\d+)/),safari:!!r.match(/version\/(\d+).+?safari/)}},{}],186:[function(t,e,n){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function u(t,e){var n;e&&(n=e.value,t[l]&&t[l](n.value,n.key),t[p]--,t[f].delete(n.key),t[h].removeNode(e))}var a=t("lodash/defaultTo"),s=t("./LinkedList"),c=Symbol(),l=Symbol(),f=Symbol(),h=Symbol(),p=Symbol(),t=function(){function e(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};o(this,e),this[c]=a(Math.max(1,t.capacity),256),this[l]=a(t.onRemove,null),this.clear()}var t,n,r;return t=e,(n=[{key:"getCapacity",value:function(){return this[c]}},{key:"getLength",value:function(){return this[p]}},{key:"forEach",value:function(t){for(var e=this[h].head;null!==e;){var n=e.next;t(e.value.value,e.value.key),e=n}}},{key:"clear",value:function(){var e=this;this[l]&&this[h]&&this[h].forEach(function(t){e[l](t.value,t.key)}),this[f]=new Map,this[h]=new s,this[p]=0}},{key:"set",value:function(t,e){if(this[f].has(t)){var n=this[f].get(t).value;return this[l]&&this[l](n.value,t),n.value=e,void this.get(t)}e=new y(t,e);this[p]++,this[h].unshift(e),this[f].set(t,this[h].head),this[p]>this[c]&&u(this,this[h].tail)}},{key:"has",value:function(t){return!!this[f].has(t)}},{key:"get",value:function(t){t=this[f].get(t);if(t)return this[h].unshiftNode(t),t.value.value}},{key:"peek",value:function(t){t=this[f].get(t);if(t)return t.value.value}},{key:"delete",value:function(t){u(this,this[f].get(t))}}])&&i(t.prototype,n),r&&i(t,r),e}(),y=function t(e,n){o(this,t),this.key=e,this.value=n};e.exports=t},{"./LinkedList":187,"lodash/defaultTo":109}],187:[function(t,e,n){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var r=function(){function t(){i(this,t),this.tail=null,this.head=null,this.length=0}var e,n,r;return e=t,(n=[{key:"push",value:function(t){return this.tail=new u(t,this.tail,null,this),this.head||(this.head=this.tail),this.length++,this.length}},{key:"unshift",value:function(t){return this.head=new u(t,null,this.head,this),this.tail||(this.tail=this.head),this.length++,this.length}},{key:"pop",value:function(){if(this.tail){var t=this.tail.value;return this.tail=this.tail.prev,this.tail?this.tail.next=null:this.head=null,this.length--,t}}},{key:"shift",value:function(){if(this.head){var t=this.head.value;return this.head=this.head.next,this.head?this.head.prev=null:this.tail=null,this.length--,t}}},{key:"get",value:function(t){for(var e=0,n=this.head;null!==n&&e<t;e++)n=n.next;if(e===t&&null!==n)return n.value}},{key:"forEach",value:function(t){for(var e=this.head,n=0;null!==e;n++)t(e.value,n),e=e.next}},{key:"map",value:function(t){for(var e=new Array(this.length),n=0,r=this.head;null!==r;n++)e[n]=t(r.value,n),r=r.next;return e}},{key:"pushNode",value:function(t){if(t!==this.tail){t.list&&t.list.removeNode(t);var e=this.tail;return t.list=this,(t.prev=e)&&(e.next=t),this.tail=t,this.head||(this.head=t),this.length++,this.length}}},{key:"unshiftNode",value:function(t){if(t!==this.head){t.list&&t.list.removeNode(t);var e=this.head;return t.list=this,(t.next=e)&&(e.prev=t),this.head=t,this.tail||(this.tail=t),this.length++,this.length}}},{key:"removeNode",value:function(t){if(t.list!==this)throw"Removing node which does not belong to this list";var e=t.next,n=t.prev;return e&&(e.prev=n),n&&(n.next=e),t===this.head&&(this.head=e),t===this.tail&&(this.tail=n),t.list.length--,t.next=null,t.prev=null,t.list=null,this.length}}])&&o(e.prototype,n),r&&o(e,r),t}(),u=function t(e,n,r,o){i(this,t),this.list=o,this.value=e,n?(n.next=this).prev=n:this.prev=null,r?(r.prev=this).next=r:this.next=null};e.exports=r},{}],188:[function(t,e,n){"use strict";e.exports=function(t,e){var n=new XMLHttpRequest;n.open("GET",t,!0),n.responseType="arraybuffer",n.onload=function(){var t=n.response;t?e(null,t):(t="Unable to load ArrayBuffer from URL: `".concat(event.path[0].currentSrc,"`"),e(t,null))},n.onerror=function(t){t="Unable to load ArrayBuffer from URL: `".concat(t.path[0].currentSrc,"`");e(t,null)},n.withCredentials=!0,n.send(null)}},{}],189:[function(t,e,n){"use strict";e.exports=function(t,e){var n=new Image;n.onload=function(){e(null,n)},n.onerror=function(t){t="Unable to load image from URL: `".concat(t.path[0].currentSrc,"`");e(t,null)},n.crossOrigin="anonymous",n.src=t}},{}],190:[function(t,e,n){"use strict";function o(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var i=t("./texture/Texture"),u=t("./shader/Shader"),a=t("./vertex/VertexBuffer"),s={vert:"\n\t\tprecision highp float;\n\t\tattribute vec3 aVertexPosition;\n\t\tattribute vec2 aTextureCoord;\n\t\tvarying vec2 vTextureCoord;\n\t\tvoid main(void) {\n\t\t\tvTextureCoord = aTextureCoord;\n\t\t\tgl_Position = vec4(aVertexPosition, 1.0);\n\t\t}\n\t\t",frag:"\n\t\tprecision highp float;\n\t\tuniform float uOpacity;\n\t\tuniform sampler2D uTextureSampler;\n\t\tvarying vec2 vTextureCoord;\n\t\tvoid main(void) {\n\t\t\tvec4 color = texture2D(uTextureSampler, vTextureCoord);\n\t\t\tgl_FragColor = vec4(color.rgb, color.a * uOpacity);\n\t\t}\n\t\t"},c=function(t,e,n){var r=new Float32Array(24);return r[0]=e,r[1]=e,r[2]=n,r[3]=e,r[4]=n,r[5]=n,r[6]=e,r[7]=e,r[8]=n,r[9]=n,r[10]=e,r[11]=n,r[12]=0,r[13]=0,r[14]=1,r[15]=0,r[16]=1,r[17]=1,r[18]=0,r[19]=0,r[20]=1,r[21]=1,r[22]=0,r[23]=1,new a(t,r,{0:{size:2,type:"FLOAT",byteOffset:0},1:{size:2,type:"FLOAT",byteOffset:48}},{count:6})},l=function(t,e,n,r){t.bindFramebuffer(t.FRAMEBUFFER,e),t.framebufferTexture2D(t.FRAMEBUFFER,t["COLOR_ATTACHMENT".concat(r)],t.TEXTURE_2D,n.texture,0),t.bindFramebuffer(t.FRAMEBUFFER,null)},t=function(){function r(t,e,n){!function(t){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}(this),this.gl=t,this.framebuffer=t.createFramebuffer(),this.shader=new u(t,s),this.quad=c(t,-1,1),this.texture=new i(t,null,{width:e,height:n,filter:"NEAREST",invertY:!1,premultiplyAlpha:!1}),l(this.gl,this.framebuffer,this.texture,0)}var t,e,n;return t=r,(e=[{key:"bind",value:function(){var t=this.gl;return t.bindFramebuffer(t.FRAMEBUFFER,this.framebuffer),this}},{key:"unbind",value:function(){var t=this.gl;return t.bindFramebuffer(t.FRAMEBUFFER,null),this}},{key:"clear",value:function(){return this.gl.clearColor(0,0,0,0),this.gl.clear(this.gl.COLOR_BUFFER_BIT),this}},{key:"blitToScreen",value:function(t){var e,n,r,o;return e=this.gl,n=this.texture,r=this.shader,o=this.quad,t=t,r.use(),e.enable(e.BLEND),e.blendFunc(e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA),r.setUniform("uOpacity",t),r.setUniform("uTextureSampler",0),n.bind(0),o.bind(),o.draw(),o.unbind(),this}},{key:"resize",value:function(t,e){return this.texture.resize(t,e),this}}])&&o(t.prototype,e),n&&o(t,n),r}();e.exports=t},{"./shader/Shader":191,"./texture/Texture":194,"./vertex/VertexBuffer":198}],191:[function(t,e,n){"use strict";function o(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function h(t,e,n){if(n=t.createShader(t[n]),t.shaderSource(n,e),t.compileShader(n),t.getShaderParameter(n,t.COMPILE_STATUS))return n;var r=(e=e.split("\n")).length.toString().length+1,e=e.map(function(t,e){return"".concat(function(t,e){var n=e-(t=t.toString()).length;t+=":";for(var r=0;r<n;r++)t+=" ";return t}(e+1,r)," ").concat(t)}).join("\n"),n=t.getShaderInfoLog(n);throw"An error occurred compiling the shader:\n\n".concat(n.slice(0,n.length-1),"\n").concat(e)}var p=t("lodash/map"),y=t("./parseShader"),v={bool:"uniform1i","bool[]":"uniform1iv",float:"uniform1f","float[]":"uniform1fv",int:"uniform1i","int[]":"uniform1iv",uint:"uniform1i","uint[]":"uniform1iv",vec2:"uniform2fv","vec2[]":"uniform2fv",ivec2:"uniform2iv","ivec2[]":"uniform2iv",vec3:"uniform3fv","vec3[]":"uniform3fv",ivec3:"uniform3iv","ivec3[]":"uniform3iv",vec4:"uniform4fv","vec4[]":"uniform4fv",ivec4:"uniform4iv","ivec4[]":"uniform4iv",mat2:"uniformMatrix2fv","mat2[]":"uniformMatrix2fv",mat3:"uniformMatrix3fv","mat3[]":"uniformMatrix3fv",mat4:"uniformMatrix4fv","mat4[]":"uniformMatrix4fv",sampler2D:"uniform1i",samplerCube:"uniform1i"},i=function(t,e){var n,r,o,i,u,a,s=t.gl,c=(f=e.define,p(f,function(t,e){return"#define ".concat(e," ").concat(t)}).join("\n"))+(e.common||""),l=c+e.vert,f=c+e.frag,c=h(s,l,"VERTEX_SHADER"),e=h(s,f,"FRAGMENT_SHADER");if(n=t,y([l,f],["uniform","attribute"]).forEach(function(t){var e;"attribute"===t.qualifier?n.attributes.set(t.name,{type:t.type,index:n.attributes.size}):(e=t.type+(1<t.count?"[]":""),n.uniforms.set(t.name,{type:t.type,func:v[e]}))}),t.program=s.createProgram(),s.attachShader(t.program,c),s.attachShader(t.program,e),o=(r=t).gl,r.attributes.forEach(function(t,e){o.bindAttribLocation(r.program,t.index,e)}),s.linkProgram(t.program),!s.getProgramParameter(t.program,s.LINK_STATUS))throw"An error occured linking the shader:\n".concat(s.getProgramInfoLog(t.program));u=(i=t).gl,(a=i.uniforms).forEach(function(t,e){var n=u.getUniformLocation(i.program,e);null===n?a.delete(e):t.location=n})},t=function(){function n(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};if(!function(t){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this),!e.vert)throw"Vertex shader argument `vert` has not been provided";if(!e.frag)throw"Fragment shader argument `frag` has not been provided";this.gl=t,this.program=null,this.attributes=new Map,this.uniforms=new Map,i(this,e)}var t,e,r;return t=n,(e=[{key:"use",value:function(){return this.gl.useProgram(this.program),this}},{key:"setUniform",value:function(t,e){var n=this.uniforms.get(t);if(!n)throw"No uniform found under name `".concat(t,"`");if(null==e)throw"Value passed for uniform `".concat(t,"` is undefined or null");return"mat2"===n.type||"mat3"===n.type||"mat4"===n.type?this.gl[n.func](n.location,!1,e):this.gl[n.func](n.location,e),this}}])&&o(t.prototype,e),r&&o(t,r),n}();e.exports=t},{"./parseShader":192,"lodash/map":127}],192:[function(t,e,n){"use strict";function u(t){var e=t.split(",").map(function(t){return t.trim()}),n=(t=e.shift().split(" ")).shift(),r=t.shift();return t.concat(e).map(function(t){return function(t,e,n){n=n.match(o);return{qualifier:t,type:e,name:n[1],count:void 0===n[2]?1:parseInt(n[2],10)}}(n,r,t)})}var a=t("./preprocess"),s=/(\/\*([\s\S]*?)\*\/)|(\/\/(.*)$)/gm,c=/(\r\n|\n|\r)/gm,l=/\s{2,}/g,f=/(\s*)(\[)(\s*)(\d+)(\s*)(\])(\s*)/g,o=/([a-zA-Z_][a-zA-Z0-9_]*)(?:\[(\d+)\])?/,h=/\bprecision\s+\w+\s+\w+;/g,p=/\b(highp|mediump|lowp)\s+/g;e.exports=function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],o=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[];if(0===t.length||0===o.length)return[];t=Array.isArray(t)?t:[t],o=Array.isArray(o)?o:[o];var e,i=[];return t.forEach(function(t){var e,n,r;t=t.replace(s,""),t=a(t),t=t.replace(h,"").replace(p,""),t=t.replace(c," ").replace(l," ").replace(f,"$2$4$6"),i=i.concat((e=o,t=(t=t).split(";"),e=e.join("|"),n=new RegExp("\\b("+e+")\\b.*"),r=[],t.forEach(function(t){t=t.match(n);t&&(r=r.concat(u(t[0])))}),r))}),e={},i.filter(function(t){return!e[t.name]&&(e[t.name]=!0)})}},{"./preprocess":193}],193:[function(t,e,n){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function i(t,e,n){return e&&r(t.prototype,e),n&&r(t,n),t}function u(t,e,n){if(void 0===e)return"!"===t[0]?!("true"===t||1<=t):"true"===t||1<=t;switch(e){case"==":return t===n;case"!=":return t!==n;case">":return n<t;case">=":return n<=t;case"<":return t<n;case"<=":return t<=n}throw"Unrecognized logical operator `".concat(e,"`")}var s="__DEFINED__",c=/#define\b/i,l=/#undef\b/i,f=/#if\b/i,h=/#ifdef\b/i,p=/#ifndef\b/i,y=/#else\b/i,v=/#elif\b/i,d=/#endif\b/i,m=/#define\s+(\w+)(\s(\w*)?)?/i,b=/#undef\s+(\w+)/i,a=/#if\s+\(?\s*(!?\s*\w+)\s*(==|!=|>=|<=|<|>)?\s*(\w*)\s*\)?/i,g=/#ifdef\s+(\w+)/i,x=/#ifndef\s+(\w+)/i,_=/#elif\s+\(?\s*(!?\s*\w+)\s*(==|!=|>=|<=|<|>)?\s*(\w*)\s*\)?/i,w=/#([\W\w\s\d])(?:.*\\r?\n)*.*$/gm,O=function(){function n(t,e){o(this,n),this.type=t,this.conditional=e.trim(),this.body=[],this.children=[]}return i(n,[{key:"eval",value:function(){var t;switch(this.type){case"if":return t=a.exec(this.conditional),u(t[1],t[2],t[3]);case"ifdef":return(t=g.exec(this.conditional))[1]===s;case"ifndef":return(t=x.exec(this.conditional))[1]!==s;case"elif":return t=_.exec(this.conditional),u(t[1],t[2],t[3])}throw"Unrecognized conditional type `".concat(this.type,"`")}}]),n}(),E=function(){function r(t,e,n){o(this,r),this.if=new O(t,e),this.elif=[],this.else=null,this.parent=null,this.current=this.if,this.startLine=n,this.endLine=null}return i(r,[{key:"addElse",value:function(t){this.current=new O("else",t),this.else=this.current}},{key:"addElif",value:function(t){this.current=new O("elif",t),this.elif.push(this.current)}},{key:"addBody",value:function(t,e){this.current.body.push({string:t.trim(),line:e})}},{key:"nest",value:function(t){(t.parent=this).current.children.push(t)}},{key:"extract",value:function(){var e=[];if(this.if.eval())return e=e.concat(this.if.body),this.if.children.forEach(function(t){e=e.concat(t.extract())}),e;for(var t=0;t<this.elif.length;t++){var n=this.elif[t];if(n.eval()){e=e.concat(n.body);for(var r=0;r<n.children.length;r++)var o=n.children[r],e=e.concat(o.extract());return e}}return this.else?(e=e.concat(this.else.body),this.else.children.forEach(function(t){e=e.concat(t.extract())}),e):[]}},{key:"eval",value:function(){return this.extract().sort(function(t,e){return t.line-e.line}).map(function(t){return t.string}).join("\n")}}]),r}();e.exports=function(t){var r,o,e=t.split("\n");t=e,r=new Map,o=[],t.forEach(function(n){var t,e;n.match(c)?(t=m.exec(n),r.set(t[1],t[2]||s)):n.match(l)?(t=b.exec(n),r.delete(t[1])):(n.match(h)?(e=g.exec(n),r.has(e[1])&&(n=n.replace(e[1],s))):n.match(p)?(e=x.exec(n),r.has(e[1])&&(n=n.replace(e[1],s))):r.forEach(function(t,e){n=n.replace(e,t)}),o.push(n))});for(var n=function(t){var o=[],i=null;if(t.forEach(function(t,e){if(t.match(f)){var n=new E("if",t,e);i?i.nest(n):o.push(n),i=n}else if(t.match(h)){var r=new E("ifdef",t,e);i?i.nest(r):o.push(r),i=r}else if(t.match(p)){r=new E("ifndef",t,e);i?i.nest(r):o.push(r),i=r}else if(t.match(v)){if(!i)throw"Invalid preprocessor syntax, unexpected `#elif`";i.addElif(t)}else if(t.match(y)){if(!i)throw"Invalid preprocessor syntax, unexpected `#else`";i.addElse(t)}else if(t.match(d)){if(!i)throw"Invalid preprocessor syntax, unexpected `#endif`";i.endLine=e,i=i.parent}else i&&i.addBody(t,e)}),i)throw"Invalid preprocessor syntax, missing expected `#endif`";return o}(e=o),i=n.length-1;0<=i;i--){var u=n[i],a=u.eval();0<a.length?e.splice(u.startLine,u.endLine-u.startLine+1,a):e.splice(u.startLine,u.endLine-u.startLine+1)}return e.join("\n").replace(w,"")}},{}],194:[function(t,e,n){"use strict";function o(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var i=t("lodash/defaultTo"),t=function(){function r(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null,n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{};!function(t){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}(this),this.gl=t,this.texture=t.createTexture(),this.format=i(n.format,"RGBA"),this.type=i(n.type,"UNSIGNED_BYTE"),this.filter=i(n.filter,"LINEAR"),this.wrap=i(n.wrap,"CLAMP_TO_EDGE"),this.invertY=i(n.invertY,!1),this.premultiplyAlpha=i(n.premultiplyAlpha,!1),this.bufferData(e,n.width,n.height),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t[this.wrap]),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t[this.wrap]),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t[this.filter]),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t[this.filter])}var t,e,n;return t=r,(e=[{key:"bind",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,e=this.gl;return e.activeTexture(e["TEXTURE".concat(t)]),e.bindTexture(e.TEXTURE_2D,this.texture),this}},{key:"unbind",value:function(){var t=this.gl;return t.bindTexture(t.TEXTURE_2D,null),this}},{key:"bufferData",value:function(t,e,n){var r=this.gl;return r.bindTexture(r.TEXTURE_2D,this.texture),r.pixelStorei(r.UNPACK_FLIP_Y_WEBGL,this.invertY),r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,this.premultiplyAlpha),t&&t.width&&t.height?(this.width=t.width,this.height=t.height,r.texImage2D(r.TEXTURE_2D,0,r[this.format],r[this.format],r[this.type],t)):(this.width=e||this.width,this.height=n||this.height,r.texImage2D(r.TEXTURE_2D,0,r[this.format],this.width,this.height,0,r[this.format],r[this.type],t)),this}},{key:"bufferSubData",value:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:void 0,o=4<arguments.length&&void 0!==arguments[4]?arguments[4]:void 0,i=this.gl;return i.bindTexture(i.TEXTURE_2D,this.texture),i.pixelStorei(i.UNPACK_FLIP_Y_WEBGL,this.invertY),i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,this.premultiplyAlpha),t.width&&t.height?i.texSubImage2D(i.TEXTURE_2D,0,e,n,i[this.format],i[this.type],t):i.texSubImage2D(i.TEXTURE_2D,0,e,n,r,o,i[this.format],i[this.type],t),this}},{key:"resize",value:function(t,e){return this.bufferData(null,t,e),this}}])&&o(t.prototype,e),n&&o(t,n),r}();e.exports=t},{"lodash/defaultTo":109}],195:[function(t,e,n){"use strict";function r(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var i=t("lodash/defaultTo"),u=function(t,e,n,r,o,i,u,a){var s=t.createTexture();return t.bindTexture(t.TEXTURE_2D,s),t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,u),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,a),t.texImage2D(t.TEXTURE_2D,0,t[e],n,n,0,t[e],t[r],null),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t[i]),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t[i]),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t[o]),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t[o]),s},t=function(){function o(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{};!function(t){if(!(t instanceof o))throw new TypeError("Cannot call a class as a function")}(this),this.gl=t,this.chunkSize=i(n.chunkSize,256),this.numChunks=i(n.numChunks,256),this.format=i(e.format,"RGBA"),this.type=i(e.type,"UNSIGNED_BYTE"),this.filter=i(e.filter,"LINEAR"),this.wrap=i(e.wrap,"CLAMP_TO_EDGE"),this.invertY=i(e.invertY,!1),this.premultiplyAlpha=i(e.premultiplyAlpha,!1),this.available=new Array(this.numChunks);for(var r=0;r<this.numChunks;r++)this.available[r]={texture:u(this.gl,this.format,this.chunkSize,this.type,this.filter,this.wrap,this.invertY,this.premultiplyAlpha)};this.used=new Map}var t,e,n;return t=o,(e=[{key:"has",value:function(t){return this.used.has(t)}},{key:"get",value:function(t){return this.used.get(t)}},{key:"set",value:function(t,e){if(this.has(t))throw"Tile of coord ".concat(t," already exists in the array");if(0===this.available.length)throw"No available texture chunks in array";var n=this.available.pop(),r=this.gl;r.bindTexture(r.TEXTURE_2D,n.texture),r.pixelStorei(r.UNPACK_FLIP_Y_WEBGL,this.invertY),r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,this.premultiplyAlpha),e.width&&e.height?r.texImage2D(r.TEXTURE_2D,0,r[this.format],r[this.format],r[this.type],e):r.texImage2D(r.TEXTURE_2D,0,r[this.format],this.chunkSize,this.chunkSize,0,r[this.format],r[this.type],e),this.used.set(t,n)}},{key:"delete",value:function(t){if(!this.has(t))throw"Tile of coord ".concat(t," does not exist in the array");var e=this.used.get(t);return this.used.delete(t),this.available.push(e),this}},{key:"bind",value:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;if(!this.has(t))throw"Tile of coord ".concat(t," does not exist in the array");var n=this.gl,t=this.used.get(t);return n.activeTexture(n["TEXTURE".concat(e)]),n.bindTexture(n.TEXTURE_2D,t.texture),this}},{key:"unbind",value:function(){return this}}])&&r(t.prototype,e),n&&r(t,n),o}();e.exports=t},{"lodash/defaultTo":109}],196:[function(t,e,n){"use strict";function o(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var i=t("lodash/defaultTo"),t=function(){function r(t,e){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{};!function(t){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}(this),this.gl=t,this.type=i(n.type,"UNSIGNED_SHORT"),this.mode=i(n.mode,"TRIANGLES"),this.count=i(n.count,0),this.byteOffset=i(n.byteOffset,0),e instanceof WebGLBuffer?this.buffer=e:(this.buffer=t.createBuffer(),e&&this.bufferData(e))}var t,e,n;return t=r,(e=[{key:"bufferData",value:function(t){var e=this.gl;e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this.buffer),e.bufferData(e.ELEMENT_ARRAY_BUFFER,t,e.STATIC_DRAW)}},{key:"bufferSubData",value:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,n=this.gl;return n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,this.buffer),n.bufferSubData(n.ELEMENT_ARRAY_BUFFER,e,t),this}},{key:"draw",value:function(){var t=this.gl;return t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.buffer),t.drawElements(t[this.mode],this.count,t[this.type],this.byteOffset),this}}])&&o(t.prototype,e),n&&o(t,n),r}();e.exports=t},{"lodash/defaultTo":109}],197:[function(t,e,n){"use strict";function r(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var s=t("lodash/defaultTo"),o=t("lodash/forIn"),i={BYTE:1,UNSIGNED_BYTE:1,SHORT:2,UNSIGNED_SHORT:2,FIXED:4,FLOAT:4},c=function(t,e){var n=0;return t.forEach(function(t){n+=i[t.type]*t.size*e}),n},l=function(n,t,r){var o=0;t.forEach(function(t,e){n.byteOffsets[e]=r+o,o+=i[t.type]*t.size})},f=function(t){var e=0;return t.forEach(function(t){e+=t.size}),e},h=function(t){var n=new Map,r=0;return o(t,function(t,e){n.set(e,{type:t.type,size:t.size,byteOffset:r,byteStride:0}),r+=i[t.type]*t.size}),n.forEach(function(t){t.byteStride=r}),n},t=function(){function a(t,e){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{};if(!function(t){if(!(t instanceof a))throw new TypeError("Cannot call a class as a function")}(this),this.gl=t,this.ext=t.getExtension("ANGLE_instanced_arrays"),!this.ext)throw"ANGLE_instanced_arrays WebGL extension is not supported";if(this.chunkSize=s(n.chunkSize,16384),this.numChunks=s(n.numChunks,256),!e)throw"No attribute pointers provided";this.pointers=h(e),this.stride=f(this.pointers),this.available=new Array(this.numChunks);for(var r=c(this.pointers,this.chunkSize),o=0;o<this.numChunks;o++){var i=o*r,u={count:0,chunkOffset:o*this.chunkSize,chunkByteOffset:i,byteOffsets:{}};l(u,this.pointers,i),this.available[o]=u}this.used=new Map,this.buffer=t.createBuffer();e=r*this.numChunks;t.bindBuffer(t.ARRAY_BUFFER,this.buffer),t.bufferData(t.ARRAY_BUFFER,e,t.DYNAMIC_DRAW)}var t,e,n;return t=a,(e=[{key:"has",value:function(t){return this.used.has(t)}},{key:"get",value:function(t){return this.used.get(t)}},{key:"set",value:function(t,e,n){if(this.has(t))throw"Tile of coord ".concat(t," already exists in the atlas");if(0===this.available.length)throw"No available vertex chunks in atlas";if(n>this.chunkSize)throw"Data count of ".concat(n," is greater that allocated size of ").concat(this.chunkSize);var r=this.available.pop();0<(r.count=n)&&((n=this.gl).bindBuffer(n.ARRAY_BUFFER,this.buffer),n.bufferSubData(n.ARRAY_BUFFER,r.chunkByteOffset,e)),this.used.set(t,r)}},{key:"delete",value:function(t){if(!this.has(t))throw"Tile of coord ".concat(t," does not exist in the atlas");var e=this.used.get(t);return this.used.delete(t),this.available.push(e),this}},{key:"bind",value:function(){var n=this.gl;return n.bindBuffer(n.ARRAY_BUFFER,this.buffer),this.pointers.forEach(function(t,e){n.enableVertexAttribArray(e),n.vertexAttribPointer(e,t.size,n[t.type],!1,t.byteStride,t.byteOffset)}),this}},{key:"bindInstanced",value:function(){var n=this.gl,r=this.ext;return n.bindBuffer(n.ARRAY_BUFFER,this.buffer),this.pointers.forEach(function(t,e){n.enableVertexAttribArray(e),r.vertexAttribDivisorANGLE(e,1)}),this}},{key:"unbind",value:function(){var n=this.gl;return this.pointers.forEach(function(t,e){n.disableVertexAttribArray(e)}),this}},{key:"unbindInstanced",value:function(){var n=this.gl,r=this.ext;return this.pointers.forEach(function(t,e){n.disableVertexAttribArray(e),r.vertexAttribDivisorANGLE(e,0)}),this}},{key:"draw",value:function(t,e){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:0;if(!this.has(t))throw"Tile of coord ".concat(t," does not exist in the atlas");var o=this.gl,t=this.used.get(t);0<t.count&&o.drawArrays(o[e],t.chunkOffset+n,r||t.count)}},{key:"drawInstanced",value:function(t,e,n){if(!this.has(t))throw"Tile of coord ".concat(t," does not exist in the atlas");var r=this.gl,o=this.ext,i=this.used.get(t);this.pointers.forEach(function(t,e){r.vertexAttribPointer(e,t.size,r[t.type],!1,t.byteStride,i.byteOffsets[e])}),0<i.count&&o.drawArraysInstancedANGLE(r[e],0,n,i.count)}}])&&r(t.prototype,e),n&&r(t,n),a}();e.exports=t},{"lodash/defaultTo":109,"lodash/forIn":111}],198:[function(t,e,n){"use strict";function r(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var i=t("lodash/defaultTo"),o=t("lodash/forIn"),u={BYTE:1,UNSIGNED_BYTE:1,SHORT:2,UNSIGNED_SHORT:2,FIXED:4,FLOAT:4},a=function(t){if(1===t.size)return 0;var r=0,o=0,i=0;return t.forEach(function(t){var e=t.byteOffset,n=t.size,t=t.type;o+=n*u[t],r<e&&(i=(r=e)+n*u[t])}),o<=r?0:i},s=function(t){var n=new Map;return o(t,function(t,e){e=parseInt(e,10);t.byteOffset=i(t.byteOffset,0),n.set(e,t)}),n},t=function(){function o(t,e){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:{};!function(t){if(!(t instanceof o))throw new TypeError("Cannot call a class as a function")}(this),this.gl=t,this.mode=i(r.mode,"TRIANGLES"),this.count=i(r.count,0),this.indexOffset=i(r.indexOffset,0),this.pointers=s(n),this.byteStride=a(this.pointers),e instanceof WebGLBuffer?this.buffer=e:(this.buffer=t.createBuffer(),e&&this.bufferData(e))}var t,e,n;return t=o,(e=[{key:"bufferData",value:function(t){var e=this.gl;return e.bindBuffer(e.ARRAY_BUFFER,this.buffer),e.bufferData(e.ARRAY_BUFFER,t,e.STATIC_DRAW),this}},{key:"bufferSubData",value:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,n=this.gl;return n.bindBuffer(n.ARRAY_BUFFER,this.buffer),n.bufferSubData(n.ARRAY_BUFFER,e,t),this}},{key:"bind",value:function(){var n=this,r=this.gl;return r.bindBuffer(r.ARRAY_BUFFER,this.buffer),this.pointers.forEach(function(t,e){r.vertexAttribPointer(e,t.size,r[t.type],!1,n.byteStride,t.byteOffset),r.enableVertexAttribArray(e)}),this}},{key:"unbind",value:function(){var n=this.gl;return this.pointers.forEach(function(t,e){n.disableVertexAttribArray(e)}),this}},{key:"draw",value:function(){var t=this.gl;return t.drawArrays(t[this.mode],this.indexOffset,this.count),this}}])&&r(t.prototype,e),n&&r(t,n),o}();e.exports=t},{"lodash/defaultTo":109,"lodash/forIn":111}]},{},[144])(144)});