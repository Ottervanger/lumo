!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).lumo=t()}}(function(){return function(){return function t(e,n,r){function i(a,s){if(!n[a]){if(!e[a]){var u="function"==typeof require&&require;if(!s&&u)return u(a,!0);if(o)return o(a,!0);var l=new Error("Cannot find module '"+a+"'");throw l.code="MODULE_NOT_FOUND",l}var c=n[a]={exports:{}};e[a][0].call(c.exports,function(t){var n=e[a][1][t];return i(n||t)},c,c.exports,t,e,n,r)}return n[a].exports}for(var o="function"==typeof require&&require,a=0;a<r.length;a++)i(r[a]);return i}}()({1:[function(t,e,n){"use strict";function r(t,e,n){n=n||2;var r,s,u,l,c,p,y,d=e&&e.length,b=d?e[0]*n:t.length,m=i(t,0,b,n,!0),g=[];if(!m)return g;if(d&&(m=function(t,e,n,r){var a,s,u,l,c,p=[];for(a=0,s=e.length;a<s;a++)u=e[a]*r,l=a<s-1?e[a+1]*r:t.length,(c=i(t,u,l,r,!1))===c.next&&(c.steiner=!0),p.push(v(c));for(p.sort(f),a=0;a<p.length;a++)h(p[a],n),n=o(n,n.next);return n}(t,e,m,n)),t.length>80*n){r=u=t[0],s=l=t[1];for(var _=n;_<b;_+=n)c=t[_],p=t[_+1],c<r&&(r=c),p<s&&(s=p),c>u&&(u=c),p>l&&(l=p);y=0!==(y=Math.max(u-r,l-s))?1/y:0}return a(m,g,n,r,s,y),g}function i(t,e,n,r,i){var o,a;if(i===E(t,e,n,r)>0)for(o=e;o<n;o+=r)a=x(o,t[o],t[o+1],a);else for(o=n-r;o>=e;o-=r)a=x(o,t[o],t[o+1],a);return a&&b(a,a.next)&&(w(a),a=a.next),a}function o(t,e){if(!t)return t;e||(e=t);var n,r=t;do{if(n=!1,r.steiner||!b(r,r.next)&&0!==d(r.prev,r,r.next))r=r.next;else{if(w(r),(r=e=r.prev)===r.next)break;n=!0}}while(n||r!==e);return e}function a(t,e,n,r,i,f,h){if(t){!h&&f&&function(t,e,n,r){var i=t;do{null===i.z&&(i.z=p(i.x,i.y,e,n,r)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next}while(i!==t);i.prevZ.nextZ=null,i.prevZ=null,function(t){var e,n,r,i,o,a,s,u,l=1;do{for(n=t,t=null,o=null,a=0;n;){for(a++,r=n,s=0,e=0;e<l&&(s++,r=r.nextZ);e++);for(u=l;s>0||u>0&&r;)0!==s&&(0===u||!r||n.z<=r.z)?(i=n,n=n.nextZ,s--):(i=r,r=r.nextZ,u--),o?o.nextZ=i:t=i,i.prevZ=o,o=i;n=r}o.nextZ=null,l*=2}while(a>1)}(i)}(t,r,i,f);for(var v,y,d=t;t.prev!==t.next;)if(v=t.prev,y=t.next,f?u(t,r,i,f):s(t))e.push(v.i/n),e.push(t.i/n),e.push(y.i/n),w(t),t=y.next,d=y.next;else if((t=y)===d){h?1===h?a(t=l(t,e,n),e,n,r,i,f,2):2===h&&c(t,e,n,r,i,f):a(o(t),e,n,r,i,f,1);break}}}function s(t){var e=t.prev,n=t,r=t.next;if(d(e,n,r)>=0)return!1;for(var i=t.next.next;i!==t.prev;){if(y(e.x,e.y,n.x,n.y,r.x,r.y,i.x,i.y)&&d(i.prev,i,i.next)>=0)return!1;i=i.next}return!0}function u(t,e,n,r){var i=t.prev,o=t,a=t.next;if(d(i,o,a)>=0)return!1;for(var s=i.x<o.x?i.x<a.x?i.x:a.x:o.x<a.x?o.x:a.x,u=i.y<o.y?i.y<a.y?i.y:a.y:o.y<a.y?o.y:a.y,l=i.x>o.x?i.x>a.x?i.x:a.x:o.x>a.x?o.x:a.x,c=i.y>o.y?i.y>a.y?i.y:a.y:o.y>a.y?o.y:a.y,f=p(s,u,e,n,r),h=p(l,c,e,n,r),v=t.prevZ,b=t.nextZ;v&&v.z>=f&&b&&b.z<=h;){if(v!==t.prev&&v!==t.next&&y(i.x,i.y,o.x,o.y,a.x,a.y,v.x,v.y)&&d(v.prev,v,v.next)>=0)return!1;if(v=v.prevZ,b!==t.prev&&b!==t.next&&y(i.x,i.y,o.x,o.y,a.x,a.y,b.x,b.y)&&d(b.prev,b,b.next)>=0)return!1;b=b.nextZ}for(;v&&v.z>=f;){if(v!==t.prev&&v!==t.next&&y(i.x,i.y,o.x,o.y,a.x,a.y,v.x,v.y)&&d(v.prev,v,v.next)>=0)return!1;v=v.prevZ}for(;b&&b.z<=h;){if(b!==t.prev&&b!==t.next&&y(i.x,i.y,o.x,o.y,a.x,a.y,b.x,b.y)&&d(b.prev,b,b.next)>=0)return!1;b=b.nextZ}return!0}function l(t,e,n){var r=t;do{var i=r.prev,o=r.next.next;!b(i,o)&&m(i,r,r.next,o)&&g(i,o)&&g(o,i)&&(e.push(i.i/n),e.push(r.i/n),e.push(o.i/n),w(r),w(r.next),r=t=o),r=r.next}while(r!==t);return r}function c(t,e,n,r,i,s){var u,l,c=t;do{for(var f=c.next.next;f!==c.prev;){if(c.i!==f.i&&(l=f,(u=c).next.i!==l.i&&u.prev.i!==l.i&&!function(t,e){var n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&m(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}(u,l)&&g(u,l)&&g(l,u)&&function(t,e){var n=t,r=!1,i=(t.x+e.x)/2,o=(t.y+e.y)/2;do{n.y>o!=n.next.y>o&&n.next.y!==n.y&&i<(n.next.x-n.x)*(o-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next}while(n!==t);return r}(u,l))){var h=_(c,f);return c=o(c,c.next),h=o(h,h.next),a(c,e,n,r,i,s),void a(h,e,n,r,i,s)}f=f.next}c=c.next}while(c!==t)}function f(t,e){return t.x-e.x}function h(t,e){if(e=function(t,e){var n,r=e,i=t.x,o=t.y,a=-1/0;do{if(o<=r.y&&o>=r.next.y&&r.next.y!==r.y){var s=r.x+(o-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(s<=i&&s>a){if(a=s,s===i){if(o===r.y)return r;if(o===r.next.y)return r.next}n=r.x<r.next.x?r:r.next}}r=r.next}while(r!==e);if(!n)return null;if(i===a)return n.prev;var u,l=n,c=n.x,f=n.y,h=1/0;r=n.next;for(;r!==l;)i>=r.x&&r.x>=c&&i!==r.x&&y(o<f?i:a,o,c,f,o<f?a:i,o,r.x,r.y)&&((u=Math.abs(o-r.y)/(i-r.x))<h||u===h&&r.x>n.x)&&g(r,t)&&(n=r,h=u),r=r.next;return n}(t,e)){var n=_(e,t);o(n,n.next)}}function p(t,e,n,r,i){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-n)*i)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-r)*i)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function v(t){var e=t,n=t;do{e.x<n.x&&(n=e),e=e.next}while(e!==t);return n}function y(t,e,n,r,i,o,a,s){return(i-a)*(e-s)-(t-a)*(o-s)>=0&&(t-a)*(r-s)-(n-a)*(e-s)>=0&&(n-a)*(o-s)-(i-a)*(r-s)>=0}function d(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function b(t,e){return t.x===e.x&&t.y===e.y}function m(t,e,n,r){return!!(b(t,e)&&b(n,r)||b(t,r)&&b(n,e))||d(t,e,n)>0!=d(t,e,r)>0&&d(n,r,t)>0!=d(n,r,e)>0}function g(t,e){return d(t.prev,t,t.next)<0?d(t,e,t.next)>=0&&d(t,t.prev,e)>=0:d(t,e,t.prev)<0||d(t,t.next,e)<0}function _(t,e){var n=new O(t.i,t.x,t.y),r=new O(e.i,e.x,e.y),i=t.next,o=e.prev;return t.next=e,e.prev=t,n.next=i,i.prev=n,r.next=n,n.prev=r,o.next=r,r.prev=o,r}function x(t,e,n,r){var i=new O(t,e,n);return r?(i.next=r.next,i.prev=r,r.next.prev=i,r.next=i):(i.prev=i,i.next=i),i}function w(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function O(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function E(t,e,n,r){for(var i=0,o=e,a=n-r;o<n;o+=r)i+=(t[a]-t[o])*(t[o+1]+t[a+1]),a=o;return i}e.exports=r,e.exports.default=r,r.deviation=function(t,e,n,r){var i=e&&e.length,o=i?e[0]*n:t.length,a=Math.abs(E(t,0,o,n));if(i)for(var s=0,u=e.length;s<u;s++){var l=e[s]*n,c=s<u-1?e[s+1]*n:t.length;a-=Math.abs(E(t,l,c,n))}var f=0;for(s=0;s<r.length;s+=3){var h=r[s]*n,p=r[s+1]*n,v=r[s+2]*n;f+=Math.abs((t[h]-t[v])*(t[p+1]-t[h+1])-(t[h]-t[p])*(t[v+1]-t[h+1]))}return 0===a&&0===f?0:Math.abs((f-a)/a)},r.flatten=function(t){for(var e=t[0][0].length,n={vertices:[],holes:[],dimensions:e},r=0,i=0;i<t.length;i++){for(var o=0;o<t[i].length;o++)for(var a=0;a<e;a++)n.vertices.push(t[i][o][a]);i>0&&(r+=t[i-1].length,n.holes.push(r))}return n}},{}],2:[function(t,e,n){"use strict";var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i=Object.create||function(t){var e=function(){};return e.prototype=t,new e},o=Object.keys||function(t){var e=[];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.push(n);return n},a=Function.prototype.bind||function(t){var e=this;return function(){return e.apply(t,arguments)}};function s(){this._events&&Object.prototype.hasOwnProperty.call(this,"_events")||(this._events=i(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0}e.exports=s,s.EventEmitter=s,s.prototype._events=void 0,s.prototype._maxListeners=void 0;var u,l=10;try{var c={};Object.defineProperty&&Object.defineProperty(c,"x",{value:0}),u=0===c.x}catch(t){u=!1}function f(t){return void 0===t._maxListeners?s.defaultMaxListeners:t._maxListeners}function h(t,e,n,o){var a,s,u;if("function"!=typeof n)throw new TypeError('"listener" argument must be a function');if((s=t._events)?(s.newListener&&(t.emit("newListener",e,n.listener?n.listener:n),s=t._events),u=s[e]):(s=t._events=i(null),t._eventsCount=0),u){if("function"==typeof u?u=s[e]=o?[n,u]:[u,n]:o?u.unshift(n):u.push(n),!u.warned&&(a=f(t))&&a>0&&u.length>a){u.warned=!0;var l=new Error("Possible EventEmitter memory leak detected. "+u.length+' "'+String(e)+'" listeners added. Use emitter.setMaxListeners() to increase limit.');l.name="MaxListenersExceededWarning",l.emitter=t,l.type=e,l.count=u.length,"object"===("undefined"==typeof console?"undefined":r(console))&&console.warn&&console.warn("%s: %s",l.name,l.message)}}else u=s[e]=n,++t._eventsCount;return t}function p(){if(!this.fired)switch(this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length){case 0:return this.listener.call(this.target);case 1:return this.listener.call(this.target,arguments[0]);case 2:return this.listener.call(this.target,arguments[0],arguments[1]);case 3:return this.listener.call(this.target,arguments[0],arguments[1],arguments[2]);default:for(var t=new Array(arguments.length),e=0;e<t.length;++e)t[e]=arguments[e];this.listener.apply(this.target,t)}}function v(t,e,n){var r={fired:!1,wrapFn:void 0,target:t,type:e,listener:n},i=a.call(p,r);return i.listener=n,r.wrapFn=i,i}function y(t){var e=this._events;if(e){var n=e[t];if("function"==typeof n)return 1;if(n)return n.length}return 0}function d(t,e){for(var n=new Array(e),r=0;r<e;++r)n[r]=t[r];return n}u?Object.defineProperty(s,"defaultMaxListeners",{enumerable:!0,get:function(){return l},set:function(t){if("number"!=typeof t||t<0||t!=t)throw new TypeError('"defaultMaxListeners" must be a positive number');l=t}}):s.defaultMaxListeners=l,s.prototype.setMaxListeners=function(t){if("number"!=typeof t||t<0||isNaN(t))throw new TypeError('"n" argument must be a positive number');return this._maxListeners=t,this},s.prototype.getMaxListeners=function(){return f(this)},s.prototype.emit=function(t){var e,n,r,i,o,a,s="error"===t;if(a=this._events)s=s&&null==a.error;else if(!s)return!1;if(s){if(arguments.length>1&&(e=arguments[1]),e instanceof Error)throw e;var u=new Error('Unhandled "error" event. ('+e+")");throw u.context=e,u}if(!(n=a[t]))return!1;var l="function"==typeof n;switch(r=arguments.length){case 1:!function(t,e,n){if(e)t.call(n);else for(var r=t.length,i=d(t,r),o=0;o<r;++o)i[o].call(n)}(n,l,this);break;case 2:!function(t,e,n,r){if(e)t.call(n,r);else for(var i=t.length,o=d(t,i),a=0;a<i;++a)o[a].call(n,r)}(n,l,this,arguments[1]);break;case 3:!function(t,e,n,r,i){if(e)t.call(n,r,i);else for(var o=t.length,a=d(t,o),s=0;s<o;++s)a[s].call(n,r,i)}(n,l,this,arguments[1],arguments[2]);break;case 4:!function(t,e,n,r,i,o){if(e)t.call(n,r,i,o);else for(var a=t.length,s=d(t,a),u=0;u<a;++u)s[u].call(n,r,i,o)}(n,l,this,arguments[1],arguments[2],arguments[3]);break;default:for(i=new Array(r-1),o=1;o<r;o++)i[o-1]=arguments[o];!function(t,e,n,r){if(e)t.apply(n,r);else for(var i=t.length,o=d(t,i),a=0;a<i;++a)o[a].apply(n,r)}(n,l,this,i)}return!0},s.prototype.addListener=function(t,e){return h(this,t,e,!1)},s.prototype.on=s.prototype.addListener,s.prototype.prependListener=function(t,e){return h(this,t,e,!0)},s.prototype.once=function(t,e){if("function"!=typeof e)throw new TypeError('"listener" argument must be a function');return this.on(t,v(this,t,e)),this},s.prototype.prependOnceListener=function(t,e){if("function"!=typeof e)throw new TypeError('"listener" argument must be a function');return this.prependListener(t,v(this,t,e)),this},s.prototype.removeListener=function(t,e){var n,r,o,a,s;if("function"!=typeof e)throw new TypeError('"listener" argument must be a function');if(!(r=this._events))return this;if(!(n=r[t]))return this;if(n===e||n.listener===e)0==--this._eventsCount?this._events=i(null):(delete r[t],r.removeListener&&this.emit("removeListener",t,n.listener||e));else if("function"!=typeof n){for(o=-1,a=n.length-1;a>=0;a--)if(n[a]===e||n[a].listener===e){s=n[a].listener,o=a;break}if(o<0)return this;0===o?n.shift():function(t,e){for(var n=e,r=n+1,i=t.length;r<i;n+=1,r+=1)t[n]=t[r];t.pop()}(n,o),1===n.length&&(r[t]=n[0]),r.removeListener&&this.emit("removeListener",t,s||e)}return this},s.prototype.removeAllListeners=function(t){var e,n,r;if(!(n=this._events))return this;if(!n.removeListener)return 0===arguments.length?(this._events=i(null),this._eventsCount=0):n[t]&&(0==--this._eventsCount?this._events=i(null):delete n[t]),this;if(0===arguments.length){var a,s=o(n);for(r=0;r<s.length;++r)"removeListener"!==(a=s[r])&&this.removeAllListeners(a);return this.removeAllListeners("removeListener"),this._events=i(null),this._eventsCount=0,this}if("function"==typeof(e=n[t]))this.removeListener(t,e);else if(e)for(r=e.length-1;r>=0;r--)this.removeListener(t,e[r]);return this},s.prototype.listeners=function(t){var e,n=this._events;return n&&(e=n[t])?"function"==typeof e?[e.listener||e]:function(t){for(var e=new Array(t.length),n=0;n<e.length;++n)e[n]=t[n].listener||t[n];return e}(e):[]},s.listenerCount=function(t,e){return"function"==typeof t.listenerCount?t.listenerCount(e):y.call(t,e)},s.prototype.listenerCount=y,s.prototype.eventNames=function(){return this._eventsCount>0?Reflect.ownKeys(this._events):[]}},{}],3:[function(t,e,n){"use strict";var r=t("./_getNative")(t("./_root"),"DataView");e.exports=r},{"./_getNative":59,"./_root":95}],4:[function(t,e,n){"use strict";var r=t("./_hashClear"),i=t("./_hashDelete"),o=t("./_hashGet"),a=t("./_hashHas"),s=t("./_hashSet");function u(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}u.prototype.clear=r,u.prototype.delete=i,u.prototype.get=o,u.prototype.has=a,u.prototype.set=s,e.exports=u},{"./_hashClear":65,"./_hashDelete":66,"./_hashGet":67,"./_hashHas":68,"./_hashSet":69}],5:[function(t,e,n){"use strict";var r=t("./_listCacheClear"),i=t("./_listCacheDelete"),o=t("./_listCacheGet"),a=t("./_listCacheHas"),s=t("./_listCacheSet");function u(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}u.prototype.clear=r,u.prototype.delete=i,u.prototype.get=o,u.prototype.has=a,u.prototype.set=s,e.exports=u},{"./_listCacheClear":76,"./_listCacheDelete":77,"./_listCacheGet":78,"./_listCacheHas":79,"./_listCacheSet":80}],6:[function(t,e,n){"use strict";var r=t("./_getNative")(t("./_root"),"Map");e.exports=r},{"./_getNative":59,"./_root":95}],7:[function(t,e,n){"use strict";var r=t("./_mapCacheClear"),i=t("./_mapCacheDelete"),o=t("./_mapCacheGet"),a=t("./_mapCacheHas"),s=t("./_mapCacheSet");function u(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}u.prototype.clear=r,u.prototype.delete=i,u.prototype.get=o,u.prototype.has=a,u.prototype.set=s,e.exports=u},{"./_mapCacheClear":81,"./_mapCacheDelete":82,"./_mapCacheGet":83,"./_mapCacheHas":84,"./_mapCacheSet":85}],8:[function(t,e,n){"use strict";var r=t("./_getNative")(t("./_root"),"Promise");e.exports=r},{"./_getNative":59,"./_root":95}],9:[function(t,e,n){"use strict";var r=t("./_getNative")(t("./_root"),"Set");e.exports=r},{"./_getNative":59,"./_root":95}],10:[function(t,e,n){"use strict";var r=t("./_MapCache"),i=t("./_setCacheAdd"),o=t("./_setCacheHas");function a(t){var e=-1,n=null==t?0:t.length;for(this.__data__=new r;++e<n;)this.add(t[e])}a.prototype.add=a.prototype.push=i,a.prototype.has=o,e.exports=a},{"./_MapCache":7,"./_setCacheAdd":96,"./_setCacheHas":97}],11:[function(t,e,n){"use strict";var r=t("./_ListCache"),i=t("./_stackClear"),o=t("./_stackDelete"),a=t("./_stackGet"),s=t("./_stackHas"),u=t("./_stackSet");function l(t){var e=this.__data__=new r(t);this.size=e.size}l.prototype.clear=i,l.prototype.delete=o,l.prototype.get=a,l.prototype.has=s,l.prototype.set=u,e.exports=l},{"./_ListCache":5,"./_stackClear":99,"./_stackDelete":100,"./_stackGet":101,"./_stackHas":102,"./_stackSet":103}],12:[function(t,e,n){"use strict";var r=t("./_root").Symbol;e.exports=r},{"./_root":95}],13:[function(t,e,n){"use strict";var r=t("./_root").Uint8Array;e.exports=r},{"./_root":95}],14:[function(t,e,n){"use strict";var r=t("./_getNative")(t("./_root"),"WeakMap");e.exports=r},{"./_getNative":59,"./_root":95}],15:[function(t,e,n){"use strict";e.exports=function(t,e){for(var n=-1,r=null==t?0:t.length,i=0,o=[];++n<r;){var a=t[n];e(a,n,t)&&(o[i++]=a)}return o}},{}],16:[function(t,e,n){"use strict";var r=t("./_baseTimes"),i=t("./isArguments"),o=t("./isArray"),a=t("./isBuffer"),s=t("./_isIndex"),u=t("./isTypedArray"),l=Object.prototype.hasOwnProperty;e.exports=function(t,e){var n=o(t),c=!n&&i(t),f=!n&&!c&&a(t),h=!n&&!c&&!f&&u(t),p=n||c||f||h,v=p?r(t.length,String):[],y=v.length;for(var d in t)!e&&!l.call(t,d)||p&&("length"==d||f&&("offset"==d||"parent"==d)||h&&("buffer"==d||"byteLength"==d||"byteOffset"==d)||s(d,y))||v.push(d);return v}},{"./_baseTimes":43,"./_isIndex":70,"./isArguments":115,"./isArray":116,"./isBuffer":118,"./isTypedArray":124}],17:[function(t,e,n){"use strict";e.exports=function(t,e){for(var n=-1,r=null==t?0:t.length,i=Array(r);++n<r;)i[n]=e(t[n],n,t);return i}},{}],18:[function(t,e,n){"use strict";e.exports=function(t,e){for(var n=-1,r=e.length,i=t.length;++n<r;)t[i+n]=e[n];return t}},{}],19:[function(t,e,n){"use strict";e.exports=function(t,e){for(var n=-1,r=null==t?0:t.length;++n<r;)if(e(t[n],n,t))return!0;return!1}},{}],20:[function(t,e,n){"use strict";var r=t("./eq");e.exports=function(t,e){for(var n=t.length;n--;)if(r(t[n][0],e))return n;return-1}},{"./eq":110}],21:[function(t,e,n){"use strict";e.exports=function(t,e,n){return t==t&&(void 0!==n&&(t=t<=n?t:n),void 0!==e&&(t=t>=e?t:e)),t}},{}],22:[function(t,e,n){"use strict";var r=t("./_baseForOwn"),i=t("./_createBaseEach")(r);e.exports=i},{"./_baseForOwn":24,"./_createBaseEach":50}],23:[function(t,e,n){"use strict";var r=t("./_createBaseFor")();e.exports=r},{"./_createBaseFor":51}],24:[function(t,e,n){"use strict";var r=t("./_baseFor"),i=t("./keys");e.exports=function(t,e){return t&&r(t,e,i)}},{"./_baseFor":23,"./keys":125}],25:[function(t,e,n){"use strict";var r=t("./_castPath"),i=t("./_toKey");e.exports=function(t,e){for(var n=0,o=(e=r(e,t)).length;null!=t&&n<o;)t=t[i(e[n++])];return n&&n==o?t:void 0}},{"./_castPath":48,"./_toKey":105}],26:[function(t,e,n){"use strict";var r=t("./_arrayPush"),i=t("./isArray");e.exports=function(t,e,n){var o=e(t);return i(t)?o:r(o,n(t))}},{"./_arrayPush":18,"./isArray":116}],27:[function(t,e,n){"use strict";var r=t("./_Symbol"),i=t("./_getRawTag"),o=t("./_objectToString"),a="[object Null]",s="[object Undefined]",u=r?r.toStringTag:void 0;e.exports=function(t){return null==t?void 0===t?s:a:u&&u in Object(t)?i(t):o(t)}},{"./_Symbol":12,"./_getRawTag":60,"./_objectToString":93}],28:[function(t,e,n){"use strict";e.exports=function(t,e){return null!=t&&e in Object(t)}},{}],29:[function(t,e,n){"use strict";var r=t("./_baseGetTag"),i=t("./isObjectLike"),o="[object Arguments]";e.exports=function(t){return i(t)&&r(t)==o}},{"./_baseGetTag":27,"./isObjectLike":122}],30:[function(t,e,n){"use strict";var r=t("./_baseIsEqualDeep"),i=t("./isObjectLike");e.exports=function t(e,n,o,a,s){return e===n||(null==e||null==n||!i(e)&&!i(n)?e!=e&&n!=n:r(e,n,o,a,t,s))}},{"./_baseIsEqualDeep":31,"./isObjectLike":122}],31:[function(t,e,n){"use strict";var r=t("./_Stack"),i=t("./_equalArrays"),o=t("./_equalByTag"),a=t("./_equalObjects"),s=t("./_getTag"),u=t("./isArray"),l=t("./isBuffer"),c=t("./isTypedArray"),f=1,h="[object Arguments]",p="[object Array]",v="[object Object]",y=Object.prototype.hasOwnProperty;e.exports=function(t,e,n,d,b,m){var g=u(t),_=u(e),x=g?p:s(t),w=_?p:s(e),O=(x=x==h?v:x)==v,E=(w=w==h?v:w)==v,T=x==w;if(T&&l(t)){if(!l(e))return!1;g=!0,O=!1}if(T&&!O)return m||(m=new r),g||c(t)?i(t,e,n,d,b,m):o(t,e,x,n,d,b,m);if(!(n&f)){var P=O&&y.call(t,"__wrapped__"),k=E&&y.call(e,"__wrapped__");if(P||k){var S=P?t.value():t,A=k?e.value():e;return m||(m=new r),b(S,A,n,d,m)}}return!!T&&(m||(m=new r),a(t,e,n,d,b,m))}},{"./_Stack":11,"./_equalArrays":52,"./_equalByTag":53,"./_equalObjects":54,"./_getTag":62,"./isArray":116,"./isBuffer":118,"./isTypedArray":124}],32:[function(t,e,n){"use strict";var r=t("./_Stack"),i=t("./_baseIsEqual"),o=1,a=2;e.exports=function(t,e,n,s){var u=n.length,l=u,c=!s;if(null==t)return!l;for(t=Object(t);u--;){var f=n[u];if(c&&f[2]?f[1]!==t[f[0]]:!(f[0]in t))return!1}for(;++u<l;){var h=(f=n[u])[0],p=t[h],v=f[1];if(c&&f[2]){if(void 0===p&&!(h in t))return!1}else{var y=new r;if(s)var d=s(p,v,h,t,e,y);if(!(void 0===d?i(v,p,o|a,s,y):d))return!1}}return!0}},{"./_Stack":11,"./_baseIsEqual":30}],33:[function(t,e,n){"use strict";var r=t("./isFunction"),i=t("./_isMasked"),o=t("./isObject"),a=t("./_toSource"),s=/^\[object .+?Constructor\]$/,u=Function.prototype,l=Object.prototype,c=u.toString,f=l.hasOwnProperty,h=RegExp("^"+c.call(f).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");e.exports=function(t){return!(!o(t)||i(t))&&(r(t)?h:s).test(a(t))}},{"./_isMasked":73,"./_toSource":106,"./isFunction":119,"./isObject":121}],34:[function(t,e,n){"use strict";var r=t("./_baseGetTag"),i=t("./isLength"),o=t("./isObjectLike"),a={};a["[object Float32Array]"]=a["[object Float64Array]"]=a["[object Int8Array]"]=a["[object Int16Array]"]=a["[object Int32Array]"]=a["[object Uint8Array]"]=a["[object Uint8ClampedArray]"]=a["[object Uint16Array]"]=a["[object Uint32Array]"]=!0,a["[object Arguments]"]=a["[object Array]"]=a["[object ArrayBuffer]"]=a["[object Boolean]"]=a["[object DataView]"]=a["[object Date]"]=a["[object Error]"]=a["[object Function]"]=a["[object Map]"]=a["[object Number]"]=a["[object Object]"]=a["[object RegExp]"]=a["[object Set]"]=a["[object String]"]=a["[object WeakMap]"]=!1,e.exports=function(t){return o(t)&&i(t.length)&&!!a[r(t)]}},{"./_baseGetTag":27,"./isLength":120,"./isObjectLike":122}],35:[function(t,e,n){"use strict";var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i=t("./_baseMatches"),o=t("./_baseMatchesProperty"),a=t("./identity"),s=t("./isArray"),u=t("./property");e.exports=function(t){return"function"==typeof t?t:null==t?a:"object"==(void 0===t?"undefined":r(t))?s(t)?o(t[0],t[1]):i(t):u(t)}},{"./_baseMatches":39,"./_baseMatchesProperty":40,"./identity":114,"./isArray":116,"./property":130}],36:[function(t,e,n){"use strict";var r=t("./_isPrototype"),i=t("./_nativeKeys"),o=Object.prototype.hasOwnProperty;e.exports=function(t){if(!r(t))return i(t);var e=[];for(var n in Object(t))o.call(t,n)&&"constructor"!=n&&e.push(n);return e}},{"./_isPrototype":74,"./_nativeKeys":90}],37:[function(t,e,n){"use strict";var r=t("./isObject"),i=t("./_isPrototype"),o=t("./_nativeKeysIn"),a=Object.prototype.hasOwnProperty;e.exports=function(t){if(!r(t))return o(t);var e=i(t),n=[];for(var s in t)("constructor"!=s||!e&&a.call(t,s))&&n.push(s);return n}},{"./_isPrototype":74,"./_nativeKeysIn":91,"./isObject":121}],38:[function(t,e,n){"use strict";var r=t("./_baseEach"),i=t("./isArrayLike");e.exports=function(t,e){var n=-1,o=i(t)?Array(t.length):[];return r(t,function(t,r,i){o[++n]=e(t,r,i)}),o}},{"./_baseEach":22,"./isArrayLike":117}],39:[function(t,e,n){"use strict";var r=t("./_baseIsMatch"),i=t("./_getMatchData"),o=t("./_matchesStrictComparable");e.exports=function(t){var e=i(t);return 1==e.length&&e[0][2]?o(e[0][0],e[0][1]):function(n){return n===t||r(n,t,e)}}},{"./_baseIsMatch":32,"./_getMatchData":58,"./_matchesStrictComparable":87}],40:[function(t,e,n){"use strict";var r=t("./_baseIsEqual"),i=t("./get"),o=t("./hasIn"),a=t("./_isKey"),s=t("./_isStrictComparable"),u=t("./_matchesStrictComparable"),l=t("./_toKey"),c=1,f=2;e.exports=function(t,e){return a(t)&&s(e)?u(l(t),e):function(n){var a=i(n,t);return void 0===a&&a===e?o(n,t):r(e,a,c|f)}}},{"./_baseIsEqual":30,"./_isKey":71,"./_isStrictComparable":75,"./_matchesStrictComparable":87,"./_toKey":105,"./get":112,"./hasIn":113}],41:[function(t,e,n){"use strict";e.exports=function(t){return function(e){return null==e?void 0:e[t]}}},{}],42:[function(t,e,n){"use strict";var r=t("./_baseGet");e.exports=function(t){return function(e){return r(e,t)}}},{"./_baseGet":25}],43:[function(t,e,n){"use strict";e.exports=function(t,e){for(var n=-1,r=Array(t);++n<t;)r[n]=e(n);return r}},{}],44:[function(t,e,n){"use strict";var r=t("./_Symbol"),i=t("./_arrayMap"),o=t("./isArray"),a=t("./isSymbol"),s=1/0,u=r?r.prototype:void 0,l=u?u.toString:void 0;e.exports=function t(e){if("string"==typeof e)return e;if(o(e))return i(e,t)+"";if(a(e))return l?l.call(e):"";var n=e+"";return"0"==n&&1/e==-s?"-0":n}},{"./_Symbol":12,"./_arrayMap":17,"./isArray":116,"./isSymbol":123}],45:[function(t,e,n){"use strict";e.exports=function(t){return function(e){return t(e)}}},{}],46:[function(t,e,n){"use strict";e.exports=function(t,e){return t.has(e)}},{}],47:[function(t,e,n){"use strict";var r=t("./identity");e.exports=function(t){return"function"==typeof t?t:r}},{"./identity":114}],48:[function(t,e,n){"use strict";var r=t("./isArray"),i=t("./_isKey"),o=t("./_stringToPath"),a=t("./toString");e.exports=function(t,e){return r(t)?t:i(t,e)?[t]:o(a(t))}},{"./_isKey":71,"./_stringToPath":104,"./isArray":116,"./toString":135}],49:[function(t,e,n){"use strict";var r=t("./_root")["__core-js_shared__"];e.exports=r},{"./_root":95}],50:[function(t,e,n){"use strict";var r=t("./isArrayLike");e.exports=function(t,e){return function(n,i){if(null==n)return n;if(!r(n))return t(n,i);for(var o=n.length,a=e?o:-1,s=Object(n);(e?a--:++a<o)&&!1!==i(s[a],a,s););return n}}},{"./isArrayLike":117}],51:[function(t,e,n){"use strict";e.exports=function(t){return function(e,n,r){for(var i=-1,o=Object(e),a=r(e),s=a.length;s--;){var u=a[t?s:++i];if(!1===n(o[u],u,o))break}return e}}},{}],52:[function(t,e,n){"use strict";var r=t("./_SetCache"),i=t("./_arraySome"),o=t("./_cacheHas"),a=1,s=2;e.exports=function(t,e,n,u,l,c){var f=n&a,h=t.length,p=e.length;if(h!=p&&!(f&&p>h))return!1;var v=c.get(t);if(v&&c.get(e))return v==e;var y=-1,d=!0,b=n&s?new r:void 0;for(c.set(t,e),c.set(e,t);++y<h;){var m=t[y],g=e[y];if(u)var _=f?u(g,m,y,e,t,c):u(m,g,y,t,e,c);if(void 0!==_){if(_)continue;d=!1;break}if(b){if(!i(e,function(t,e){if(!o(b,e)&&(m===t||l(m,t,n,u,c)))return b.push(e)})){d=!1;break}}else if(m!==g&&!l(m,g,n,u,c)){d=!1;break}}return c.delete(t),c.delete(e),d}},{"./_SetCache":10,"./_arraySome":19,"./_cacheHas":46}],53:[function(t,e,n){"use strict";var r=t("./_Symbol"),i=t("./_Uint8Array"),o=t("./eq"),a=t("./_equalArrays"),s=t("./_mapToArray"),u=t("./_setToArray"),l=1,c=2,f="[object Boolean]",h="[object Date]",p="[object Error]",v="[object Map]",y="[object Number]",d="[object RegExp]",b="[object Set]",m="[object String]",g="[object Symbol]",_="[object ArrayBuffer]",x="[object DataView]",w=r?r.prototype:void 0,O=w?w.valueOf:void 0;e.exports=function(t,e,n,r,w,E,T){switch(n){case x:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case _:return!(t.byteLength!=e.byteLength||!E(new i(t),new i(e)));case f:case h:case y:return o(+t,+e);case p:return t.name==e.name&&t.message==e.message;case d:case m:return t==e+"";case v:var P=s;case b:var k=r&l;if(P||(P=u),t.size!=e.size&&!k)return!1;var S=T.get(t);if(S)return S==e;r|=c,T.set(t,e);var A=a(P(t),P(e),r,w,E,T);return T.delete(t),A;case g:if(O)return O.call(t)==O.call(e)}return!1}},{"./_Symbol":12,"./_Uint8Array":13,"./_equalArrays":52,"./_mapToArray":86,"./_setToArray":98,"./eq":110}],54:[function(t,e,n){"use strict";var r=t("./_getAllKeys"),i=1,o=Object.prototype.hasOwnProperty;e.exports=function(t,e,n,a,s,u){var l=n&i,c=r(t),f=c.length;if(f!=r(e).length&&!l)return!1;for(var h=f;h--;){var p=c[h];if(!(l?p in e:o.call(e,p)))return!1}var v=u.get(t);if(v&&u.get(e))return v==e;var y=!0;u.set(t,e),u.set(e,t);for(var d=l;++h<f;){var b=t[p=c[h]],m=e[p];if(a)var g=l?a(m,b,p,e,t,u):a(b,m,p,t,e,u);if(!(void 0===g?b===m||s(b,m,n,a,u):g)){y=!1;break}d||(d="constructor"==p)}if(y&&!d){var _=t.constructor,x=e.constructor;_!=x&&"constructor"in t&&"constructor"in e&&!("function"==typeof _&&_ instanceof _&&"function"==typeof x&&x instanceof x)&&(y=!1)}return u.delete(t),u.delete(e),y}},{"./_getAllKeys":56}],55:[function(t,e,n){(function(t){"use strict";var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r="object"==(void 0===t?"undefined":n(t))&&t&&t.Object===Object&&t;e.exports=r}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],56:[function(t,e,n){"use strict";var r=t("./_baseGetAllKeys"),i=t("./_getSymbols"),o=t("./keys");e.exports=function(t){return r(t,o,i)}},{"./_baseGetAllKeys":26,"./_getSymbols":61,"./keys":125}],57:[function(t,e,n){"use strict";var r=t("./_isKeyable");e.exports=function(t,e){var n=t.__data__;return r(e)?n["string"==typeof e?"string":"hash"]:n.map}},{"./_isKeyable":72}],58:[function(t,e,n){"use strict";var r=t("./_isStrictComparable"),i=t("./keys");e.exports=function(t){for(var e=i(t),n=e.length;n--;){var o=e[n],a=t[o];e[n]=[o,a,r(a)]}return e}},{"./_isStrictComparable":75,"./keys":125}],59:[function(t,e,n){"use strict";var r=t("./_baseIsNative"),i=t("./_getValue");e.exports=function(t,e){var n=i(t,e);return r(n)?n:void 0}},{"./_baseIsNative":33,"./_getValue":63}],60:[function(t,e,n){"use strict";var r=t("./_Symbol"),i=Object.prototype,o=i.hasOwnProperty,a=i.toString,s=r?r.toStringTag:void 0;e.exports=function(t){var e=o.call(t,s),n=t[s];try{t[s]=void 0;var r=!0}catch(t){}var i=a.call(t);return r&&(e?t[s]=n:delete t[s]),i}},{"./_Symbol":12}],61:[function(t,e,n){"use strict";var r=t("./_arrayFilter"),i=t("./stubArray"),o=Object.prototype.propertyIsEnumerable,a=Object.getOwnPropertySymbols,s=a?function(t){return null==t?[]:(t=Object(t),r(a(t),function(e){return o.call(t,e)}))}:i;e.exports=s},{"./_arrayFilter":15,"./stubArray":131}],62:[function(t,e,n){"use strict";var r=t("./_DataView"),i=t("./_Map"),o=t("./_Promise"),a=t("./_Set"),s=t("./_WeakMap"),u=t("./_baseGetTag"),l=t("./_toSource"),c="[object Map]",f="[object Promise]",h="[object Set]",p="[object WeakMap]",v="[object DataView]",y=l(r),d=l(i),b=l(o),m=l(a),g=l(s),_=u;(r&&_(new r(new ArrayBuffer(1)))!=v||i&&_(new i)!=c||o&&_(o.resolve())!=f||a&&_(new a)!=h||s&&_(new s)!=p)&&(_=function(t){var e=u(t),n="[object Object]"==e?t.constructor:void 0,r=n?l(n):"";if(r)switch(r){case y:return v;case d:return c;case b:return f;case m:return h;case g:return p}return e}),e.exports=_},{"./_DataView":3,"./_Map":6,"./_Promise":8,"./_Set":9,"./_WeakMap":14,"./_baseGetTag":27,"./_toSource":106}],63:[function(t,e,n){"use strict";e.exports=function(t,e){return null==t?void 0:t[e]}},{}],64:[function(t,e,n){"use strict";var r=t("./_castPath"),i=t("./isArguments"),o=t("./isArray"),a=t("./_isIndex"),s=t("./isLength"),u=t("./_toKey");e.exports=function(t,e,n){for(var l=-1,c=(e=r(e,t)).length,f=!1;++l<c;){var h=u(e[l]);if(!(f=null!=t&&n(t,h)))break;t=t[h]}return f||++l!=c?f:!!(c=null==t?0:t.length)&&s(c)&&a(h,c)&&(o(t)||i(t))}},{"./_castPath":48,"./_isIndex":70,"./_toKey":105,"./isArguments":115,"./isArray":116,"./isLength":120}],65:[function(t,e,n){"use strict";var r=t("./_nativeCreate");e.exports=function(){this.__data__=r?r(null):{},this.size=0}},{"./_nativeCreate":89}],66:[function(t,e,n){"use strict";e.exports=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e}},{}],67:[function(t,e,n){"use strict";var r=t("./_nativeCreate"),i="__lodash_hash_undefined__",o=Object.prototype.hasOwnProperty;e.exports=function(t){var e=this.__data__;if(r){var n=e[t];return n===i?void 0:n}return o.call(e,t)?e[t]:void 0}},{"./_nativeCreate":89}],68:[function(t,e,n){"use strict";var r=t("./_nativeCreate"),i=Object.prototype.hasOwnProperty;e.exports=function(t){var e=this.__data__;return r?void 0!==e[t]:i.call(e,t)}},{"./_nativeCreate":89}],69:[function(t,e,n){"use strict";var r=t("./_nativeCreate"),i="__lodash_hash_undefined__";e.exports=function(t,e){var n=this.__data__;return this.size+=this.has(t)?0:1,n[t]=r&&void 0===e?i:e,this}},{"./_nativeCreate":89}],70:[function(t,e,n){"use strict";var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i=9007199254740991,o=/^(?:0|[1-9]\d*)$/;e.exports=function(t,e){var n=void 0===t?"undefined":r(t);return!!(e=null==e?i:e)&&("number"==n||"symbol"!=n&&o.test(t))&&t>-1&&t%1==0&&t<e}},{}],71:[function(t,e,n){"use strict";var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i=t("./isArray"),o=t("./isSymbol"),a=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,s=/^\w*$/;e.exports=function(t,e){if(i(t))return!1;var n=void 0===t?"undefined":r(t);return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=t&&!o(t))||s.test(t)||!a.test(t)||null!=e&&t in Object(e)}},{"./isArray":116,"./isSymbol":123}],72:[function(t,e,n){"use strict";var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};e.exports=function(t){var e=void 0===t?"undefined":r(t);return"string"==e||"number"==e||"symbol"==e||"boolean"==e?"__proto__"!==t:null===t}},{}],73:[function(t,e,n){"use strict";var r,i=t("./_coreJsData"),o=(r=/[^.]+$/.exec(i&&i.keys&&i.keys.IE_PROTO||""))?"Symbol(src)_1."+r:"";e.exports=function(t){return!!o&&o in t}},{"./_coreJsData":49}],74:[function(t,e,n){"use strict";var r=Object.prototype;e.exports=function(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||r)}},{}],75:[function(t,e,n){"use strict";var r=t("./isObject");e.exports=function(t){return t==t&&!r(t)}},{"./isObject":121}],76:[function(t,e,n){"use strict";e.exports=function(){this.__data__=[],this.size=0}},{}],77:[function(t,e,n){"use strict";var r=t("./_assocIndexOf"),i=Array.prototype.splice;e.exports=function(t){var e=this.__data__,n=r(e,t);return!(n<0||(n==e.length-1?e.pop():i.call(e,n,1),--this.size,0))}},{"./_assocIndexOf":20}],78:[function(t,e,n){"use strict";var r=t("./_assocIndexOf");e.exports=function(t){var e=this.__data__,n=r(e,t);return n<0?void 0:e[n][1]}},{"./_assocIndexOf":20}],79:[function(t,e,n){"use strict";var r=t("./_assocIndexOf");e.exports=function(t){return r(this.__data__,t)>-1}},{"./_assocIndexOf":20}],80:[function(t,e,n){"use strict";var r=t("./_assocIndexOf");e.exports=function(t,e){var n=this.__data__,i=r(n,t);return i<0?(++this.size,n.push([t,e])):n[i][1]=e,this}},{"./_assocIndexOf":20}],81:[function(t,e,n){"use strict";var r=t("./_Hash"),i=t("./_ListCache"),o=t("./_Map");e.exports=function(){this.size=0,this.__data__={hash:new r,map:new(o||i),string:new r}}},{"./_Hash":4,"./_ListCache":5,"./_Map":6}],82:[function(t,e,n){"use strict";var r=t("./_getMapData");e.exports=function(t){var e=r(this,t).delete(t);return this.size-=e?1:0,e}},{"./_getMapData":57}],83:[function(t,e,n){"use strict";var r=t("./_getMapData");e.exports=function(t){return r(this,t).get(t)}},{"./_getMapData":57}],84:[function(t,e,n){"use strict";var r=t("./_getMapData");e.exports=function(t){return r(this,t).has(t)}},{"./_getMapData":57}],85:[function(t,e,n){"use strict";var r=t("./_getMapData");e.exports=function(t,e){var n=r(this,t),i=n.size;return n.set(t,e),this.size+=n.size==i?0:1,this}},{"./_getMapData":57}],86:[function(t,e,n){"use strict";e.exports=function(t){var e=-1,n=Array(t.size);return t.forEach(function(t,r){n[++e]=[r,t]}),n}},{}],87:[function(t,e,n){"use strict";e.exports=function(t,e){return function(n){return null!=n&&n[t]===e&&(void 0!==e||t in Object(n))}}},{}],88:[function(t,e,n){"use strict";var r=t("./memoize"),i=500;e.exports=function(t){var e=r(t,function(t){return n.size===i&&n.clear(),t}),n=e.cache;return e}},{"./memoize":128}],89:[function(t,e,n){"use strict";var r=t("./_getNative")(Object,"create");e.exports=r},{"./_getNative":59}],90:[function(t,e,n){"use strict";var r=t("./_overArg")(Object.keys,Object);e.exports=r},{"./_overArg":94}],91:[function(t,e,n){"use strict";e.exports=function(t){var e=[];if(null!=t)for(var n in Object(t))e.push(n);return e}},{}],92:[function(t,e,n){"use strict";var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i=t("./_freeGlobal"),o="object"==(void 0===n?"undefined":r(n))&&n&&!n.nodeType&&n,a=o&&"object"==(void 0===e?"undefined":r(e))&&e&&!e.nodeType&&e,s=a&&a.exports===o&&i.process,u=function(){try{return s&&s.binding&&s.binding("util")}catch(t){}}();e.exports=u},{"./_freeGlobal":55}],93:[function(t,e,n){"use strict";var r=Object.prototype.toString;e.exports=function(t){return r.call(t)}},{}],94:[function(t,e,n){"use strict";e.exports=function(t,e){return function(n){return t(e(n))}}},{}],95:[function(t,e,n){"use strict";var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i=t("./_freeGlobal"),o="object"==("undefined"==typeof self?"undefined":r(self))&&self&&self.Object===Object&&self,a=i||o||Function("return this")();e.exports=a},{"./_freeGlobal":55}],96:[function(t,e,n){"use strict";var r="__lodash_hash_undefined__";e.exports=function(t){return this.__data__.set(t,r),this}},{}],97:[function(t,e,n){"use strict";e.exports=function(t){return this.__data__.has(t)}},{}],98:[function(t,e,n){"use strict";e.exports=function(t){var e=-1,n=Array(t.size);return t.forEach(function(t){n[++e]=t}),n}},{}],99:[function(t,e,n){"use strict";var r=t("./_ListCache");e.exports=function(){this.__data__=new r,this.size=0}},{"./_ListCache":5}],100:[function(t,e,n){"use strict";e.exports=function(t){var e=this.__data__,n=e.delete(t);return this.size=e.size,n}},{}],101:[function(t,e,n){"use strict";e.exports=function(t){return this.__data__.get(t)}},{}],102:[function(t,e,n){"use strict";e.exports=function(t){return this.__data__.has(t)}},{}],103:[function(t,e,n){"use strict";var r=t("./_ListCache"),i=t("./_Map"),o=t("./_MapCache"),a=200;e.exports=function(t,e){var n=this.__data__;if(n instanceof r){var s=n.__data__;if(!i||s.length<a-1)return s.push([t,e]),this.size=++n.size,this;n=this.__data__=new o(s)}return n.set(t,e),this.size=n.size,this}},{"./_ListCache":5,"./_Map":6,"./_MapCache":7}],104:[function(t,e,n){"use strict";var r=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,i=/\\(\\)?/g,o=t("./_memoizeCapped")(function(t){var e=[];return 46===t.charCodeAt(0)&&e.push(""),t.replace(r,function(t,n,r,o){e.push(r?o.replace(i,"$1"):n||t)}),e});e.exports=o},{"./_memoizeCapped":88}],105:[function(t,e,n){"use strict";var r=t("./isSymbol"),i=1/0;e.exports=function(t){if("string"==typeof t||r(t))return t;var e=t+"";return"0"==e&&1/t==-i?"-0":e}},{"./isSymbol":123}],106:[function(t,e,n){"use strict";var r=Function.prototype.toString;e.exports=function(t){if(null!=t){try{return r.call(t)}catch(t){}try{return t+""}catch(t){}}return""}},{}],107:[function(t,e,n){"use strict";var r=t("./_baseClamp"),i=t("./toNumber");e.exports=function(t,e,n){return void 0===n&&(n=e,e=void 0),void 0!==n&&(n=(n=i(n))==n?n:0),void 0!==e&&(e=(e=i(e))==e?e:0),r(i(t),e,n)}},{"./_baseClamp":21,"./toNumber":134}],108:[function(t,e,n){"use strict";var r=t("./isObject"),i=t("./now"),o=t("./toNumber"),a="Expected a function",s=Math.max,u=Math.min;e.exports=function(t,e,n){var l,c,f,h,p,v,y=0,d=!1,b=!1,m=!0;if("function"!=typeof t)throw new TypeError(a);function g(e){var n=l,r=c;return l=c=void 0,y=e,h=t.apply(r,n)}function _(t){var n=t-v;return void 0===v||n>=e||n<0||b&&t-y>=f}function x(){var t,n,r=i();if(_(r))return w(r);p=setTimeout(x,(n=e-((t=r)-v),b?u(n,f-(t-y)):n))}function w(t){return p=void 0,m&&l?g(t):(l=c=void 0,h)}function O(){var t,n=i(),r=_(n);if(l=arguments,c=this,v=n,r){if(void 0===p)return y=t=v,p=setTimeout(x,e),d?g(t):h;if(b)return p=setTimeout(x,e),g(v)}return void 0===p&&(p=setTimeout(x,e)),h}return e=o(e)||0,r(n)&&(d=!!n.leading,f=(b="maxWait"in n)?s(o(n.maxWait)||0,e):f,m="trailing"in n?!!n.trailing:m),O.cancel=function(){void 0!==p&&clearTimeout(p),y=0,l=v=c=p=void 0},O.flush=function(){return void 0===p?h:w(i())},O}},{"./isObject":121,"./now":129,"./toNumber":134}],109:[function(t,e,n){"use strict";e.exports=function(t,e){return null==t||t!=t?e:t}},{}],110:[function(t,e,n){"use strict";e.exports=function(t,e){return t===e||t!=t&&e!=e}},{}],111:[function(t,e,n){"use strict";var r=t("./_baseFor"),i=t("./_castFunction"),o=t("./keysIn");e.exports=function(t,e){return null==t?t:r(t,i(e),o)}},{"./_baseFor":23,"./_castFunction":47,"./keysIn":126}],112:[function(t,e,n){"use strict";var r=t("./_baseGet");e.exports=function(t,e,n){var i=null==t?void 0:r(t,e);return void 0===i?n:i}},{"./_baseGet":25}],113:[function(t,e,n){"use strict";var r=t("./_baseHasIn"),i=t("./_hasPath");e.exports=function(t,e){return null!=t&&i(t,e,r)}},{"./_baseHasIn":28,"./_hasPath":64}],114:[function(t,e,n){"use strict";e.exports=function(t){return t}},{}],115:[function(t,e,n){"use strict";var r=t("./_baseIsArguments"),i=t("./isObjectLike"),o=Object.prototype,a=o.hasOwnProperty,s=o.propertyIsEnumerable,u=r(function(){return arguments}())?r:function(t){return i(t)&&a.call(t,"callee")&&!s.call(t,"callee")};e.exports=u},{"./_baseIsArguments":29,"./isObjectLike":122}],116:[function(t,e,n){"use strict";var r=Array.isArray;e.exports=r},{}],117:[function(t,e,n){"use strict";var r=t("./isFunction"),i=t("./isLength");e.exports=function(t){return null!=t&&i(t.length)&&!r(t)}},{"./isFunction":119,"./isLength":120}],118:[function(t,e,n){"use strict";var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i=t("./_root"),o=t("./stubFalse"),a="object"==(void 0===n?"undefined":r(n))&&n&&!n.nodeType&&n,s=a&&"object"==(void 0===e?"undefined":r(e))&&e&&!e.nodeType&&e,u=s&&s.exports===a?i.Buffer:void 0,l=(u?u.isBuffer:void 0)||o;e.exports=l},{"./_root":95,"./stubFalse":132}],119:[function(t,e,n){"use strict";var r=t("./_baseGetTag"),i=t("./isObject"),o="[object AsyncFunction]",a="[object Function]",s="[object GeneratorFunction]",u="[object Proxy]";e.exports=function(t){if(!i(t))return!1;var e=r(t);return e==a||e==s||e==o||e==u}},{"./_baseGetTag":27,"./isObject":121}],120:[function(t,e,n){"use strict";var r=9007199254740991;e.exports=function(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=r}},{}],121:[function(t,e,n){"use strict";var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};e.exports=function(t){var e=void 0===t?"undefined":r(t);return null!=t&&("object"==e||"function"==e)}},{}],122:[function(t,e,n){"use strict";var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};e.exports=function(t){return null!=t&&"object"==(void 0===t?"undefined":r(t))}},{}],123:[function(t,e,n){"use strict";var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i=t("./_baseGetTag"),o=t("./isObjectLike"),a="[object Symbol]";e.exports=function(t){return"symbol"==(void 0===t?"undefined":r(t))||o(t)&&i(t)==a}},{"./_baseGetTag":27,"./isObjectLike":122}],124:[function(t,e,n){"use strict";var r=t("./_baseIsTypedArray"),i=t("./_baseUnary"),o=t("./_nodeUtil"),a=o&&o.isTypedArray,s=a?i(a):r;e.exports=s},{"./_baseIsTypedArray":34,"./_baseUnary":45,"./_nodeUtil":92}],125:[function(t,e,n){"use strict";var r=t("./_arrayLikeKeys"),i=t("./_baseKeys"),o=t("./isArrayLike");e.exports=function(t){return o(t)?r(t):i(t)}},{"./_arrayLikeKeys":16,"./_baseKeys":36,"./isArrayLike":117}],126:[function(t,e,n){"use strict";var r=t("./_arrayLikeKeys"),i=t("./_baseKeysIn"),o=t("./isArrayLike");e.exports=function(t){return o(t)?r(t,!0):i(t)}},{"./_arrayLikeKeys":16,"./_baseKeysIn":37,"./isArrayLike":117}],127:[function(t,e,n){"use strict";var r=t("./_arrayMap"),i=t("./_baseIteratee"),o=t("./_baseMap"),a=t("./isArray");e.exports=function(t,e){return(a(t)?r:o)(t,i(e,3))}},{"./_arrayMap":17,"./_baseIteratee":35,"./_baseMap":38,"./isArray":116}],128:[function(t,e,n){"use strict";var r=t("./_MapCache"),i="Expected a function";function o(t,e){if("function"!=typeof t||null!=e&&"function"!=typeof e)throw new TypeError(i);var n=function n(){var r=arguments,i=e?e.apply(this,r):r[0],o=n.cache;if(o.has(i))return o.get(i);var a=t.apply(this,r);return n.cache=o.set(i,a)||o,a};return n.cache=new(o.Cache||r),n}o.Cache=r,e.exports=o},{"./_MapCache":7}],129:[function(t,e,n){"use strict";var r=t("./_root");e.exports=function(){return r.Date.now()}},{"./_root":95}],130:[function(t,e,n){"use strict";var r=t("./_baseProperty"),i=t("./_basePropertyDeep"),o=t("./_isKey"),a=t("./_toKey");e.exports=function(t){return o(t)?r(a(t)):i(t)}},{"./_baseProperty":41,"./_basePropertyDeep":42,"./_isKey":71,"./_toKey":105}],131:[function(t,e,n){"use strict";e.exports=function(){return[]}},{}],132:[function(t,e,n){"use strict";e.exports=function(){return!1}},{}],133:[function(t,e,n){"use strict";var r=t("./debounce"),i=t("./isObject"),o="Expected a function";e.exports=function(t,e,n){var a=!0,s=!0;if("function"!=typeof t)throw new TypeError(o);return i(n)&&(a="leading"in n?!!n.leading:a,s="trailing"in n?!!n.trailing:s),r(t,e,{leading:a,maxWait:e,trailing:s})}},{"./debounce":108,"./isObject":121}],134:[function(t,e,n){"use strict";var r=t("./isObject"),i=t("./isSymbol"),o=NaN,a=/^\s+|\s+$/g,s=/^[-+]0x[0-9a-f]+$/i,u=/^0b[01]+$/i,l=/^0o[0-7]+$/i,c=parseInt;e.exports=function(t){if("number"==typeof t)return t;if(i(t))return o;if(r(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=r(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=t.replace(a,"");var n=u.test(t);return n||l.test(t)?c(t.slice(2),n?2:8):s.test(t)?o:+t}},{"./isObject":121,"./isSymbol":123}],135:[function(t,e,n){"use strict";var r=t("./_baseToString");e.exports=function(t){return null==t?"":r(t)}},{"./_baseToString":44}],136:[function(t,e,n){"use strict";function r(t,e,n,r,a){!function t(e,n,r,o,a){for(;o>r;){if(o-r>600){var s=o-r+1,u=n-r+1,l=Math.log(s),c=.5*Math.exp(2*l/3),f=.5*Math.sqrt(l*c*(s-c)/s)*(u-s/2<0?-1:1),h=Math.max(r,Math.floor(n-u*c/s+f)),p=Math.min(o,Math.floor(n+(s-u)*c/s+f));t(e,n,h,p,a)}var v=e[n],y=r,d=o;for(i(e,r,n),a(e[o],v)>0&&i(e,r,o);y<d;){for(i(e,y,d),y++,d--;a(e[y],v)<0;)y++;for(;a(e[d],v)>0;)d--}0===a(e[r],v)?i(e,r,d):i(e,++d,o),d<=n&&(r=d+1),n<=d&&(o=d-1)}}(t,e,n||0,r||t.length-1,a||o)}function i(t,e,n){var r=t[e];t[e]=t[n],t[n]=r}function o(t,e){return t<e?-1:t>e?1:0}e.exports=r,e.exports.default=r},{}],137:[function(t,e,n){"use strict";e.exports=i,e.exports.default=i;var r=t("quickselect");function i(t,e){if(!(this instanceof i))return new i(t,e);this._maxEntries=Math.max(4,t||9),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),e&&this._initFormat(e),this.clear()}function o(t,e,n){if(!n)return e.indexOf(t);for(var r=0;r<e.length;r++)if(n(t,e[r]))return r;return-1}function a(t,e){s(t,0,t.children.length,e,t)}function s(t,e,n,r,i){i||(i=y(null)),i.minX=1/0,i.minY=1/0,i.maxX=-1/0,i.maxY=-1/0;for(var o,a=e;a<n;a++)o=t.children[a],u(i,t.leaf?r(o):o);return i}function u(t,e){return t.minX=Math.min(t.minX,e.minX),t.minY=Math.min(t.minY,e.minY),t.maxX=Math.max(t.maxX,e.maxX),t.maxY=Math.max(t.maxY,e.maxY),t}function l(t,e){return t.minX-e.minX}function c(t,e){return t.minY-e.minY}function f(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function h(t){return t.maxX-t.minX+(t.maxY-t.minY)}function p(t,e){return t.minX<=e.minX&&t.minY<=e.minY&&e.maxX<=t.maxX&&e.maxY<=t.maxY}function v(t,e){return e.minX<=t.maxX&&e.minY<=t.maxY&&e.maxX>=t.minX&&e.maxY>=t.minY}function y(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function d(t,e,n,i,o){for(var a,s=[e,n];s.length;)(n=s.pop())-(e=s.pop())<=i||(a=e+Math.ceil((n-e)/i/2)*i,r(t,a,e,n,o),s.push(e,a,a,n))}i.prototype={all:function(){return this._all(this.data,[])},search:function(t){var e=this.data,n=[],r=this.toBBox;if(!v(t,e))return n;for(var i,o,a,s,u=[];e;){for(i=0,o=e.children.length;i<o;i++)a=e.children[i],v(t,s=e.leaf?r(a):a)&&(e.leaf?n.push(a):p(t,s)?this._all(a,n):u.push(a));e=u.pop()}return n},collides:function(t){var e=this.data,n=this.toBBox;if(!v(t,e))return!1;for(var r,i,o,a,s=[];e;){for(r=0,i=e.children.length;r<i;r++)if(o=e.children[r],v(t,a=e.leaf?n(o):o)){if(e.leaf||p(t,a))return!0;s.push(o)}e=s.pop()}return!1},load:function(t){if(!t||!t.length)return this;if(t.length<this._minEntries){for(var e=0,n=t.length;e<n;e++)this.insert(t[e]);return this}var r=this._build(t.slice(),0,t.length-1,0);if(this.data.children.length)if(this.data.height===r.height)this._splitRoot(this.data,r);else{if(this.data.height<r.height){var i=this.data;this.data=r,r=i}this._insert(r,this.data.height-r.height-1,!0)}else this.data=r;return this},insert:function(t){return t&&this._insert(t,this.data.height-1),this},clear:function(){return this.data=y([]),this},remove:function(t,e){if(!t)return this;for(var n,r,i,a,s=this.data,u=this.toBBox(t),l=[],c=[];s||l.length;){if(s||(s=l.pop(),r=l[l.length-1],n=c.pop(),a=!0),s.leaf&&-1!==(i=o(t,s.children,e)))return s.children.splice(i,1),l.push(s),this._condense(l),this;a||s.leaf||!p(s,u)?r?(n++,s=r.children[n],a=!1):s=null:(l.push(s),c.push(n),n=0,r=s,s=s.children[0])}return this},toBBox:function(t){return t},compareMinX:l,compareMinY:c,toJSON:function(){return this.data},fromJSON:function(t){return this.data=t,this},_all:function(t,e){for(var n=[];t;)t.leaf?e.push.apply(e,t.children):n.push.apply(n,t.children),t=n.pop();return e},_build:function(t,e,n,r){var i,o=n-e+1,s=this._maxEntries;if(o<=s)return a(i=y(t.slice(e,n+1)),this.toBBox),i;r||(r=Math.ceil(Math.log(o)/Math.log(s)),s=Math.ceil(o/Math.pow(s,r-1))),(i=y([])).leaf=!1,i.height=r;var u,l,c,f,h=Math.ceil(o/s),p=h*Math.ceil(Math.sqrt(s));for(d(t,e,n,p,this.compareMinX),u=e;u<=n;u+=p)for(d(t,u,c=Math.min(u+p-1,n),h,this.compareMinY),l=u;l<=c;l+=h)f=Math.min(l+h-1,c),i.children.push(this._build(t,l,f,r-1));return a(i,this.toBBox),i},_chooseSubtree:function(t,e,n,r){for(var i,o,a,s,u,l,c,h,p,v;r.push(e),!e.leaf&&r.length-1!==n;){for(c=h=1/0,i=0,o=e.children.length;i<o;i++)u=f(a=e.children[i]),p=t,v=a,(l=(Math.max(v.maxX,p.maxX)-Math.min(v.minX,p.minX))*(Math.max(v.maxY,p.maxY)-Math.min(v.minY,p.minY))-u)<h?(h=l,c=u<c?u:c,s=a):l===h&&u<c&&(c=u,s=a);e=s||e.children[0]}return e},_insert:function(t,e,n){var r=this.toBBox,i=n?t:r(t),o=[],a=this._chooseSubtree(i,this.data,e,o);for(a.children.push(t),u(a,i);e>=0&&o[e].children.length>this._maxEntries;)this._split(o,e),e--;this._adjustParentBBoxes(i,o,e)},_split:function(t,e){var n=t[e],r=n.children.length,i=this._minEntries;this._chooseSplitAxis(n,i,r);var o=this._chooseSplitIndex(n,i,r),s=y(n.children.splice(o,n.children.length-o));s.height=n.height,s.leaf=n.leaf,a(n,this.toBBox),a(s,this.toBBox),e?t[e-1].children.push(s):this._splitRoot(n,s)},_splitRoot:function(t,e){this.data=y([t,e]),this.data.height=t.height+1,this.data.leaf=!1,a(this.data,this.toBBox)},_chooseSplitIndex:function(t,e,n){var r,i,o,a,u,l,c,h,p,v,y,d,b,m;for(l=c=1/0,r=e;r<=n-e;r++)i=s(t,0,r,this.toBBox),o=s(t,r,n,this.toBBox),p=i,v=o,void 0,void 0,void 0,void 0,y=Math.max(p.minX,v.minX),d=Math.max(p.minY,v.minY),b=Math.min(p.maxX,v.maxX),m=Math.min(p.maxY,v.maxY),a=Math.max(0,b-y)*Math.max(0,m-d),u=f(i)+f(o),a<l?(l=a,h=r,c=u<c?u:c):a===l&&u<c&&(c=u,h=r);return h},_chooseSplitAxis:function(t,e,n){var r=t.leaf?this.compareMinX:l,i=t.leaf?this.compareMinY:c;this._allDistMargin(t,e,n,r)<this._allDistMargin(t,e,n,i)&&t.children.sort(r)},_allDistMargin:function(t,e,n,r){t.children.sort(r);var i,o,a=this.toBBox,l=s(t,0,e,a),c=s(t,n-e,n,a),f=h(l)+h(c);for(i=e;i<n-e;i++)o=t.children[i],u(l,t.leaf?a(o):o),f+=h(l);for(i=n-e-1;i>=e;i--)o=t.children[i],u(c,t.leaf?a(o):o),f+=h(c);return f},_adjustParentBBoxes:function(t,e,n){for(var r=n;r>=0;r--)u(e[r],t)},_condense:function(t){for(var e,n=t.length-1;n>=0;n--)0===t[n].children.length?n>0?(e=t[n-1].children).splice(e.indexOf(t[n]),1):this.clear():a(t[n],this.toBBox)},_initFormat:function(t){var e=["return a"," - b",";"];this.compareMinX=new Function("a","b",e.join(t[0])),this.compareMinY=new Function("a","b",e.join(t[1])),this.toBBox=new Function("a","return {minX: a"+t[0]+", minY: a"+t[1]+", maxX: a"+t[2]+", maxY: a"+t[3]+"};")}}},{quickselect:136}],138:[function(t,e,n){"use strict";e.exports=function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Date.now();!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.target=e,this.timestamp=n}},{}],139:[function(t,e,n){"use strict";var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var i=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.plot=e}return r(t,[{key:"broadcast",value:function(t){var e=this;this.plot.on(t,function(n){for(var r=e.plot.getSortedLayers(),i=r.length-1;i>=0;i--)r[i].isHidden()||r[i].emit(t,n)})}}]),t}();e.exports=i},{}],140:[function(t,e,n){"use strict";var r,i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();function o(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var a=t("./EventType"),s=t("./MouseEvent"),u=function(t,e,n){return new s(t,n.originalEvent,{x:n.pos.x,y:n.pos.y},{x:n.px.x,y:n.px.y},e)},l=(o(r={},a.MOUSE_MOVE,function(t,e,n,r){var i=[],o=t.prevMouseover;return r?(o&&o.data!==r&&(o.target.unhighlight(),i.push({type:a.MOUSE_OUT,event:u(o.target,o.data,o)})),i.push({type:a.MOUSE_MOVE,event:u(e,r,n)}),t.plot.getContainer().style.cursor="pointer",e.highlight(r),o&&o.data===r||i.push({type:a.MOUSE_OVER,event:u(e,r,n)}),t.prevMouseover=i[i.length-1].event):o&&(t.plot.getContainer().style.cursor="inherit",o.target.unhighlight(),i.push({type:a.MOUSE_OUT,event:u(o.target,o.data,o)}),t.prevMouseover=null),i}),o(r,a.MOUSE_UP,function(t,e,n,r){return r?[{type:a.MOUSE_UP,event:u(e,r,n)}]:[]}),o(r,a.MOUSE_DOWN,function(t,e,n,r){return r?[{type:a.MOUSE_DOWN,event:u(e,r,n)}]:[]}),o(r,a.CLICK,function(t,e,n,r){var i=n.originalEvent.ctrlKey||n.originalEvent.metaKey;if(r){e.isSelected(r)?i&&e.unselect(r):(i||(t.prevClick.forEach(function(t){t.target.unselectAll()}),t.prevClick=[]),e.select(r,i));var o={type:a.CLICK,event:u(e,r,n)};return t.prevClick.push(o.event),[o]}if(t.prevClick.length>0){if(i)return[];t.prevClick.forEach(function(t){t.target.unselectAll()}),t.prevClick=[]}return[]}),o(r,a.DBL_CLICK,function(t,e,n,r){return r?[{type:a.DBL_CLICK,event:u(e,r,n)}]:[]}),r),c=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.plot=e,this.prevClick=[],this.prevMouseover=null}return i(t,[{key:"delegate",value:function(t){var e=this,n=l[t];if(!n)throw"Delegation for event type "+t+" is not supported";this.plot.on(t,function(t){for(var r=e.plot.getSortedLayers(),i=null,o=null,a=r.length-1;a>=0;a--)if(!r[a].isHidden()&&(i=r[a].pick(t.pos))){o=r[a];break}for(var s=n(e,o,t,i),u=0;u<s.length;u++){var l=s[u];l.event.target.emit(l.type,l.event)}})}}]),t}();e.exports=c},{"./EventType":141,"./MouseEvent":142}],141:[function(t,e,n){"use strict";e.exports={CLICK:"click",DBL_CLICK:"dblclick",MOUSE_DOWN:"mousedown",MOUSE_UP:"mouseup",MOUSE_MOVE:"mousemove",MOUSE_OVER:"mouseover",MOUSE_OUT:"mouseout",PAN_START:"panstart",PAN:"pan",PAN_END:"panend",ZOOM_START:"zoomstart",ZOOM:"zoom",ZOOM_END:"zoomend",FRAME:"frame",RESIZE:"resize",CELL_UPDATE:"cellupdate",REFRESH:"refresh",TILE_REQUEST:"tilerequest",TILE_FAILURE:"tilefailure",TILE_ADD:"tileadd",TILE_DISCARD:"tilediscard",TILE_REMOVE:"tileremove",LOAD:"load"}},{}],142:[function(t,e,n){"use strict";var r=t("./Event"),i=function(t){function e(t,n,r,i){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var a=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return a.originalEvent=n,a.pos=r,a.px=i,a.data=o,a}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,r),e}();e.exports=i},{"./Event":138}],143:[function(t,e,n){"use strict";var r=t("./Event"),i=function(t){function e(t,n,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var i=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.oldSize=n,i.newSize=r,i}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,r),e}();e.exports=i},{"./Event":138}],144:[function(t,e,n){"use strict";var r=t("./Event"),i=function(t){function e(t,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var r=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return r.tile=n,r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,r),e}();e.exports=i},{"./Event":138}],145:[function(t,e,n){"use strict";var r=t("./event/EventType");e.exports={CLICK:r.CLICK,DBL_CLICK:r.DBL_CLICK,MOUSE_DOWN:r.MOUSE_DOWN,MOUSE_UP:r.MOUSE_UP,MOUSE_MOVE:r.MOUSE_MOVE,MOUSE_OVER:r.MOUSE_OVER,MOUSE_OUT:r.MOUSE_OUT,PAN_START:r.PAN_START,PAN:r.PAN,PAN_END:r.PAN_END,ZOOM_START:r.ZOOM_START,ZOOM:r.ZOOM,ZOOM_END:r.ZOOM_END,RESIZE:r.RESIZE,FRAME:r.FRAME,REFRESH:r.REFRESH,TILE_REQUEST:r.TILE_REQUEST,TILE_FAILURE:r.TILE_FAILURE,TILE_ADD:r.TILE_ADD,TILE_DISCARD:r.TILE_DISCARD,TILE_REMOVE:r.TILE_REMOVE,CELL_UPDATE:r.CELL_UPDATE,Event:t("./event/Event"),MouseEvent:t("./event/MouseEvent"),ResizeEvent:t("./event/ResizeEvent"),TileEvent:t("./event/TileEvent"),Bounds:t("./geometry/Bounds"),RTree:t("./geometry/RTree"),RTreePyramid:t("./geometry/RTreePyramid"),CircleCollidable:t("./geometry/CircleCollidable"),RectangleCollidable:t("./geometry/RectangleCollidable"),RingCollidable:t("./geometry/RingCollidable"),Plot:t("./plot/Plot"),Layer:t("./layer/Layer"),TileLayer:t("./layer/tile/TileLayer"),Overlay:t("./layer/overlay/Overlay"),PointOverlay:t("./layer/overlay/PointOverlay"),PolylineOverlay:t("./layer/overlay/PolylineOverlay"),PolygonOverlay:t("./layer/overlay/PolygonOverlay"),Renderer:t("./renderer/Renderer"),TileRenderer:t("./renderer/tile/TileRenderer"),WebGLTileRenderer:t("./renderer/tile/WebGLTileRenderer"),ImageTileRenderer:t("./renderer/tile/sample/ImageTileRenderer"),InteractiveTileRenderer:t("./renderer/tile/sample/InteractiveTileRenderer"),PointTileRenderer:t("./renderer/tile/sample/PointTileRenderer"),InstancedTileRenderer:t("./renderer/tile/sample/InstancedTileRenderer"),OverlayRenderer:t("./renderer/overlay/OverlayRenderer"),WebGLOverlayRenderer:t("./renderer/overlay/WebGLOverlayRenderer"),PointOverlayRenderer:t("./renderer/overlay/sample/PointOverlayRenderer"),PolylineOverlayRenderer:t("./renderer/overlay/sample/PolylineOverlayRenderer"),PolygonOverlayRenderer:t("./renderer/overlay/sample/PolygonOverlayRenderer"),Shader:t("./webgl/shader/Shader"),Texture:t("./webgl/texture/Texture"),TextureArray:t("./webgl/texture/TextureArray"),VertexAtlas:t("./webgl/vertex/VertexAtlas"),VertexBuffer:t("./webgl/vertex/VertexBuffer"),IndexBuffer:t("./webgl/vertex/IndexBuffer"),loadBuffer:t("./util/loadBuffer"),loadImage:t("./util/loadImage")}},{"./event/Event":138,"./event/EventType":141,"./event/MouseEvent":142,"./event/ResizeEvent":143,"./event/TileEvent":144,"./geometry/Bounds":146,"./geometry/CircleCollidable":147,"./geometry/RTree":148,"./geometry/RTreePyramid":149,"./geometry/RectangleCollidable":150,"./geometry/RingCollidable":151,"./layer/Layer":152,"./layer/overlay/Overlay":153,"./layer/overlay/PointOverlay":154,"./layer/overlay/PolygonOverlay":155,"./layer/overlay/PolylineOverlay":156,"./layer/tile/TileLayer":159,"./plot/Plot":163,"./renderer/Renderer":173,"./renderer/overlay/OverlayRenderer":174,"./renderer/overlay/WebGLOverlayRenderer":175,"./renderer/overlay/sample/PointOverlayRenderer":176,"./renderer/overlay/sample/PolygonOverlayRenderer":177,"./renderer/overlay/sample/PolylineOverlayRenderer":178,"./renderer/tile/TileRenderer":180,"./renderer/tile/WebGLTileRenderer":181,"./renderer/tile/sample/ImageTileRenderer":182,"./renderer/tile/sample/InstancedTileRenderer":183,"./renderer/tile/sample/InteractiveTileRenderer":184,"./renderer/tile/sample/PointTileRenderer":185,"./util/loadBuffer":189,"./util/loadImage":190,"./webgl/shader/Shader":192,"./webgl/texture/Texture":195,"./webgl/texture/TextureArray":196,"./webgl/vertex/IndexBuffer":197,"./webgl/vertex/VertexAtlas":198,"./webgl/vertex/VertexBuffer":199}],146:[function(t,e,n){"use strict";var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var i=function(t,e,n){var r=0;return e<t.left?r|=1:e>t.right&&(r|=2),n<t.bottom?r|=4:n>t.top&&(r|=8),r},o=function(t,e,n){for(var r=e.x,o=e.y,a=n.x,s=n.y,u=i(t,r,o),l=i(t,a,s),c=!1,f=0;f<8;){if(!(u|l)){c=!0;break}if(u&l)break;var h=void 0,p=0,v=u||l;8&v?(h=r+(a-r)*(t.top-o)/(s-o),p=t.top):4&v?(h=r+(a-r)*(t.bottom-o)/(s-o),p=t.bottom):2&v?(p=o+(s-o)*(t.right-r)/(a-r),h=t.right):(p=o+(s-o)*(t.left-r)/(a-r),h=t.left),v===u?u=i(t,r=h,o=p):l=i(t,a=h,s=p),f++}return c?[{x:r,y:o},{x:a,y:s}]:null},a=function(){function t(e,n,r,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.left=e,this.right=n,this.bottom=r,this.top=i}return r(t,[{key:"getWidth",value:function(){return this.right-this.left}},{key:"getHeight",value:function(){return this.top-this.bottom}},{key:"extend",value:function(t){void 0!==t.left&&void 0!==t.right&&void 0!==t.bottom&&void 0!==t.top?(t.left<this.left&&(this.left=t.left),t.right>this.right&&(this.right=t.right),t.bottom<this.bottom&&(this.bottom=t.bottom),t.top>this.top&&(this.top=t.top)):(t.x<this.left&&(this.left=t.x),t.x>this.right&&(this.right=t.x),t.y<this.bottom&&(this.bottom=t.y),t.y>this.top&&(this.top=t.y))}},{key:"getCenter",value:function(){return{x:this.left+this.getWidth()/2,y:this.bottom+this.getHeight()/2}}},{key:"equals",value:function(t){return this.left===t.left&&this.right===t.right&&this.bottom===t.bottom&&this.top===t.top}},{key:"overlaps",value:function(t){return!(this.left>t.right||this.right<t.left||this.top<t.bottom||this.bottom>t.top)}},{key:"intersection",value:function(e){if(this.overlaps(e))return new t(Math.max(this.left,e.left),Math.min(this.right,e.right),Math.max(this.bottom,e.bottom),Math.min(this.top,e.top))}},{key:"clipLine",value:function(t){return t&&2===t.length?o(this,t[0],t[1]):null}},{key:"clipPolyline",value:function(t){if(!t||t.length<2)return null;for(var e=[],n=[],r=1;r<t.length;r++){var i=t[r-1],a=t[r],s=o(this,i,a);if(s){var u=s[0],l=s[1];n.push(u),(l.x!==a.x&&l.y!==a.y||r===t.length-1)&&(n.push(l),e.push(n),n=[])}}return e.length>0?e:null}},{key:"clipPoints",value:function(t){if(!t)return null;for(var e=[],n=0;n<t.length;n++){var r=t[n];r.x>=this.left&&r.x<=this.right&&r.y>=this.bottom&&r.y<=this.top&&e.push(r)}return e.length>0?e:null}},{key:"clipPolygon",value:function(t){return!t||t.length<3?null:function(t,e){for(var n=void 0,r=1;r<=8;r*=2){n=[];for(var o=e[e.length-1],a=!(i(t,o.x,o.y)&r),s=0;s<e.length;s++){var u=e[s],l=!(i(t,u.x,u.y)&r);if(l!==a){var c=o.x,f=o.y,h=u.x,p=u.y,v=void 0,y=0;8&r?(v=c+(h-c)*(t.top-f)/(p-f),y=t.top):4&r?(v=c+(h-c)*(t.bottom-f)/(p-f),y=t.bottom):2&r?(y=f+(p-f)*(t.right-c)/(h-c),v=t.right):(y=f+(p-f)*(t.left-c)/(h-c),v=t.left),n.push({x:v,y:y})}l&&n.push(u),o=u,a=l}if(!(e=n).length)break}return n.length>0?n:null}(this,t)}}]),t}();e.exports=a},{}],147:[function(t,e,n){"use strict";var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var i=t("lodash/clamp"),o=function(){function t(e,n,r,i,o,a,s){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.x=e,this.y=n,this.radius=r,this.minX=e+i-r,this.maxX=e+i+r,this.minY=n+o-r,this.maxY=n+o+r,this.tile=a,this.data=s}return r(t,[{key:"testPoint",value:function(t,e){var n=.5*(this.minX+this.maxX)-t,r=.5*(this.minY+this.maxY)-e;return n*n+r*r<=this.radius*this.radius}},{key:"testRectangle",value:function(t,e,n,r){var o=.5*(this.minX+this.maxX),a=.5*(this.minY+this.maxY),s=o-i(o,t,e),u=a-i(a,n,r);return s*s+u*u<this.radius*this.radius}}]),t}();e.exports=o},{"lodash/clamp":107}],148:[function(t,e,n){"use strict";var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var i=t("rbush"),o=t("lodash/defaultTo"),a=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.tree=i(o(e.nodeCapacity,32))}return r(t,[{key:"insert",value:function(t){this.tree.load(t)}},{key:"remove",value:function(t){for(var e=this.tree,n=0;n<t.length;n++)e.remove(t[n])}},{key:"searchPoint",value:function(t,e){var n=this.tree.search({minX:t,maxX:t,minY:e,maxY:e});if(0===n.length)return null;for(var r=0;r<n.length;r++){var i=n[r];if(i.testPoint(t,e))return i}return null}},{key:"searchRectangle",value:function(t,e,n,r){var i=this.tree.search({minX:t,maxX:e,minY:n,maxY:r});if(0===i.length)return null;for(var o=0;o<i.length;o++){var a=i[o];if(a.testRectangle(t,e,n,r))return a}return null}}]),t}();e.exports=a},{"lodash/defaultTo":109,rbush:137}],149:[function(t,e,n){"use strict";var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var i=t("lodash/defaultTo"),o=t("./RTree"),a=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.trees=new Map,this.collidables=new Map,this.nodeCapacity=i(e.nodeCapacity,32)}return r(t,[{key:"insert",value:function(t,e){return this.trees.has(t.z)||this.trees.set(t.z,new o({nodeCapacity:this.nodeCapacity})),this.trees.get(t.z).insert(e),this.collidables.set(t.hash,e),this}},{key:"remove",value:function(t){var e=this.collidables.get(t.hash);return this.trees.get(t.z).remove(e),this.collidables.delete(t.hash),this}},{key:"searchPoint",value:function(t,e,n,r){var i=Math.round(n),o=this.trees.get(i);if(!o)return null;var a=Math.pow(2,i-n),s=t*r*a,u=e*r*a;return o.searchPoint(s,u)}},{key:"searchRectangle",value:function(t,e,n,r,i,o){var a=Math.round(i),s=this.trees.get(a);if(!s)return null;var u=Math.pow(2,a-i),l=t*o*u,c=e*o*u,f=n*o*u,h=r*o*u;return s.searchRectangle(l,c,f,h)}}]),t}();e.exports=a},{"./RTree":148,"lodash/defaultTo":109}],150:[function(t,e,n){"use strict";var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var i=function(){function t(e,n,r,i,o,a,s,u){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.minX=e+o,this.maxX=n+o,this.minY=r+a,this.maxY=i+a,this.tile=s,this.data=u}return r(t,[{key:"testPoint",value:function(t,e){return!0}},{key:"testRectangle",value:function(t,e,n,r){return!0}}]),t}();e.exports=i},{}],151:[function(t,e,n){"use strict";var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var i=t("lodash/clamp"),o=function(){function t(e,n,r,i,o,a,s,u){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.x=e,this.y=n,this.radius=r,this.width=i;var l=.5*i;this.minX=e+o-r-l,this.maxX=e+o+r+l,this.minY=n+a-r-l,this.maxY=n+a+r+l,this.tile=s,this.data=u}return r(t,[{key:"testPoint",value:function(t,e){var n=.5*(this.minX+this.maxX)-t,r=.5*(this.minY+this.maxY)-e,i=n*n+r*r,o=.5*this.width,a=this.radius-o,s=this.radius+o;return i<=s*s&&i>=a*a}},{key:"testRectangle",value:function(t,e,n,r){var o=.5*(this.minX+this.maxX),a=.5*(this.minY+this.maxY),s=o-(Math.abs(o-t)<Math.abs(o-e)?e:t),u=a-(Math.abs(a-n)<Math.abs(a-r)?r:n),l=.5*this.width,c=this.radius-l;if(s*s+u*u<c*c)return!1;var f=o-i(o,t,e),h=a-i(a,n,r),p=this.radius+l;return f*f+h*h<p*p}}]),t}();e.exports=o},{"lodash/clamp":107}],152:[function(t,e,n){"use strict";var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var i=t("lodash/clamp"),o=t("lodash/defaultTo"),a=t("events"),s=t("../event/Event"),u=t("../event/EventType"),l=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return n.opacity=o(t.opacity,1),n.hidden=o(t.hidden,!1),n.zIndex=o(t.zIndex,0),n.renderer=o(t.renderer,null),n.highlighted=null,n.selected=[],n.plot=null,n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,a),r(e,[{key:"onAdd",value:function(t){if(!t)throw"No plot argument provided";return this.plot=t,this.plot.setDirty(),this.renderer&&this.renderer.onAdd(this),this}},{key:"onRemove",value:function(t){if(!t)throw"No plot argument provided";return this.renderer&&this.renderer.onRemove(this),this.clear(),this.plot.setDirty(),this.plot=null,this}},{key:"setRenderer",value:function(t){if(!t)throw"No renderer argument provided";return this.renderer&&this.plot&&this.renderer.onRemove(this),this.renderer=t,this.plot&&this.renderer.onAdd(this),this}},{key:"removeRenderer",value:function(){if(!this.renderer)throw"No renderer is currently attached to the layer";return this.plot&&this.renderer.onRemove(this),this.renderer=null,this}},{key:"getRenderer",value:function(){return this.renderer}},{key:"setOpacity",value:function(t){return t=i(t,0,1),this.opacity!==t&&(this.opacity=t,this.plot&&this.plot.setDirty()),this}},{key:"getOpacity",value:function(){return this.opacity}},{key:"setZIndex",value:function(t){return this.zIndex!==t&&(this.zIndex=t,this.plot&&this.plot.setDirty()),this}},{key:"getZIndex",value:function(){return this.zIndex}},{key:"show",value:function(){return this.hidden&&(this.hidden=!1,this.plot&&this.plot.setDirty()),this}},{key:"hide",value:function(){return this.hidden||(this.hidden=!0,this.renderer&&this.renderer.clear(),this.plot&&this.plot.setDirty()),this}},{key:"isHidden",value:function(){return this.hidden}},{key:"pick",value:function(t){return this.renderer?this.renderer.pick(t):null}},{key:"highlight",value:function(t){return this.highlighted!==t&&(this.highlighted=t,this.plot&&this.plot.setDirty()),this}},{key:"unhighlight",value:function(){return null!==this.highlighted&&(this.highlighted=null,this.plot&&this.plot.setDirty()),this}},{key:"getHighlighted",value:function(){return this.highlighted}},{key:"isHighlighted",value:function(t){return this.highlighted===t}},{key:"select",value:function(t,e){var n=!1;e?-1===this.selected.indexOf(t)&&(this.selected.push(t),n=!0):1===this.selected.length&&this.selected[0]===t||(this.selected=[t],n=!0);return this.plot&&n&&this.plot.setDirty(),this}},{key:"unselect",value:function(t){var e=this.selected.indexOf(t);return-1!==e&&(this.selected.splice(e,1),this.plot&&this.plot.setDirty()),this}},{key:"unselectAll",value:function(){return this.selected.length>0&&(this.selected=[],this.plot&&this.plot.setDirty()),this}},{key:"getSelected",value:function(){return this.selected}},{key:"isSelected",value:function(t){return-1!==this.selected.indexOf(t)}},{key:"draw",value:function(t){return this.renderer&&this.renderer.draw(t),this}},{key:"clear",value:function(){return(this.highlighted||this.selected.length>0)&&(this.highlighted=null,this.selected=[]),this.renderer&&this.renderer.clear(),this.plot&&this.plot.setDirty(),this}},{key:"refresh",value:function(){return this.clear(),this.emit(u.REFRESH,new s(this)),this}}]),e}();e.exports=l},{"../event/Event":138,"../event/EventType":141,events:2,"lodash/clamp":107,"lodash/defaultTo":109}],153:[function(t,e,n){"use strict";var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),i=function t(e,n,r){null===e&&(e=Function.prototype);var i=Object.getOwnPropertyDescriptor(e,n);if(void 0===i){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,r)}if("value"in i)return i.value;var a=i.get;return void 0!==a?a.call(r):void 0};var o=t("../../event/EventType"),a=t("../Layer"),s=Symbol(),u=Symbol(),l=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n[u]=null,n[s]=null,n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,a),r(e,[{key:"onAdd",value:function(t){var n=this;return i(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"onAdd",this).call(this,t),this.refresh(),this[s]=function(){n.refresh()},this.plot.on(o.CELL_UPDATE,this[s]),this}},{key:"onRemove",value:function(t){return this[u]=null,this.plot.removeListener(o.CELL_UPDATE,this[s]),this[s]=null,i(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"onRemove",this).call(this,t),this}},{key:"enable",value:function(){return this.show(),this}},{key:"disable",value:function(){return this.hide(),this}},{key:"isDisabled",value:function(){return this.isHidden()}},{key:"refresh",value:function(){return this.plot&&(this[u]=this.clipGeometry(this.plot.cell)),i(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"refresh",this).call(this),this}},{key:"clipGeometry",value:function(t){throw"`clipGeometry` must be overridden"}},{key:"getClippedGeometry",value:function(){return this[u]}}]),e}();e.exports=l},{"../../event/EventType":141,"../Layer":152}],154:[function(t,e,n){"use strict";var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var i=t("./Overlay"),o=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.points=new Map,n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,i),r(e,[{key:"addPoints",value:function(t,e){return this.points.set(t,e),this.plot&&this.refresh(),this}},{key:"removePoints",value:function(t){return this.points.delete(t),this.plot&&this.refresh(),this}},{key:"clearPoints",value:function(){return this.clear(),this.points=new Map,this.plot&&this.refresh(),this}},{key:"clipGeometry",value:function(t){return e=t,n=this.points,r=[],n.forEach(function(t){var n=e.bounds.clipPoints(t);if(n)for(var i=0;i<n.length;i++)r.push(e.project(n[i]))}),r;var e,n,r}}]),e}();e.exports=o},{"./Overlay":153}],155:[function(t,e,n){"use strict";var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var i=t("./Overlay"),o=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.polygons=new Map,n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,i),r(e,[{key:"addPolygon",value:function(t,e){return this.polygons.set(t,e),this.plot&&this.refresh(),this}},{key:"removePolygon",value:function(t){return this.polygons.delete(t),this.plot&&this.refresh(),this}},{key:"clearPolygons",value:function(){return this.clear(),this.polygons=new Map,this.plot&&this.refresh(),this}},{key:"clipGeometry",value:function(t){return e=t,n=this.polygons,r=[],n.forEach(function(t){var n=e.bounds.clipPolygon(t);if(n){for(var i=new Array(n.length),o=0;o<n.length;o++)i[o]=e.project(n[o]);r.push(i)}}),r;var e,n,r}}]),e}();e.exports=o},{"./Overlay":153}],156:[function(t,e,n){"use strict";var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var i=t("./Overlay"),o=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.polylines=new Map,n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,i),r(e,[{key:"addPolyline",value:function(t,e){return this.polylines.set(t,e),this.plot&&this.refresh(),this}},{key:"removePolyline",value:function(t){return this.polylines.delete(t),this.plot&&this.refresh(),this}},{key:"clearPolylines",value:function(){return this.clear(),this.polylines=new Map,this.plot&&this.refresh(),this}},{key:"clipGeometry",value:function(t){return e=t,n=this.polylines,r=[],n.forEach(function(t){var n=e.bounds.clipPolyline(t);if(n)for(var i=0;i<n.length;i++){for(var o=n[i],a=0;a<o.length;a++)o[a]=e.project(o[a]);r.push(o)}}),r;var e,n,r}}]),e}();e.exports=o},{"./Overlay":153}],157:[function(t,e,n){"use strict";var r=Math.pow(2,53)-1,i=1;e.exports=function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.coord=e,this.uid=i=(i+1)%r,this.data=null,this.err=null}},{}],158:[function(t,e,n){"use strict";var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var i=function(t,e){return(t%e+e)%e},o=function(){function t(e,n,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.z=e,this.x=n,this.y=r,this.hash=this.z+":"+this.x+":"+this.y}return r(t,[{key:"xyz",value:function(){var t=Math.pow(2,this.z);return this.z+"/"+this.x+"/"+(t-1-this.y)}},{key:"tms",value:function(){return this.z+"/"+this.x+"/"+this.y}},{key:"equals",value:function(t){return this.z===t.z&&this.x===t.x&&this.y===t.y}},{key:"getAncestor",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,n=Math.pow(2,e);return new t(this.z-e,Math.floor(this.x/n),Math.floor(this.y/n))}},{key:"getDescendants",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,n=Math.pow(2,e),r=new Array(n*n),i=0;i<n;i++)for(var o=i*n,a=0;a<n;a++)r[o+a]=new t(this.z+e,this.x*n+i,this.y*n+a);return r}},{key:"isAncestorOf",value:function(t){if(this.z>=t.z)return!1;var e=t.z-this.z,n=Math.pow(2,e),r=Math.floor(t.x/n);if(this.x!==r)return!1;var i=Math.floor(t.y/n);return this.y===i}},{key:"isDescendantOf",value:function(t){return t.isAncestorOf(this)}},{key:"normalize",value:function(){var e=Math.pow(2,this.z);return new t(this.z,i(this.x,e),i(this.y,e))}},{key:"getPosition",value:function(){var t=Math.pow(2,this.z);return{x:this.x/t,y:this.y/t}}},{key:"getCenter",value:function(){var t=Math.pow(2,this.z);return{x:(this.x+.5)/t,y:(this.y+.5)/t}}}]),t}();e.exports=o},{}],159:[function(t,e,n){"use strict";var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),i=function t(e,n,r){null===e&&(e=Function.prototype);var i=Object.getOwnPropertyDescriptor(e,n);if(void 0===i){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,r)}if("value"in i)return i.value;var a=i.get;return void 0!==a?a.call(r):void 0};var o=t("lodash/defaultTo"),a=t("../Layer"),s=t("./TilePyramid"),u=function(t){var e=t.plot.getTargetVisibleCoords();t.requestTiles(e)},l=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.muted=o(t.muted,!1),n.pyramid=new s(n,t),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,a),r(e,[{key:"onAdd",value:function(t){return i(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"onAdd",this).call(this,t),this.isMuted()||u(this),this}},{key:"onRemove",value:function(t){return this.pyramid.clear(),i(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"onRemove",this).call(this,t),this}},{key:"getPyramid",value:function(){return this.pyramid}},{key:"hide",value:function(){return i(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"hide",this).call(this),this}},{key:"mute",value:function(){return this.muted=!0,this}},{key:"unmute",value:function(){return this.isMuted()&&(this.muted=!1,this.plot&&u(this)),this}},{key:"isMuted",value:function(){return this.muted}},{key:"enable",value:function(){return this.show(),this.unmute(),this}},{key:"disable",value:function(){return this.hide(),this.mute(),this}},{key:"isDisabled",value:function(){return this.isMuted()&&this.isHidden()}},{key:"refresh",value:function(){return this.pyramid.clear(),this.plot&&!this.isMuted()&&u(this),i(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"refresh",this).call(this),this}},{key:"requestTile",value:function(t,e){e(null,null)}},{key:"requestTiles",value:function(t){return this.isMuted()?this:(this.pyramid.requestTiles(t),this)}}]),e}();e.exports=l},{"../Layer":152,"./TilePyramid":161,"lodash/defaultTo":109}],160:[function(t,e,n){"use strict";var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var i=function(){function t(e,n,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.target=e,this.tile=n,this.relative=r}return r(t,null,[{key:"fromTile",value:function(e){return new t(e,e,null)}},{key:"fromAncestor",value:function(e,n,r){return new t(e,n,r)}},{key:"fromDescendant",value:function(e,n){return new t(e,n,null)}}]),t}();e.exports=i},{}],161:[function(t,e,n){"use strict";var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var i=t("lodash/defaultTo"),o=t("lodash/throttle"),a=t("../../event/EventType"),s=t("../../event/TileEvent"),u=t("../../util/LRUCache"),l=t("./Tile"),c=t("./TilePartial"),f=256,h=4,p=200,v=function(t,e){if(e.coord.z<t.numPersistentLevels){if(!t.persistents.has(e.coord.hash))throw"Tile of coord "+e.coord.hash+" does not exists in the pyramid";t.persistents.delete(e.coord.hash)}var n=t.levels.get(e.coord.z);n.splice(n.indexOf(e),1),0===n.length&&t.levels.delete(e.coord.z),t.layer.emit(a.TILE_REMOVE,new s(t.layer,e))},y=function(t){0===t.pending.size&&t.emitLoad(new s(t.layer,null))},d=function(){function t(e){var n=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),!e)throw"No layer parameter provided";this.cacheSize=i(r.cacheSize,f),this.numPersistentLevels=i(r.numPersistentLevels,h),this.layer=e,this.levels=new Map,this.persistents=new Map,this.pending=new Map,this.stale=new Map,this.tiles=new u({capacity:this.cacheSize,onRemove:function(t){v(n,t)}}),this.emitLoad=o(function(t){n.layer.emit(a.LOAD,t)},p)}return r(t,[{key:"getCapacity",value:function(){return this.cacheSize+(t=this.numPersistentLevels,1/3*(Math.pow(4,t)-1));var t}},{key:"clear",value:function(){var t=this;this.pending.forEach(function(e){var n,r,i,o;n=t,i=(r=e).coord.hash,(o=n.stale.get(i))||(o=new Map,n.stale.set(i,o)),o.set(r.uid,!0)}),this.pending=new Map,this.persistents.forEach(function(e){v(t,e)}),this.persistents.clear(),this.tiles.clear()}},{key:"has",value:function(t){return t.z<this.numPersistentLevels?this.persistents.has(t.hash):this.tiles.has(t.hash)}},{key:"forEach",value:function(t){this.persistents.forEach(t),this.tiles.forEach(t)}},{key:"isPending",value:function(t){return this.pending.has(t.hash)}},{key:"get",value:function(t){return t.z<this.numPersistentLevels?this.persistents.get(t.hash):this.tiles.get(t.hash)}},{key:"getAncestor",value:function(t,e){var n=t.getAncestor(e);return this.get(n)}},{key:"getDescendants",value:function(t,e){for(var n=t.getDescendants(e),r=!1,i=0;i<n.length;i++)if(this.has(n[i])){r=!0;break}if(r){for(var o=new Array(n.length),a=0;a<n.length;a++){var s=n[a];o[a]=this.get(s)||s}return o}}},{key:"requestTiles",value:function(t){var e,n,r,i,o,u,c=this,f=t.map(function(t){return{coord:t,ncoord:t.normalize()}});e=f,n=new Map,f=e.filter(function(t){var e=t.ncoord.hash;return!n.has(e)&&n.set(e,!0)}),r=this,f=f.filter(function(t){return!r.get(t.ncoord)&&!r.isPending(t.ncoord)}),i=this.layer.plot,o=f,u=i.getTargetViewportCenter(),o.sort(function(t,e){var n=t.coord.getCenter(),r=e.coord.getCenter(),i=u.x-n.x,o=u.y-n.y,a=u.x-r.x,s=u.y-r.y;return i*i+o*o-(a*a+s*s)});for(var h=(f=o).map(function(t){var e=new l(t.ncoord);return c.pending.set(e.coord.hash,e),e}),p=function(t){var e=h[t];c.layer.emit(a.TILE_REQUEST,new s(c.layer,e)),c.layer.requestTile(e.coord,function(t,n){var r,i,o,u,l,f,h=(r=c,o=(i=e).coord.hash,!(!(u=r.stale.get(o))||!u.has(i.uid)||(u.delete(i.uid),0===u.size&&r.stale.delete(o),0)));return h||c.pending.delete(e.coord.hash),null!==t?(e.err=t,c.layer.emit(a.TILE_FAILURE,new s(c.layer,e)),void(h||y(c))):(e.data=n,!h&&(l=e,(f=c.layer.plot)&&f.getTargetViewport().isInView(l.coord,f.wraparound))?(function(t,e){if(e.coord.z<t.numPersistentLevels){if(t.persistents.has(e.coord.hash))throw"Tile of coord "+e.coord.hash+" already exists in the pyramid";t.persistents.set(e.coord.hash,e)}else{if(t.tiles.has(e.coord.hash))throw"Tile of coord "+e.coord.hash+" already exists in the pyramid";t.tiles.set(e.coord.hash,e)}t.levels.has(e.coord.z)||t.levels.set(e.coord.z,[]),t.levels.get(e.coord.z).push(e),t.layer.emit(a.TILE_ADD,new s(t.layer,e))}(c,e),y(c),void c.layer.plot.setDirty()):(c.layer.emit(a.TILE_DISCARD,new s(c.layer,e)),void(h||y(c))))})},v=0;v<h.length;v++)p(v)}},{key:"getAvailableLOD",value:function(t){var e=this.get(t);if(e)return[c.fromTile(e)];var n=t.z,r=[];this.levels.forEach(function(t,e){e!==n&&r.push(e)}),r.sort(function(t,e){return(t>n?t-n:n-t-.5)-(e>n?e-n:n-e-.5)});for(var i=[],o=[],a=t,s=r.shift();void 0!==a&&void 0!==s;){if(s<a.z){var u=a.z-s,l=this.getAncestor(a,u);if(l){i.push(c.fromAncestor(t,l,a)),a=o.shift();continue}}else{if(s-n<4){var f=s-a.z,h=this.getDescendants(a,f);if(h){for(var p=0;p<h.length;p++){var v=h[p];v.coord?i.push(c.fromDescendant(t,v)):o.push(v)}a=o.shift()}}}s=r.shift()}return i.length>0?i:void 0}}]),t}();e.exports=d},{"../../event/EventType":141,"../../event/TileEvent":144,"../../util/LRUCache":187,"./Tile":157,"./TilePartial":160,"lodash/defaultTo":109,"lodash/throttle":133}],162:[function(t,e,n){"use strict";var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var i=t("../geometry/Bounds"),o=Math.pow(2,16)/2,a=function(){function t(e,n,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t);var a=o/r,s={x:n.x-a,y:n.y-a};this.zoom=e,this.halfSize=a,this.center=n,this.offset=s,this.extent=r,this.bounds=new i(n.x-a,n.x+a,n.y-a,n.y+a)}return r(t,[{key:"project",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.zoom,n=Math.pow(2,e-this.zoom)*this.extent;return{x:(t.x-this.offset.x)*n,y:(t.y-this.offset.y)*n}}},{key:"unproject",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.zoom,n=Math.pow(2,e-this.zoom)*this.extent;return{x:t.x/n+this.offset.x,y:t.y/n+this.offset.y}}}]),t}();e.exports=a},{"../geometry/Bounds":146}],163:[function(t,e,n){"use strict";var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var i=t("lodash/clamp"),o=t("lodash/defaultTo"),a=t("lodash/throttle"),s=t("events"),u=t("../event/EventType"),l=t("../event/EventBroadcaster"),c=t("../event/EventDelegator"),f=t("../event/Event"),h=t("../event/ResizeEvent"),p=t("../webgl/RenderBuffer"),v=t("./handler/ClickHandler"),y=t("./handler/MouseHandler"),d=t("./handler/PanHandler"),b=t("./handler/ZoomHandler"),m=t("./Cell"),g=t("./Viewport"),_=100,x=200,w=400,O=24,E=Symbol(),T=Symbol(),P=Symbol(),k=Symbol(),S=Symbol(),A=Symbol(),R=Symbol(),j=Symbol(),M=function(){var t=this.getTargetVisibleCoords();return this.layers.forEach(function(e){e.requestTiles&&e.requestTiles(t)}),this},C=function(t){var e=t.getTargetZoom(),n=t.getTargetViewportCenter(),r=t.getTargetPixelExtent(),i=t.getViewportPixelSize(),o=new m(e,n,r),a=!1;if(t.cell)if(Math.abs(t.cell.zoom-o.zoom)>=1)a=!0;else{var s=t.cell.halfSize-i.width/t.cell.extent,l=t.cell.halfSize-i.height/t.cell.extent;(Math.abs(o.center.x-t.cell.center.x)>s||Math.abs(o.center.y-t.cell.center.y)>l)&&(a=!0)}else a=!0;a&&(t.cell=o,t.emit(u.CELL_UPDATE,new f(o)))},L=function t(e){var n=Date.now();(e.emit(u.FRAME,new f(e,n)),function(t){var e={width:t.container.offsetWidth,height:t.container.offsetHeight},n=t.getViewportPixelSize(),r=t.viewport.getCenter();if(n.width!==e.width||n.height!==e.height||t.pixelRatio!==window.devicePixelRatio){t.pixelRatio=window.devicePixelRatio,t.canvas.style.width=e.width+"px",t.canvas.style.height=e.height+"px",t.canvas.width=e.width*t.pixelRatio,t.canvas.height=e.height*t.pixelRatio,t.renderBuffer&&t.renderBuffer.resize(e.width*t.pixelRatio,e.height*t.pixelRatio);var i=t.getPixelExtent();t.viewport.width=e.width/i,t.viewport.height=e.height/i,t.viewport.centerOn(r),t.resizeRequest(),t.setDirty(),t.emit(u.RESIZE,new h(t,n,e))}}(e),!e.dirtyChecking||e.isDirty())&&(e.clearDirty(),e.isZooming()&&e.zoomAnimation.update(n)&&(e.zoomAnimation=null),e.isPanning()&&(e.panAnimation.update(n)&&(e.panAnimation=null),e.panRequest()),function(t){if(t.wraparound){var e=Math.ceil(t.viewport.width/1);t.viewport.x>1&&(t.viewport.x-=e,t.isPanning()&&(t.panAnimation.start.x-=e)),t.viewport.x+t.viewport.width<0&&(t.viewport.x+=e,t.isPanning()&&(t.panAnimation.start.x+=e))}}(e),C(e),function(t){var e=t.getRenderingContext();if(e){e.clearColor(0,0,0,0),e.clear(e.COLOR_BUFFER_BIT);var n=t.getViewportPixelSize();e.viewport(0,0,n.width*t.pixelRatio,n.height*t.pixelRatio)}}(e),e.getSortedLayers().forEach(function(t){t.isHidden()||t.draw(n)}));e.frameRequest=requestAnimationFrame(function(){t(e)})},D=function(t){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var r=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));if(r.container=document.querySelector(t),!r.container)throw"Element could not be found for selector "+t;if(r.canvas=document.createElement("canvas"),r.canvas.style.width=r.container.offsetWidth+"px",r.canvas.style.height=r.container.offsetHeight+"px",r.canvas.width=r.container.offsetWidth*r.pixelRatio,r.canvas.height=r.container.offsetHeight*r.pixelRatio,r.container.appendChild(r.canvas),r.ctx=r.canvas.getContext("webgl",n.contextAttributes)||r.canvas.getContext("experimental-webgl",n.contextAttributes),!r.ctx&&!n.noContext)throw"Unable to create a WebGLRenderingContext, please ensure your browser supports WebGL";r.ctx?r.renderBuffer=new p(r.ctx,r.canvas.width,r.canvas.height):r.renderBuffer=null,r.pixelRatio=window.devicePixelRatio,r.tileSize=o(n.tileSize,256),r.minZoom=o(n.minZoom,0),r.maxZoom=o(n.maxZoom,O),r.zoom=o(n.zoom,0),r.zoom=i(r.zoom,r.minZoom,r.maxZoom);var s=Math.pow(2,r.zoom),f=r.canvas.offsetWidth/s,h=r.canvas.offsetHeight/s;r.viewport=new g(0,0,f,h);var m=o(n.center,{x:.5,y:.5});r.viewport.centerOn(m),r.cell=null,C(r),r.wraparound=o(n.wraparound,!1);var D=o(n.panThrottle,_),z=o(n.resizeThrottle,x),U=o(n.zoomThrottle,w);return r.panRequest=a(M,D,{leading:!1}),r.resizeRequest=a(M,z,{leading:!1}),r.zoomRequest=a(M,U,{leading:!1}),r.layers=[],r.frameRequest=null,r[S]=new Map,r[S].set(E,new v(r,n)),r[S].set(T,new y(r,n)),r[S].set(P,new d(r,n)),r[S].set(k,new b(r,n)),r[S].forEach(function(t){t.enable()}),r[A]=new c(r),r[A].delegate(u.CLICK),r[A].delegate(u.DBL_CLICK),r[A].delegate(u.MOUSE_MOVE),r[A].delegate(u.MOUSE_UP),r[A].delegate(u.MOUSE_DOWN),r[R]=new l(r),r[R].broadcast(u.ZOOM_START),r[R].broadcast(u.ZOOM),r[R].broadcast(u.ZOOM_END),r[R].broadcast(u.PAN_START),r[R].broadcast(u.PAN),r[R].broadcast(u.PAN_END),r.dirtyChecking=o(n.dirtyChecking,!0),r[j]=!0,L(r),r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,s),r(e,[{key:"destroy",value:function(){var t=this;return cancelAnimationFrame(this.frameRequest),this.frameRequest=null,this[S].forEach(function(t){t.disable()}),this.layers.forEach(function(e){t.remove(e)}),this.ctx=null,this.container.removeChild(this.canvas),this.canvas=null,this.container=null,this.renderBuffer=null,this}},{key:"setDirty",value:function(){this[j]=!0}},{key:"isDirty",value:function(){return this[j]||this.isPanning()||this.isZooming()}},{key:"clearDirty",value:function(){this[j]=!1}},{key:"add",value:function(t){if(!t)throw"No argument provided";if(-1!==this.layers.indexOf(t))throw"Provided layer is already attached to the plot";return this.layers.push(t),t.onAdd(this),this.setDirty(),this}},{key:"remove",value:function(t){if(!t)throw"No argument provided";var e=this.layers.indexOf(t);if(-1===e)throw"Provided layer is not attached to the plot";return this.layers.splice(e,1),t.onRemove(this),this.setDirty(),this}},{key:"getRenderingContext",value:function(){return this.ctx}},{key:"getSortedLayers",value:function(){return this.layers.sort(function(t,e){return t.getZIndex()-e.getZIndex()})}},{key:"getZoom",value:function(){return this.zoom}},{key:"getTargetZoom",value:function(){return this.isZooming()?this.zoomAnimation.targetZoom:this.zoom}},{key:"getViewport",value:function(){return this.viewport}},{key:"getTargetViewport",value:function(){return this.isZooming()?this.zoomAnimation.targetViewport:this.viewport}},{key:"getViewportPosition",value:function(){return this.viewport.getPosition()}},{key:"getTargetViewportPosition",value:function(){return this.getTargetViewport().getPosition()}},{key:"getViewportCenter",value:function(){return this.viewport.getCenter()}},{key:"getTargetViewportCenter",value:function(){return this.getTargetViewport().getCenter()}},{key:"getTargetVisibleCoords",value:function(){var t=Math.round(this.getTargetZoom());return this.getTargetViewport().getVisibleCoords(t,this.wraparound)}},{key:"getVisibleCoords",value:function(){var t=Math.round(this.zoom);return this.viewport.getVisibleCoords(t,this.wraparound)}},{key:"getPixelExtent",value:function(){return Math.pow(2,this.zoom)*this.tileSize}},{key:"getTargetPixelExtent",value:function(){return Math.pow(2,this.getTargetZoom())*this.tileSize}},{key:"getViewportPixelSize",value:function(){return this.viewport.getPixelSize(this.zoom,this.tileSize)}},{key:"getTargetViewportPixelSize",value:function(){return this.getTargetViewport().getPixelSize(this.zoom,this.tileSize)}},{key:"getViewportPixelOffset",value:function(){return this.viewport.getPixelOffset(this.zoom,this.tileSize)}},{key:"getTargetViewportPixelOffset",value:function(){return this.getTargetViewport().getPixelOffset(this.zoom,this.tileSize)}},{key:"mouseToPlotCoord",value:function(t){var e=this.getPixelExtent(),n=this.getViewportPixelSize(),r=this.getContainer().getBoundingClientRect(),i=t.pageX-r.left,o=t.pageY-r.top;return{x:this.viewport.x+i/e,y:this.viewport.y+(n.height-o)/e}}},{key:"mouseToViewportPixel",value:function(t){var e=this.getViewportPixelSize(),n=this.getContainer().getBoundingClientRect(),r=t.pageX-n.left,i=t.pageY-n.top;return{x:r,y:e.height-i}}},{key:"viewportPixelToPlotCoord",value:function(t){var e=this.getPixelExtent();return{x:t.x/e,y:t.y/e}}},{key:"plotCoordToViewportPixel",value:function(t){var e=this.plot.getPixelExtent();return{x:t.x*e,y:t.y*e}}},{key:"getOrthoMatrix",value:function(){var t=this.getViewportPixelSize(),e=t.width,n=t.height,r=1/(0-e),i=1/(0-n),o=new Float32Array(16);return o[0]=-2*r,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=-2*i,o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[10]=-1,o[11]=0,o[12]=(0+e)*r,o[13]=(n+0)*i,o[14]=-0,o[15]=1,o}},{key:"panTo",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return this.cancelPan(),this.cancelZoom(),this[S].get(P).panTo(t,e),this.setDirty(),this}},{key:"zoomTo",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return this.cancelPan(),this.cancelZoom(),this[S].get(k).zoomTo(t,e),this.setDirty(),this}},{key:"zoomToPosition",value:function(t,e){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return this.cancelPan(),this.cancelZoom(),this[S].get(k).zoomToPosition(t,e,n),this.setDirty(),this}},{key:"fitToBounds",value:function(t){var e=this.getTargetZoom(),n=this.getTargetViewport(),r=n.width/t.getWidth(),o=n.height/t.getHeight(),a=Math.min(r,o),s=Math.log2(a)+e;s=i(s,this.minZoom,this.maxZoom),this.continuousZoom||(s=Math.floor(s));var u=t.getCenter();return this.zoomTo(s,!1),this.panTo(u,!1),this.setDirty(),this}},{key:"isPanning",value:function(){return!!this.panAnimation}},{key:"isZooming",value:function(){return!!this.zoomAnimation}},{key:"cancelPan",value:function(){return!!this.isPanning()&&(this.panAnimation.cancel(),this.panAnimation=null,!0)}},{key:"cancelZoom",value:function(){return!!this.isZooming()&&(this.zoomAnimation.cancel(),this.zoomAnimation=null,!0)}},{key:"enablePanning",value:function(){this[S].get(P).enable()}},{key:"disablePanning",value:function(){this[S].get(P).disable()}},{key:"enableZooming",value:function(){this[S].get(k).enable()}},{key:"disableZooming",value:function(){this[S].get(k).disable()}},{key:"getHighlighted",value:function(){for(var t=this.layers,e=0;e<t.length;e++){var n=t[e].getHighlighted();if(n)return n}return null}},{key:"isHighlighted",value:function(t){for(var e=this.layers,n=0;n<e.length;n++)if(e[n].isHighlighted(t))return!0;return!1}},{key:"getSelected",value:function(){for(var t=[],e=this.layers,n=0;n<e.length;n++)for(var r=e[n].getSelected(),i=0;i<r.length;i++)t.push(r[i]);return t}},{key:"isSelected",value:function(t){for(var e=this.layers,n=0;n<e.length;n++)if(e[n].isSelected(t))return!0;return!1}},{key:"getContainer",value:function(){return this.container}}]),e}();e.exports=D},{"../event/Event":138,"../event/EventBroadcaster":139,"../event/EventDelegator":140,"../event/EventType":141,"../event/ResizeEvent":143,"../webgl/RenderBuffer":191,"./Cell":162,"./Viewport":164,"./handler/ClickHandler":168,"./handler/MouseHandler":170,"./handler/PanHandler":171,"./handler/ZoomHandler":172,events:2,"lodash/clamp":107,"lodash/defaultTo":109,"lodash/throttle":133}],164:[function(t,e,n){"use strict";var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var i=t("../geometry/Bounds"),o=t("../layer/tile/TileCoord"),a=function(t,e,n){var r=t.getTileBounds(e),o=Math.pow(2,e)-1,a=new i(n?-1/0:0,n?1/0:o,0,o);if(r.overlaps(a)){var s=n?r.left:Math.max(0,r.left),u=n?r.right:Math.min(o,r.right),l=Math.max(0,r.bottom),c=Math.min(o,r.top);return new i(s,u,l,c)}},s=function(t,e,n,r){return t<=r&&r<=e||(t>r?r+Math.ceil((t-r)/n)*n<=e:r-Math.ceil((r-e)/n)*n>=t)},u=function(){function t(e,n,r,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.x=e,this.y=n,this.width=r,this.height=i}return r(t,[{key:"getTileBounds",value:function(t){var e=1/Math.pow(2,t);return new i(Math.floor(this.x/e),Math.ceil((this.x+this.width)/e)-1,Math.floor(this.y/e),Math.ceil((this.y+this.height)/e)-1)}},{key:"getVisibleCoords",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=a(this,t,e);if(!n)return[];for(var r=[],i=n.left;i<=n.right;i++)for(var s=n.bottom;s<=n.top;s++)r.push(new o(t,i,s));return r}},{key:"isInView",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=a(this,t.z,e);if(!n)return!1;var r=Math.pow(2,t.z);return s(n.left,n.right,r,t.x)&&s(n.bottom,n.top,r,t.y)}},{key:"zoomToPos",value:function(e,n,r){var i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],o=Math.pow(2,n-e),a=this.width/o,s=this.height/o,u=new t(r.x-(r.x-this.x)/o,r.y-(r.y-this.y)/o,a,s);return i||u.centerOn(r),u}},{key:"getPosition",value:function(){return{x:this.x,y:this.y}}},{key:"getCenter",value:function(){return{x:this.x+this.width/2,y:this.y+this.height/2}}},{key:"getPixelSize",value:function(t,e){var n=Math.pow(2,t)*e;return{width:Math.round(this.width*n),height:Math.round(this.height*n)}}},{key:"getPixelOffset",value:function(t,e){var n=Math.pow(2,t)*e;return{x:this.x*n,y:this.y*n}}},{key:"centerOn",value:function(t){this.x=t.x-this.width/2,this.y=t.y-this.height/2}}]),t}();e.exports=u},{"../geometry/Bounds":146,"../layer/tile/TileCoord":158}],165:[function(t,e,n){"use strict";var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var i=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.timestamp=Date.now(),this.duration=e.duration,this.plot=e.plot}return r(t,[{key:"getT",value:function(t){return this.duration>0?Math.min(1,(t-this.timestamp)/this.duration):1}},{key:"update",value:function(t){return!0}},{key:"cancel",value:function(){}},{key:"finish",value:function(){}}]),t}();e.exports=i},{}],166:[function(t,e,n){"use strict";var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var i=t("../../event/EventType"),o=t("../../event/Event"),a=t("./Animation"),s=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.start=t.start,n.delta=t.delta,n.end={x:n.start.x+n.delta.x,y:n.start.y+n.delta.y},n.easing=t.easing,n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,a),r(e,[{key:"update",value:function(t){var e=this.getT(t),n=1-Math.pow(1-e,1/this.easing),r=this.plot;r.viewport.x=this.start.x+this.delta.x*n,r.viewport.y=this.start.y+this.delta.y*n;var a=new o(r);return e<1?(r.emit(i.PAN,a),!1):(r.emit(i.PAN_END,a),!0)}},{key:"cancel",value:function(){var t=this.plot;t.emit(i.PAN_END,new o(t))}},{key:"finish",value:function(){var t=this.plot;t.viewport.x=this.end.x,t.viewport.y=this.end.y,t.emit(i.PAN_END,new o(t))}}]),e}();e.exports=s},{"../../event/Event":138,"../../event/EventType":141,"./Animation":165}],167:[function(t,e,n){"use strict";var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var i=t("../../event/EventType"),o=t("../../event/Event"),a=t("./Animation"),s=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.prevZoom=t.prevZoom,n.targetZoom=t.targetZoom,n.prevViewport=t.prevViewport,n.targetViewport=t.targetViewport,n.targetPos=t.targetPos,n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,a),r(e,[{key:"update",value:function(t){var e=this.getT(t),n=this.targetZoom-this.prevZoom,r=this.prevZoom+n*e,a=this.plot;a.zoom=r,a.viewport=this.prevViewport.zoomToPos(this.prevZoom,a.zoom,this.targetPos);var s=new o(a);return e<1?(a.emit(i.ZOOM,s),!1):(a.emit(i.ZOOM_END,s),!0)}},{key:"cancel",value:function(){var t=this.plot;t.continuousZoom||(t.zoom=Math.round(t.zoom),t.viewport=this.prevViewport.zoomToPos(this.prevZoom,t.zoom,this.targetPos));var e=new o(t);t.emit(i.ZOOM_END,e)}},{key:"finish",value:function(){var t=this.plot;t.zoom=this.targetZoom,t.viewport=this.targetViewport;var e=new o(t);t.emit(i.ZOOM_END,e)}}]),e}();e.exports=s},{"../../event/Event":138,"../../event/EventType":141,"./Animation":165}],168:[function(t,e,n){"use strict";var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),i=function t(e,n,r){null===e&&(e=Function.prototype);var i=Object.getOwnPropertyDescriptor(e,n);if(void 0===i){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,r)}if("value"in i)return i.value;var a=i.get;return void 0!==a?a.call(r):void 0};var o=t("../../event/EventType"),a=t("../../event/MouseEvent"),s=t("./DOMHandler"),u=function(t,e,n){return new a(e,n,t.mouseToPlot(n),t.mouseToViewPx(n))},l=function(t){function e(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,s),r(e,[{key:"enable",value:function(){var t=this;if(this.enabled)return this;var n=this.plot,r=null;this.mousedown=function(e){r=t.mouseToViewPx(e)},this.mouseup=function(e){if(r){var i=t.mouseToViewPx(e),a=r.x-i.x,s=r.y-i.y;a*a+s*s<225&&(n.setDirty(),e.preventDefault(),t.plot.emit(o.CLICK,u(t,n,e))),r=null}},this.dblclick=function(e){n.setDirty(),e.preventDefault(),t.plot.emit(o.DBL_CLICK,u(t,n,e))};var a=n.getContainer();return a.addEventListener("mousedown",this.mousedown),a.addEventListener("mouseup",this.mouseup),a.addEventListener("dblclick",this.dblclick),i(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"enable",this).call(this)}},{key:"disable",value:function(){if(!this.enabled)return this;var t=this.plot.getContainer();return t.removeEventListener("mousedown",this.mousedown),t.removeEventListener("mouseup",this.mouseup),t.removeEventListener("dblclick",this.dblclick),this.mousedown=null,this.mouseup=null,this.dblclick=null,i(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"disable",this).call(this)}}]),e}();e.exports=l},{"../../event/EventType":141,"../../event/MouseEvent":142,"./DOMHandler":169}],169:[function(t,e,n){"use strict";var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var i=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.plot=e,this.enabled=!1}return r(t,[{key:"enable",value:function(){return this.enabled=!0,this}},{key:"disable",value:function(){return this.enabled=!1,this}},{key:"mouseToPlot",value:function(t){return this.plot.mouseToPlotCoord(t)}},{key:"mouseToViewPx",value:function(t){return this.plot.mouseToViewportPixel(t)}},{key:"viewPxToPlot",value:function(t){return this.plot.viewportPixelToPlotCoord(t)}},{key:"plotToViewPx",value:function(t){return this.plot.plotCoordToViewportPixel(t)}},{key:"isLeftButton",value:function(t){return t.which?1===t.which:0===t.button}},{key:"isMiddleButton",value:function(t){return t.which?2===t.which:1===t.button}},{key:"isRightButton",value:function(t){return t.which?3===t.which:2===t.button}}]),t}();e.exports=i},{}],170:[function(t,e,n){"use strict";var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),i=function t(e,n,r){null===e&&(e=Function.prototype);var i=Object.getOwnPropertyDescriptor(e,n);if(void 0===i){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,r)}if("value"in i)return i.value;var a=i.get;return void 0!==a?a.call(r):void 0};var o=t("../../event/EventType"),a=t("../../event/MouseEvent"),s=t("./DOMHandler"),u=function(t,e,n){return new a(e,n,t.mouseToPlot(n),t.mouseToViewPx(n))},l=function(t){function e(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,s),r(e,[{key:"enable",value:function(){var t=this;if(this.enabled)return this;var n=this.plot;this.mousedown=function(e){n.setDirty(),e.preventDefault(),n.emit(o.MOUSE_DOWN,u(t,n,e))},this.mouseup=function(e){n.setDirty(),e.preventDefault(),n.emit(o.MOUSE_UP,u(t,n,e))},this.mousemove=function(e){n.setDirty(),e.preventDefault(),n.emit(o.MOUSE_MOVE,u(t,n,e))},this.mouseover=function(e){n.setDirty(),e.preventDefault(),n.emit(o.MOUSE_OVER,u(t,n,e))},this.mouseout=function(e){n.setDirty(),e.preventDefault(),n.emit(o.MOUSE_OUT,u(t,n,e))},this.wheel=function(t){n.setDirty(),t.preventDefault()};var r=n.getContainer();return r.addEventListener("mousedown",this.mousedown),r.addEventListener("mouseup",this.mouseup),r.addEventListener("mousemove",this.mousemove),r.addEventListener("mouseover",this.mouseover),r.addEventListener("mouseout",this.mouseout),r.addEventListener("wheel",this.wheel),i(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"enable",this).call(this)}},{key:"disable",value:function(){if(!this.enabled)return this;var t=this.plot.getContainer();return t.removeEventListener("mousedown",this.mousedown),t.removeEventListener("mouseup",this.mouseup),t.removeEventListener("mousemove",this.mousemove),t.removeEventListener("mouseover",this.mouseover),t.removeEventListener("mouseout",this.mouseout),t.removeEventListener("wheel",this.wheel),this.mousedown=null,this.mouseup=null,this.mousemove=null,this.mouseover=null,this.mouseout=null,this.wheel=null,i(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"disable",this).call(this)}}]),e}();e.exports=l},{"../../event/EventType":141,"../../event/MouseEvent":142,"./DOMHandler":169}],171:[function(t,e,n){"use strict";var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),i=function t(e,n,r){null===e&&(e=Function.prototype);var i=Object.getOwnPropertyDescriptor(e,n);if(void 0===i){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,r)}if("value"in i)return i.value;var a=i.get;return void 0!==a?a.call(r):void 0};var o=t("lodash/defaultTo"),a=t("../animation/PanAnimation"),s=t("../../event/EventType"),u=t("../../event/Event"),l=t("./DOMHandler"),c=!0,f=.2,h=3400,p=function(t,e){t.isZooming()||(t.viewport.x+=e.x,t.viewport.y+=e.y,t.panRequest(),t.emit(s.PAN,new u(t)))},v=function(t){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var r=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return r.inertia=o(n.inertia,c),r.inertiaEasing=o(n.inertiaEasing,f),r.inertiaDeceleration=o(n.inertiaDeceleration,h),r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,l),r(e,[{key:"enable",value:function(){var t=this;if(this.enabled)return this;var n=this.plot,r=!1,o=null,l=null,c=[],f=[];return this.mousedown=function(e){t.isLeftButton(e)&&(r=!0,o=t.mouseToViewPx(e),l=Date.now(),t.inertia&&(n.panAnimation=null,c=[],f=[]))},this.mousemove=function(e){if(r){var i=t.mouseToViewPx(e),a=Date.now();0===c.length&&n.emit(s.PAN_START,new u(n)),t.inertia&&(c.push(i),f.push(a),a-f[0]>50&&(c.shift(),f.shift()));var h={x:o.x-i.x,y:o.y-i.y};p(n,t.viewPxToPlot(h)),l=a,o=i}},this.mouseup=function(e){if(r=!1,!n.isZooming()&&t.isLeftButton(e)&&0!==c.length)if(t.inertia){for(var i=Date.now();i-f[0]>50;)c.shift(),f.shift();if(f.length<2)n.emit(s.PAN_END,new u(n));else{var h=t.inertiaDeceleration,p=t.inertiaEasing,v=o.x-c[0].x,y=o.y-c[0].y,d=(l-f[0]||1)/1e3,b=v*(p/d),m=y*(p/d),g=Math.sqrt(b*b+m*m)/(h*p),_={x:Math.round(b*(-g/2)),y:Math.round(m*(-g/2))};n.panAnimation=new a({plot:n,start:n.getViewportPosition(),delta:t.viewPxToPlot(_),easing:p,duration:1e3*g})}}else n.emit(s.PAN_END,new u(n))},n.getContainer().addEventListener("mousedown",this.mousedown),document.addEventListener("mousemove",this.mousemove),document.addEventListener("mouseup",this.mouseup),i(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"enable",this).call(this)}},{key:"disable",value:function(){return this.enabled?(this.plot.getContainer().removeEventListener("mousedown",this.mousedown),document.removeEventListener("mousemove",this.mousemove),document.removeEventListener("mouseup",this.mouseup),this.mousedown=null,this.mousemove=null,this.mouseup=null,i(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"disable",this).call(this)):this}},{key:"panTo",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=this.plot,r=n.getViewportCenter(),i={x:t.x-r.x,y:t.y-r.y};e?(n.emit(s.PAN_START,new u(n)),n.panAnimation=new a({plot:n,start:n.getViewportPosition(),delta:i,easing:this.inertiaEasing,duration:800})):(n.emit(s.PAN_START,new u(n)),p(n,i),n.emit(s.PAN_END,new u(n)))}}]),e}();e.exports=v},{"../../event/Event":138,"../../event/EventType":141,"../animation/PanAnimation":166,"./DOMHandler":169,"lodash/defaultTo":109}],172:[function(t,e,n){"use strict";var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),i=function t(e,n,r){null===e&&(e=Function.prototype);var i=Object.getOwnPropertyDescriptor(e,n);if(void 0===i){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,r)}if("value"in i)return i.value;var a=i.get;return void 0!==a?a.call(r):void 0};var o=t("lodash/clamp"),a=t("lodash/defaultTo"),s=t("../../util/Browser"),u=t("../../event/EventType"),l=t("../../event/Event"),c=t("../animation/ZoomAnimation"),f=t("../Viewport"),h=t("./DOMHandler"),p=300,v=250,y=4,d=100,b=!1,m=Date.now(),g=function(t,e,n,r){var i,a,s,h,p,v,y=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],d=(i=n,a=t.zoom,s=t.zoomAnimation,h=t.minZoom,p=t.maxZoom,v=void 0,v=s?s.targetZoom+i:a+i,o(v,h,p)),b=t.viewport.zoomToPos(t.zoom,d,e,y),m=t.getTargetZoom(),g=t.getTargetViewport();d===m&&b.x===g.x&&b.y===g.y||(t.panAnimation=null,r>0&&(t.zoomAnimation=new c({plot:t,duration:r,prevZoom:t.zoom,targetZoom:d,prevViewport:new f(t.viewport.x,t.viewport.y,t.viewport.width,t.viewport.height),targetViewport:b,targetPos:e})),t.emit(u.ZOOM_START,new l(t)),0===r&&(t.zoom=d,t.viewport=b,t.emit(u.ZOOM_END,new l(t))),t.zoomRequest())},_=function(t,e,n,r,i){if(0!==r){var a,s,u,l,c,f,h,p,v,y=(a=r,s=i,u=t.deltaPerZoom,l=t.maxConcurrentZooms,c=a/u,s||(c=a>0?Math.ceil(c):Math.floor(c)),o(c,-l,l)),d=t.zoomDuration;i&&(f=e.zoomAnimation,h=r,p=Date.now(),v=p-m,m=p,h%4.000244140625!=0&&(Math.abs(h)<4||(!f||0===f.duration)&&v<40))&&(d=0),g(e,n,y,d)}},x=function(t){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var r=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return r.continuousZoom=a(n.continuousZoom,b),r.zoomDuration=a(n.zoomDuration,v),r.maxConcurrentZooms=a(n.maxConcurrentZooms,y),r.deltaPerZoom=a(n.deltaPerZoom,p),r.zoomDebounce=a(n.zoomDebounce,d),r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,h),r(e,[{key:"enable",value:function(){var t=this;if(this.enabled)return this;var n=this.plot,r=0,o=null,a=null;this.dblclick=function(e){var r=t.mouseToPlot(e);g(n,r,1,t.zoomDuration)},this.wheel=function(e){var i,u,l=(i=n,0===(u=e).deltaMode?s.firefox?-u.deltaY/i.pixelRatio:-u.deltaY:1===u.deltaMode?20*-u.deltaY:60*-u.deltaY);if(t.continuousZoom||!(Math.abs(l)<4)){if(r+=l,t.continuousZoom){var c=t.mouseToPlot(e);_(t,n,c,r,!0),r=0}else a=e,o||(o=setTimeout(function(){var e=t.mouseToPlot(a);_(t,n,e,r,!1),r=0,o=null,a=null},t.zoomDebounce));e.preventDefault(),e.stopPropagation()}};var u=n.getContainer();return u.addEventListener("dblclick",this.dblclick),u.addEventListener("wheel",this.wheel),i(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"enable",this).call(this)}},{key:"disable",value:function(){if(!this.enabled)return this;var t=this.plot.getContainer();return t.removeEventListener("dblclick",this.dblclick),t.removeEventListener("wheel",this.wheel),this.dblclick=null,this.wheel=null,i(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"disable",this).call(this)}},{key:"zoomTo",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=this.plot,r=this.plot.getViewportCenter(),i=t-n.zoom;g(n,r,i,e?this.zoomDuration:0)}},{key:"zoomToPosition",value:function(t,e){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=this.plot,i=t-r.zoom,o=n?this.zoomDuration:0;g(r,e,i,o,!1)}}]),e}();e.exports=x},{"../../event/Event":138,"../../event/EventType":141,"../../util/Browser":186,"../Viewport":164,"../animation/ZoomAnimation":167,"./DOMHandler":169,"lodash/clamp":107,"lodash/defaultTo":109}],173:[function(t,e,n){"use strict";var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var i=t("events"),o=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,i),r(e,[{key:"onAdd",value:function(t){return this}},{key:"onRemove",value:function(t){return this}},{key:"pick",value:function(t){return null}},{key:"clear",value:function(){return this}},{key:"draw",value:function(t){return this}}]),e}();e.exports=o},{events:2}],174:[function(t,e,n){"use strict";var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var i=t("../Renderer"),o=function(t){function e(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var t=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return t.overlay=null,t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,i),r(e,[{key:"onAdd",value:function(t){if(!t)throw"No overlay provided as argument";return this.overlay=t,this}},{key:"onRemove",value:function(t){if(!t)throw"No overlay provided as argument";return this.overlay=null,this}}]),e}();e.exports=o},{"../Renderer":173}],175:[function(t,e,n){"use strict";var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),i=function t(e,n,r){null===e&&(e=Function.prototype);var i=Object.getOwnPropertyDescriptor(e,n);if(void 0===i){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,r)}if("value"in i)return i.value;var a=i.get;return void 0!==a?a.call(r):void 0};var o=t("../../webgl/shader/Shader"),a=t("../../event/EventType"),s=t("./OverlayRenderer"),u=Symbol(),l=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.gl=null,n[u]=null,n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,s),r(e,[{key:"onAdd",value:function(t){var n=this;return i(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"onAdd",this).call(this,t),this.gl=this.overlay.plot.getRenderingContext(),this.refreshBuffers(),this[u]=function(){n.refreshBuffers()},this.overlay.on(a.REFRESH,this[u]),this}},{key:"onRemove",value:function(t){return this.overlay.removeListener(a.REFRESH,this[u]),this[u]=null,this.gl=null,i(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"onRemove",this).call(this,t),this}},{key:"refreshBuffers",value:function(){throw"`refreshBuffers` must be overridden"}},{key:"createShader",value:function(t){return new o(this.gl,t)}},{key:"getOrthoMatrix",value:function(){return this.overlay.plot.getOrthoMatrix()}}]),e}();e.exports=l},{"../../event/EventType":141,"../../webgl/shader/Shader":192,"./OverlayRenderer":174}],176:[function(t,e,n){"use strict";var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),i=function t(e,n,r){null===e&&(e=Function.prototype);var i=Object.getOwnPropertyDescriptor(e,n);if(void 0===i){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,r)}if("value"in i)return i.value;var a=i.get;return void 0!==a?a.call(r):void 0};var o=t("lodash/defaultTo"),a=t("../../../webgl/vertex/VertexBuffer"),s=t("../WebGLOverlayRenderer"),u={vert:"\n\t\tprecision highp float;\n\t\tattribute vec2 aPosition;\n\t\tattribute vec2 aNormal;\n\t\tuniform vec2 uViewOffset;\n\t\tuniform float uScale;\n\t\tuniform float uLineWidth;\n\t\tuniform float uPixelRatio;\n\t\tuniform float uPointRadius;\n\t\tuniform mat4 uProjectionMatrix;\n\t\tvoid main() {\n\t\t\tvec2 wPosition = (aPosition * uScale) - uViewOffset;\n\t\t\tgl_Position = uProjectionMatrix * vec4(wPosition, 0.0, 1.0);\n\t\t\tgl_PointSize = uPointRadius * 2.0 * uPixelRatio;\n\t\t}\n\t\t",frag:"\n\t\t#ifdef GL_OES_standard_derivatives\n\t\t\t#extension GL_OES_standard_derivatives : enable\n\t\t#endif\n\t\tprecision highp float;\n\t\tuniform vec4 uPointColor;\n\t\tuniform float uOpacity;\n\t\tvoid main() {\n\t\t\tvec2 cxy = 2.0 * gl_PointCoord - 1.0;\n\t\t\tfloat radius = dot(cxy, cxy);\n\t\t\tfloat alpha = 1.0;\n\t\t\t#ifdef GL_OES_standard_derivatives\n\t\t\t\tfloat delta = fwidth(radius);\n\t\t\t\talpha = 1.0 - smoothstep(1.0 - delta, 1.0 + delta, radius);\n\t\t\t#else\n\t\t\t\tif (radius > 1.0) {\n\t\t\t\t\tdiscard;\n\t\t\t\t}\n\t\t\t#endif\n\t\t\tgl_FragColor = vec4(uPointColor.rgb, uPointColor.a * alpha * uOpacity);\n\t\t}\n\t\t"},l=function(t,e){var n=function(t){for(var e=new Float32Array(2*t.length),n=0;n<t.length;n++){var r=t[n];e[2*n]=r.x,e[2*n+1]=r.y}return e}(e);return new a(t,n,{0:{size:2,type:"FLOAT"}},{mode:"POINTS",count:e.length})},c=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.pointColor=o(t.pointColor,[1,0,1,1]),n.pointRadius=o(t.pointRadius,4),n.shader=null,n.ext=null,n.points=null,n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,s),r(e,[{key:"onAdd",value:function(t){return i(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"onAdd",this).call(this,t),this.ext=this.gl.getExtension("OES_standard_derivatives"),this.shader=this.createShader(u),this}},{key:"onRemove",value:function(t){return this.shader=null,this.ext=null,this.points=null,i(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"onRemove",this).call(this,t),this}},{key:"refreshBuffers",value:function(){var t=this.overlay.getClippedGeometry();t&&t.length>0?this.points=l(this.gl,t):this.points=null}},{key:"draw",value:function(){if(!this.points)return this;var t=this.gl,e=this.shader,n=this.points,r=this.overlay.plot,i=r.cell,o=this.getOrthoMatrix(),a=Math.pow(2,r.zoom-i.zoom),s=this.overlay.opacity,u=i.project(r.viewport,r.zoom);return t.enable(t.BLEND),t.blendFunc(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA),e.use(),e.setUniform("uProjectionMatrix",o),e.setUniform("uViewOffset",[u.x,u.y]),e.setUniform("uScale",a),e.setUniform("uPointColor",this.pointColor),e.setUniform("uPointRadius",this.pointRadius),e.setUniform("uPixelRatio",r.pixelRatio),e.setUniform("uOpacity",s),n.bind(),n.draw(),this}}]),e}();e.exports=c},{"../../../webgl/vertex/VertexBuffer":199,"../WebGLOverlayRenderer":175,"lodash/defaultTo":109}],177:[function(t,e,n){"use strict";var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),i=function t(e,n,r){null===e&&(e=Function.prototype);var i=Object.getOwnPropertyDescriptor(e,n);if(void 0===i){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,r)}if("value"in i)return i.value;var a=i.get;return void 0!==a?a.call(r):void 0};var o=t("earcut"),a=t("lodash/defaultTo"),s=t("../../../webgl/vertex/VertexBuffer"),u=t("../../../webgl/vertex/IndexBuffer"),l=t("../WebGLOverlayRenderer"),c={vert:"\n\t\tprecision highp float;\n\t\tattribute vec2 aPosition;\n\t\tuniform vec2 uViewOffset;\n\t\tuniform float uScale;\n\t\tuniform mat4 uProjectionMatrix;\n\t\tvoid main() {\n\t\t\tvec2 wPosition = (aPosition * uScale) - uViewOffset;\n\t\t\tgl_Position = uProjectionMatrix * vec4(wPosition, 0.0, 1.0);\n\t\t}\n\t\t",frag:"\n\t\tprecision highp float;\n\t\tuniform vec4 uPolygonColor;\n\t\tuniform float uOpacity;\n\t\tvoid main() {\n\t\t\tgl_FragColor = vec4(uPolygonColor.rgb, uPolygonColor.a * uOpacity);\n\t\t}\n\t\t"},f=function(t,e){var n=function(t){for(var e=new Float32Array(2*t.length),n=0;n<t.length;n++)e[2*n]=t[n].x,e[2*n+1]=t[n].y;return e}(e),r=o(n),i=new s(t.gl,n,{0:{size:2,type:"FLOAT"}}),a=n.length<Math.pow(2,16);return{vertex:i,index:new u(t.gl,a?new Uint16Array(r):new Uint32Array(r),{mode:"TRIANGLES",type:a?"UNSIGNED_SHORT":"UNSIGNED_INT",count:r.length})}},h=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.polygonColor=a(t.polygonColor,[1,.4,.1,.8]),n.shader=null,n.polygons=null,n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,l),r(e,[{key:"onAdd",value:function(t){return i(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"onAdd",this).call(this,t),this.shader=this.createShader(c),this}},{key:"onRemove",value:function(t){return i(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"onRemove",this).call(this,t),this.shader=null,this}},{key:"refreshBuffers",value:function(){var t=this,e=this.overlay.getClippedGeometry();this.polygons=e?e.map(function(e){return f(t,e)}):null}},{key:"draw",value:function(){if(!this.polygons)return this;var t=this.gl,e=this.shader,n=this.polygons,r=this.overlay.plot,i=r.cell,o=this.getOrthoMatrix(),a=Math.pow(2,r.zoom-i.zoom),s=this.overlay.opacity,u=i.project(r.viewport,r.zoom);return t.enable(t.BLEND),t.blendFunc(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA),e.use(),e.setUniform("uProjectionMatrix",o),e.setUniform("uViewOffset",[u.x,u.y]),e.setUniform("uScale",a),e.setUniform("uPolygonColor",this.polygonColor),e.setUniform("uOpacity",s),n.forEach(function(t){t.vertex.bind(),t.index.draw()}),this}}]),e}();e.exports=h},{"../../../webgl/vertex/IndexBuffer":197,"../../../webgl/vertex/VertexBuffer":199,"../WebGLOverlayRenderer":175,earcut:1,"lodash/defaultTo":109}],178:[function(t,e,n){"use strict";var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),i=function t(e,n,r){null===e&&(e=Function.prototype);var i=Object.getOwnPropertyDescriptor(e,n);if(void 0===i){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,r)}if("value"in i)return i.value;var a=i.get;return void 0!==a?a.call(r):void 0};var o=t("lodash/defaultTo"),a=t("../../../webgl/vertex/VertexBuffer"),s=t("../WebGLOverlayRenderer"),u={vert:"\n\t\tprecision highp float;\n\t\tattribute vec2 aPosition;\n\t\tattribute vec2 aNormal;\n\t\tuniform vec2 uViewOffset;\n\t\tuniform float uScale;\n\t\tuniform float uLineWidth;\n\t\tuniform mat4 uProjectionMatrix;\n\t\tvoid main() {\n\t\t\tvec2 wPosition = (aPosition * uScale) - uViewOffset + aNormal * uLineWidth;\n\t\t\tgl_Position = uProjectionMatrix * vec4(wPosition, 0.0, 1.0);\n\t\t}\n\t\t",frag:"\n\t\tprecision highp float;\n\t\tuniform vec4 uLineColor;\n\t\tuniform float uOpacity;\n\t\tvoid main() {\n\t\t\tgl_FragColor = vec4(uLineColor.rgb, uLineColor.a * uOpacity);\n\t\t}\n\t\t"},l=1e-6,c=function(t,e){return{x:t.x*e,y:t.y*e}},f=function(t){return{x:-t.y,y:t.x}},h=function(t){return{x:-t.x,y:-t.y}},p=function(t){return Math.sqrt(t.x*t.x+t.y*t.y)},v=function(t){var e=Math.sqrt(t.x*t.x+t.y*t.y);return{x:t.x/e,y:t.y/e}},y=function(t,e){return{x:t.x+e.x,y:t.y+e.y}},d=function(t,e){return{x:t.x-e.x,y:t.y-e.y}},b=function(t,e){return c(y(t,e),.5)},m=function(t,e,n){return(e.x-t.x)*(n.y-t.y)-(n.x-t.x)*(e.y-t.y)},g=function(t,e,n,r,i,o){var a=Math.atan2(n.y-t.y,n.x-t.x),s=Math.atan2(e.y-t.y,e.x-t.x),u=a;s>a?s-a>=Math.PI-l&&(s-=2*Math.PI):a-s>=Math.PI-l&&(a-=2*Math.PI);var c=s-a;if(Math.abs(c)>=Math.PI-l&&Math.abs(c)<=Math.PI+l){var f=d(t,r);0===f.x?f.y>0&&(c=-c):f.x>=-l&&(c=-c)}for(var h=Math.ceil(16*Math.abs(c/Math.PI)),p=c/h,v={x:0,y:0},y=0;y<h;y++){var b={x:Math.cos(u+p*y),y:Math.sin(u+p*y)},m={x:Math.cos(u+p*(1+y)),y:Math.sin(u+p*(1+y))};i.push(t),i.push(t),i.push(t),o.push(v),o.push(b),o.push(m)}};function _(t,e,n,r,i,o){var a=d(e,t),s=d(n,e);a=f(a),s=f(s),m(t,e,n)>0&&(a=h(a),s=h(s)),a=v(a),s=v(s),a=c(a,o),s=c(s,o);var u=function(t,e,n,r){var i=e.y-t.y,o=t.x-e.x,a=r.y-n.y,s=n.x-r.x,u=i*s-a*o;if(u>-l&&u<l)return null;var c=i*t.x+o*t.y,f=a*n.x+s*n.y;return{x:(s*c-o*f)/u,y:(i*f-a*c)/u}}(y(a,t),y(a,e),y(s,n),y(s,e)),b=null,_=Number.MAX_VALUE,x=null;u&&(b=d(u,e),_=p(b),x=h(c(b,1/o)));var w=d(t,e),O=p(w),E=d(e,n),T=p(E),P=v(a),k=h(P),S=v(s),A=h(S);_>O||_>T?(r.push(t),r.push(t),r.push(e),i.push(P),i.push(k),i.push(P),r.push(t),r.push(e),r.push(e),i.push(k),i.push(P),i.push(k),g(e,y(e,a),y(e,s),n,r,i),r.push(n),r.push(e),r.push(e),i.push(S),i.push(A),i.push(S),r.push(n),r.push(e),r.push(n),i.push(S),i.push(A),i.push(A)):(r.push(t),r.push(t),r.push(e),i.push(P),i.push(k),i.push(x),r.push(t),r.push(e),r.push(e),i.push(P),i.push(x),i.push(P),r.push(e),r.push(e),r.push(e),i.push(P),i.push({x:0,y:0}),i.push(x),g(e,y(e,a),y(e,s),d(e,b),r,i),r.push(e),r.push(e),r.push(e),i.push({x:0,y:0}),i.push(S),i.push(x),r.push(n),r.push(e),r.push(e),i.push(S),i.push(x),i.push(S),r.push(n),r.push(e),r.push(n),i.push(S),i.push(x),i.push(A))}var x=function(t,e){var n=function(t,e){if(t.length<2)throw"A valid polyline must consist of at least 2 points";var n,r,i=e/2,o=[],a=[],s=[],u=!1;if(2===t.length)_(t[0],b(t[0],t[1]),t[1],o,a,i);else{if(n=t[0],r=t[t.length-1],n.x===r.x&&n.y===r.y){var l=b(t.shift(),t[0]);t.unshift(l),t.push(l),u=!0}for(var c=0;c<t.length-1;c++)0===c?s.push(t[0]):c===t.length-2?s.push(t[t.length-1]):s.push(b(t[c],t[c+1]));for(var h=1;h<s.length;h++)_(s[h-1],t[h],s[h],o,a,i)}if(!u){var p=t[0],v=t[1],m=f(d(v,p));g(p,y(p,m),d(p,m),v,o,a),p=t[t.length-1],v=t[t.length-2],m=f(d(v,p)),g(p,y(p,m),d(p,m),v,o,a)}return{positions:o,normals:a}}(e,t.lineWidth),r=function(t,e){for(var n=new Float32Array(4*t.length),r=0;r<t.length;r++){var i=t[r],o=e[r];n[4*r]=i.x,n[4*r+1]=i.y,n[4*r+2]=o.x,n[4*r+3]=o.y}return n}(n.positions,n.normals);return new a(t.gl,r,{0:{size:2,type:"FLOAT",byteOffset:0},1:{size:2,type:"FLOAT",byteOffset:8}},{mode:"TRIANGLES",count:n.positions.length})},w=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.lineColor=o(t.lineColor,[1,.4,.1,.8]),n.lineWidth=o(t.lineWidth,2),n.shader=null,n.lines=null,n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,s),r(e,[{key:"onAdd",value:function(t){return i(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"onAdd",this).call(this,t),this.shader=this.createShader(u),this}},{key:"onRemove",value:function(t){return i(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"onRemove",this).call(this,t),this.shader=null,this}},{key:"refreshBuffers",value:function(){var t=this,e=this.overlay.getClippedGeometry();this.lines=e?e.map(function(e){return x(t,e)}):null}},{key:"draw",value:function(){if(!this.lines)return this;var t=this.gl,e=this.shader,n=this.lines,r=this.overlay.plot,i=r.cell,o=this.getOrthoMatrix(),a=Math.pow(2,r.zoom-i.zoom),s=this.overlay.opacity,u=i.project(r.viewport,r.zoom);return t.enable(t.BLEND),t.blendFunc(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA),e.use(),e.setUniform("uProjectionMatrix",o),e.setUniform("uViewOffset",[u.x,u.y]),e.setUniform("uScale",a),e.setUniform("uLineWidth",this.lineWidth/2),e.setUniform("uLineColor",this.lineColor),e.setUniform("uOpacity",s),n.forEach(function(t){t.bind(),t.draw()}),this}}]),e}();e.exports=w},{"../../../webgl/vertex/VertexBuffer":199,"../WebGLOverlayRenderer":175,"lodash/defaultTo":109}],179:[function(t,e,n){"use strict";var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var i=function(t,e){var n=1/Math.pow(2,e.z-t.z);return[e.x*n-t.x,e.y*n-t.y,n,n]},o=function(){function t(e,n,r,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.tile=e,this.hash=e.coord.hash,this.scale=n,this.tileOffset=r,this.uvOffset=i}return r(t,[{key:"toCanvas",value:function(t,e){var n=this.uvOffset;n[1]=1-n[2]-n[1];var r=this.tileOffset;return r[1]=t.height-r[1]-e*this.scale,this}}],[{key:"fromTile",value:function(e,n,r,i,o){var a=r*i;return new t(e,r,[n.x*a-o.x,n.y*a-o.y],[0,0,1,1])}},{key:"fromAncestor",value:function(e,n,r,o,a,s,u){var l=r*o,c=[0,0];if(u===s)c[0]=n.x*l-a.x,c[1]=n.y*l-a.y;else{var f=1/Math.pow(2,u.z-s.z),h=u.x*f-s.x,p=u.y*f-s.y;c[0]=(n.x+h)*l-a.x,c[1]=(n.y+p)*l-a.y,r*=f}return new t(e,r,c,i(e.coord,u))}},{key:"fromDescendant",value:function(e,n,r,i,o,a){var s=r*i,u=1/Math.pow(2,e.coord.z-a.z),l=e.coord.x*u-a.x,c=e.coord.y*u-a.y;return new t(e,r*u,[(n.x+l)*s-o.x,(n.y+c)*s-o.y],[0,0,1,1])}},{key:"fromAncestorPartial",value:function(e,n,r,o,a){var s=e.tile,u=e.target,l=e.relative,c=r*o,f=[0,0];if(l===e.target)f[0]=n.x*c-a.x,f[1]=n.y*c-a.y;else{var h=1/Math.pow(2,l.z-u.z),p=l.x*h-u.x,v=l.y*h-u.y;f[0]=(n.x+p)*c-a.x,f[1]=(n.y+v)*c-a.y,r*=h}return new t(s,r,f,i(s.coord,l))}},{key:"fromDescendantPartial",value:function(e,n,r,i,o){var a=e.tile,s=e.target,u=r*i,l=1/Math.pow(2,a.coord.z-s.z),c=a.coord.x*l-s.x,f=a.coord.y*l-s.y;return new t(a,r*l,[(n.x+c)*u-o.x,(n.y+f)*u-o.y],[0,0,1,1])}}]),t}();e.exports=o},{}],180:[function(t,e,n){"use strict";var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var i=t("../../event/EventType"),o=t("../../geometry/RTreePyramid"),a=t("../Renderer"),s=t("./TileRenderable"),u=Symbol(),l=Symbol(),c=function(t){function e(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var t=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return t[u]=new Map,t[l]=new Map,t.layer=null,t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,a),r(e,[{key:"onAdd",value:function(t){if(!t)throw"No layer provided as argument";return this.layer=t,this}},{key:"onRemove",value:function(t){if(!t)throw"No layer provided as argument";return this.layer=null,this}},{key:"createRTreePyramid",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.createCollidables;if(!n)throw"`options.createCollidables` argument is missing";var r=new o({nodeCapacity:e.nodeCapacity}),a=function(e){var i=e.tile,o=i.coord,a=t.layer.plot.tileSize,s=o.x*a,u=o.y*a,l=n(i,s,u);r.insert(o,l)},s=function(t){r.remove(t.tile.coord)};return this.layer.on(i.TILE_ADD,a),this.layer.on(i.TILE_REMOVE,s),this[u].set(r,a),this[l].set(r,s),r}},{key:"destroyRTreePyramid",value:function(t){this.layer.removeListener(i.TILE_ADD,this[u].get(t)),this.layer.removeListener(i.TILE_REMOVE,this[l].get(t)),this[u].delete(t),this[l].delete(t)}},{key:"getRenderables",value:function(){for(var t=this.layer.plot,e=this.layer.pyramid,n=t.tileSize,r=t.zoom,i=t.getViewportPixelOffset(),o=t.getVisibleCoords(),a=[],u=0;u<o.length;u++){var l=o[u],c=l.normalize(),f=e.get(c);if(f){var h=Math.pow(2,r-l.z),p=s.fromTile(f,l,h,n,i);a.push(p)}}return a}},{key:"getRenderablesLOD",value:function(){for(var t=this.layer.plot,e=this.layer.pyramid,n=t.tileSize,r=t.zoom,i=t.getViewportPixelOffset(),o=t.getVisibleCoords(),a=[],u=0;u<o.length;u++){var l=o[u],c=l.normalize(),f=Math.pow(2,r-l.z),h=e.getAvailableLOD(c);if(h)for(var p=0;p<h.length;p++){var v=h[p],y=v.tile,d=void 0;d=y.coord.z===l.z?s.fromTile(y,l,f,n,i):y.coord.z<l.z?s.fromAncestorPartial(v,l,f,n,i):s.fromDescendantPartial(v,l,f,n,i),a.push(d)}}return a}}]),e}();e.exports=c},{"../../event/EventType":141,"../../geometry/RTreePyramid":149,"../Renderer":173,"./TileRenderable":179}],181:[function(t,e,n){"use strict";var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),i=function t(e,n,r){null===e&&(e=Function.prototype);var i=Object.getOwnPropertyDescriptor(e,n);if(void 0===i){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,r)}if("value"in i)return i.value;var a=i.get;return void 0!==a?a.call(r):void 0};var o=t("lodash/defaultTo"),a=t("../../event/EventType"),s=t("../../webgl/shader/Shader"),u=t("../../webgl/texture/TextureArray"),l=t("../../webgl/vertex/VertexAtlas"),c=t("./TileRenderer"),f=Symbol(),h=Symbol(),p=function(t,e){t.set(e.coord.hash,e.data)},v=function(t,e){t.delete(e.coord.hash)},y=function(t,e){t.set(e.coord.hash,e.data,e.data.length/t.stride)},d=function(t,e){t.delete(e.coord.hash)},b=function(t){function e(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var t=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return t.gl=null,t[f]=new Map,t[h]=new Map,t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,c),r(e,[{key:"onAdd",value:function(t){return i(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"onAdd",this).call(this,t),this.gl=this.layer.plot.getRenderingContext(),this}},{key:"onRemove",value:function(t){return this.gl=null,i(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"onRemove",this).call(this,t),this}},{key:"getOrthoMatrix",value:function(){return this.layer.plot.getOrthoMatrix()}},{key:"createShader",value:function(t){return new s(this.gl,t)}},{key:"createTextureArray",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=new u(this.gl,{format:t.format,type:t.type,filter:t.filter,invertY:t.invertY,premultiplyAlpha:t.premultiplyAlpha},{numChunks:this.layer.pyramid.getCapacity(),chunkSize:t.chunkSize}),n=o(t.onAdd,p),r=o(t.onRemove,v),i=function(t){n(e,t.tile)},s=function(t){r(e,t.tile)};return this.layer.on(a.TILE_ADD,i),this.layer.on(a.TILE_REMOVE,s),this[f].set(e,i),this[h].set(e,s),e}},{key:"destroyTextureArray",value:function(t){this.layer.removeListener(a.TILE_ADD,this[f].get(t)),this.layer.removeListener(a.TILE_REMOVE,this[h].get(t)),this[f].delete(t),this[h].delete(t)}},{key:"createVertexAtlas",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=new l(this.gl,t.attributePointers,{numChunks:this.layer.pyramid.getCapacity(),chunkSize:t.chunkSize}),n=o(t.onAdd,y),r=o(t.onRemove,d),i=function(t){n(e,t.tile)},s=function(t){r(e,t.tile)};return this.layer.on(a.TILE_ADD,i),this.layer.on(a.TILE_REMOVE,s),this[f].set(e,i),this[h].set(e,s),e}},{key:"destroyVertexAtlas",value:function(t){this.layer.removeListener(a.TILE_ADD,this[f].get(t)),this.layer.removeListener(a.TILE_REMOVE,this[h].get(t)),this[f].delete(t),this[h].delete(t)}}]),e}();e.exports=b},{"../../event/EventType":141,"../../webgl/shader/Shader":192,"../../webgl/texture/TextureArray":196,"../../webgl/vertex/VertexAtlas":198,"./TileRenderer":180,"lodash/defaultTo":109}],182:[function(t,e,n){"use strict";var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),i=function t(e,n,r){null===e&&(e=Function.prototype);var i=Object.getOwnPropertyDescriptor(e,n);if(void 0===i){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,r)}if("value"in i)return i.value;var a=i.get;return void 0!==a?a.call(r):void 0};var o=t("../../../webgl/vertex/VertexBuffer"),a=t("../WebGLTileRenderer"),s={vert:"\n\t\tprecision highp float;\n\t\tattribute vec2 aPosition;\n\t\tattribute vec2 aTextureCoord;\n\t\tuniform vec4 uTextureCoordOffset;\n\t\tuniform vec2 uTileOffset;\n\t\tuniform float uScale;\n\t\tuniform mat4 uProjectionMatrix;\n\t\tvarying vec2 vTextureCoord;\n\t\tvoid main() {\n\t\t\tvTextureCoord = vec2(\n\t\t\t\tuTextureCoordOffset.x + (aTextureCoord.x * uTextureCoordOffset.z),\n\t\t\t\tuTextureCoordOffset.y + (aTextureCoord.y * uTextureCoordOffset.w));\n\t\t\tvec2 wPosition = (aPosition * uScale) + uTileOffset;\n\t\t\tgl_Position = uProjectionMatrix * vec4(wPosition, 0.0, 1.0);\n\t\t}\n\t\t",frag:"\n\t\tprecision highp float;\n\t\tuniform sampler2D uTextureSampler;\n\t\tuniform float uOpacity;\n\t\tvarying vec2 vTextureCoord;\n\t\tvoid main() {\n\t\t\tvec4 color = texture2D(uTextureSampler, vec2(vTextureCoord.x, 1.0 - vTextureCoord.y));\n\t\t\tgl_FragColor = vec4(color.rgb, color.a * uOpacity);\n\t\t}\n\t\t"},u=function(t){function e(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var t=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return t.quad=null,t.shader=null,t.array=null,t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,a),r(e,[{key:"onAdd",value:function(t){var n,r,a,u;return i(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"onAdd",this).call(this,t),this.quad=(n=this.gl,r=0,a=t.plot.tileSize,(u=new Float32Array(24))[0]=r,u[1]=r,u[2]=a,u[3]=r,u[4]=a,u[5]=a,u[6]=r,u[7]=r,u[8]=a,u[9]=a,u[10]=r,u[11]=a,u[12]=0,u[13]=0,u[14]=1,u[15]=0,u[16]=1,u[17]=1,u[18]=0,u[19]=0,u[20]=1,u[21]=1,u[22]=0,u[23]=1,new o(n,u,{0:{size:2,type:"FLOAT",byteOffset:0},1:{size:2,type:"FLOAT",byteOffset:48}},{count:6})),this.shader=this.createShader(s),this.array=this.createTextureArray({chunkSize:t.plot.tileSize}),this}},{key:"onRemove",value:function(t){return this.destroyTextureArray(this.array),this.array=null,this.quad=null,this.shader=null,i(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"onRemove",this).call(this,t),this}},{key:"draw",value:function(){var t=this.gl,e=this.shader,n=this.array,r=this.quad,i=this.getRenderablesLOD(),o=this.getOrthoMatrix();e.use(),e.setUniform("uProjectionMatrix",o),e.setUniform("uTextureSampler",0),e.setUniform("uOpacity",this.layer.opacity),t.enable(t.BLEND),t.blendFunc(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA),r.bind();for(var a=0;a<i.length;a++){var s=i[a];n.bind(s.hash,0),e.setUniform("uTextureCoordOffset",s.uvOffset),e.setUniform("uScale",s.scale),e.setUniform("uTileOffset",s.tileOffset),r.draw()}return r.unbind(),this}}]),e}();e.exports=u},{"../../../webgl/vertex/VertexBuffer":199,"../WebGLTileRenderer":181}],183:[function(t,e,n){"use strict";var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),i=function t(e,n,r){null===e&&(e=Function.prototype);var i=Object.getOwnPropertyDescriptor(e,n);if(void 0===i){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,r)}if("value"in i)return i.value;var a=i.get;return void 0!==a?a.call(r):void 0};var o=t("lodash/defaultTo"),a=t("../../../webgl/vertex/VertexBuffer"),s=t("../WebGLTileRenderer"),u={vert:"\n\t\tprecision highp float;\n\t\tattribute vec2 aPosition;\n\t\tattribute vec2 aOffset;\n\t\tattribute float aRadius;\n\t\tuniform vec2 uTileOffset;\n\t\tuniform float uScale;\n\t\tuniform mat4 uProjectionMatrix;\n\t\tvoid main() {\n\t\t\tvec2 wPosition = (aPosition * aRadius) + (aOffset * uScale) + uTileOffset;\n\t\t\tgl_Position = uProjectionMatrix * vec4(wPosition, 0.0, 1.0);\n\t\t}\n\t\t",frag:"\n\t\tprecision highp float;\n\t\tuniform vec4 uColor;\n\t\tvoid main() {\n\t\t\tgl_FragColor = uColor;\n\t\t}\n\t\t"},l=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return n.color=o(t.color,[1,.4,.1,.8]),n.shape=null,n.shader=null,n.atlas=null,n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,s),r(e,[{key:"onAdd",value:function(t){return i(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"onAdd",this).call(this,t),this.shape=function(t){var e=2*Math.PI/5,n=e/2,r=e/4,i=new Float32Array(24);i[0]=0,i[1]=0;for(var o=0;o<5;o++){var s=o*e,u=.4*Math.cos(s-r),l=.4*Math.sin(s-r);i[4*o+2]=u,i[4*o+1+2]=l,u=1*Math.cos(s+n-r),l=1*Math.sin(s+n-r),i[4*o+2+2]=u,i[4*o+3+2]=l}return i[i.length-2]=i[2],i[i.length-1]=i[3],new a(t,i,{0:{size:2,type:"FLOAT"}},{mode:"TRIANGLE_FAN",count:i.length/2})}(this.gl),this.shader=this.createShader(u),this.atlas=this.createVertexAtlas({chunkSize:16384,attributePointers:{1:{size:2,type:"FLOAT"},2:{size:1,type:"FLOAT"}}}),this}},{key:"onRemove",value:function(t){return this.destroyVertexAtlas(this.atlas),this.atlas=null,this.shape=null,this.shader=null,i(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"onRemove",this).call(this,t),this}},{key:"draw",value:function(){var t=this.gl,e=this.shader,n=this.atlas,r=this.shape,i=this.getRenderables(),o=this.getOrthoMatrix();t.enable(t.BLEND),t.blendFunc(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA),e.use(),e.setUniform("uProjectionMatrix",o),e.setUniform("uColor",this.color),r.bind(),n.bindInstanced();for(var a=0;a<i.length;a++){var s=i[a];e.setUniform("uScale",s.scale),e.setUniform("uTileOffset",s.tileOffset),n.drawInstanced(s.hash,r.mode,r.count)}return n.unbindInstanced(),r.unbind(),this}}]),e}();e.exports=l},{"../../../webgl/vertex/VertexBuffer":199,"../WebGLTileRenderer":181,"lodash/defaultTo":109}],184:[function(t,e,n){"use strict";var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),i=function t(e,n,r){null===e&&(e=Function.prototype);var i=Object.getOwnPropertyDescriptor(e,n);if(void 0===i){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,r)}if("value"in i)return i.value;var a=i.get;return void 0!==a?a.call(r):void 0};var o=t("lodash/defaultTo"),a=t("../../../geometry/CircleCollidable"),s=t("../../../webgl/vertex/VertexBuffer"),u=t("../WebGLTileRenderer"),l={vert:"\n\t\tprecision highp float;\n\t\tattribute vec2 aPosition;\n\t\tattribute float aRadius;\n\t\tuniform float uRadiusOffset;\n\t\tuniform vec2 uTileOffset;\n\t\tuniform float uScale;\n\t\tuniform float uPixelRatio;\n\t\tuniform mat4 uProjectionMatrix;\n\t\tvoid main() {\n\t\t\tvec2 wPosition = (aPosition * uScale) + uTileOffset;\n\t\t\tgl_PointSize = (aRadius + uRadiusOffset) * uScale * 2.0 * uPixelRatio;\n\t\t\tgl_Position = uProjectionMatrix * vec4(wPosition, 0.0, 1.0);\n\t\t}\n\t\t",frag:"\n\t\t#ifdef GL_OES_standard_derivatives\n\t\t\t#extension GL_OES_standard_derivatives : enable\n\t\t#endif\n\t\tprecision highp float;\n\t\tuniform vec4 uColor;\n\t\tvoid main() {\n\t\t\tvec2 cxy = 2.0 * gl_PointCoord - 1.0;\n\t\t\tfloat radius = dot(cxy, cxy);\n\t\t\tfloat alpha = 1.0;\n\t\t\t#ifdef GL_OES_standard_derivatives\n\t\t\t\tfloat delta = fwidth(radius);\n\t\t\t\talpha = 1.0 - smoothstep(1.0 - delta, 1.0 + delta, radius);\n\t\t\t#else\n\t\t\t\tif (radius > 1.0) {\n\t\t\t\t\tdiscard;\n\t\t\t\t}\n\t\t\t#endif\n\t\t\tgl_FragColor = vec4(uColor.rgb, uColor.a * alpha);\n\t\t}\n\t\t"},c=function(t,e,n){for(var r=t.data,i=new Array(r.length/3),o=0;o<r.length;o+=3)i[o/3]=new a(r[o],r[o+1],r[o+2],e,n,t);return i},f=function(t,e,n,r,i,o){var a=r.tile.coord,s=Math.pow(2,n.zoom-a.z),u=n.getViewportPixelOffset(),l=[(a.x*n.tileSize+r.x)*s-u.x,(a.y*n.tileSize+r.y)*s-u.y];e.setUniform("uTileOffset",l),e.setUniform("uScale",s),e.setUniform("uColor",i),e.setUniform("uRadiusOffset",o+r.radius),t.bind(),t.draw(),t.unbind()},h=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return n.color=o(t.color,[1,.4,.1,.8]),n.shader=null,n.point=null,n.tree=null,n.atlas=null,n.ext=null,n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,u),r(e,[{key:"onAdd",value:function(t){var n,r;return i(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"onAdd",this).call(this,t),this.ext=this.gl.getExtension("OES_standard_derivatives"),this.point=(n=this.gl,(r=new Float32Array(2))[0]=0,r[1]=0,new s(n,r,{0:{size:2,type:"FLOAT"}},{mode:"POINTS",count:1})),this.shader=this.createShader(l),this.tree=this.createRTreePyramid({nodeCapacity:32,createCollidables:c}),this.atlas=this.createVertexAtlas({chunkSize:16384,attributePointers:{0:{size:2,type:"FLOAT"},1:{size:1,type:"FLOAT"}}}),this}},{key:"onRemove",value:function(t){return this.destroyVertexAtlas(this.atlas),this.destroyRTreePyramid(this.tree),this.atlas=null,this.shader=null,this.point=null,this.tree=null,this.ext=null,i(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"onRemove",this).call(this,t),this}},{key:"pick",value:function(t){return this.layer.plot.isZooming()?null:this.tree.searchPoint(t.x,t.y,this.layer.plot.zoom,this.layer.plot.getPixelExtent())}},{key:"draw",value:function(){var t=this,e=this.gl,n=this.layer,r=n.plot,i=this.getOrthoMatrix(),o=this.shader;r.renderBuffer.bind(),r.renderBuffer.clear(),e.enable(e.BLEND),e.blendFunc(e.SRC_ALPHA,e.ONE),o.use(),o.setUniform("uProjectionMatrix",i),o.setUniform("uPixelRatio",r.pixelRatio),function(t,e,n,r){e.setUniform("uColor",r),e.setUniform("uRadiusOffset",0),t.bind();for(var i=0;i<n.length;i++){var o=n[i];e.setUniform("uScale",o.scale),e.setUniform("uTileOffset",o.tileOffset),t.draw(o.hash,"POINTS")}t.unbind()}(this.atlas,o,this.getRenderables(),this.color),n.getSelected().forEach(function(e){f(t.point,o,r,e,t.color,4)});var a=n.getHighlighted();return a&&!n.isSelected(a)&&f(this.point,o,r,a,this.color,2),r.renderBuffer.unbind(),r.renderBuffer.blitToScreen(this.layer.opacity),this}}]),e}();e.exports=h},{"../../../geometry/CircleCollidable":147,"../../../webgl/vertex/VertexBuffer":199,"../WebGLTileRenderer":181,"lodash/defaultTo":109}],185:[function(t,e,n){"use strict";var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),i=function t(e,n,r){null===e&&(e=Function.prototype);var i=Object.getOwnPropertyDescriptor(e,n);if(void 0===i){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,r)}if("value"in i)return i.value;var a=i.get;return void 0!==a?a.call(r):void 0};var o=t("lodash/defaultTo"),a=t("../WebGLTileRenderer"),s={vert:"\n\t\tprecision highp float;\n\t\tattribute vec2 aPosition;\n\t\tattribute float aRadius;\n\t\tuniform vec2 uTileOffset;\n\t\tuniform float uScale;\n\t\tuniform float uPixelRatio;\n\t\tuniform mat4 uProjectionMatrix;\n\t\tvoid main() {\n\t\t\tvec2 wPosition = (aPosition * uScale) + uTileOffset;\n\t\t\tgl_PointSize = aRadius * 2.0 * uPixelRatio;\n\t\t\tgl_Position = uProjectionMatrix * vec4(wPosition, 0.0, 1.0);\n\t\t}\n\t\t",frag:"\n\t\t#ifdef GL_OES_standard_derivatives\n\t\t\t#extension GL_OES_standard_derivatives : enable\n\t\t#endif\n\t\tprecision highp float;\n\t\tuniform vec4 uColor;\n\t\tvoid main() {\n\t\t\tvec2 cxy = 2.0 * gl_PointCoord - 1.0;\n\t\t\tfloat radius = dot(cxy, cxy);\n\t\t\tfloat alpha = 1.0;\n\t\t\t#ifdef GL_OES_standard_derivatives\n\t\t\t\tfloat delta = fwidth(radius);\n\t\t\t\talpha = 1.0 - smoothstep(1.0 - delta, 1.0 + delta, radius);\n\t\t\t#else\n\t\t\t\tif (radius > 1.0) {\n\t\t\t\t\tdiscard;\n\t\t\t\t}\n\t\t\t#endif\n\t\t\tgl_FragColor = vec4(uColor.rgb, uColor.a * alpha);\n\t\t}\n\t\t"},u=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return n.color=o(t.color,[1,.4,.1,.8]),n.shader=null,n.atlas=null,n.ext=null,n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,a),r(e,[{key:"onAdd",value:function(t){return i(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"onAdd",this).call(this,t),this.ext=this.gl.getExtension("OES_standard_derivatives"),this.shader=this.createShader(s),this.atlas=this.createVertexAtlas({chunkSize:16384,attributePointers:{0:{size:2,type:"FLOAT"},1:{size:1,type:"FLOAT"}}}),this}},{key:"onRemove",value:function(t){return this.destroyVertexAtlas(this.atlas),this.atlas=null,this.shader=null,this.ext=null,i(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"onRemove",this).call(this,t),this}},{key:"draw",value:function(){var t=this.gl,e=this.shader,n=this.atlas,r=this.layer.plot,i=this.getRenderables(),o=this.getOrthoMatrix();r.renderBuffer.bind(),r.renderBuffer.clear(),t.enable(t.BLEND),t.blendFunc(t.SRC_ALPHA,t.ONE),e.use(),e.setUniform("uProjectionMatrix",o),e.setUniform("uColor",this.color),e.setUniform("uPixelRatio",r.pixelRatio),n.bind();for(var a=0;a<i.length;a++){var s=i[a];e.setUniform("uScale",s.scale),e.setUniform("uTileOffset",s.tileOffset),n.draw(s.hash,"POINTS")}return n.unbind(),r.renderBuffer.unbind(),r.renderBuffer.blitToScreen(this.layer.opacity),this}}]),e}();e.exports=u},{"../WebGLTileRenderer":181,"lodash/defaultTo":109}],186:[function(t,e,n){"use strict";var r=(navigator&&navigator.userAgent||"").toLowerCase(),i=(navigator&&navigator.vendor||"").toLowerCase();e.exports={firefox:!!r.match(/(?:firefox|fxios)\/(\d+)/),chrome:!(!/google inc/.test(i)||!r.match(/(?:chrome|crios)\/(\d+)/)),ie:!!r.match(/(?:msie |trident.+?; rv:)(\d+)/),edge:!!r.match(/edge\/(\d+)/),opera:!!r.match(/(?:^opera.+?version|opr)\/(\d+)/),safari:!!r.match(/version\/(\d+).+?safari/)}},{}],187:[function(t,e,n){"use strict";var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var o=t("lodash/defaultTo"),a=t("./LinkedList"),s=Symbol(),u=Symbol(),l=Symbol(),c=Symbol(),f=Symbol(),h=function(t,e){if(e){var n=e.value;t[u]&&t[u](n.value,n.key),t[f]--,t[l].delete(n.key),t[c].removeNode(e)}},p=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,t),this[s]=o(Math.max(1,e.capacity),256),this[u]=o(e.onRemove,null),this.clear()}return r(t,[{key:"getCapacity",value:function(){return this[s]}},{key:"getLength",value:function(){return this[f]}},{key:"forEach",value:function(t){for(var e=this[c].head;null!==e;){var n=e.next;t(e.value.value,e.value.key),e=n}}},{key:"clear",value:function(){var t=this;this[u]&&this[c]&&this[c].forEach(function(e){t[u](e.value,e.key)}),this[l]=new Map,this[c]=new a,this[f]=0}},{key:"set",value:function(t,e){if(this[l].has(t)){var n=this[l].get(t).value;return this[u]&&this[u](n.value,t),n.value=e,void this.get(t)}var r=new v(t,e);this[f]++,this[c].unshift(r),this[l].set(t,this[c].head),this[f]>this[s]&&h(this,this[c].tail)}},{key:"has",value:function(t){return!!this[l].has(t)}},{key:"get",value:function(t){var e=this[l].get(t);if(e)return this[c].unshiftNode(e),e.value.value}},{key:"peek",value:function(t){var e=this[l].get(t);if(e)return e.value.value}},{key:"delete",value:function(t){h(this,this[l].get(t))}}]),t}(),v=function t(e,n){i(this,t),this.key=e,this.value=n};e.exports=p},{"./LinkedList":188,"lodash/defaultTo":109}],188:[function(t,e,n){"use strict";var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var o=function(){function t(){i(this,t),this.tail=null,this.head=null,this.length=0}return r(t,[{key:"push",value:function(t){return this.tail=new a(t,this.tail,null,this),this.head||(this.head=this.tail),this.length++,this.length}},{key:"unshift",value:function(t){return this.head=new a(t,null,this.head,this),this.tail||(this.tail=this.head),this.length++,this.length}},{key:"pop",value:function(){if(this.tail){var t=this.tail.value;return this.tail=this.tail.prev,this.tail?this.tail.next=null:this.head=null,this.length--,t}}},{key:"shift",value:function(){if(this.head){var t=this.head.value;return this.head=this.head.next,this.head?this.head.prev=null:this.tail=null,this.length--,t}}},{key:"get",value:function(t){var e=void 0,n=void 0;for(e=0,n=this.head;null!==n&&e<t;e++)n=n.next;if(e===t&&null!==n)return n.value}},{key:"forEach",value:function(t){for(var e=this.head,n=0;null!==e;n++)t(e.value,n),e=e.next}},{key:"map",value:function(t){for(var e=new Array(this.length),n=0,r=this.head;null!==r;n++)e[n]=t(r.value,n),r=r.next;return e}},{key:"pushNode",value:function(t){if(t!==this.tail){t.list&&t.list.removeNode(t);var e=this.tail;return t.list=this,t.prev=e,e&&(e.next=t),this.tail=t,this.head||(this.head=t),this.length++,this.length}}},{key:"unshiftNode",value:function(t){if(t!==this.head){t.list&&t.list.removeNode(t);var e=this.head;return t.list=this,t.next=e,e&&(e.prev=t),this.head=t,this.tail||(this.tail=t),this.length++,this.length}}},{key:"removeNode",value:function(t){if(t.list!==this)throw"Removing node which does not belong to this list";var e=t.next,n=t.prev;return e&&(e.prev=n),n&&(n.next=e),t===this.head&&(this.head=e),t===this.tail&&(this.tail=n),t.list.length--,t.next=null,t.prev=null,t.list=null,this.length}}]),t}(),a=function t(e,n,r,o){i(this,t),this.list=o,this.value=e,n?(n.next=this,this.prev=n):this.prev=null,r?(r.prev=this,this.next=r):this.next=null};e.exports=o},{}],189:[function(t,e,n){"use strict";e.exports=function(t,e){var n=new XMLHttpRequest;n.open("GET",t,!0),n.responseType="arraybuffer",n.onload=function(){var t=n.response;if(t)e(null,t);else{var r="Unable to load ArrayBuffer from URL: `"+event.path[0].currentSrc+"`";e(r,null)}},n.onerror=function(t){var n="Unable to load ArrayBuffer from URL: `"+t.path[0].currentSrc+"`";e(n,null)},n.withCredentials=!0,n.send(null)}},{}],190:[function(t,e,n){"use strict";e.exports=function(t,e){var n=new Image;n.onload=function(){e(null,n)},n.onerror=function(t){var n="Unable to load image from URL: `"+t.path[0].currentSrc+"`";e(n,null)},n.crossOrigin="anonymous",n.src=t}},{}],191:[function(t,e,n){"use strict";var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var i=t("./texture/Texture"),o=t("./shader/Shader"),a=t("./vertex/VertexBuffer"),s={vert:"\n\t\tprecision highp float;\n\t\tattribute vec3 aVertexPosition;\n\t\tattribute vec2 aTextureCoord;\n\t\tvarying vec2 vTextureCoord;\n\t\tvoid main(void) {\n\t\t\tvTextureCoord = aTextureCoord;\n\t\t\tgl_Position = vec4(aVertexPosition, 1.0);\n\t\t}\n\t\t",frag:"\n\t\tprecision highp float;\n\t\tuniform float uOpacity;\n\t\tuniform sampler2D uTextureSampler;\n\t\tvarying vec2 vTextureCoord;\n\t\tvoid main(void) {\n\t\t\tvec4 color = texture2D(uTextureSampler, vTextureCoord);\n\t\t\tgl_FragColor = vec4(color.rgb, color.a * uOpacity);\n\t\t}\n\t\t"},u=function(t,e,n){var r=new Float32Array(24);return r[0]=e,r[1]=e,r[2]=n,r[3]=e,r[4]=n,r[5]=n,r[6]=e,r[7]=e,r[8]=n,r[9]=n,r[10]=e,r[11]=n,r[12]=0,r[13]=0,r[14]=1,r[15]=0,r[16]=1,r[17]=1,r[18]=0,r[19]=0,r[20]=1,r[21]=1,r[22]=0,r[23]=1,new a(t,r,{0:{size:2,type:"FLOAT",byteOffset:0},1:{size:2,type:"FLOAT",byteOffset:48}},{count:6})},l=function(t,e,n,r){t.bindFramebuffer(t.FRAMEBUFFER,e),t.framebufferTexture2D(t.FRAMEBUFFER,t["COLOR_ATTACHMENT"+r],t.TEXTURE_2D,n.texture,0),t.bindFramebuffer(t.FRAMEBUFFER,null)},c=function(){function t(e,n,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.gl=e,this.framebuffer=e.createFramebuffer(),this.shader=new o(e,s),this.quad=u(e,-1,1),this.texture=new i(e,null,{width:n,height:r,filter:"NEAREST",invertY:!1,premultiplyAlpha:!1}),l(this.gl,this.framebuffer,this.texture,0)}return r(t,[{key:"bind",value:function(){var t=this.gl;return t.bindFramebuffer(t.FRAMEBUFFER,this.framebuffer),this}},{key:"unbind",value:function(){var t=this.gl;return t.bindFramebuffer(t.FRAMEBUFFER,null),this}},{key:"clear",value:function(){return this.gl.clearColor(0,0,0,0),this.gl.clear(this.gl.COLOR_BUFFER_BIT),this}},{key:"blitToScreen",value:function(t){var e,n,r,i,o;return e=this.gl,n=this.texture,r=this.shader,i=this.quad,o=t,r.use(),e.enable(e.BLEND),e.blendFunc(e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA),r.setUniform("uOpacity",o),r.setUniform("uTextureSampler",0),n.bind(0),i.bind(),i.draw(),i.unbind(),this}},{key:"resize",value:function(t,e){return this.texture.resize(t,e),this}}]),t}();e.exports=c},{"./shader/Shader":192,"./texture/Texture":195,"./vertex/VertexBuffer":199}],192:[function(t,e,n){"use strict";var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var i=t("lodash/map"),o=t("./parseShader"),a={bool:"uniform1i","bool[]":"uniform1iv",float:"uniform1f","float[]":"uniform1fv",int:"uniform1i","int[]":"uniform1iv",uint:"uniform1i","uint[]":"uniform1iv",vec2:"uniform2fv","vec2[]":"uniform2fv",ivec2:"uniform2iv","ivec2[]":"uniform2iv",vec3:"uniform3fv","vec3[]":"uniform3fv",ivec3:"uniform3iv","ivec3[]":"uniform3iv",vec4:"uniform4fv","vec4[]":"uniform4fv",ivec4:"uniform4iv","ivec4[]":"uniform4iv",mat2:"uniformMatrix2fv","mat2[]":"uniformMatrix2fv",mat3:"uniformMatrix3fv","mat3[]":"uniformMatrix3fv",mat4:"uniformMatrix4fv","mat4[]":"uniformMatrix4fv",sampler2D:"uniform1i",samplerCube:"uniform1i"},s=function(t,e,n){var r=t.createShader(t[n]);if(t.shaderSource(r,e),t.compileShader(r),!t.getShaderParameter(r,t.COMPILE_STATUS)){var i=e.split("\n"),o=i.length.toString().length+1,a=i.map(function(t,e){return function(t,e){var n=e-(t=t.toString()).length;t+=":";for(var r=0;r<n;r++)t+=" ";return t}(e+1,o)+" "+t}).join("\n"),s=t.getShaderInfoLog(r);throw"An error occurred compiling the shader:\n\n"+s.slice(0,s.length-1)+"\n"+a}return r},u=function(t,e){var n,r,u,l,c,f,h,p=t.gl,v=(n=e.define,i(n,function(t,e){return"#define "+e+" "+t}).join("\n"))+(e.common||""),y=v+e.vert,d=v+e.frag,b=s(p,y,"VERTEX_SHADER"),m=s(p,d,"FRAGMENT_SHADER");if(r=t,o([y,d],["uniform","attribute"]).forEach(function(t){if("attribute"===t.qualifier)r.attributes.set(t.name,{type:t.type,index:r.attributes.size});else{var e=t.type+(t.count>1?"[]":"");r.uniforms.set(t.name,{type:t.type,func:a[e]})}}),t.program=p.createProgram(),p.attachShader(t.program,b),p.attachShader(t.program,m),l=(u=t).gl,u.attributes.forEach(function(t,e){l.bindAttribLocation(u.program,t.index,e)}),p.linkProgram(t.program),!p.getProgramParameter(t.program,p.LINK_STATUS))throw"An error occured linking the shader:\n"+p.getProgramInfoLog(t.program);f=(c=t).gl,(h=c.uniforms).forEach(function(t,e){var n=f.getUniformLocation(c.program,e);null===n?h.delete(e):t.location=n})},l=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),!n.vert)throw"Vertex shader argument `vert` has not been provided";if(!n.frag)throw"Fragment shader argument `frag` has not been provided";this.gl=e,this.program=null,this.attributes=new Map,this.uniforms=new Map,u(this,n)}return r(t,[{key:"use",value:function(){return this.gl.useProgram(this.program),this}},{key:"setUniform",value:function(t,e){var n=this.uniforms.get(t);if(!n)throw"No uniform found under name `"+t+"`";if(void 0===e||null===e)throw"Value passed for uniform `"+t+"` is undefined or null";return"mat2"===n.type||"mat3"===n.type||"mat4"===n.type?this.gl[n.func](n.location,!1,e):this.gl[n.func](n.location,e),this}}]),t}();e.exports=l},{"./parseShader":193,"lodash/map":127}],193:[function(t,e,n){"use strict";var r=t("./preprocess"),i=/(\/\*([\s\S]*?)\*\/)|(\/\/(.*)$)/gm,o=/(\r\n|\n|\r)/gm,a=/\s{2,}/g,s=/(\s*)(\[)(\s*)(\d+)(\s*)(\])(\s*)/g,u=/([a-zA-Z_][a-zA-Z0-9_]*)(?:\s*\[\s*(\d+)\s*\])?/,l=/\bprecision\s+\w+\s+\w+;/g,c=/\b(highp|mediump|lowp)\s+/g,f=function(t){var e=t.split(",").map(function(t){return t.trim()}),n=e.shift().split(" "),r=n.shift(),i=n.shift();return n.concat(e).map(function(t){return e=r,n=i,o=t.match(u),{qualifier:e,type:n,name:o[1],count:void 0===o[2]?1:parseInt(o[2],10)};var e,n,o})};e.exports=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(0===t.length||0===e.length)return[];t=Array.isArray(t)?t:[t],e=Array.isArray(e)?e:[e];var n,u=[];return t.forEach(function(t){var n,h,p,v,y;t=t.replace(i,""),t=r(t),t=t.replace(l,"").replace(c,""),t=t.replace(o," ").replace(a," ").replace(s,"$2$4$6"),u=u.concat((n=e,h=t.split(";"),p=n.join("|"),v=new RegExp("\\b("+p+")\\b.*"),y=[],h.forEach(function(t){var e=t.match(v);e&&(y=y.concat(f(e[0])))}),y))}),n={},u.filter(function(t){return!n[t.name]&&(n[t.name]=!0,!0)})}},{"./preprocess":194}],194:[function(t,e,n){"use strict";var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var o="__DEFINED__",a=/#define\b/i,s=/#undef\b/i,u=/#if\b/i,l=/#ifdef\b/i,c=/#ifndef\b/i,f=/#else\b/i,h=/#elif\b/i,p=/#endif\b/i,v=/#define\s+(\w+)(\s(\w*)?)?/i,y=/#undef\s+(\w+)/i,d=/#if\s+\(?\s*(!?\s*\w+)\s*(==|!=|>=|<=|<|>)?\s*(\w*)\s*\)?/i,b=/#ifdef\s+(\w+)/i,m=/#ifndef\s+(\w+)/i,g=/#elif\s+\(?\s*(!?\s*\w+)\s*(==|!=|>=|<=|<|>)?\s*(\w*)\s*\)?/i,_=/#([\W\w\s\d])(?:.*\\r?\n)*.*$/gm,x=function(t,e,n){if(void 0===e)return"!"===t[0]?!("true"===t||t>=1):"true"===t||t>=1;switch(e){case"==":return t===n;case"!=":return t!==n;case">":return t>n;case">=":return t>=n;case"<":return t<n;case"<=":return t<=n}throw"Unrecognized logical operator `"+e+"`"},w=function(){function t(e,n){i(this,t),this.type=e,this.conditional=n.trim(),this.body=[],this.children=[]}return r(t,[{key:"eval",value:function(){var t=void 0;switch(this.type){case"if":return t=d.exec(this.conditional),x(t[1],t[2],t[3]);case"ifdef":return(t=b.exec(this.conditional))[1]===o;case"ifndef":return(t=m.exec(this.conditional))[1]!==o;case"elif":return t=g.exec(this.conditional),x(t[1],t[2],t[3])}throw"Unrecognized conditional type `"+this.type+"`"}}]),t}(),O=function(){function t(e,n,r){i(this,t),this.if=new w(e,n),this.elif=[],this.else=null,this.parent=null,this.current=this.if,this.startLine=r,this.endLine=null}return r(t,[{key:"addElse",value:function(t){this.current=new w("else",t),this.else=this.current}},{key:"addElif",value:function(t){this.current=new w("elif",t),this.elif.push(this.current)}},{key:"addBody",value:function(t,e){this.current.body.push({string:t.trim(),line:e})}},{key:"nest",value:function(t){t.parent=this,this.current.children.push(t)}},{key:"extract",value:function(){var t=[];if(this.if.eval())return t=t.concat(this.if.body),this.if.children.forEach(function(e){t=t.concat(e.extract())}),t;for(var e=0;e<this.elif.length;e++){var n=this.elif[e];if(n.eval()){t=t.concat(n.body);for(var r=0;r<n.children.length;r++){var i=n.children[r];t=t.concat(i.extract())}return t}}return this.else?(t=t.concat(this.else.body),this.else.children.forEach(function(e){t=t.concat(e.extract())}),t):[]}},{key:"eval",value:function(){return this.extract().sort(function(t,e){return t.line-e.line}).map(function(t){return t.string}).join("\n")}}]),t}();e.exports=function(t){var e,n,r,i=t.split("\n");e=i,n=new Map,r=[],e.forEach(function(t){if(t.match(a)){var e=v.exec(t);n.set(e[1],e[2]||o)}else if(t.match(s)){var i=y.exec(t);n.delete(i[1])}else if(t.match(l)){var u=b.exec(t);n.has(u[1])&&(t=t.replace(u[1],o)),r.push(t)}else if(t.match(c)){var f=m.exec(t);n.has(f[1])&&(t=t.replace(f[1],o)),r.push(t)}else n.forEach(function(e,n){t=t.replace(n,e)}),r.push(t)});for(var d=function(t){var e=[],n=null;if(t.forEach(function(t,r){if(t.match(u)){var i=new O("if",t,r);n?n.nest(i):e.push(i),n=i}else if(t.match(l)){var o=new O("ifdef",t,r);n?n.nest(o):e.push(o),n=o}else if(t.match(c)){var a=new O("ifndef",t,r);n?n.nest(a):e.push(a),n=a}else if(t.match(h)){if(!n)throw"Invalid preprocessor syntax, unexpected `#elif`";n.addElif(t)}else if(t.match(f)){if(!n)throw"Invalid preprocessor syntax, unexpected `#else`";n.addElse(t)}else if(t.match(p)){if(!n)throw"Invalid preprocessor syntax, unexpected `#endif`";n.endLine=r,n=n.parent}else n&&n.addBody(t,r)}),n)throw"Invalid preprocessor syntax, missing expected `#endif`";return e}(i=r),g=d.length-1;g>=0;g--){var x=d[g],w=x.eval();w.length>0?i.splice(x.startLine,x.endLine-x.startLine+1,w):i.splice(x.startLine,x.endLine-x.startLine+1)}return i.join("\n").replace(_,"")}},{}],195:[function(t,e,n){"use strict";var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var i=t("lodash/defaultTo"),o=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.gl=e,this.texture=e.createTexture(),this.format=i(r.format,"RGBA"),this.type=i(r.type,"UNSIGNED_BYTE"),this.filter=i(r.filter,"LINEAR"),this.wrap=i(r.wrap,"CLAMP_TO_EDGE"),this.invertY=i(r.invertY,!1),this.premultiplyAlpha=i(r.premultiplyAlpha,!1),this.bufferData(n,r.width,r.height),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e[this.wrap]),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e[this.wrap]),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e[this.filter]),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e[this.filter])}return r(t,[{key:"bind",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=this.gl;return e.activeTexture(e["TEXTURE"+t]),e.bindTexture(e.TEXTURE_2D,this.texture),this}},{key:"unbind",value:function(){var t=this.gl;return t.bindTexture(t.TEXTURE_2D,null),this}},{key:"bufferData",value:function(t,e,n){var r=this.gl;return r.bindTexture(r.TEXTURE_2D,this.texture),r.pixelStorei(r.UNPACK_FLIP_Y_WEBGL,this.invertY),r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,this.premultiplyAlpha),t&&t.width&&t.height?(this.width=t.width,this.height=t.height,r.texImage2D(r.TEXTURE_2D,0,r[this.format],r[this.format],r[this.type],t)):(this.width=e||this.width,this.height=n||this.height,r.texImage2D(r.TEXTURE_2D,0,r[this.format],this.width,this.height,0,r[this.format],r[this.type],t)),this}},{key:"bufferSubData",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:void 0,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:void 0,o=this.gl;return o.bindTexture(o.TEXTURE_2D,this.texture),o.pixelStorei(o.UNPACK_FLIP_Y_WEBGL,this.invertY),o.pixelStorei(o.UNPACK_PREMULTIPLY_ALPHA_WEBGL,this.premultiplyAlpha),t.width&&t.height?o.texSubImage2D(o.TEXTURE_2D,0,e,n,o[this.format],o[this.type],t):o.texSubImage2D(o.TEXTURE_2D,0,e,n,r,i,o[this.format],o[this.type],t),this}},{key:"resize",value:function(t,e){return this.bufferData(null,t,e),this}}]),t}();e.exports=o},{"lodash/defaultTo":109}],196:[function(t,e,n){"use strict";var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var i=t("lodash/defaultTo"),o=function(t,e,n,r,i,o,a,s){var u=t.createTexture();return t.bindTexture(t.TEXTURE_2D,u),t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,a),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,s),t.texImage2D(t.TEXTURE_2D,0,t[e],n,n,0,t[e],t[r],null),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t[o]),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t[o]),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t[i]),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t[i]),u},a=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.gl=e,this.chunkSize=i(r.chunkSize,256),this.numChunks=i(r.numChunks,256),this.format=i(n.format,"RGBA"),this.type=i(n.type,"UNSIGNED_BYTE"),this.filter=i(n.filter,"LINEAR"),this.wrap=i(n.wrap,"CLAMP_TO_EDGE"),this.invertY=i(n.invertY,!1),this.premultiplyAlpha=i(n.premultiplyAlpha,!1),this.available=new Array(this.numChunks);for(var a=0;a<this.numChunks;a++)this.available[a]={texture:o(this.gl,this.format,this.chunkSize,this.type,this.filter,this.wrap,this.invertY,this.premultiplyAlpha)};this.used=new Map}return r(t,[{key:"has",value:function(t){return this.used.has(t)}},{key:"get",value:function(t){return this.used.get(t)}},{key:"set",value:function(t,e){if(this.has(t))throw"Tile of coord "+t+" already exists in the array";if(0===this.available.length)throw"No available texture chunks in array";var n=this.available.pop(),r=this.gl;r.bindTexture(r.TEXTURE_2D,n.texture),r.pixelStorei(r.UNPACK_FLIP_Y_WEBGL,this.invertY),r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,this.premultiplyAlpha),e.width&&e.height?r.texImage2D(r.TEXTURE_2D,0,r[this.format],r[this.format],r[this.type],e):r.texImage2D(r.TEXTURE_2D,0,r[this.format],this.chunkSize,this.chunkSize,0,r[this.format],r[this.type],e),this.used.set(t,n)}},{key:"delete",value:function(t){if(!this.has(t))throw"Tile of coord "+t+" does not exist in the array";var e=this.used.get(t);return this.used.delete(t),this.available.push(e),this}},{key:"bind",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(!this.has(t))throw"Tile of coord "+t+" does not exist in the array";var n=this.gl,r=this.used.get(t);return n.activeTexture(n["TEXTURE"+e]),n.bindTexture(n.TEXTURE_2D,r.texture),this}},{key:"unbind",value:function(){return this}}]),t}();e.exports=a},{"lodash/defaultTo":109}],197:[function(t,e,n){"use strict";var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var i=t("lodash/defaultTo"),o=function(){function t(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.gl=e,this.type=i(r.type,"UNSIGNED_SHORT"),this.mode=i(r.mode,"TRIANGLES"),this.count=i(r.count,0),this.byteOffset=i(r.byteOffset,0),n instanceof WebGLBuffer?this.buffer=n:(this.buffer=e.createBuffer(),n&&this.bufferData(n))}return r(t,[{key:"bufferData",value:function(t){var e=this.gl;e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this.buffer),e.bufferData(e.ELEMENT_ARRAY_BUFFER,t,e.STATIC_DRAW)}},{key:"bufferSubData",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this.gl;return n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,this.buffer),n.bufferSubData(n.ELEMENT_ARRAY_BUFFER,e,t),this}},{key:"draw",value:function(){var t=this.gl;return t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.buffer),t.drawElements(t[this.mode],this.count,t[this.type],this.byteOffset),this}}]),t}();e.exports=o},{"lodash/defaultTo":109}],198:[function(t,e,n){"use strict";var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var i=t("lodash/defaultTo"),o=t("lodash/forIn"),a={BYTE:1,UNSIGNED_BYTE:1,SHORT:2,UNSIGNED_SHORT:2,FIXED:4,FLOAT:4},s=function(t,e){var n=0;return t.forEach(function(t){n+=a[t.type]*t.size*e}),n},u=function(t,e,n){var r=0;e.forEach(function(e,i){t.byteOffsets[i]=n+r,r+=a[e.type]*e.size})},l=function(t){var e=0;return t.forEach(function(t){e+=t.size}),e},c=function(t){var e=new Map,n=0;return o(t,function(t,r){e.set(r,{type:t.type,size:t.size,byteOffset:n,byteStride:0}),n+=a[t.type]*t.size}),e.forEach(function(t){t.byteStride=n}),e},f=function(){function t(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.gl=e,this.ext=e.getExtension("ANGLE_instanced_arrays"),!this.ext)throw"ANGLE_instanced_arrays WebGL extension is not supported";if(this.chunkSize=i(r.chunkSize,16384),this.numChunks=i(r.numChunks,256),!n)throw"No attribute pointers provided";this.pointers=c(n),this.stride=l(this.pointers),this.available=new Array(this.numChunks);for(var o=s(this.pointers,this.chunkSize),a=0;a<this.numChunks;a++){var f=a*o,h={count:0,chunkOffset:a*this.chunkSize,chunkByteOffset:f,byteOffsets:{}};u(h,this.pointers,f),this.available[a]=h}this.used=new Map,this.buffer=e.createBuffer();var p=o*this.numChunks;e.bindBuffer(e.ARRAY_BUFFER,this.buffer),e.bufferData(e.ARRAY_BUFFER,p,e.DYNAMIC_DRAW)}return r(t,[{key:"has",value:function(t){return this.used.has(t)}},{key:"get",value:function(t){return this.used.get(t)}},{key:"set",value:function(t,e,n){if(this.has(t))throw"Tile of coord "+t+" already exists in the atlas";if(0===this.available.length)throw"No available vertex chunks in atlas";if(n>this.chunkSize)throw"Data count of "+n+" is greater that allocated size of "+this.chunkSize;var r=this.available.pop();if(r.count=n,n>0){var i=this.gl;i.bindBuffer(i.ARRAY_BUFFER,this.buffer),i.bufferSubData(i.ARRAY_BUFFER,r.chunkByteOffset,e)}this.used.set(t,r)}},{key:"delete",value:function(t){if(!this.has(t))throw"Tile of coord "+t+" does not exist in the atlas";var e=this.used.get(t);return this.used.delete(t),this.available.push(e),this}},{key:"bind",value:function(){var t=this.gl;return t.bindBuffer(t.ARRAY_BUFFER,this.buffer),this.pointers.forEach(function(e,n){t.enableVertexAttribArray(n),t.vertexAttribPointer(n,e.size,t[e.type],!1,e.byteStride,e.byteOffset)}),this}},{key:"bindInstanced",value:function(){var t=this.gl,e=this.ext;return t.bindBuffer(t.ARRAY_BUFFER,this.buffer),this.pointers.forEach(function(n,r){t.enableVertexAttribArray(r),e.vertexAttribDivisorANGLE(r,1)}),this}},{key:"unbind",value:function(){var t=this.gl;return this.pointers.forEach(function(e,n){t.disableVertexAttribArray(n)}),this}},{key:"unbindInstanced",value:function(){var t=this.gl,e=this.ext;return this.pointers.forEach(function(n,r){t.disableVertexAttribArray(r),e.vertexAttribDivisorANGLE(r,0)}),this}},{key:"draw",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;if(!this.has(t))throw"Tile of coord "+t+" does not exist in the atlas";var i=this.gl,o=this.used.get(t);o.count>0&&i.drawArrays(i[e],o.chunkOffset+n,r||o.count)}},{key:"drawInstanced",value:function(t,e,n){if(!this.has(t))throw"Tile of coord "+t+" does not exist in the atlas";var r=this.gl,i=this.ext,o=this.used.get(t);this.pointers.forEach(function(t,e){r.vertexAttribPointer(e,t.size,r[t.type],!1,t.byteStride,o.byteOffsets[e])}),o.count>0&&i.drawArraysInstancedANGLE(r[e],0,n,o.count)}}]),t}();e.exports=f},{"lodash/defaultTo":109,"lodash/forIn":111}],199:[function(t,e,n){"use strict";var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var i=t("lodash/defaultTo"),o=t("lodash/forIn"),a={BYTE:1,UNSIGNED_BYTE:1,SHORT:2,UNSIGNED_SHORT:2,FIXED:4,FLOAT:4},s=function(t){if(1===t.size)return 0;var e=0,n=0,r=0;return t.forEach(function(t){var i=t.byteOffset,o=t.size,s=t.type;n+=o*a[s],i>e&&(e=i,r=i+o*a[s])}),e>=n?0:r},u=function(t){var e=new Map;return o(t,function(t,n){var r=parseInt(n,10);t.byteOffset=i(t.byteOffset,0),e.set(r,t)}),e},l=function(){function t(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.gl=e,this.mode=i(o.mode,"TRIANGLES"),this.count=i(o.count,0),this.indexOffset=i(o.indexOffset,0),this.pointers=u(r),this.byteStride=s(this.pointers),n instanceof WebGLBuffer?this.buffer=n:(this.buffer=e.createBuffer(),n&&this.bufferData(n))}return r(t,[{key:"bufferData",value:function(t){var e=this.gl;return e.bindBuffer(e.ARRAY_BUFFER,this.buffer),e.bufferData(e.ARRAY_BUFFER,t,e.STATIC_DRAW),this}},{key:"bufferSubData",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this.gl;return n.bindBuffer(n.ARRAY_BUFFER,this.buffer),n.bufferSubData(n.ARRAY_BUFFER,e,t),this}},{key:"bind",value:function(){var t=this,e=this.gl;return e.bindBuffer(e.ARRAY_BUFFER,this.buffer),this.pointers.forEach(function(n,r){e.vertexAttribPointer(r,n.size,e[n.type],!1,t.byteStride,n.byteOffset),e.enableVertexAttribArray(r)}),this}},{key:"unbind",value:function(){var t=this.gl;return this.pointers.forEach(function(e,n){t.disableVertexAttribArray(n)}),this}},{key:"draw",value:function(){var t=this.gl;return t.drawArrays(t[this.mode],this.indexOffset,this.count),this}}]),t}();e.exports=l},{"lodash/defaultTo":109,"lodash/forIn":111}]},{},[145])(145)});