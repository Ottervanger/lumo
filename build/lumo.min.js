!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).lumo=t()}}(function(){return function t(e,n,r){function i(a,s){if(!n[a]){if(!e[a]){var u="function"==typeof require&&require;if(!s&&u)return u(a,!0);if(o)return o(a,!0);var l=new Error("Cannot find module '"+a+"'");throw l.code="MODULE_NOT_FOUND",l}var c=n[a]={exports:{}};e[a][0].call(c.exports,function(t){var n=e[a][1][t];return i(n||t)},c,c.exports,t,e,n,r)}return n[a].exports}for(var o="function"==typeof require&&require,a=0;a<r.length;a++)i(r[a]);return i}({1:[function(t,e,n){"use strict";function r(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function i(t){return"function"==typeof t}function o(t){return"number"==typeof t}function a(t){return"object"===(void 0===t?"undefined":u(t))&&null!==t}function s(t){return void 0===t}var u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};e.exports=r,r.EventEmitter=r,r.prototype._events=void 0,r.prototype._maxListeners=void 0,r.defaultMaxListeners=10,r.prototype.setMaxListeners=function(t){if(!o(t)||t<0||isNaN(t))throw TypeError("n must be a positive number");return this._maxListeners=t,this},r.prototype.emit=function(t){var e,n,r,o,u,l;if(this._events||(this._events={}),"error"===t&&(!this._events.error||a(this._events.error)&&!this._events.error.length)){if((e=arguments[1])instanceof Error)throw e;var c=new Error('Uncaught, unspecified "error" event. ('+e+")");throw c.context=e,c}if(n=this._events[t],s(n))return!1;if(i(n))switch(arguments.length){case 1:n.call(this);break;case 2:n.call(this,arguments[1]);break;case 3:n.call(this,arguments[1],arguments[2]);break;default:o=Array.prototype.slice.call(arguments,1),n.apply(this,o)}else if(a(n))for(o=Array.prototype.slice.call(arguments,1),r=(l=n.slice()).length,u=0;u<r;u++)l[u].apply(this,o);return!0},r.prototype.addListener=function(t,e){var n;if(!i(e))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",t,i(e.listener)?e.listener:e),this._events[t]?a(this._events[t])?this._events[t].push(e):this._events[t]=[this._events[t],e]:this._events[t]=e,a(this._events[t])&&!this._events[t].warned&&(n=s(this._maxListeners)?r.defaultMaxListeners:this._maxListeners)&&n>0&&this._events[t].length>n&&(this._events[t].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[t].length),"function"==typeof console.trace&&console.trace()),this},r.prototype.on=r.prototype.addListener,r.prototype.once=function(t,e){function n(){this.removeListener(t,n),r||(r=!0,e.apply(this,arguments))}if(!i(e))throw TypeError("listener must be a function");var r=!1;return n.listener=e,this.on(t,n),this},r.prototype.removeListener=function(t,e){var n,r,o,s;if(!i(e))throw TypeError("listener must be a function");if(!this._events||!this._events[t])return this;if(n=this._events[t],o=n.length,r=-1,n===e||i(n.listener)&&n.listener===e)delete this._events[t],this._events.removeListener&&this.emit("removeListener",t,e);else if(a(n)){for(s=o;s-- >0;)if(n[s]===e||n[s].listener&&n[s].listener===e){r=s;break}if(r<0)return this;1===n.length?(n.length=0,delete this._events[t]):n.splice(r,1),this._events.removeListener&&this.emit("removeListener",t,e)}return this},r.prototype.removeAllListeners=function(t){var e,n;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[t]&&delete this._events[t],this;if(0===arguments.length){for(e in this._events)"removeListener"!==e&&this.removeAllListeners(e);return this.removeAllListeners("removeListener"),this._events={},this}if(n=this._events[t],i(n))this.removeListener(t,n);else if(n)for(;n.length;)this.removeListener(t,n[n.length-1]);return delete this._events[t],this},r.prototype.listeners=function(t){return this._events&&this._events[t]?i(this._events[t])?[this._events[t]]:this._events[t].slice():[]},r.prototype.listenerCount=function(t){if(this._events){var e=this._events[t];if(i(e))return 1;if(e)return e.length}return 0},r.listenerCount=function(t,e){return t.listenerCount(e)}},{}],2:[function(t,e,n){"use strict";var r=t("./_getNative")(t("./_root"),"DataView");e.exports=r},{"./_getNative":58,"./_root":94}],3:[function(t,e,n){"use strict";function r(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}var i=t("./_hashClear"),o=t("./_hashDelete"),a=t("./_hashGet"),s=t("./_hashHas"),u=t("./_hashSet");r.prototype.clear=i,r.prototype.delete=o,r.prototype.get=a,r.prototype.has=s,r.prototype.set=u,e.exports=r},{"./_hashClear":64,"./_hashDelete":65,"./_hashGet":66,"./_hashHas":67,"./_hashSet":68}],4:[function(t,e,n){"use strict";function r(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}var i=t("./_listCacheClear"),o=t("./_listCacheDelete"),a=t("./_listCacheGet"),s=t("./_listCacheHas"),u=t("./_listCacheSet");r.prototype.clear=i,r.prototype.delete=o,r.prototype.get=a,r.prototype.has=s,r.prototype.set=u,e.exports=r},{"./_listCacheClear":75,"./_listCacheDelete":76,"./_listCacheGet":77,"./_listCacheHas":78,"./_listCacheSet":79}],5:[function(t,e,n){"use strict";var r=t("./_getNative")(t("./_root"),"Map");e.exports=r},{"./_getNative":58,"./_root":94}],6:[function(t,e,n){"use strict";function r(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}var i=t("./_mapCacheClear"),o=t("./_mapCacheDelete"),a=t("./_mapCacheGet"),s=t("./_mapCacheHas"),u=t("./_mapCacheSet");r.prototype.clear=i,r.prototype.delete=o,r.prototype.get=a,r.prototype.has=s,r.prototype.set=u,e.exports=r},{"./_mapCacheClear":80,"./_mapCacheDelete":81,"./_mapCacheGet":82,"./_mapCacheHas":83,"./_mapCacheSet":84}],7:[function(t,e,n){"use strict";var r=t("./_getNative")(t("./_root"),"Promise");e.exports=r},{"./_getNative":58,"./_root":94}],8:[function(t,e,n){"use strict";var r=t("./_getNative")(t("./_root"),"Set");e.exports=r},{"./_getNative":58,"./_root":94}],9:[function(t,e,n){"use strict";function r(t){var e=-1,n=null==t?0:t.length;for(this.__data__=new i;++e<n;)this.add(t[e])}var i=t("./_MapCache"),o=t("./_setCacheAdd"),a=t("./_setCacheHas");r.prototype.add=r.prototype.push=o,r.prototype.has=a,e.exports=r},{"./_MapCache":6,"./_setCacheAdd":95,"./_setCacheHas":96}],10:[function(t,e,n){"use strict";function r(t){var e=this.__data__=new i(t);this.size=e.size}var i=t("./_ListCache"),o=t("./_stackClear"),a=t("./_stackDelete"),s=t("./_stackGet"),u=t("./_stackHas"),l=t("./_stackSet");r.prototype.clear=o,r.prototype.delete=a,r.prototype.get=s,r.prototype.has=u,r.prototype.set=l,e.exports=r},{"./_ListCache":4,"./_stackClear":98,"./_stackDelete":99,"./_stackGet":100,"./_stackHas":101,"./_stackSet":102}],11:[function(t,e,n){"use strict";var r=t("./_root").Symbol;e.exports=r},{"./_root":94}],12:[function(t,e,n){"use strict";var r=t("./_root").Uint8Array;e.exports=r},{"./_root":94}],13:[function(t,e,n){"use strict";var r=t("./_getNative")(t("./_root"),"WeakMap");e.exports=r},{"./_getNative":58,"./_root":94}],14:[function(t,e,n){"use strict";function r(t,e){for(var n=-1,r=null==t?0:t.length,i=0,o=[];++n<r;){var a=t[n];e(a,n,t)&&(o[i++]=a)}return o}e.exports=r},{}],15:[function(t,e,n){"use strict";function r(t,e){var n=a(t),r=!n&&o(t),f=!n&&!r&&s(t),h=!n&&!r&&!f&&l(t),p=n||r||f||h,v=p?i(t.length,String):[],y=v.length;for(var d in t)!e&&!c.call(t,d)||p&&("length"==d||f&&("offset"==d||"parent"==d)||h&&("buffer"==d||"byteLength"==d||"byteOffset"==d)||u(d,y))||v.push(d);return v}var i=t("./_baseTimes"),o=t("./isArguments"),a=t("./isArray"),s=t("./isBuffer"),u=t("./_isIndex"),l=t("./isTypedArray"),c=Object.prototype.hasOwnProperty;e.exports=r},{"./_baseTimes":42,"./_isIndex":69,"./isArguments":114,"./isArray":115,"./isBuffer":117,"./isTypedArray":123}],16:[function(t,e,n){"use strict";function r(t,e){for(var n=-1,r=null==t?0:t.length,i=Array(r);++n<r;)i[n]=e(t[n],n,t);return i}e.exports=r},{}],17:[function(t,e,n){"use strict";function r(t,e){for(var n=-1,r=e.length,i=t.length;++n<r;)t[i+n]=e[n];return t}e.exports=r},{}],18:[function(t,e,n){"use strict";function r(t,e){for(var n=-1,r=null==t?0:t.length;++n<r;)if(e(t[n],n,t))return!0;return!1}e.exports=r},{}],19:[function(t,e,n){"use strict";function r(t,e){for(var n=t.length;n--;)if(i(t[n][0],e))return n;return-1}var i=t("./eq");e.exports=r},{"./eq":109}],20:[function(t,e,n){"use strict";function r(t,e,n){return t===t&&(void 0!==n&&(t=t<=n?t:n),void 0!==e&&(t=t>=e?t:e)),t}e.exports=r},{}],21:[function(t,e,n){"use strict";var r=t("./_baseForOwn"),i=t("./_createBaseEach")(r);e.exports=i},{"./_baseForOwn":23,"./_createBaseEach":49}],22:[function(t,e,n){"use strict";var r=t("./_createBaseFor")();e.exports=r},{"./_createBaseFor":50}],23:[function(t,e,n){"use strict";function r(t,e){return t&&i(t,e,o)}var i=t("./_baseFor"),o=t("./keys");e.exports=r},{"./_baseFor":22,"./keys":124}],24:[function(t,e,n){"use strict";function r(t,e){for(var n=0,r=(e=i(e,t)).length;null!=t&&n<r;)t=t[o(e[n++])];return n&&n==r?t:void 0}var i=t("./_castPath"),o=t("./_toKey");e.exports=r},{"./_castPath":47,"./_toKey":104}],25:[function(t,e,n){"use strict";function r(t,e,n){var r=e(t);return o(t)?r:i(r,n(t))}var i=t("./_arrayPush"),o=t("./isArray");e.exports=r},{"./_arrayPush":17,"./isArray":115}],26:[function(t,e,n){"use strict";function r(t){return null==t?void 0===t?u:s:l&&l in Object(t)?o(t):a(t)}var i=t("./_Symbol"),o=t("./_getRawTag"),a=t("./_objectToString"),s="[object Null]",u="[object Undefined]",l=i?i.toStringTag:void 0;e.exports=r},{"./_Symbol":11,"./_getRawTag":59,"./_objectToString":92}],27:[function(t,e,n){"use strict";function r(t,e){return null!=t&&e in Object(t)}e.exports=r},{}],28:[function(t,e,n){"use strict";function r(t){return o(t)&&i(t)==a}var i=t("./_baseGetTag"),o=t("./isObjectLike"),a="[object Arguments]";e.exports=r},{"./_baseGetTag":26,"./isObjectLike":121}],29:[function(t,e,n){"use strict";function r(t,e,n,a,s){return t===e||(null==t||null==e||!o(t)&&!o(e)?t!==t&&e!==e:i(t,e,n,a,r,s))}var i=t("./_baseIsEqualDeep"),o=t("./isObjectLike");e.exports=r},{"./_baseIsEqualDeep":30,"./isObjectLike":121}],30:[function(t,e,n){"use strict";function r(t,e,n,r,m,b){var g=l(t),_=l(e),x=g?v:u(t),w=_?v:u(e),O=(x=x==p?y:x)==y,E=(w=w==p?y:w)==y,T=x==w;if(T&&c(t)){if(!c(e))return!1;g=!0,O=!1}if(T&&!O)return b||(b=new i),g||f(t)?o(t,e,n,r,m,b):a(t,e,x,n,r,m,b);if(!(n&h)){var P=O&&d.call(t,"__wrapped__"),S=E&&d.call(e,"__wrapped__");if(P||S){var k=P?t.value():t,A=S?e.value():e;return b||(b=new i),m(k,A,n,r,b)}}return!!T&&(b||(b=new i),s(t,e,n,r,m,b))}var i=t("./_Stack"),o=t("./_equalArrays"),a=t("./_equalByTag"),s=t("./_equalObjects"),u=t("./_getTag"),l=t("./isArray"),c=t("./isBuffer"),f=t("./isTypedArray"),h=1,p="[object Arguments]",v="[object Array]",y="[object Object]",d=Object.prototype.hasOwnProperty;e.exports=r},{"./_Stack":10,"./_equalArrays":51,"./_equalByTag":52,"./_equalObjects":53,"./_getTag":61,"./isArray":115,"./isBuffer":117,"./isTypedArray":123}],31:[function(t,e,n){"use strict";function r(t,e,n,r){var u=n.length,l=u,c=!r;if(null==t)return!l;for(t=Object(t);u--;){var f=n[u];if(c&&f[2]?f[1]!==t[f[0]]:!(f[0]in t))return!1}for(;++u<l;){var h=(f=n[u])[0],p=t[h],v=f[1];if(c&&f[2]){if(void 0===p&&!(h in t))return!1}else{var y=new i;if(r)var d=r(p,v,h,t,e,y);if(!(void 0===d?o(v,p,a|s,r,y):d))return!1}}return!0}var i=t("./_Stack"),o=t("./_baseIsEqual"),a=1,s=2;e.exports=r},{"./_Stack":10,"./_baseIsEqual":29}],32:[function(t,e,n){"use strict";function r(t){return!(!a(t)||o(t))&&(i(t)?v:l).test(s(t))}var i=t("./isFunction"),o=t("./_isMasked"),a=t("./isObject"),s=t("./_toSource"),u=/[\\^$.*+?()[\]{}|]/g,l=/^\[object .+?Constructor\]$/,c=Function.prototype,f=Object.prototype,h=c.toString,p=f.hasOwnProperty,v=RegExp("^"+h.call(p).replace(u,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");e.exports=r},{"./_isMasked":72,"./_toSource":105,"./isFunction":118,"./isObject":120}],33:[function(t,e,n){"use strict";function r(t){return a(t)&&o(t.length)&&!!s[i(t)]}var i=t("./_baseGetTag"),o=t("./isLength"),a=t("./isObjectLike"),s={};s["[object Float32Array]"]=s["[object Float64Array]"]=s["[object Int8Array]"]=s["[object Int16Array]"]=s["[object Int32Array]"]=s["[object Uint8Array]"]=s["[object Uint8ClampedArray]"]=s["[object Uint16Array]"]=s["[object Uint32Array]"]=!0,s["[object Arguments]"]=s["[object Array]"]=s["[object ArrayBuffer]"]=s["[object Boolean]"]=s["[object DataView]"]=s["[object Date]"]=s["[object Error]"]=s["[object Function]"]=s["[object Map]"]=s["[object Number]"]=s["[object Object]"]=s["[object RegExp]"]=s["[object Set]"]=s["[object String]"]=s["[object WeakMap]"]=!1,e.exports=r},{"./_baseGetTag":26,"./isLength":119,"./isObjectLike":121}],34:[function(t,e,n){"use strict";function r(t){return"function"==typeof t?t:null==t?s:"object"==(void 0===t?"undefined":i(t))?u(t)?a(t[0],t[1]):o(t):l(t)}var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o=t("./_baseMatches"),a=t("./_baseMatchesProperty"),s=t("./identity"),u=t("./isArray"),l=t("./property");e.exports=r},{"./_baseMatches":38,"./_baseMatchesProperty":39,"./identity":113,"./isArray":115,"./property":129}],35:[function(t,e,n){"use strict";function r(t){if(!i(t))return o(t);var e=[];for(var n in Object(t))a.call(t,n)&&"constructor"!=n&&e.push(n);return e}var i=t("./_isPrototype"),o=t("./_nativeKeys"),a=Object.prototype.hasOwnProperty;e.exports=r},{"./_isPrototype":73,"./_nativeKeys":89}],36:[function(t,e,n){"use strict";function r(t){if(!i(t))return a(t);var e=o(t),n=[];for(var r in t)("constructor"!=r||!e&&s.call(t,r))&&n.push(r);return n}var i=t("./isObject"),o=t("./_isPrototype"),a=t("./_nativeKeysIn"),s=Object.prototype.hasOwnProperty;e.exports=r},{"./_isPrototype":73,"./_nativeKeysIn":90,"./isObject":120}],37:[function(t,e,n){"use strict";function r(t,e){var n=-1,r=o(t)?Array(t.length):[];return i(t,function(t,i,o){r[++n]=e(t,i,o)}),r}var i=t("./_baseEach"),o=t("./isArrayLike");e.exports=r},{"./_baseEach":21,"./isArrayLike":116}],38:[function(t,e,n){"use strict";function r(t){var e=o(t);return 1==e.length&&e[0][2]?a(e[0][0],e[0][1]):function(n){return n===t||i(n,t,e)}}var i=t("./_baseIsMatch"),o=t("./_getMatchData"),a=t("./_matchesStrictComparable");e.exports=r},{"./_baseIsMatch":31,"./_getMatchData":57,"./_matchesStrictComparable":86}],39:[function(t,e,n){"use strict";function r(t,e){return s(t)&&u(e)?l(c(t),e):function(n){var r=o(n,t);return void 0===r&&r===e?a(n,t):i(e,r,f|h)}}var i=t("./_baseIsEqual"),o=t("./get"),a=t("./hasIn"),s=t("./_isKey"),u=t("./_isStrictComparable"),l=t("./_matchesStrictComparable"),c=t("./_toKey"),f=1,h=2;e.exports=r},{"./_baseIsEqual":29,"./_isKey":70,"./_isStrictComparable":74,"./_matchesStrictComparable":86,"./_toKey":104,"./get":111,"./hasIn":112}],40:[function(t,e,n){"use strict";function r(t){return function(e){return null==e?void 0:e[t]}}e.exports=r},{}],41:[function(t,e,n){"use strict";function r(t){return function(e){return i(e,t)}}var i=t("./_baseGet");e.exports=r},{"./_baseGet":24}],42:[function(t,e,n){"use strict";function r(t,e){for(var n=-1,r=Array(t);++n<t;)r[n]=e(n);return r}e.exports=r},{}],43:[function(t,e,n){"use strict";function r(t){if("string"==typeof t)return t;if(a(t))return o(t,r)+"";if(s(t))return c?c.call(t):"";var e=t+"";return"0"==e&&1/t==-u?"-0":e}var i=t("./_Symbol"),o=t("./_arrayMap"),a=t("./isArray"),s=t("./isSymbol"),u=1/0,l=i?i.prototype:void 0,c=l?l.toString:void 0;e.exports=r},{"./_Symbol":11,"./_arrayMap":16,"./isArray":115,"./isSymbol":122}],44:[function(t,e,n){"use strict";function r(t){return function(e){return t(e)}}e.exports=r},{}],45:[function(t,e,n){"use strict";function r(t,e){return t.has(e)}e.exports=r},{}],46:[function(t,e,n){"use strict";function r(t){return"function"==typeof t?t:i}var i=t("./identity");e.exports=r},{"./identity":113}],47:[function(t,e,n){"use strict";function r(t,e){return i(t)?t:o(t,e)?[t]:a(s(t))}var i=t("./isArray"),o=t("./_isKey"),a=t("./_stringToPath"),s=t("./toString");e.exports=r},{"./_isKey":70,"./_stringToPath":103,"./isArray":115,"./toString":134}],48:[function(t,e,n){"use strict";var r=t("./_root")["__core-js_shared__"];e.exports=r},{"./_root":94}],49:[function(t,e,n){"use strict";function r(t,e){return function(n,r){if(null==n)return n;if(!i(n))return t(n,r);for(var o=n.length,a=e?o:-1,s=Object(n);(e?a--:++a<o)&&!1!==r(s[a],a,s););return n}}var i=t("./isArrayLike");e.exports=r},{"./isArrayLike":116}],50:[function(t,e,n){"use strict";function r(t){return function(e,n,r){for(var i=-1,o=Object(e),a=r(e),s=a.length;s--;){var u=a[t?s:++i];if(!1===n(o[u],u,o))break}return e}}e.exports=r},{}],51:[function(t,e,n){"use strict";function r(t,e,n,r,l,c){var f=n&s,h=t.length,p=e.length;if(h!=p&&!(f&&p>h))return!1;var v=c.get(t);if(v&&c.get(e))return v==e;var y=-1,d=!0,m=n&u?new i:void 0;for(c.set(t,e),c.set(e,t);++y<h;){var b=t[y],g=e[y];if(r)var _=f?r(g,b,y,e,t,c):r(b,g,y,t,e,c);if(void 0!==_){if(_)continue;d=!1;break}if(m){if(!o(e,function(t,e){if(!a(m,e)&&(b===t||l(b,t,n,r,c)))return m.push(e)})){d=!1;break}}else if(b!==g&&!l(b,g,n,r,c)){d=!1;break}}return c.delete(t),c.delete(e),d}var i=t("./_SetCache"),o=t("./_arraySome"),a=t("./_cacheHas"),s=1,u=2;e.exports=r},{"./_SetCache":9,"./_arraySome":18,"./_cacheHas":45}],52:[function(t,e,n){"use strict";function r(t,e,n,r,i,O,T){switch(n){case w:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case x:return!(t.byteLength!=e.byteLength||!O(new o(t),new o(e)));case h:case p:case d:return a(+t,+e);case v:return t.name==e.name&&t.message==e.message;case m:case g:return t==e+"";case y:var P=u;case b:var S=r&c;if(P||(P=l),t.size!=e.size&&!S)return!1;var k=T.get(t);if(k)return k==e;r|=f,T.set(t,e);var A=s(P(t),P(e),r,i,O,T);return T.delete(t),A;case _:if(E)return E.call(t)==E.call(e)}return!1}var i=t("./_Symbol"),o=t("./_Uint8Array"),a=t("./eq"),s=t("./_equalArrays"),u=t("./_mapToArray"),l=t("./_setToArray"),c=1,f=2,h="[object Boolean]",p="[object Date]",v="[object Error]",y="[object Map]",d="[object Number]",m="[object RegExp]",b="[object Set]",g="[object String]",_="[object Symbol]",x="[object ArrayBuffer]",w="[object DataView]",O=i?i.prototype:void 0,E=O?O.valueOf:void 0;e.exports=r},{"./_Symbol":11,"./_Uint8Array":12,"./_equalArrays":51,"./_mapToArray":85,"./_setToArray":97,"./eq":109}],53:[function(t,e,n){"use strict";function r(t,e,n,r,s,u){var l=n&o,c=i(t),f=c.length;if(f!=i(e).length&&!l)return!1;for(var h=f;h--;){var p=c[h];if(!(l?p in e:a.call(e,p)))return!1}var v=u.get(t);if(v&&u.get(e))return v==e;var y=!0;u.set(t,e),u.set(e,t);for(var d=l;++h<f;){var m=t[p=c[h]],b=e[p];if(r)var g=l?r(b,m,p,e,t,u):r(m,b,p,t,e,u);if(!(void 0===g?m===b||s(m,b,n,r,u):g)){y=!1;break}d||(d="constructor"==p)}if(y&&!d){var _=t.constructor,x=e.constructor;_!=x&&"constructor"in t&&"constructor"in e&&!("function"==typeof _&&_ instanceof _&&"function"==typeof x&&x instanceof x)&&(y=!1)}return u.delete(t),u.delete(e),y}var i=t("./_getAllKeys"),o=1,a=Object.prototype.hasOwnProperty;e.exports=r},{"./_getAllKeys":55}],54:[function(t,e,n){(function(t){"use strict";var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r="object"==(void 0===t?"undefined":n(t))&&t&&t.Object===Object&&t;e.exports=r}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],55:[function(t,e,n){"use strict";function r(t){return i(t,a,o)}var i=t("./_baseGetAllKeys"),o=t("./_getSymbols"),a=t("./keys");e.exports=r},{"./_baseGetAllKeys":25,"./_getSymbols":60,"./keys":124}],56:[function(t,e,n){"use strict";function r(t,e){var n=t.__data__;return i(e)?n["string"==typeof e?"string":"hash"]:n.map}var i=t("./_isKeyable");e.exports=r},{"./_isKeyable":71}],57:[function(t,e,n){"use strict";function r(t){for(var e=o(t),n=e.length;n--;){var r=e[n],a=t[r];e[n]=[r,a,i(a)]}return e}var i=t("./_isStrictComparable"),o=t("./keys");e.exports=r},{"./_isStrictComparable":74,"./keys":124}],58:[function(t,e,n){"use strict";function r(t,e){var n=o(t,e);return i(n)?n:void 0}var i=t("./_baseIsNative"),o=t("./_getValue");e.exports=r},{"./_baseIsNative":32,"./_getValue":62}],59:[function(t,e,n){"use strict";function r(t){var e=a.call(t,u),n=t[u];try{t[u]=void 0;var r=!0}catch(t){}var i=s.call(t);return r&&(e?t[u]=n:delete t[u]),i}var i=t("./_Symbol"),o=Object.prototype,a=o.hasOwnProperty,s=o.toString,u=i?i.toStringTag:void 0;e.exports=r},{"./_Symbol":11}],60:[function(t,e,n){"use strict";var r=t("./_arrayFilter"),i=t("./stubArray"),o=Object.prototype.propertyIsEnumerable,a=Object.getOwnPropertySymbols,s=a?function(t){return null==t?[]:(t=Object(t),r(a(t),function(e){return o.call(t,e)}))}:i;e.exports=s},{"./_arrayFilter":14,"./stubArray":130}],61:[function(t,e,n){"use strict";var r=t("./_DataView"),i=t("./_Map"),o=t("./_Promise"),a=t("./_Set"),s=t("./_WeakMap"),u=t("./_baseGetTag"),l=t("./_toSource"),c=l(r),f=l(i),h=l(o),p=l(a),v=l(s),y=u;(r&&"[object DataView]"!=y(new r(new ArrayBuffer(1)))||i&&"[object Map]"!=y(new i)||o&&"[object Promise]"!=y(o.resolve())||a&&"[object Set]"!=y(new a)||s&&"[object WeakMap]"!=y(new s))&&(y=function(t){var e=u(t),n="[object Object]"==e?t.constructor:void 0,r=n?l(n):"";if(r)switch(r){case c:return"[object DataView]";case f:return"[object Map]";case h:return"[object Promise]";case p:return"[object Set]";case v:return"[object WeakMap]"}return e}),e.exports=y},{"./_DataView":2,"./_Map":5,"./_Promise":7,"./_Set":8,"./_WeakMap":13,"./_baseGetTag":26,"./_toSource":105}],62:[function(t,e,n){"use strict";function r(t,e){return null==t?void 0:t[e]}e.exports=r},{}],63:[function(t,e,n){"use strict";function r(t,e,n){for(var r=-1,c=(e=i(e,t)).length,f=!1;++r<c;){var h=l(e[r]);if(!(f=null!=t&&n(t,h)))break;t=t[h]}return f||++r!=c?f:!!(c=null==t?0:t.length)&&u(c)&&s(h,c)&&(a(t)||o(t))}var i=t("./_castPath"),o=t("./isArguments"),a=t("./isArray"),s=t("./_isIndex"),u=t("./isLength"),l=t("./_toKey");e.exports=r},{"./_castPath":47,"./_isIndex":69,"./_toKey":104,"./isArguments":114,"./isArray":115,"./isLength":119}],64:[function(t,e,n){"use strict";function r(){this.__data__=i?i(null):{},this.size=0}var i=t("./_nativeCreate");e.exports=r},{"./_nativeCreate":88}],65:[function(t,e,n){"use strict";function r(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e}e.exports=r},{}],66:[function(t,e,n){"use strict";function r(t){var e=this.__data__;if(i){var n=e[t];return n===o?void 0:n}return a.call(e,t)?e[t]:void 0}var i=t("./_nativeCreate"),o="__lodash_hash_undefined__",a=Object.prototype.hasOwnProperty;e.exports=r},{"./_nativeCreate":88}],67:[function(t,e,n){"use strict";function r(t){var e=this.__data__;return i?void 0!==e[t]:o.call(e,t)}var i=t("./_nativeCreate"),o=Object.prototype.hasOwnProperty;e.exports=r},{"./_nativeCreate":88}],68:[function(t,e,n){"use strict";function r(t,e){var n=this.__data__;return this.size+=this.has(t)?0:1,n[t]=i&&void 0===e?o:e,this}var i=t("./_nativeCreate"),o="__lodash_hash_undefined__";e.exports=r},{"./_nativeCreate":88}],69:[function(t,e,n){"use strict";function r(t,e){return!!(e=null==e?i:e)&&("number"==typeof t||o.test(t))&&t>-1&&t%1==0&&t<e}var i=9007199254740991,o=/^(?:0|[1-9]\d*)$/;e.exports=r},{}],70:[function(t,e,n){"use strict";function r(t,e){if(o(t))return!1;var n=void 0===t?"undefined":i(t);return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=t&&!a(t))||(u.test(t)||!s.test(t)||null!=e&&t in Object(e))}var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o=t("./isArray"),a=t("./isSymbol"),s=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,u=/^\w*$/;e.exports=r},{"./isArray":115,"./isSymbol":122}],71:[function(t,e,n){"use strict";function r(t){var e=void 0===t?"undefined":i(t);return"string"==e||"number"==e||"symbol"==e||"boolean"==e?"__proto__"!==t:null===t}var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};e.exports=r},{}],72:[function(t,e,n){"use strict";function r(t){return!!o&&o in t}var i=t("./_coreJsData"),o=function(){var t=/[^.]+$/.exec(i&&i.keys&&i.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}();e.exports=r},{"./_coreJsData":48}],73:[function(t,e,n){"use strict";function r(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||i)}var i=Object.prototype;e.exports=r},{}],74:[function(t,e,n){"use strict";function r(t){return t===t&&!i(t)}var i=t("./isObject");e.exports=r},{"./isObject":120}],75:[function(t,e,n){"use strict";function r(){this.__data__=[],this.size=0}e.exports=r},{}],76:[function(t,e,n){"use strict";function r(t){var e=this.__data__,n=i(e,t);return!(n<0)&&(n==e.length-1?e.pop():o.call(e,n,1),--this.size,!0)}var i=t("./_assocIndexOf"),o=Array.prototype.splice;e.exports=r},{"./_assocIndexOf":19}],77:[function(t,e,n){"use strict";function r(t){var e=this.__data__,n=i(e,t);return n<0?void 0:e[n][1]}var i=t("./_assocIndexOf");e.exports=r},{"./_assocIndexOf":19}],78:[function(t,e,n){"use strict";function r(t){return i(this.__data__,t)>-1}var i=t("./_assocIndexOf");e.exports=r},{"./_assocIndexOf":19}],79:[function(t,e,n){"use strict";function r(t,e){var n=this.__data__,r=i(n,t);return r<0?(++this.size,n.push([t,e])):n[r][1]=e,this}var i=t("./_assocIndexOf");e.exports=r},{"./_assocIndexOf":19}],80:[function(t,e,n){"use strict";function r(){this.size=0,this.__data__={hash:new i,map:new(a||o),string:new i}}var i=t("./_Hash"),o=t("./_ListCache"),a=t("./_Map");e.exports=r},{"./_Hash":3,"./_ListCache":4,"./_Map":5}],81:[function(t,e,n){"use strict";function r(t){var e=i(this,t).delete(t);return this.size-=e?1:0,e}var i=t("./_getMapData");e.exports=r},{"./_getMapData":56}],82:[function(t,e,n){"use strict";function r(t){return i(this,t).get(t)}var i=t("./_getMapData");e.exports=r},{"./_getMapData":56}],83:[function(t,e,n){"use strict";function r(t){return i(this,t).has(t)}var i=t("./_getMapData");e.exports=r},{"./_getMapData":56}],84:[function(t,e,n){"use strict";function r(t,e){var n=i(this,t),r=n.size;return n.set(t,e),this.size+=n.size==r?0:1,this}var i=t("./_getMapData");e.exports=r},{"./_getMapData":56}],85:[function(t,e,n){"use strict";function r(t){var e=-1,n=Array(t.size);return t.forEach(function(t,r){n[++e]=[r,t]}),n}e.exports=r},{}],86:[function(t,e,n){"use strict";function r(t,e){return function(n){return null!=n&&(n[t]===e&&(void 0!==e||t in Object(n)))}}e.exports=r},{}],87:[function(t,e,n){"use strict";function r(t){var e=i(t,function(t){return n.size===o&&n.clear(),t}),n=e.cache;return e}var i=t("./memoize"),o=500;e.exports=r},{"./memoize":127}],88:[function(t,e,n){"use strict";var r=t("./_getNative")(Object,"create");e.exports=r},{"./_getNative":58}],89:[function(t,e,n){"use strict";var r=t("./_overArg")(Object.keys,Object);e.exports=r},{"./_overArg":93}],90:[function(t,e,n){"use strict";function r(t){var e=[];if(null!=t)for(var n in Object(t))e.push(n);return e}e.exports=r},{}],91:[function(t,e,n){"use strict";var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i=t("./_freeGlobal"),o="object"==(void 0===n?"undefined":r(n))&&n&&!n.nodeType&&n,a=o&&"object"==(void 0===e?"undefined":r(e))&&e&&!e.nodeType&&e,s=a&&a.exports===o&&i.process,u=function(){try{return s&&s.binding&&s.binding("util")}catch(t){}}();e.exports=u},{"./_freeGlobal":54}],92:[function(t,e,n){"use strict";function r(t){return i.call(t)}var i=Object.prototype.toString;e.exports=r},{}],93:[function(t,e,n){"use strict";function r(t,e){return function(n){return t(e(n))}}e.exports=r},{}],94:[function(t,e,n){"use strict";var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i=t("./_freeGlobal"),o="object"==("undefined"==typeof self?"undefined":r(self))&&self&&self.Object===Object&&self,a=i||o||Function("return this")();e.exports=a},{"./_freeGlobal":54}],95:[function(t,e,n){"use strict";function r(t){return this.__data__.set(t,i),this}var i="__lodash_hash_undefined__";e.exports=r},{}],96:[function(t,e,n){"use strict";function r(t){return this.__data__.has(t)}e.exports=r},{}],97:[function(t,e,n){"use strict";function r(t){var e=-1,n=Array(t.size);return t.forEach(function(t){n[++e]=t}),n}e.exports=r},{}],98:[function(t,e,n){"use strict";function r(){this.__data__=new i,this.size=0}var i=t("./_ListCache");e.exports=r},{"./_ListCache":4}],99:[function(t,e,n){"use strict";function r(t){var e=this.__data__,n=e.delete(t);return this.size=e.size,n}e.exports=r},{}],100:[function(t,e,n){"use strict";function r(t){return this.__data__.get(t)}e.exports=r},{}],101:[function(t,e,n){"use strict";function r(t){return this.__data__.has(t)}e.exports=r},{}],102:[function(t,e,n){"use strict";function r(t,e){var n=this.__data__;if(n instanceof i){var r=n.__data__;if(!o||r.length<s-1)return r.push([t,e]),this.size=++n.size,this;n=this.__data__=new a(r)}return n.set(t,e),this.size=n.size,this}var i=t("./_ListCache"),o=t("./_Map"),a=t("./_MapCache"),s=200;e.exports=r},{"./_ListCache":4,"./_Map":5,"./_MapCache":6}],103:[function(t,e,n){"use strict";var r=/^\./,i=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,o=/\\(\\)?/g,a=t("./_memoizeCapped")(function(t){var e=[];return r.test(t)&&e.push(""),t.replace(i,function(t,n,r,i){e.push(r?i.replace(o,"$1"):n||t)}),e});e.exports=a},{"./_memoizeCapped":87}],104:[function(t,e,n){"use strict";function r(t){if("string"==typeof t||i(t))return t;var e=t+"";return"0"==e&&1/t==-o?"-0":e}var i=t("./isSymbol"),o=1/0;e.exports=r},{"./isSymbol":122}],105:[function(t,e,n){"use strict";function r(t){if(null!=t){try{return i.call(t)}catch(t){}try{return t+""}catch(t){}}return""}var i=Function.prototype.toString;e.exports=r},{}],106:[function(t,e,n){"use strict";function r(t,e,n){return void 0===n&&(n=e,e=void 0),void 0!==n&&(n=(n=o(n))===n?n:0),void 0!==e&&(e=(e=o(e))===e?e:0),i(o(t),e,n)}var i=t("./_baseClamp"),o=t("./toNumber");e.exports=r},{"./_baseClamp":20,"./toNumber":133}],107:[function(t,e,n){"use strict";function r(t,e,n){function r(e){var n=b,r=g;return b=g=void 0,E=e,x=t.apply(r,n)}function c(t){return E=t,w=setTimeout(p,e),T?r(t):x}function f(t){var n=t-E,r=e-(t-O);return P?l(r,_-n):r}function h(t){var n=t-O,r=t-E;return void 0===O||n>=e||n<0||P&&r>=_}function p(){var t=o();if(h(t))return v(t);w=setTimeout(p,f(t))}function v(t){return w=void 0,S&&b?r(t):(b=g=void 0,x)}function y(){void 0!==w&&clearTimeout(w),E=0,b=O=g=w=void 0}function d(){return void 0===w?x:v(o())}function m(){var t=o(),n=h(t);if(b=arguments,g=this,O=t,n){if(void 0===w)return c(O);if(P)return w=setTimeout(p,e),r(O)}return void 0===w&&(w=setTimeout(p,e)),x}var b,g,_,x,w,O,E=0,T=!1,P=!1,S=!0;if("function"!=typeof t)throw new TypeError(s);return e=a(e)||0,i(n)&&(T=!!n.leading,_=(P="maxWait"in n)?u(a(n.maxWait)||0,e):_,S="trailing"in n?!!n.trailing:S),m.cancel=y,m.flush=d,m}var i=t("./isObject"),o=t("./now"),a=t("./toNumber"),s="Expected a function",u=Math.max,l=Math.min;e.exports=r},{"./isObject":120,"./now":128,"./toNumber":133}],108:[function(t,e,n){"use strict";function r(t,e){return null==t||t!==t?e:t}e.exports=r},{}],109:[function(t,e,n){"use strict";function r(t,e){return t===e||t!==t&&e!==e}e.exports=r},{}],110:[function(t,e,n){"use strict";function r(t,e){return null==t?t:i(t,o(e),a)}var i=t("./_baseFor"),o=t("./_castFunction"),a=t("./keysIn");e.exports=r},{"./_baseFor":22,"./_castFunction":46,"./keysIn":125}],111:[function(t,e,n){"use strict";function r(t,e,n){var r=null==t?void 0:i(t,e);return void 0===r?n:r}var i=t("./_baseGet");e.exports=r},{"./_baseGet":24}],112:[function(t,e,n){"use strict";function r(t,e){return null!=t&&o(t,e,i)}var i=t("./_baseHasIn"),o=t("./_hasPath");e.exports=r},{"./_baseHasIn":27,"./_hasPath":63}],113:[function(t,e,n){"use strict";function r(t){return t}e.exports=r},{}],114:[function(t,e,n){"use strict";var r=t("./_baseIsArguments"),i=t("./isObjectLike"),o=Object.prototype,a=o.hasOwnProperty,s=o.propertyIsEnumerable,u=r(function(){return arguments}())?r:function(t){return i(t)&&a.call(t,"callee")&&!s.call(t,"callee")};e.exports=u},{"./_baseIsArguments":28,"./isObjectLike":121}],115:[function(t,e,n){"use strict";var r=Array.isArray;e.exports=r},{}],116:[function(t,e,n){"use strict";function r(t){return null!=t&&o(t.length)&&!i(t)}var i=t("./isFunction"),o=t("./isLength");e.exports=r},{"./isFunction":118,"./isLength":119}],117:[function(t,e,n){"use strict";var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i=t("./_root"),o=t("./stubFalse"),a="object"==(void 0===n?"undefined":r(n))&&n&&!n.nodeType&&n,s=a&&"object"==(void 0===e?"undefined":r(e))&&e&&!e.nodeType&&e,u=s&&s.exports===a?i.Buffer:void 0,l=(u?u.isBuffer:void 0)||o;e.exports=l},{"./_root":94,"./stubFalse":131}],118:[function(t,e,n){"use strict";function r(t){if(!o(t))return!1;var e=i(t);return e==s||e==u||e==a||e==l}var i=t("./_baseGetTag"),o=t("./isObject"),a="[object AsyncFunction]",s="[object Function]",u="[object GeneratorFunction]",l="[object Proxy]";e.exports=r},{"./_baseGetTag":26,"./isObject":120}],119:[function(t,e,n){"use strict";function r(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=i}var i=9007199254740991;e.exports=r},{}],120:[function(t,e,n){"use strict";function r(t){var e=void 0===t?"undefined":i(t);return null!=t&&("object"==e||"function"==e)}var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};e.exports=r},{}],121:[function(t,e,n){"use strict";function r(t){return null!=t&&"object"==(void 0===t?"undefined":i(t))}var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};e.exports=r},{}],122:[function(t,e,n){"use strict";function r(t){return"symbol"==(void 0===t?"undefined":i(t))||a(t)&&o(t)==s}var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o=t("./_baseGetTag"),a=t("./isObjectLike"),s="[object Symbol]";e.exports=r},{"./_baseGetTag":26,"./isObjectLike":121}],123:[function(t,e,n){"use strict";var r=t("./_baseIsTypedArray"),i=t("./_baseUnary"),o=t("./_nodeUtil"),a=o&&o.isTypedArray,s=a?i(a):r;e.exports=s},{"./_baseIsTypedArray":33,"./_baseUnary":44,"./_nodeUtil":91}],124:[function(t,e,n){"use strict";function r(t){return a(t)?i(t):o(t)}var i=t("./_arrayLikeKeys"),o=t("./_baseKeys"),a=t("./isArrayLike");e.exports=r},{"./_arrayLikeKeys":15,"./_baseKeys":35,"./isArrayLike":116}],125:[function(t,e,n){"use strict";function r(t){return a(t)?i(t,!0):o(t)}var i=t("./_arrayLikeKeys"),o=t("./_baseKeysIn"),a=t("./isArrayLike");e.exports=r},{"./_arrayLikeKeys":15,"./_baseKeysIn":36,"./isArrayLike":116}],126:[function(t,e,n){"use strict";function r(t,e){return(s(t)?i:a)(t,o(e,3))}var i=t("./_arrayMap"),o=t("./_baseIteratee"),a=t("./_baseMap"),s=t("./isArray");e.exports=r},{"./_arrayMap":16,"./_baseIteratee":34,"./_baseMap":37,"./isArray":115}],127:[function(t,e,n){"use strict";function r(t,e){if("function"!=typeof t||null!=e&&"function"!=typeof e)throw new TypeError(o);var n=function n(){var r=arguments,i=e?e.apply(this,r):r[0],o=n.cache;if(o.has(i))return o.get(i);var a=t.apply(this,r);return n.cache=o.set(i,a)||o,a};return n.cache=new(r.Cache||i),n}var i=t("./_MapCache"),o="Expected a function";r.Cache=i,e.exports=r},{"./_MapCache":6}],128:[function(t,e,n){"use strict";var r=t("./_root"),i=function(){return r.Date.now()};e.exports=i},{"./_root":94}],129:[function(t,e,n){"use strict";function r(t){return a(t)?i(s(t)):o(t)}var i=t("./_baseProperty"),o=t("./_basePropertyDeep"),a=t("./_isKey"),s=t("./_toKey");e.exports=r},{"./_baseProperty":40,"./_basePropertyDeep":41,"./_isKey":70,"./_toKey":104}],130:[function(t,e,n){"use strict";function r(){return[]}e.exports=r},{}],131:[function(t,e,n){"use strict";function r(){return!1}e.exports=r},{}],132:[function(t,e,n){"use strict";function r(t,e,n){var r=!0,s=!0;if("function"!=typeof t)throw new TypeError(a);return o(n)&&(r="leading"in n?!!n.leading:r,s="trailing"in n?!!n.trailing:s),i(t,e,{leading:r,maxWait:e,trailing:s})}var i=t("./debounce"),o=t("./isObject"),a="Expected a function";e.exports=r},{"./debounce":107,"./isObject":120}],133:[function(t,e,n){"use strict";function r(t){if("number"==typeof t)return t;if(o(t))return a;if(i(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=i(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=t.replace(s,"");var n=l.test(t);return n||c.test(t)?f(t.slice(2),n?2:8):u.test(t)?a:+t}var i=t("./isObject"),o=t("./isSymbol"),a=NaN,s=/^\s+|\s+$/g,u=/^[-+]0x[0-9a-f]+$/i,l=/^0b[01]+$/i,c=/^0o[0-7]+$/i,f=parseInt;e.exports=r},{"./isObject":120,"./isSymbol":122}],134:[function(t,e,n){"use strict";function r(t){return null==t?"":i(t)}var i=t("./_baseToString");e.exports=r},{"./_baseToString":43}],135:[function(t,e,n){"use strict";function r(t,e,n){var r;return d[e]?r=d[e]:(r=h(e),d[e]=r),2===arguments.length?t[r]:(t[r]=n,n)}function i(){return 1}function o(t){if(!(this instanceof o))return new o(t);"number"==typeof t&&(t={max:t}),t||(t={});var e=r(this,"max",t.max);(!e||"number"!=typeof e||e<=0)&&r(this,"max",1/0);var n=t.length||i;"function"!=typeof n&&(n=i),r(this,"lengthCalculator",n),r(this,"allowStale",t.stale||!1),r(this,"maxAge",t.maxAge||0),r(this,"dispose",t.dispose),this.reset()}function a(t,e,n,i){var o=n.value;u(t,o)&&(c(t,n),r(t,"allowStale")||(o=void 0)),o&&e.call(i,o.value,o.key,t)}function s(t,e,n){var i=r(t,"cache").get(e);if(i){var o=i.value;u(t,o)?(c(t,i),r(t,"allowStale")||(o=void 0)):n&&r(t,"lruList").unshiftNode(i),o&&(o=o.value)}return o}function u(t,e){if(!e||!e.maxAge&&!r(t,"maxAge"))return!1;var n=Date.now()-e.now;return e.maxAge?n>e.maxAge:r(t,"maxAge")&&n>r(t,"maxAge")}function l(t){if(r(t,"length")>r(t,"max"))for(var e=r(t,"lruList").tail;r(t,"length")>r(t,"max")&&null!==e;){var n=e.prev;c(t,e),e=n}}function c(t,e){if(e){var n=e.value;r(t,"dispose")&&r(t,"dispose").call(this,n.key,n.value),r(t,"length",r(t,"length")-n.length),r(t,"cache").delete(n.key),r(t,"lruList").removeNode(e)}}function f(t,e,n,r,i){this.key=t,this.value=e,this.length=n,this.now=r,this.maxAge=i||0}e.exports=o;var h,p=t("pseudomap"),v=t("util"),y=t("yallist"),d={},m="function"==typeof Symbol;h=m?function(t){return Symbol.for(t)}:function(t){return"_"+t},Object.defineProperty(o.prototype,"max",{set:function(t){(!t||"number"!=typeof t||t<=0)&&(t=1/0),r(this,"max",t),l(this)},get:function(){return r(this,"max")},enumerable:!0}),Object.defineProperty(o.prototype,"allowStale",{set:function(t){r(this,"allowStale",!!t)},get:function(){return r(this,"allowStale")},enumerable:!0}),Object.defineProperty(o.prototype,"maxAge",{set:function(t){(!t||"number"!=typeof t||t<0)&&(t=0),r(this,"maxAge",t),l(this)},get:function(){return r(this,"maxAge")},enumerable:!0}),Object.defineProperty(o.prototype,"lengthCalculator",{set:function(t){"function"!=typeof t&&(t=i),t!==r(this,"lengthCalculator")&&(r(this,"lengthCalculator",t),r(this,"length",0),r(this,"lruList").forEach(function(t){t.length=r(this,"lengthCalculator").call(this,t.value,t.key),r(this,"length",r(this,"length")+t.length)},this)),l(this)},get:function(){return r(this,"lengthCalculator")},enumerable:!0}),Object.defineProperty(o.prototype,"length",{get:function(){return r(this,"length")},enumerable:!0}),Object.defineProperty(o.prototype,"itemCount",{get:function(){return r(this,"lruList").length},enumerable:!0}),o.prototype.rforEach=function(t,e){e=e||this;for(var n=r(this,"lruList").tail;null!==n;){var i=n.prev;a(this,t,n,e),n=i}},o.prototype.forEach=function(t,e){e=e||this;for(var n=r(this,"lruList").head;null!==n;){var i=n.next;a(this,t,n,e),n=i}},o.prototype.keys=function(){return r(this,"lruList").toArray().map(function(t){return t.key},this)},o.prototype.values=function(){return r(this,"lruList").toArray().map(function(t){return t.value},this)},o.prototype.reset=function(){r(this,"dispose")&&r(this,"lruList")&&r(this,"lruList").length&&r(this,"lruList").forEach(function(t){r(this,"dispose").call(this,t.key,t.value)},this),r(this,"cache",new p),r(this,"lruList",new y),r(this,"length",0)},o.prototype.dump=function(){return r(this,"lruList").map(function(t){if(!u(this,t))return{k:t.key,v:t.value,e:t.now+(t.maxAge||0)}},this).toArray().filter(function(t){return t})},o.prototype.dumpLru=function(){return r(this,"lruList")},o.prototype.inspect=function(t,e){var n="LRUCache {",o=!1;r(this,"allowStale")&&(n+="\n  allowStale: true",o=!0);var a=r(this,"max");a&&a!==1/0&&(o&&(n+=","),n+="\n  max: "+v.inspect(a,e),o=!0);var s=r(this,"maxAge");s&&(o&&(n+=","),n+="\n  maxAge: "+v.inspect(s,e),o=!0);var l=r(this,"lengthCalculator");l&&l!==i&&(o&&(n+=","),n+="\n  length: "+v.inspect(r(this,"length"),e),o=!0);var c=!1;return r(this,"lruList").forEach(function(t){c?n+=",\n  ":(o&&(n+=",\n"),c=!0,n+="\n  ");var r=v.inspect(t.key).split("\n").join("\n  "),a={value:t.value};t.maxAge!==s&&(a.maxAge=t.maxAge),l!==i&&(a.length=t.length),u(this,t)&&(a.stale=!0),a=v.inspect(a,e).split("\n").join("\n  "),n+=r+" => "+a}),(c||o)&&(n+="\n"),n+="}"},o.prototype.set=function(t,e,n){var i=(n=n||r(this,"maxAge"))?Date.now():0,o=r(this,"lengthCalculator").call(this,e,t);if(r(this,"cache").has(t)){if(o>r(this,"max"))return c(this,r(this,"cache").get(t)),!1;var a=r(this,"cache").get(t).value;return r(this,"dispose")&&r(this,"dispose").call(this,t,a.value),a.now=i,a.maxAge=n,a.value=e,r(this,"length",r(this,"length")+(o-a.length)),a.length=o,this.get(t),l(this),!0}var s=new f(t,e,o,i,n);return s.length>r(this,"max")?(r(this,"dispose")&&r(this,"dispose").call(this,t,e),!1):(r(this,"length",r(this,"length")+s.length),r(this,"lruList").unshift(s),r(this,"cache").set(t,r(this,"lruList").head),l(this),!0)},o.prototype.has=function(t){return!!r(this,"cache").has(t)&&!u(this,r(this,"cache").get(t).value)},o.prototype.get=function(t){return s(this,t,!0)},o.prototype.peek=function(t){return s(this,t,!1)},o.prototype.pop=function(){var t=r(this,"lruList").tail;return t?(c(this,t),t.value):null},o.prototype.del=function(t){c(this,r(this,"cache").get(t))},o.prototype.load=function(t){this.reset();for(var e=Date.now(),n=t.length-1;n>=0;n--){var r=t[n],i=r.e||0;if(0===i)this.set(r.k,r.v);else{var o=i-e;o>0&&this.set(r.k,r.v,o)}}},o.prototype.prune=function(){var t=this;r(this,"cache").forEach(function(e,n){s(t,n,!1)})}},{pseudomap:137,util:143,yallist:144}],136:[function(t,e,n){"use strict";function r(){throw new Error("setTimeout has not been defined")}function i(){throw new Error("clearTimeout has not been defined")}function o(t){if(f===setTimeout)return setTimeout(t,0);if((f===r||!f)&&setTimeout)return f=setTimeout,setTimeout(t,0);try{return f(t,0)}catch(e){try{return f.call(null,t,0)}catch(e){return f.call(this,t,0)}}}function a(t){if(h===clearTimeout)return clearTimeout(t);if((h===i||!h)&&clearTimeout)return h=clearTimeout,clearTimeout(t);try{return h(t)}catch(e){try{return h.call(null,t)}catch(e){return h.call(this,t)}}}function s(){d&&v&&(d=!1,v.length?y=v.concat(y):m=-1,y.length&&u())}function u(){if(!d){var t=o(s);d=!0;for(var e=y.length;e;){for(v=y,y=[];++m<e;)v&&v[m].run();m=-1,e=y.length}v=null,d=!1,a(t)}}function l(t,e){this.fun=t,this.array=e}function c(){}var f,h,p=e.exports={};!function(){try{f="function"==typeof setTimeout?setTimeout:r}catch(t){f=r}try{h="function"==typeof clearTimeout?clearTimeout:i}catch(t){h=i}}();var v,y=[],d=!1,m=-1;p.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];y.push(new l(t,e)),1!==y.length||d||o(u)},l.prototype.run=function(){this.fun.apply(null,this.array)},p.title="browser",p.browser=!0,p.env={},p.argv=[],p.version="",p.versions={},p.on=c,p.addListener=c,p.once=c,p.off=c,p.removeListener=c,p.removeAllListeners=c,p.emit=c,p.prependListener=c,p.prependOnceListener=c,p.listeners=function(t){return[]},p.binding=function(t){throw new Error("process.binding is not supported")},p.cwd=function(){return"/"},p.chdir=function(t){throw new Error("process.chdir is not supported")},p.umask=function(){return 0}},{}],137:[function(t,e,n){(function(n){"use strict";"pseudomap"===n.env.npm_package_name&&"test"===n.env.npm_lifecycle_script&&(n.env.TEST_PSEUDOMAP="true"),"function"!=typeof Map||n.env.TEST_PSEUDOMAP?e.exports=t("./pseudomap"):e.exports=Map}).call(this,t("_process"))},{"./pseudomap":138,_process:136}],138:[function(t,e,n){"use strict";function r(t){if(!(this instanceof r))throw new TypeError("Constructor PseudoMap requires 'new'");if(this.clear(),t)if(t instanceof r||"function"==typeof Map&&t instanceof Map)t.forEach(function(t,e){this.set(e,t)},this);else{if(!Array.isArray(t))throw new TypeError("invalid argument");t.forEach(function(t){this.set(t[0],t[1])},this)}}function i(t,e){return t===e||t!==t&&e!==e}function o(t,e,n){this.key=t,this.value=e,this._index=n}function a(t,e){for(var n=0,r="_"+e,o=r;u.call(t,o);o=r+n++)if(i(t[o].key,e))return t[o]}function s(t,e,n){for(var r=0,a="_"+e,s=a;u.call(t,s);s=a+r++)if(i(t[s].key,e))return void(t[s].value=n);t.size++,t[s]=new o(e,n,s)}var u=Object.prototype.hasOwnProperty;e.exports=r,r.prototype.forEach=function(t,e){e=e||this,Object.keys(this._data).forEach(function(n){"size"!==n&&t.call(e,this._data[n].value,this._data[n].key)},this)},r.prototype.has=function(t){return!!a(this._data,t)},r.prototype.get=function(t){var e=a(this._data,t);return e&&e.value},r.prototype.set=function(t,e){s(this._data,t,e)},r.prototype.delete=function(t){var e=a(this._data,t);e&&(delete this._data[e._index],this._data.size--)},r.prototype.clear=function(){var t=Object.create(null);t.size=0,Object.defineProperty(this,"_data",{value:t,enumerable:!1,configurable:!0,writable:!1})},Object.defineProperty(r.prototype,"size",{get:function(){return this._data.size},set:function(t){},enumerable:!0,configurable:!0}),r.prototype.values=r.prototype.keys=r.prototype.entries=function(){throw new Error("iterators are not implemented in this version")}},{}],139:[function(t,e,n){"use strict";function r(t,e,n,a,s){for(n=n||0,a=a||t.length-1,s=s||o;a>n;){if(a-n>600){var u=a-n+1,l=e-n+1,c=Math.log(u),f=.5*Math.exp(2*c/3),h=.5*Math.sqrt(c*f*(u-f)/u)*(l-u/2<0?-1:1);r(t,e,Math.max(n,Math.floor(e-l*f/u+h)),Math.min(a,Math.floor(e+(u-l)*f/u+h)),s)}var p=t[e],v=n,y=a;for(i(t,n,e),s(t[a],p)>0&&i(t,n,a);v<y;){for(i(t,v,y),v++,y--;s(t[v],p)<0;)v++;for(;s(t[y],p)>0;)y--}0===s(t[n],p)?i(t,n,y):i(t,++y,a),y<=e&&(n=y+1),e<=y&&(a=y-1)}}function i(t,e,n){var r=t[e];t[e]=t[n],t[n]=r}function o(t,e){return t<e?-1:t>e?1:0}e.exports=r},{}],140:[function(t,e,n){"use strict";function r(t,e){if(!(this instanceof r))return new r(t,e);this._maxEntries=Math.max(4,t||9),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),e&&this._initFormat(e),this.clear()}function i(t,e,n){if(!n)return e.indexOf(t);for(var r=0;r<e.length;r++)if(n(t,e[r]))return r;return-1}function o(t,e){a(t,0,t.children.length,e,t)}function a(t,e,n,r,i){i||(i=d(null)),i.minX=1/0,i.minY=1/0,i.maxX=-1/0,i.maxY=-1/0;for(var o,a=e;a<n;a++)o=t.children[a],s(i,t.leaf?r(o):o);return i}function s(t,e){return t.minX=Math.min(t.minX,e.minX),t.minY=Math.min(t.minY,e.minY),t.maxX=Math.max(t.maxX,e.maxX),t.maxY=Math.max(t.maxY,e.maxY),t}function u(t,e){return t.minX-e.minX}function l(t,e){return t.minY-e.minY}function c(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function f(t){return t.maxX-t.minX+(t.maxY-t.minY)}function h(t,e){return(Math.max(e.maxX,t.maxX)-Math.min(e.minX,t.minX))*(Math.max(e.maxY,t.maxY)-Math.min(e.minY,t.minY))}function p(t,e){var n=Math.max(t.minX,e.minX),r=Math.max(t.minY,e.minY),i=Math.min(t.maxX,e.maxX),o=Math.min(t.maxY,e.maxY);return Math.max(0,i-n)*Math.max(0,o-r)}function v(t,e){return t.minX<=e.minX&&t.minY<=e.minY&&e.maxX<=t.maxX&&e.maxY<=t.maxY}function y(t,e){return e.minX<=t.maxX&&e.minY<=t.maxY&&e.maxX>=t.minX&&e.maxY>=t.minY}function d(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function m(t,e,n,r,i){for(var o,a=[e,n];a.length;)(n=a.pop())-(e=a.pop())<=r||(o=e+Math.ceil((n-e)/r/2)*r,b(t,o,e,n,i),a.push(e,o,o,n))}e.exports=r;var b=t("quickselect");r.prototype={all:function(){return this._all(this.data,[])},search:function(t){var e=this.data,n=[],r=this.toBBox;if(!y(t,e))return n;for(var i,o,a,s,u=[];e;){for(i=0,o=e.children.length;i<o;i++)a=e.children[i],y(t,s=e.leaf?r(a):a)&&(e.leaf?n.push(a):v(t,s)?this._all(a,n):u.push(a));e=u.pop()}return n},collides:function(t){var e=this.data,n=this.toBBox;if(!y(t,e))return!1;for(var r,i,o,a,s=[];e;){for(r=0,i=e.children.length;r<i;r++)if(o=e.children[r],a=e.leaf?n(o):o,y(t,a)){if(e.leaf||v(t,a))return!0;s.push(o)}e=s.pop()}return!1},load:function(t){if(!t||!t.length)return this;if(t.length<this._minEntries){for(var e=0,n=t.length;e<n;e++)this.insert(t[e]);return this}var r=this._build(t.slice(),0,t.length-1,0);if(this.data.children.length)if(this.data.height===r.height)this._splitRoot(this.data,r);else{if(this.data.height<r.height){var i=this.data;this.data=r,r=i}this._insert(r,this.data.height-r.height-1,!0)}else this.data=r;return this},insert:function(t){return t&&this._insert(t,this.data.height-1),this},clear:function(){return this.data=d([]),this},remove:function(t,e){if(!t)return this;for(var n,r,o,a,s=this.data,u=this.toBBox(t),l=[],c=[];s||l.length;){if(s||(s=l.pop(),r=l[l.length-1],n=c.pop(),a=!0),s.leaf&&-1!==(o=i(t,s.children,e)))return s.children.splice(o,1),l.push(s),this._condense(l),this;a||s.leaf||!v(s,u)?r?(n++,s=r.children[n],a=!1):s=null:(l.push(s),c.push(n),n=0,r=s,s=s.children[0])}return this},toBBox:function(t){return t},compareMinX:u,compareMinY:l,toJSON:function(){return this.data},fromJSON:function(t){return this.data=t,this},_all:function(t,e){for(var n=[];t;)t.leaf?e.push.apply(e,t.children):n.push.apply(n,t.children),t=n.pop();return e},_build:function(t,e,n,r){var i,a=n-e+1,s=this._maxEntries;if(a<=s)return i=d(t.slice(e,n+1)),o(i,this.toBBox),i;r||(r=Math.ceil(Math.log(a)/Math.log(s)),s=Math.ceil(a/Math.pow(s,r-1))),(i=d([])).leaf=!1,i.height=r;var u,l,c,f,h=Math.ceil(a/s),p=h*Math.ceil(Math.sqrt(s));for(m(t,e,n,p,this.compareMinX),u=e;u<=n;u+=p)for(m(t,u,c=Math.min(u+p-1,n),h,this.compareMinY),l=u;l<=c;l+=h)f=Math.min(l+h-1,c),i.children.push(this._build(t,l,f,r-1));return o(i,this.toBBox),i},_chooseSubtree:function(t,e,n,r){for(var i,o,a,s,u,l,f,p;;){if(r.push(e),e.leaf||r.length-1===n)break;for(f=p=1/0,i=0,o=e.children.length;i<o;i++)u=c(a=e.children[i]),(l=h(t,a)-u)<p?(p=l,f=u<f?u:f,s=a):l===p&&u<f&&(f=u,s=a);e=s||e.children[0]}return e},_insert:function(t,e,n){var r=this.toBBox,i=n?t:r(t),o=[],a=this._chooseSubtree(i,this.data,e,o);for(a.children.push(t),s(a,i);e>=0&&o[e].children.length>this._maxEntries;)this._split(o,e),e--;this._adjustParentBBoxes(i,o,e)},_split:function(t,e){var n=t[e],r=n.children.length,i=this._minEntries;this._chooseSplitAxis(n,i,r);var a=this._chooseSplitIndex(n,i,r),s=d(n.children.splice(a,n.children.length-a));s.height=n.height,s.leaf=n.leaf,o(n,this.toBBox),o(s,this.toBBox),e?t[e-1].children.push(s):this._splitRoot(n,s)},_splitRoot:function(t,e){this.data=d([t,e]),this.data.height=t.height+1,this.data.leaf=!1,o(this.data,this.toBBox)},_chooseSplitIndex:function(t,e,n){var r,i,o,s,u,l,f,h;for(l=f=1/0,r=e;r<=n-e;r++)s=p(i=a(t,0,r,this.toBBox),o=a(t,r,n,this.toBBox)),u=c(i)+c(o),s<l?(l=s,h=r,f=u<f?u:f):s===l&&u<f&&(f=u,h=r);return h},_chooseSplitAxis:function(t,e,n){var r=t.leaf?this.compareMinX:u,i=t.leaf?this.compareMinY:l;this._allDistMargin(t,e,n,r)<this._allDistMargin(t,e,n,i)&&t.children.sort(r)},_allDistMargin:function(t,e,n,r){t.children.sort(r);var i,o,u=this.toBBox,l=a(t,0,e,u),c=a(t,n-e,n,u),h=f(l)+f(c);for(i=e;i<n-e;i++)o=t.children[i],s(l,t.leaf?u(o):o),h+=f(l);for(i=n-e-1;i>=e;i--)o=t.children[i],s(c,t.leaf?u(o):o),h+=f(c);return h},_adjustParentBBoxes:function(t,e,n){for(var r=n;r>=0;r--)s(e[r],t)},_condense:function(t){for(var e,n=t.length-1;n>=0;n--)0===t[n].children.length?n>0?(e=t[n-1].children).splice(e.indexOf(t[n]),1):this.clear():o(t[n],this.toBBox)},_initFormat:function(t){var e=["return a"," - b",";"];this.compareMinX=new Function("a","b",e.join(t[0])),this.compareMinY=new Function("a","b",e.join(t[1])),this.toBBox=new Function("a","return {minX: a"+t[0]+", minY: a"+t[1]+", maxX: a"+t[2]+", maxY: a"+t[3]+"};")}}},{quickselect:139}],141:[function(t,e,n){"use strict";"function"==typeof Object.create?e.exports=function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:e.exports=function(t,e){t.super_=e;var n=function(){};n.prototype=e.prototype,t.prototype=new n,t.prototype.constructor=t}},{}],142:[function(t,e,n){"use strict";var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};e.exports=function(t){return t&&"object"===(void 0===t?"undefined":r(t))&&"function"==typeof t.copy&&"function"==typeof t.fill&&"function"==typeof t.readUInt8}},{}],143:[function(t,e,n){(function(e,r){"use strict";function i(t,e){var r={seen:[],stylize:a};return arguments.length>=3&&(r.depth=arguments[2]),arguments.length>=4&&(r.colors=arguments[3]),y(e)?r.showHidden=e:e&&n._extend(r,e),x(r.showHidden)&&(r.showHidden=!1),x(r.depth)&&(r.depth=2),x(r.colors)&&(r.colors=!1),x(r.customInspect)&&(r.customInspect=!0),r.colors&&(r.stylize=o),u(r,t,r.depth)}function o(t,e){var n=i.styles[e];return n?"["+i.colors[n][0]+"m"+t+"["+i.colors[n][1]+"m":t}function a(t,e){return t}function s(t){var e={};return t.forEach(function(t,n){e[t]=!0}),e}function u(t,e,r){if(t.customInspect&&e&&P(e.inspect)&&e.inspect!==n.inspect&&(!e.constructor||e.constructor.prototype!==e)){var i=e.inspect(r,t);return g(i)||(i=u(t,i,r)),i}var o=l(t,e);if(o)return o;var a=Object.keys(e),y=s(a);if(t.showHidden&&(a=Object.getOwnPropertyNames(e)),T(e)&&(a.indexOf("message")>=0||a.indexOf("description")>=0))return c(e);if(0===a.length){if(P(e)){var d=e.name?": "+e.name:"";return t.stylize("[Function"+d+"]","special")}if(w(e))return t.stylize(RegExp.prototype.toString.call(e),"regexp");if(E(e))return t.stylize(Date.prototype.toString.call(e),"date");if(T(e))return c(e)}var m="",b=!1,_=["{","}"];if(v(e)&&(b=!0,_=["[","]"]),P(e)&&(m=" [Function"+(e.name?": "+e.name:"")+"]"),w(e)&&(m=" "+RegExp.prototype.toString.call(e)),E(e)&&(m=" "+Date.prototype.toUTCString.call(e)),T(e)&&(m=" "+c(e)),0===a.length&&(!b||0==e.length))return _[0]+m+_[1];if(r<0)return w(e)?t.stylize(RegExp.prototype.toString.call(e),"regexp"):t.stylize("[Object]","special");t.seen.push(e);var x;return x=b?f(t,e,r,y,a):a.map(function(n){return h(t,e,r,y,n,b)}),t.seen.pop(),p(x,m,_)}function l(t,e){if(x(e))return t.stylize("undefined","undefined");if(g(e)){var n="'"+JSON.stringify(e).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return t.stylize(n,"string")}return b(e)?t.stylize(""+e,"number"):y(e)?t.stylize(""+e,"boolean"):d(e)?t.stylize("null","null"):void 0}function c(t){return"["+Error.prototype.toString.call(t)+"]"}function f(t,e,n,r,i){for(var o=[],a=0,s=e.length;a<s;++a)R(e,String(a))?o.push(h(t,e,n,r,String(a),!0)):o.push("");return i.forEach(function(i){i.match(/^\d+$/)||o.push(h(t,e,n,r,i,!0))}),o}function h(t,e,n,r,i,o){var a,s,l;if(l=Object.getOwnPropertyDescriptor(e,i)||{value:e[i]},l.get?s=l.set?t.stylize("[Getter/Setter]","special"):t.stylize("[Getter]","special"):l.set&&(s=t.stylize("[Setter]","special")),R(r,i)||(a="["+i+"]"),s||(t.seen.indexOf(l.value)<0?(s=d(n)?u(t,l.value,null):u(t,l.value,n-1)).indexOf("\n")>-1&&(s=o?s.split("\n").map(function(t){return"  "+t}).join("\n").substr(2):"\n"+s.split("\n").map(function(t){return"   "+t}).join("\n")):s=t.stylize("[Circular]","special")),x(a)){if(o&&i.match(/^\d+$/))return s;(a=JSON.stringify(""+i)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(a=a.substr(1,a.length-2),a=t.stylize(a,"name")):(a=a.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),a=t.stylize(a,"string"))}return a+": "+s}function p(t,e,n){var r=0;return t.reduce(function(t,e){return r++,e.indexOf("\n")>=0&&r++,t+e.replace(/\u001b\[\d\d?m/g,"").length+1},0)>60?n[0]+(""===e?"":e+"\n ")+" "+t.join(",\n  ")+" "+n[1]:n[0]+e+" "+t.join(", ")+" "+n[1]}function v(t){return Array.isArray(t)}function y(t){return"boolean"==typeof t}function d(t){return null===t}function m(t){return null==t}function b(t){return"number"==typeof t}function g(t){return"string"==typeof t}function _(t){return"symbol"===(void 0===t?"undefined":M(t))}function x(t){return void 0===t}function w(t){return O(t)&&"[object RegExp]"===k(t)}function O(t){return"object"===(void 0===t?"undefined":M(t))&&null!==t}function E(t){return O(t)&&"[object Date]"===k(t)}function T(t){return O(t)&&("[object Error]"===k(t)||t instanceof Error)}function P(t){return"function"==typeof t}function S(t){return null===t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||"symbol"===(void 0===t?"undefined":M(t))||void 0===t}function k(t){return Object.prototype.toString.call(t)}function A(t){return t<10?"0"+t.toString(10):t.toString(10)}function j(){var t=new Date,e=[A(t.getHours()),A(t.getMinutes()),A(t.getSeconds())].join(":");return[t.getDate(),z[t.getMonth()],e].join(" ")}function R(t,e){return Object.prototype.hasOwnProperty.call(t,e)}var M="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},L=/%[sdj%]/g;n.format=function(t){if(!g(t)){for(var e=[],n=0;n<arguments.length;n++)e.push(i(arguments[n]));return e.join(" ")}for(var n=1,r=arguments,o=r.length,a=String(t).replace(L,function(t){if("%%"===t)return"%";if(n>=o)return t;switch(t){case"%s":return String(r[n++]);case"%d":return Number(r[n++]);case"%j":try{return JSON.stringify(r[n++])}catch(t){return"[Circular]"}default:return t}}),s=r[n];n<o;s=r[++n])d(s)||!O(s)?a+=" "+s:a+=" "+i(s);return a},n.deprecate=function(t,i){function o(){if(!a){if(e.throwDeprecation)throw new Error(i);e.traceDeprecation?console.trace(i):console.error(i),a=!0}return t.apply(this,arguments)}if(x(r.process))return function(){return n.deprecate(t,i).apply(this,arguments)};if(!0===e.noDeprecation)return t;var a=!1;return o};var C,D={};n.debuglog=function(t){if(x(C)&&(C=e.env.NODE_DEBUG||""),t=t.toUpperCase(),!D[t])if(new RegExp("\\b"+t+"\\b","i").test(C)){var r=e.pid;D[t]=function(){var e=n.format.apply(n,arguments);console.error("%s %d: %s",t,r,e)}}else D[t]=function(){};return D[t]},n.inspect=i,i.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},i.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},n.isArray=v,n.isBoolean=y,n.isNull=d,n.isNullOrUndefined=m,n.isNumber=b,n.isString=g,n.isSymbol=_,n.isUndefined=x,n.isRegExp=w,n.isObject=O,n.isDate=E,n.isError=T,n.isFunction=P,n.isPrimitive=S,n.isBuffer=t("./support/isBuffer");var z=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];n.log=function(){console.log("%s - %s",j(),n.format.apply(n,arguments))},n.inherits=t("inherits"),n._extend=function(t,e){if(!e||!O(e))return t;for(var n=Object.keys(e),r=n.length;r--;)t[n[r]]=e[n[r]];return t}}).call(this,t("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./support/isBuffer":142,_process:136,inherits:141}],144:[function(t,e,n){"use strict";function r(t){var e=this;if(e instanceof r||(e=new r),e.tail=null,e.head=null,e.length=0,t&&"function"==typeof t.forEach)t.forEach(function(t){e.push(t)});else if(arguments.length>0)for(var n=0,i=arguments.length;n<i;n++)e.push(arguments[n]);return e}function i(t,e){t.tail=new a(e,t.tail,null,t),t.head||(t.head=t.tail),t.length++}function o(t,e){t.head=new a(e,null,t.head,t),t.tail||(t.tail=t.head),t.length++}function a(t,e,n,r){if(!(this instanceof a))return new a(t,e,n,r);this.list=r,this.value=t,e?(e.next=this,this.prev=e):this.prev=null,n?(n.prev=this,this.next=n):this.next=null}e.exports=r,r.Node=a,r.create=r,r.prototype.removeNode=function(t){if(t.list!==this)throw new Error("removing node which does not belong to this list");var e=t.next,n=t.prev;e&&(e.prev=n),n&&(n.next=e),t===this.head&&(this.head=e),t===this.tail&&(this.tail=n),t.list.length--,t.next=null,t.prev=null,t.list=null},r.prototype.unshiftNode=function(t){if(t!==this.head){t.list&&t.list.removeNode(t);var e=this.head;t.list=this,t.next=e,e&&(e.prev=t),this.head=t,this.tail||(this.tail=t),this.length++}},r.prototype.pushNode=function(t){if(t!==this.tail){t.list&&t.list.removeNode(t);var e=this.tail;t.list=this,t.prev=e,e&&(e.next=t),this.tail=t,this.head||(this.head=t),this.length++}},r.prototype.push=function(){for(var t=0,e=arguments.length;t<e;t++)i(this,arguments[t]);return this.length},r.prototype.unshift=function(){for(var t=0,e=arguments.length;t<e;t++)o(this,arguments[t]);return this.length},r.prototype.pop=function(){if(this.tail){var t=this.tail.value;return this.tail=this.tail.prev,this.tail?this.tail.next=null:this.head=null,this.length--,t}},r.prototype.shift=function(){if(this.head){var t=this.head.value;return this.head=this.head.next,this.head?this.head.prev=null:this.tail=null,this.length--,t}},r.prototype.forEach=function(t,e){e=e||this;for(var n=this.head,r=0;null!==n;r++)t.call(e,n.value,r,this),n=n.next},r.prototype.forEachReverse=function(t,e){e=e||this;for(var n=this.tail,r=this.length-1;null!==n;r--)t.call(e,n.value,r,this),n=n.prev},r.prototype.get=function(t){for(var e=0,n=this.head;null!==n&&e<t;e++)n=n.next;if(e===t&&null!==n)return n.value},r.prototype.getReverse=function(t){for(var e=0,n=this.tail;null!==n&&e<t;e++)n=n.prev;if(e===t&&null!==n)return n.value},r.prototype.map=function(t,e){e=e||this;for(var n=new r,i=this.head;null!==i;)n.push(t.call(e,i.value,this)),i=i.next;return n},r.prototype.mapReverse=function(t,e){e=e||this;for(var n=new r,i=this.tail;null!==i;)n.push(t.call(e,i.value,this)),i=i.prev;return n},r.prototype.reduce=function(t,e){var n,r=this.head;if(arguments.length>1)n=e;else{if(!this.head)throw new TypeError("Reduce of empty list with no initial value");r=this.head.next,n=this.head.value}for(var i=0;null!==r;i++)n=t(n,r.value,i),r=r.next;return n},r.prototype.reduceReverse=function(t,e){var n,r=this.tail;if(arguments.length>1)n=e;else{if(!this.tail)throw new TypeError("Reduce of empty list with no initial value");r=this.tail.prev,n=this.tail.value}for(var i=this.length-1;null!==r;i--)n=t(n,r.value,i),r=r.prev;return n},r.prototype.toArray=function(){for(var t=new Array(this.length),e=0,n=this.head;null!==n;e++)t[e]=n.value,n=n.next;return t},r.prototype.toArrayReverse=function(){for(var t=new Array(this.length),e=0,n=this.tail;null!==n;e++)t[e]=n.value,n=n.prev;return t},r.prototype.slice=function(t,e){(e=e||this.length)<0&&(e+=this.length),(t=t||0)<0&&(t+=this.length);var n=new r;if(e<t||e<0)return n;t<0&&(t=0),e>this.length&&(e=this.length);for(var i=0,o=this.head;null!==o&&i<t;i++)o=o.next;for(;null!==o&&i<e;i++,o=o.next)n.push(o.value);return n},r.prototype.sliceReverse=function(t,e){(e=e||this.length)<0&&(e+=this.length),(t=t||0)<0&&(t+=this.length);var n=new r;if(e<t||e<0)return n;t<0&&(t=0),e>this.length&&(e=this.length);for(var i=this.length,o=this.tail;null!==o&&i>e;i--)o=o.prev;for(;null!==o&&i>t;i--,o=o.prev)n.push(o.value);return n},r.prototype.reverse=function(){for(var t=this.head,e=this.tail,n=t;null!==n;n=n.prev){var r=n.prev;n.prev=n.next,n.next=r}return this.head=e,this.tail=t,this}},{}],145:[function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var i=function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Date.now();r(this,t),this.target=e,this.timestamp=n};e.exports=i},{}],146:[function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=function(){function t(e){r(this,t),this.plot=e}return i(t,[{key:"broadcast",value:function(t){var e=this;this.plot.on(t,function(n){for(var r=e.plot.getSortedLayers(),i=r.length-1;i>=0;i--)r[i].isHidden()||r[i].emit(t,n)})}}]),t}();e.exports=o},{}],147:[function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var o,a=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),s=t("./EventType"),u=t("./MouseEvent"),l=function(t){t.getContainer().style.cursor="pointer"},c=function(t){t.getContainer().style.cursor="inherit"},f=function(t,e,n){return new u(t,n.originalEvent,{x:n.pos.x,y:n.pos.y},{x:n.px.x,y:n.px.y},e)},h=function(t,e,n,r){var i=[],o=t.prevMouseover;return r?(o&&o.data!==r&&(o.target.unhighlight(),i.push({type:s.MOUSE_OUT,event:f(o.target,o.data,o)})),i.push({type:s.MOUSE_MOVE,event:f(e,r,n)}),l(t.plot),e.highlight(r),o&&o.data===r||i.push({type:s.MOUSE_OVER,event:f(e,r,n)}),t.prevMouseover=i[i.length-1].event):o&&(c(t.plot),o.target.unhighlight(),i.push({type:s.MOUSE_OUT,event:f(o.target,o.data,o)}),t.prevMouseover=null),i},p=function(t,e,n,r){return r?[{type:s.MOUSE_UP,event:f(e,r,n)}]:[]},v=function(t,e,n,r){return r?[{type:s.MOUSE_DOWN,event:f(e,r,n)}]:[]},y=function(t,e,n,r){var i=n.originalEvent.ctrlKey||n.originalEvent.metaKey;if(r){e.isSelected(r)?i&&e.unselect(r):(i||(t.prevClick.forEach(function(t){t.target.unselectAll()}),t.prevClick=[]),e.select(r,i));var o={type:s.CLICK,event:f(e,r,n)};return t.prevClick.push(o.event),[o]}if(t.prevClick.length>0){if(i)return[];t.prevClick.forEach(function(t){t.target.unselectAll()}),t.prevClick=[]}return[]},d=function(t,e,n,r){return r?[{type:s.DBL_CLICK,event:f(e,r,n)}]:[]},m=(o={},i(o,s.MOUSE_MOVE,h),i(o,s.MOUSE_UP,p),i(o,s.MOUSE_DOWN,v),i(o,s.CLICK,y),i(o,s.DBL_CLICK,d),o),b=function(){function t(e){r(this,t),this.plot=e,this.prevClick=[],this.prevMouseover=null}return a(t,[{key:"delegate",value:function(t){var e=this,n=m[t];if(!n)throw"Delegation for event type "+t+" is not supported";this.plot.on(t,function(t){for(var r=e.plot.getSortedLayers(),i=null,o=null,a=r.length-1;a>=0;a--)if(!r[a].isHidden()&&(i=r[a].pick(t.pos))){o=r[a];break}for(var s=n(e,o,t,i),u=0;u<s.length;u++){var l=s[u];l.event.target.emit(l.type,l.event)}})}}]),t}();e.exports=b},{"./EventType":148,"./MouseEvent":149}],148:[function(t,e,n){"use strict";e.exports={CLICK:"click",DBL_CLICK:"dblclick",MOUSE_DOWN:"mousedown",MOUSE_UP:"mouseup",MOUSE_MOVE:"mousemove",MOUSE_OVER:"mouseover",MOUSE_OUT:"mouseout",PAN_START:"panstart",PAN:"pan",PAN_END:"panend",ZOOM_START:"zoomstart",ZOOM:"zoom",ZOOM_END:"zoomend",FRAME:"frame",RESIZE:"resize",CELL_UPDATE:"cellupdate",REFRESH:"refresh",TILE_REQUEST:"tilerequest",TILE_FAILURE:"tilefailure",TILE_ADD:"tileadd",TILE_DISCARD:"tilediscard",TILE_REMOVE:"tileremove",LOAD:"load"}},{}],149:[function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a=function(t){function e(t,n,o,a){var s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;r(this,e);var u=i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return u.originalEvent=n,u.pos=o,u.px=a,u.data=s,u}return o(e,t),e}(t("./Event"));e.exports=a},{"./Event":145}],150:[function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a=function(t){function e(t,n,o){r(this,e);var a=i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return a.oldSize=n,a.newSize=o,a}return o(e,t),e}(t("./Event"));e.exports=a},{"./Event":145}],151:[function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a=function(t){function e(t,n){r(this,e);var o=i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return o.tile=n,o}return o(e,t),e}(t("./Event"));e.exports=a},{"./Event":145}],152:[function(t,e,n){"use strict";var r=t("./event/EventType");e.exports={CLICK:r.CLICK,DBL_CLICK:r.DBL_CLICK,MOUSE_DOWN:r.MOUSE_DOWN,MOUSE_UP:r.MOUSE_UP,MOUSE_MOVE:r.MOUSE_MOVE,MOUSE_OVER:r.MOUSE_OVER,MOUSE_OUT:r.MOUSE_OUT,PAN_START:r.PAN_START,PAN:r.PAN,PAN_END:r.PAN_END,ZOOM_START:r.ZOOM_START,ZOOM:r.ZOOM,ZOOM_END:r.ZOOM_END,RESIZE:r.RESIZE,FRAME:r.FRAME,REFRESH:r.REFRESH,TILE_REQUEST:r.TILE_REQUEST,TILE_FAILURE:r.TILE_FAILURE,TILE_ADD:r.TILE_ADD,TILE_DISCARD:r.TILE_DISCARD,TILE_REMOVE:r.TILE_REMOVE,CELL_UPDATE:r.CELL_UPDATE,Event:t("./event/Event"),MouseEvent:t("./event/MouseEvent"),ResizeEvent:t("./event/ResizeEvent"),TileEvent:t("./event/TileEvent"),Bounds:t("./geometry/Bounds"),RTree:t("./geometry/RTree"),RTreePyramid:t("./geometry/RTreePyramid"),CircleCollidable:t("./geometry/CircleCollidable"),RectangleCollidable:t("./geometry/RectangleCollidable"),Plot:t("./plot/Plot"),Layer:t("./layer/Layer"),TileLayer:t("./layer/tile/TileLayer"),Overlay:t("./layer/overlay/Overlay"),PointOverlay:t("./layer/overlay/PointOverlay"),LineOverlay:t("./layer/overlay/LineOverlay"),Renderer:t("./renderer/Renderer"),TileRenderer:t("./renderer/tile/TileRenderer"),WebGLTileRenderer:t("./renderer/tile/WebGLTileRenderer"),ImageTileRenderer:t("./renderer/tile/sample/ImageTileRenderer"),InteractiveTileRenderer:t("./renderer/tile/sample/InteractiveTileRenderer"),PointTileRenderer:t("./renderer/tile/sample/PointTileRenderer"),InstancedTileRenderer:t("./renderer/tile/sample/InstancedTileRenderer"),OverlayRenderer:t("./renderer/overlay/OverlayRenderer"),WebGLOverlayRenderer:t("./renderer/overlay/WebGLOverlayRenderer"),PointOverlayRenderer:t("./renderer/overlay/sample/PointOverlayRenderer"),LineOverlayRenderer:t("./renderer/overlay/sample/LineOverlayRenderer"),Shader:t("./webgl/shader/Shader"),Texture:t("./webgl/texture/Texture"),TextureArray:t("./webgl/texture/TextureArray"),VertexAtlas:t("./webgl/vertex/VertexAtlas"),VertexBuffer:t("./webgl/vertex/VertexBuffer"),Browser:t("./util/Browser"),loadBuffer:t("./util/loadBuffer"),loadImage:t("./util/loadImage")}},{"./event/Event":145,"./event/EventType":148,"./event/MouseEvent":149,"./event/ResizeEvent":150,"./event/TileEvent":151,"./geometry/Bounds":153,"./geometry/CircleCollidable":154,"./geometry/RTree":155,"./geometry/RTreePyramid":156,"./geometry/RectangleCollidable":157,"./layer/Layer":158,"./layer/overlay/LineOverlay":159,"./layer/overlay/Overlay":160,"./layer/overlay/PointOverlay":161,"./layer/tile/TileLayer":164,"./plot/Plot":168,"./renderer/Renderer":178,"./renderer/overlay/OverlayRenderer":179,"./renderer/overlay/WebGLOverlayRenderer":180,"./renderer/overlay/sample/LineOverlayRenderer":181,"./renderer/overlay/sample/PointOverlayRenderer":182,"./renderer/tile/TileRenderer":184,"./renderer/tile/WebGLTileRenderer":185,"./renderer/tile/sample/ImageTileRenderer":186,"./renderer/tile/sample/InstancedTileRenderer":187,"./renderer/tile/sample/InteractiveTileRenderer":188,"./renderer/tile/sample/PointTileRenderer":189,"./util/Browser":190,"./util/loadBuffer":191,"./util/loadImage":192,"./webgl/shader/Shader":194,"./webgl/texture/Texture":197,"./webgl/texture/TextureArray":198,"./webgl/vertex/VertexAtlas":199,"./webgl/vertex/VertexBuffer":200}],153:[function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e,n){var r=s;return e<t.left?r|=u:e>t.right&&(r|=l),n<t.bottom?r|=c:n>t.top&&(r|=f),r}function o(t,e,n){for(var r=e.x,o=e.y,a=n.x,s=n.y,h=i(t,r,o),p=i(t,a,s),v=!1,y=!1,d=!1,m=0;m<8;){if(!(h|p)){v=!0;break}if(h&p)break;var b=void 0,g=void 0,_=h||p;_&f?(b=r+(a-r)*(t.top-o)/(s-o),g=t.top):_&c?(b=r+(a-r)*(t.bottom-o)/(s-o),g=t.bottom):_&l?(g=o+(s-o)*(t.right-r)/(a-r),b=t.right):_&u&&(g=o+(s-o)*(t.left-r)/(a-r),b=t.left),_===h?(h=i(t,r=b,o=g),y=!0):(p=i(t,a=b,s=g),d=!0),m++}return v?{a:{x:r,y:o,clipped:y},b:{x:a,y:s,clipped:d}}:null}var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),s=0,u=1,l=2,c=4,f=8,h=function(){function t(e,n,i,o){r(this,t),this.left=e,this.right=n,this.bottom=i,this.top=o}return a(t,[{key:"getWidth",value:function(){return this.right-this.left}},{key:"getHeight",value:function(){return this.top-this.bottom}},{key:"extend",value:function(t){void 0!==t.left&&void 0!==t.right&&void 0!==t.bottom&&void 0!==t.top?(t.left<this.left&&(this.left=t.left),t.right>this.right&&(this.right=t.right),t.bottom<this.bottom&&(this.bottom=t.bottom),t.top>this.top&&(this.top=t.top)):(t.x<this.left&&(this.left=t.x),t.x>this.right&&(this.right=t.x),t.y<this.bottom&&(this.bottom=t.y),t.y>this.top&&(this.top=t.y))}},{key:"getCenter",value:function(){return{x:this.left+this.getWidth()/2,y:this.bottom+this.getHeight()/2}}},{key:"equals",value:function(t){return this.left===t.left&&this.right===t.right&&this.bottom===t.bottom&&this.top===t.top}},{key:"overlaps",value:function(t){return!(this.left>t.right||this.right<t.left||this.top<t.bottom||this.bottom>t.top)}},{key:"intersection",value:function(e){if(this.overlaps(e))return new t(Math.max(this.left,e.left),Math.min(this.right,e.right),Math.max(this.bottom,e.bottom),Math.min(this.top,e.top))}},{key:"clipLine",value:function(t,e){return o(this,t,e)}},{key:"clipPoints",value:function(t){for(var e=[],n=0;n<t.length;n++){var r=t[n];r.x>=this.left&&r.x<=this.right&&r.y>=this.bottom&&r.y<=this.top&&e.push(r)}return e}}]),t}();e.exports=h},{}],154:[function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=function(){function t(e,n,i,o,a,s,u){r(this,t),this.x=e,this.y=n,this.radius=i,this.minX=e+o-i,this.maxX=e+o+i,this.minY=n+a-i,this.maxY=n+a+i,this.tile=s,this.data=u}return i(t,[{key:"testPoint",value:function(t,e){var n=.5*(this.minX+this.maxX)-t,r=.5*(this.minY+this.maxY)-e;return n*n+r*r<=this.radius*this.radius}},{key:"testRectangle",value:function(t,e,n,r){var i=.5*(t+e),o=.5*(n+r),a=.5*(this.minX+this.maxX),s=.5*(this.minY+this.maxY),u=Math.abs(a-t),l=Math.abs(s-n);return!(u>i+this.radius||l>o+this.radius)&&(u<=i||l<=o||Math.pow(2,u-i)+Math.pow(2,l-o)<=this.radius*this.radius)}}]),t}();e.exports=o},{}],155:[function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=t("rbush"),a=t("lodash/defaultTo"),s=function(){function t(e){r(this,t),this.tree=o(a(e.nodeCapacity,32))}return i(t,[{key:"insert",value:function(t){this.tree.load(t)}},{key:"remove",value:function(t){for(var e=this.tree,n=0;n<t.length;n++)e.remove(t[n])}},{key:"searchPoint",value:function(t,e){var n=this.tree.search({minX:t,maxX:t,minY:e,maxY:e});if(0===n.length)return null;for(var r=0;r<n.length;r++){var i=n[r];if(i.testPoint(t,e))return i}return null}},{key:"searchRectangle",value:function(t,e,n,r){var i=this.tree.search({minX:t,maxX:e,minY:n,maxY:r});if(0===i.length)return null;for(var o=0;o<i.length;o++){var a=i[o];if(a.testRectangle(t,e,n,r))return a}return null}}]),t}();e.exports=s},{"lodash/defaultTo":108,rbush:140}],156:[function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=t("lodash/defaultTo"),a=t("./RTree"),s=function(){function t(e){r(this,t),this.trees=new Map,this.collidables=new Map,this.nodeCapacity=o(e.nodeCapacity,32)}return i(t,[{key:"insert",value:function(t,e){return this.trees.has(t.z)||this.trees.set(t.z,new a({nodeCapacity:this.nodeCapacity})),this.trees.get(t.z).insert(e),this.collidables.set(t.hash,e),this}},{key:"remove",value:function(t){var e=this.collidables.get(t.hash);return this.trees.get(t.z).remove(e),this.collidables.delete(t.hash),this}},{key:"searchPoint",value:function(t,e,n,r){var i=Math.round(n),o=this.trees.get(i);if(!o)return null;var a=Math.pow(2,i-n),s=t*r*a,u=e*r*a;return o.searchPoint(s,u)}},{key:"searchRectangle",value:function(t,e,n,r,i,o){var a=Math.round(i),s=this.trees.get(a);if(!s)return null;var u=Math.pow(2,a-i),l=t*o*u,c=e*o*u,f=n*o*u,h=r*o*u;return s.searchRectangle(l,c,f,h)}}]),t}();e.exports=s},{"./RTree":155,"lodash/defaultTo":108}],157:[function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=function(){function t(e,n,i,o,a,s,u,l){r(this,t),this.minX=e+a,this.maxX=n+a,this.minY=i+s,this.maxY=o+s,this.tile=u,this.data=l}return i(t,[{key:"testPoint",value:function(t,e){return!0}},{key:"testRectangle",value:function(t,e,n,r){return!0}}]),t}();e.exports=o},{}],158:[function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),s=t("lodash/clamp"),u=t("lodash/defaultTo"),l=t("events"),c=t("../event/Event"),f=t("../event/EventType"),h=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r(this,e);var n=i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return n.opacity=u(t.opacity,1),n.hidden=u(t.hidden,!1),n.zIndex=u(t.zIndex,0),n.renderer=u(t.renderer,null),n.highlighted=null,n.selected=[],n.plot=null,n}return o(e,t),a(e,[{key:"onAdd",value:function(t){if(!t)throw"No plot argument provided";return this.plot=t,this.plot.setDirty(),this.renderer&&this.renderer.onAdd(this),this}},{key:"onRemove",value:function(t){if(!t)throw"No plot argument provided";return this.renderer&&this.renderer.onRemove(this),this.clear(),this.plot.setDirty(),this.plot=null,this}},{key:"setRenderer",value:function(t){if(!t)throw"No renderer argument provided";return this.renderer&&this.plot&&this.renderer.onRemove(this),this.renderer=t,this.plot&&this.renderer.onAdd(this),this}},{key:"removeRenderer",value:function(){if(!this.renderer)throw"No renderer is currently attached to the layer";return this.plot&&this.renderer.onRemove(this),this.renderer=null,this}},{key:"getRenderer",value:function(){return this.renderer}},{key:"setOpacity",value:function(t){return t=s(t,0,1),this.opacity!==t&&(this.opacity=t,this.plot&&this.plot.setDirty()),this}},{key:"getOpacity",value:function(){return this.opacity}},{key:"setZIndex",value:function(t){return this.zIndex!==t&&(this.zIndex=t,this.plot&&this.plot.setDirty()),this}},{key:"getZIndex",value:function(){return this.zIndex}},{key:"show",value:function(){return this.hidden&&(this.hidden=!1,this.plot&&this.plot.setDirty()),this}},{key:"hide",value:function(){return this.hidden||(this.hidden=!0,this.renderer&&this.renderer.clear(),this.plot&&this.plot.setDirty()),this}},{key:"isHidden",value:function(){return this.hidden}},{key:"pick",value:function(t){return this.renderer?this.renderer.pick(t):null}},{key:"highlight",value:function(t){return this.highlighted!==t&&(this.highlighted=t,this.plot&&this.plot.setDirty()),this}},{key:"unhighlight",value:function(){return null!==this.highlighted&&(this.highlighted=null,this.plot&&this.plot.setDirty()),this}},{key:"getHighlighted",value:function(){return this.highlighted}},{key:"isHighlighted",value:function(t){return this.highlighted===t}},{key:"select",value:function(t,e){var n=!1;return e?-1===this.selected.indexOf(t)&&(this.selected.push(t),n=!0):1===this.selected.length&&this.selected[0]===t||(this.selected=[t],n=!0),this.plot&&n&&this.plot.setDirty(),this}},{key:"unselect",value:function(t){var e=this.selected.indexOf(t);return-1!==e&&(this.selected.splice(e,1),this.plot&&this.plot.setDirty()),this}},{key:"unselectAll",value:function(){return this.selected.length>0&&(this.selected=[],this.plot&&this.plot.setDirty()),this}},{key:"getSelected",value:function(){return this.selected}},{key:"isSelected",value:function(t){return-1!==this.selected.indexOf(t)}},{key:"draw",value:function(t){return this.renderer&&this.renderer.draw(t),this}},{key:"clear",value:function(){return(this.highlighted||this.selected.length>0)&&(this.highlighted=null,this.selected=[]),this.renderer&&this.renderer.clear(),this.plot&&this.plot.setDirty(),this}},{key:"refresh",value:function(){return this.clear(),this.emit(f.REFRESH,new c(this)),this}}]),e}(l);e.exports=h},{"../event/Event":145,"../event/EventType":148,events:1,"lodash/clamp":106,"lodash/defaultTo":108}],159:[function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),s=function(t,e){var n=[];return e.forEach(function(e){for(var r=[],i=1;i<e.length;i++){var o=e[i-1],a=e[i],s=t.bounds.clipLine(o,a);s&&(r.push(t.project(s.a)),(s.b.clipped||i===e.length-1)&&(r.push(t.project(s.b)),n.push(r),r=[]))}r.length>0&&n.push(r)}),n},u=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r(this,e);var n=i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.polylines=new Map,n}return o(e,t),a(e,[{key:"addPolyline",value:function(t,e){return this.polylines.set(t,e),this.plot&&this.refresh(),this}},{key:"removePolyline",value:function(t){return this.polylines.delete(t),this.plot&&this.refresh(),this}},{key:"clearPolylines",value:function(){return this.clear(),this.polylines=new Map,this.plot&&this.refresh(),this}},{key:"clipGeometry",value:function(t){return s(t,this.polylines)}}]),e}(t("./Overlay"));e.exports=u},{"./Overlay":160}],160:[function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),s=function t(e,n,r){null===e&&(e=Function.prototype);var i=Object.getOwnPropertyDescriptor(e,n);if(void 0===i){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,r)}if("value"in i)return i.value;var a=i.get;if(void 0!==a)return a.call(r)},u=t("../../event/EventType"),l=t("../Layer"),c=Symbol(),f=Symbol(),h=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r(this,e);var n=i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n[f]=null,n[c]=null,n}return o(e,t),a(e,[{key:"onAdd",value:function(t){var n=this;return s(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"onAdd",this).call(this,t),this.refresh(),this[c]=function(){n.refresh()},this.plot.on(u.CELL_UPDATE,this[c]),this}},{key:"onRemove",value:function(t){return this[f]=null,this.plot.removeListener(u.CELL_UPDATE,this[c]),this[c]=null,s(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"onRemove",this).call(this,t),this}},{key:"enable",value:function(){return this.show(),this}},{key:"disable",value:function(){return this.hide(),this}},{key:"isDisabled",value:function(){return this.isHidden()}},{key:"refresh",value:function(){return this.plot&&(this[f]=this.clipGeometry(this.plot.cell)),s(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"refresh",this).call(this),this}},{key:"clipGeometry",value:function(t){throw"`clipGeometry` must be overridden"}},{key:"getClippedGeometry",value:function(){return this[f]}}]),e}(l);e.exports=h},{"../../event/EventType":148,"../Layer":158}],161:[function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),s=function(t,e){var n=[];return e.forEach(function(e){for(var r=t.bounds.clipPoints(e),i=0;i<r.length;i++)n.push(t.project(r[i]))}),n},u=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r(this,e);var n=i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.points=new Map,n}return o(e,t),a(e,[{key:"addPoints",value:function(t,e){return this.points.set(t,e),this.plot&&this.refresh(),this}},{key:"removePoints",value:function(t){return this.points.delete(t),this.plot&&this.refresh(),this}},{key:"clearPoints",value:function(){return this.clear(),this.points=new Map,this.plot&&this.refresh(),this}},{key:"clipGeometry",value:function(t){return s(t,this.points)}}]),e}(t("./Overlay"));e.exports=u},{"./Overlay":160}],162:[function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var i=Math.pow(2,53)-1,o=1,a=function(){return o=(o+1)%i},s=function t(e){r(this,t),this.coord=e,this.uid=a(),this.data=null,this.err=null};e.exports=s},{}],163:[function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=function(t,e){return(t%e+e)%e},a=function(){function t(e,n,i){r(this,t),this.z=e,this.x=n,this.y=i,this.hash=this.z+":"+this.x+":"+this.y}return i(t,[{key:"xyz",value:function(){var t=Math.pow(2,this.z);return this.z+"/"+this.x+"/"+(t-1-this.y)}},{key:"tms",value:function(){return this.z+"/"+this.x+"/"+this.y}},{key:"equals",value:function(t){return this.z===t.z&&this.x===t.x&&this.y===t.y}},{key:"getAncestor",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,n=Math.pow(2,e);return new t(this.z-e,Math.floor(this.x/n),Math.floor(this.y/n))}},{key:"getDescendants",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,n=Math.pow(2,e),r=new Array(n*n),i=0;i<n;i++)for(var o=i*n,a=0;a<n;a++)r[o+a]=new t(this.z+e,this.x*n+i,this.y*n+a);return r}},{key:"isAncestorOf",value:function(t){if(this.z>=t.z)return!1;var e=t.z-this.z,n=Math.pow(2,e),r=Math.floor(t.x/n);if(this.x!==r)return!1;var i=Math.floor(t.y/n);return this.y===i}},{key:"isDescendantOf",value:function(t){return t.isAncestorOf(this)}},{key:"normalize",value:function(){var e=Math.pow(2,this.z);return new t(this.z,o(this.x,e),o(this.y,e))}},{key:"getPosition",value:function(){var t=Math.pow(2,this.z);return{x:this.x/t,y:this.y/t}}},{key:"getCenter",value:function(){var t=Math.pow(2,this.z);return{x:(this.x+.5)/t,y:(this.y+.5)/t}}}]),t}();e.exports=a},{}],164:[function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),s=function t(e,n,r){null===e&&(e=Function.prototype);var i=Object.getOwnPropertyDescriptor(e,n);if(void 0===i){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,r)}if("value"in i)return i.value;var a=i.get;if(void 0!==a)return a.call(r)},u=t("lodash/defaultTo"),l=t("../Layer"),c=t("./TilePyramid"),f=function(t){var e=t.plot.getTargetVisibleCoords();t.requestTiles(e)},h=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r(this,e);var n=i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.muted=u(t.muted,!1),n.pyramid=new c(n,t),n}return o(e,t),a(e,[{key:"onAdd",value:function(t){return s(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"onAdd",this).call(this,t),this.isMuted()||f(this),this}},{key:"onRemove",value:function(t){return this.pyramid.clear(),s(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"onRemove",this).call(this,t),this}},{key:"getPyramid",value:function(){return this.pyramid}},{key:"hide",value:function(){return s(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"hide",this).call(this),this}},{key:"mute",value:function(){return this.muted=!0,this}},{key:"unmute",value:function(){return this.isMuted()&&(this.muted=!1,this.plot&&f(this)),this}},{key:"isMuted",value:function(){return this.muted}},{key:"enable",value:function(){return this.show(),this.unmute(),this}},{key:"disable",value:function(){return this.hide(),this.mute(),this}},{key:"isDisabled",value:function(){return this.isMuted()&&this.isHidden()}},{key:"refresh",value:function(){return this.pyramid.clear(),this.plot&&!this.isMuted()&&f(this),s(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"refresh",this).call(this),this}},{key:"requestTile",value:function(t,e){e(null,null)}},{key:"requestTiles",value:function(t){return this.isMuted()?this:(this.pyramid.requestTiles(t),this)}}]),e}(l);e.exports=h},{"../Layer":158,"./TilePyramid":166,"lodash/defaultTo":108}],165:[function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=function(){function t(e,n,i){r(this,t),this.target=e,this.tile=n,this.relative=i}return i(t,null,[{key:"fromTile",value:function(e){return new t(e,e,null)}},{key:"fromAncestor",value:function(e,n,r){return new t(e,n,r)}},{key:"fromDescendant",value:function(e,n){return new t(e,n,null)}}]),t}();e.exports=o},{}],166:[function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=t("lodash/defaultTo"),a=t("lodash/throttle"),s=t("lru-cache"),u=t("../../event/EventType"),l=t("../../event/TileEvent"),c=t("./Tile"),f=t("./TilePartial"),h=256,p=4,v=200,y=function(t,e){if(e.coord.z<t.numPersistentLevels){if(t.persistents.has(e.coord.hash))throw"Tile of coord "+e.coord.hash+" already exists in the pyramid";t.persistents.set(e.coord.hash,e)}else{if(t.tiles.has(e.coord.hash))throw"Tile of coord "+e.coord.hash+" already exists in the pyramid";t.tiles.set(e.coord.hash,e)}t.levels.has(e.coord.z)||t.levels.set(e.coord.z,[]),t.levels.get(e.coord.z).push(e),t.layer.emit(u.TILE_ADD,new l(t.layer,e))},d=function(t,e){if(e.coord.z<t.numPersistentLevels){if(!t.persistents.has(e.coord.hash))throw"Tile of coord "+e.coord.hash+" does not exists in the pyramid";t.persistents.delete(e.coord.hash)}var n=t.levels.get(e.coord.z);n.splice(n.indexOf(e),1),0===n.length&&t.levels.delete(e.coord.z),t.layer.emit(u.TILE_REMOVE,new l(t.layer,e))},m=function(t){return 1/3*(Math.pow(4,t)-1)},b=function(t){0===t.pending.size&&t.emitLoad(new l(t.layer,null))},g=function(t,e){var n=t.getTargetViewportCenter();return e.sort(function(t,e){var r=t.coord.getCenter(),i=e.coord.getCenter(),o=n.x-r.x,a=n.y-r.y,s=n.x-i.x,u=n.y-i.y;return o*o+a*a-(s*s+u*u)}),e},_=function(t){var e=new Map;return t.filter(function(t){var n=t.ncoord.hash;return!e.has(n)&&e.set(n,!0)})},x=function(t,e){return e.filter(function(e){return!t.get(e.ncoord)&&!t.isPending(e.ncoord)})},w=function(t,e){var n=e.coord.hash,r=t.stale.get(n);r||(r=new Map,t.stale.set(n,r)),r.set(e.uid,!0)},O=function(t,e){var n=e.coord.hash,r=t.stale.get(n);return!(!r||!r.has(e.uid))&&(r.delete(e.uid),0===r.size&&t.stale.delete(n),!0)},E=function(t,e){var n=t.layer.plot;return!n||!n.getTargetViewport().isInView(e.coord,n.wraparound)},T=function(){function t(e){var n=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(r(this,t),!e)throw"No layer parameter provided";this.cacheSize=o(i.cacheSize,h),this.numPersistentLevels=o(i.numPersistentLevels,p),this.layer=e,this.levels=new Map,this.persistents=new Map,this.pending=new Map,this.stale=new Map,this.tiles=new s({max:this.cacheSize,dispose:function(t,e){d(n,e)}}),this.emitLoad=a(function(t){n.layer.emit(u.LOAD,t)},v)}return i(t,[{key:"getCapacity",value:function(){return this.cacheSize+m(this.numPersistentLevels)}},{key:"clear",value:function(){var t=this;this.pending.forEach(function(e){w(t,e)}),this.pending=new Map,this.persistents.forEach(function(e){d(t,e)}),this.persistents.clear(),this.tiles.reset()}},{key:"has",value:function(t){return t.z<this.numPersistentLevels?this.persistents.has(t.hash):this.tiles.has(t.hash)}},{key:"forEach",value:function(t){this.persistents.forEach(t),this.tiles.forEach(t)}},{key:"isPending",value:function(t){return this.pending.has(t.hash)}},{key:"get",value:function(t){return t.z<this.numPersistentLevels?this.persistents.get(t.hash):this.tiles.get(t.hash)}},{key:"getAncestor",value:function(t,e){var n=t.getAncestor(e);return this.get(n)}},{key:"getDescendants",value:function(t,e){for(var n=t.getDescendants(e),r=!1,i=0;i<n.length;i++)if(this.has(n[i])){r=!0;break}if(r){for(var o=new Array(n.length),a=0;a<n.length;a++){var s=n[a];o[a]=this.get(s)||s}return o}}},{key:"requestTiles",value:function(t){var e=this,n=t.map(function(t){return{coord:t,ncoord:t.normalize()}});n=_(n),n=x(this,n);for(var r=(n=g(this.layer.plot,n)).map(function(t){var n=new c(t.ncoord);return e.pending.set(n.coord.hash,n),n}),i=0;i<r.length;i++)!function(t){var n=r[t];e.layer.emit(u.TILE_REQUEST,new l(e.layer,n)),e.layer.requestTile(n.coord,function(t,r){var i=O(e,n);return i||e.pending.delete(n.coord.hash),null!==t?(n.err=t,e.layer.emit(u.TILE_FAILURE,new l(e.layer,n)),void(i||b(e))):(n.data=r,i||E(e,n)?(e.layer.emit(u.TILE_DISCARD,new l(e.layer,n)),void(i||b(e))):(y(e,n),b(e),void e.layer.plot.setDirty()))})}(i)}},{key:"getAvailableLOD",value:function(t){var e=this.get(t);if(e)return[f.fromTile(e)];var n=t.z,r=[];this.levels.forEach(function(t,e){e!==n&&r.push(e)}),r.sort(function(t,e){return(t>n?t-n:n-t-.5)-(e>n?e-n:n-e-.5)});for(var i=[],o=[],a=t,s=r.shift();void 0!==a&&void 0!==s;){if(s<a.z){var u=a.z-s,l=this.getAncestor(a,u);if(l){i.push(f.fromAncestor(t,l,a)),a=o.shift();continue}}else if(s-n<4){var c=s-a.z,h=this.getDescendants(a,c);if(h){for(var p=0;p<h.length;p++){var v=h[p];v.coord?i.push(f.fromDescendant(t,v)):o.push(v)}a=o.shift()}}s=r.shift()}return i.length>0?i:void 0}}]),t}();e.exports=T},{"../../event/EventType":148,"../../event/TileEvent":151,"./Tile":162,"./TilePartial":165,"lodash/defaultTo":108,"lodash/throttle":132,"lru-cache":135}],167:[function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=t("../geometry/Bounds"),a=Math.pow(2,16)/2,s=function(){function t(e,n,i){r(this,t);var s=a/i,u={x:n.x-s,y:n.y-s};this.zoom=e,this.halfSize=s,this.center=n,this.offset=u,this.extent=i,this.bounds=new o(n.x-s,n.x+s,n.y-s,n.y+s)}return i(t,[{key:"project",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.zoom,n=Math.pow(2,e-this.zoom)*this.extent;return{x:(t.x-this.offset.x)*n,y:(t.y-this.offset.y)*n}}},{key:"unproject",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.zoom,n=Math.pow(2,e-this.zoom)*this.extent;return{x:t.x/n+this.offset.x,y:t.y/n+this.offset.y}}}]),t}();e.exports=s},{"../geometry/Bounds":153}],168:[function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),s=t("lodash/clamp"),u=t("lodash/defaultTo"),l=t("lodash/throttle"),c=t("events"),f=t("../event/EventType"),h=t("../event/EventBroadcaster"),p=t("../event/EventDelegator"),v=t("../event/Event"),y=t("../event/ResizeEvent"),d=t("../webgl/RenderBuffer"),m=t("./handler/ClickHandler"),b=t("./handler/MouseHandler"),g=t("./handler/PanHandler"),_=t("./handler/ZoomHandler"),x=t("./Cell"),w=t("./Viewport"),O=100,E=200,T=400,P=24,S=Symbol(),k=Symbol(),A=Symbol(),j=Symbol(),R=Symbol(),M=Symbol(),L=Symbol(),C=Symbol(),D=function(){var t=this.getTargetVisibleCoords();return this.layers.forEach(function(e){e.requestTiles&&e.requestTiles(t)}),this},z=function(t){var e={width:t.container.offsetWidth,height:t.container.offsetHeight},n=t.getViewportPixelSize(),r=t.viewport.getCenter();if(n.width!==e.width||n.height!==e.height||t.pixelRatio!==window.devicePixelRatio){t.pixelRatio=window.devicePixelRatio,t.canvas.style.width=e.width+"px",t.canvas.style.height=e.height+"px",t.canvas.width=e.width*t.pixelRatio,t.canvas.height=e.height*t.pixelRatio,t.renderBuffer.resize(e.width*t.pixelRatio,e.height*t.pixelRatio);var i=t.getPixelExtent();t.viewport.width=e.width/i,t.viewport.height=e.height/i,t.viewport.centerOn(r),t.resizeRequest(),t.setDirty(),t.emit(f.RESIZE,new y(t,n,e))}},U=function(t){var e=t.getTargetZoom(),n=t.getTargetViewportCenter(),r=t.getTargetPixelExtent(),i=t.getViewportPixelSize(),o=new x(e,n,r),a=!1;if(t.cell)if(Math.abs(t.cell.zoom-o.zoom)>=1)a=!0;else{var s=t.cell.halfSize-i.width/t.cell.extent,u=t.cell.halfSize-i.height/t.cell.extent;(Math.abs(o.center.x-t.cell.center.x)>s||Math.abs(o.center.y-t.cell.center.y)>u)&&(a=!0)}else a=!0;a&&(t.cell=o,t.emit(f.CELL_UPDATE,new v(o)))},I=function(t){if(t.wraparound){var e=Math.ceil(t.viewport.width/1);t.viewport.x>1&&(t.viewport.x-=e,t.isPanning()&&(t.panAnimation.start.x-=e)),t.viewport.x+t.viewport.width<0&&(t.viewport.x+=e,t.isPanning()&&(t.panAnimation.start.x+=e))}},B=function t(e){var n=Date.now();if(e.emit(f.FRAME,new v(e,n)),z(e),!e.dirtyChecking||e.isDirty()){e.clearDirty(),e.isZooming()&&e.zoomAnimation.update(n)&&(e.zoomAnimation=null),e.isPanning()&&(e.panAnimation.update(n)&&(e.panAnimation=null),e.panRequest()),I(e),U(e);var r=e.getRenderingContext();r.clearColor(0,0,0,0),r.clear(r.COLOR_BUFFER_BIT);var i=e.getViewportPixelSize();r.viewport(0,0,i.width*e.pixelRatio,i.height*e.pixelRatio),e.getSortedLayers().forEach(function(t){t.isHidden()||t.draw(n)})}e.frameRequest=requestAnimationFrame(function(){t(e)})},N=function(t){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};r(this,e);var o=i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));if(o.container=document.querySelector(t),!o.container)throw"Element could not be found for selector "+t;if(o.pixelRatio=window.devicePixelRatio,o.canvas=document.createElement("canvas"),o.canvas.style.width=o.container.offsetWidth+"px",o.canvas.style.height=o.container.offsetHeight+"px",o.canvas.width=o.container.offsetWidth*o.pixelRatio,o.canvas.height=o.container.offsetHeight*o.pixelRatio,o.container.appendChild(o.canvas),o.ctx=o.canvas.getContext("webgl",n.contextAttributes),!o.ctx)throw"Unable to create a WebGLRenderingContext, please ensure your browser supports WebGL";o.renderBuffer=new d(o.ctx,o.canvas.width,o.canvas.height),o.tileSize=u(n.tileSize,256),o.minZoom=u(n.minZoom,0),o.maxZoom=u(n.maxZoom,P),o.zoom=u(n.zoom,0),o.zoom=s(o.zoom,o.minZoom,o.maxZoom);var a=Math.pow(2,o.zoom),c=o.canvas.offsetWidth/a,v=o.canvas.offsetHeight/a;o.viewport=new w(0,0,c,v);var y=u(n.center,{x:.5,y:.5});o.viewport.centerOn(y),o.cell=null,U(o),o.wraparound=u(n.wraparound,!1);var x=u(n.panThrottle,O),z=u(n.resizeThrottle,E),I=u(n.zoomThrottle,T);return o.panRequest=l(D,x,{leading:!1}),o.resizeRequest=l(D,z,{leading:!1}),o.zoomRequest=l(D,I,{leading:!1}),o.layers=[],o.frameRequest=null,o[R]=new Map,o[R].set(S,new m(o,n)),o[R].set(k,new b(o,n)),o[R].set(A,new g(o,n)),o[R].set(j,new _(o,n)),o[R].forEach(function(t){t.enable()}),o[M]=new p(o),o[M].delegate(f.CLICK),o[M].delegate(f.DBL_CLICK),o[M].delegate(f.MOUSE_MOVE),o[M].delegate(f.MOUSE_UP),o[M].delegate(f.MOUSE_DOWN),o[L]=new h(o),o[L].broadcast(f.ZOOM_START),o[L].broadcast(f.ZOOM),o[L].broadcast(f.ZOOM_END),o[L].broadcast(f.PAN_START),o[L].broadcast(f.PAN),o[L].broadcast(f.PAN_END),o.dirtyChecking=u(n.dirtyChecking,!0),o[C]=!0,B(o),o}return o(e,t),a(e,[{key:"destroy",value:function(){var t=this;return cancelAnimationFrame(this.frameRequest),this.frameRequest=null,this[R].forEach(function(t){t.disable()}),this.layers.forEach(function(e){t.remove(e)}),this.ctx=null,this.container.removeChild(this.canvas),this.canvas=null,this.container=null,this.renderBuffer=null,this}},{key:"setDirty",value:function(){this[C]=!0}},{key:"isDirty",value:function(){return this[C]||this.isPanning()||this.isZooming()}},{key:"clearDirty",value:function(){this[C]=!1}},{key:"add",value:function(t){if(!t)throw"No argument provided";if(-1!==this.layers.indexOf(t))throw"Provided layer is already attached to the plot";return this.layers.push(t),t.onAdd(this),this.setDirty(),this}},{key:"remove",value:function(t){if(!t)throw"No argument provided";var e=this.layers.indexOf(t);if(-1===e)throw"Provided layer is not attached to the plot";return this.layers.splice(e,1),t.onRemove(this),this.setDirty(),this}},{key:"getRenderingContext",value:function(){return this.ctx}},{key:"getSortedLayers",value:function(){return this.layers.sort(function(t,e){return t.getZIndex()-e.getZIndex()})}},{key:"getZoom",value:function(){return this.zoom}},{key:"getTargetZoom",value:function(){return this.isZooming()?this.zoomAnimation.targetZoom:this.zoom}},{key:"getViewport",value:function(){return this.viewport}},{key:"getTargetViewport",value:function(){return this.isZooming()?this.zoomAnimation.targetViewport:this.viewport}},{key:"getViewportPosition",value:function(){return this.viewport.getPosition()}},{key:"getTargetViewportPosition",value:function(){return this.getTargetViewport().getPosition()}},{key:"getViewportCenter",value:function(){return this.viewport.getCenter()}},{key:"getTargetViewportCenter",value:function(){return this.getTargetViewport().getCenter()}},{key:"getViewportCenter",value:function(){return this.viewport.getCenter()}},{key:"getTargetVisibleCoords",value:function(){var t=Math.round(this.getTargetZoom());return this.getTargetViewport().getVisibleCoords(t,this.wraparound)}},{key:"getVisibleCoords",value:function(){var t=Math.round(this.zoom);return this.viewport.getVisibleCoords(t,this.wraparound)}},{key:"getPixelExtent",value:function(){return Math.pow(2,this.zoom)*this.tileSize}},{key:"getTargetPixelExtent",value:function(){return Math.pow(2,this.getTargetZoom())*this.tileSize}},{key:"getViewportPixelSize",value:function(){return this.viewport.getPixelSize(this.zoom,this.tileSize)}},{key:"getTargetViewportPixelSize",value:function(){return this.getTargetViewport().getPixelSize(this.zoom,this.tileSize)}},{key:"getViewportPixelOffset",value:function(){return this.viewport.getPixelOffset(this.zoom,this.tileSize)}},{key:"getTargetViewportPixelOffset",value:function(){return this.getTargetViewport().getPixelOffset(this.zoom,this.tileSize)}},{key:"getOrthoMatrix",value:function(){var t=this.getViewportPixelSize(),e=t.width,n=t.height,r=1/(0-e),i=1/(0-n),o=new Float32Array(16);return o[0]=-2*r,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=-2*i,o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[10]=-1,o[11]=0,o[12]=(0+e)*r,o[13]=(n+0)*i,o[14]=-0,o[15]=1,o}},{key:"panTo",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return this.cancelPan(),this.cancelZoom(),this[R].get(A).panTo(t,e),this.setDirty(),this}},{key:"zoomTo",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return this.cancelPan(),this.cancelZoom(),this[R].get(j).zoomTo(t,e),this.setDirty(),this}},{key:"fitToBounds",value:function(t){var e=this.getTargetZoom(),n=this.getTargetViewport(),r=n.width/t.getWidth(),i=n.height/t.getHeight(),o=Math.min(r,i),a=Math.log2(o)+e;a=s(a,this.minZoom,this.maxZoom),this.continuousZoom||(a=Math.floor(a));var u=t.getCenter();return this.zoomTo(a,!1),this.panTo(u,!1),this.setDirty(),this}},{key:"isPanning",value:function(){return!!this.panAnimation}},{key:"isZooming",value:function(){return!!this.zoomAnimation}},{key:"cancelPan",value:function(){return!!this.isPanning()&&(this.panAnimation.cancel(),this.panAnimation=null,!0)}},{key:"cancelZoom",value:function(){return!!this.isZooming()&&(this.zoomAnimation.cancel(),this.zoomAnimation=null,!0)}},{key:"getHighlighted",value:function(){for(var t=this.layers,e=0;e<t.length;e++){var n=t[e].getHighlighted();if(n)return n}return null}},{key:"isHighlighted",value:function(t){for(var e=this.layers,n=0;n<e.length;n++)if(e[n].isHighlighted(t))return!0;return!1}},{key:"getSelected",value:function(){for(var t=[],e=this.layers,n=0;n<e.length;n++)for(var r=e[n].getSelected(),i=0;i<r.length;i++)t.push(r[i]);return t}},{key:"isSelected",value:function(t){for(var e=this.layers,n=0;n<e.length;n++)if(e[n].isSelected(t))return!0;return!1}},{key:"getContainer",value:function(){return this.container}}]),e}(c);e.exports=N},{"../event/Event":145,"../event/EventBroadcaster":146,"../event/EventDelegator":147,"../event/EventType":148,"../event/ResizeEvent":150,"../webgl/RenderBuffer":193,"./Cell":167,"./Viewport":169,"./handler/ClickHandler":173,"./handler/MouseHandler":175,"./handler/PanHandler":176,"./handler/ZoomHandler":177,events:1,"lodash/clamp":106,"lodash/defaultTo":108,"lodash/throttle":132}],169:[function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=t("../geometry/Bounds"),a=t("../layer/tile/TileCoord"),s=function(t,e,n){var r=t.getTileBounds(e),i=Math.pow(2,e)-1,a=new o(n?-1/0:0,n?1/0:i,0,i);if(r.overlaps(a)){var s=n?r.left:Math.max(0,r.left),u=n?r.right:Math.min(i,r.right),l=Math.max(0,r.bottom),c=Math.min(i,r.top);return new o(s,u,l,c)}},u=function(t,e,n,r){return t<=r&&r<=e||(t>r?r+Math.ceil((t-r)/n)*n<=e:r-Math.ceil((r-e)/n)*n>=t)},l=function(){function t(e,n,i,o){r(this,t),this.x=e,this.y=n,this.width=i,this.height=o}return i(t,[{key:"getTileBounds",value:function(t){var e=1/Math.pow(2,t);return new o(Math.floor(this.x/e),Math.ceil((this.x+this.width)/e)-1,Math.floor(this.y/e),Math.ceil((this.y+this.height)/e)-1)}},{key:"getVisibleCoords",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=s(this,t,e);if(!n)return[];for(var r=[],i=n.left;i<=n.right;i++)for(var o=n.bottom;o<=n.top;o++)r.push(new a(t,i,o));return r}},{key:"isInView",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=s(this,t.z,e);if(!n)return!1;var r=Math.pow(2,t.z);return u(n.left,n.right,r,t.x)&&u(n.bottom,n.top,r,t.y)}},{key:"zoomToPos",value:function(e,n,r){var i=Math.pow(2,n-e),o=this.width/i,a=this.height/i,s={x:(r.x-this.x)/i,y:(r.y-this.y)/i};return new t(r.x-s.x,r.y-s.y,o,a)}},{key:"getPosition",value:function(){return{x:this.x,y:this.y}}},{key:"getCenter",value:function(){return{x:this.x+this.width/2,y:this.y+this.height/2}}},{key:"getPixelSize",value:function(t,e){var n=Math.pow(2,t)*e;return{width:Math.round(this.width*n),height:Math.round(this.height*n)}}},{key:"getPixelOffset",value:function(t,e){var n=Math.pow(2,t)*e;return{x:this.x*n,y:this.y*n}}},{key:"centerOn",value:function(t){this.x=t.x-this.width/2,this.y=t.y-this.height/2}}]),t}();e.exports=l},{"../geometry/Bounds":153,"../layer/tile/TileCoord":163}],170:[function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=function(){function t(e){r(this,t),this.timestamp=Date.now(),this.duration=e.duration,this.plot=e.plot}return i(t,[{key:"getT",value:function(t){return this.duration>0?Math.min(1,(t-this.timestamp)/this.duration):1}},{key:"update",value:function(t){return!0}},{key:"cancel",value:function(){}},{key:"finish",value:function(){}}]),t}();e.exports=o},{}],171:[function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),s=t("../../event/EventType"),u=t("../../event/Event"),l=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r(this,e);var n=i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.start=t.start,n.delta=t.delta,n.end={x:n.start.x+n.delta.x,y:n.start.y+n.delta.y},n.easing=t.easing,n}return o(e,t),a(e,[{key:"update",value:function(t){var e=this.getT(t),n=1-Math.pow(1-e,1/this.easing),r=this.plot;r.viewport.x=this.start.x+this.delta.x*n,r.viewport.y=this.start.y+this.delta.y*n;var i=new u(r);return e<1?(r.emit(s.PAN,i),!1):(r.emit(s.PAN_END,i),!0)}},{key:"cancel",value:function(){var t=this.plot;t.emit(s.PAN_END,new u(t))}},{key:"finish",value:function(){var t=this.plot;t.viewport.x=this.end.x,t.viewport.y=this.end.y,t.emit(s.PAN_END,new u(t))}}]),e}(t("./Animation"));e.exports=l},{"../../event/Event":145,"../../event/EventType":148,"./Animation":170}],172:[function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),s=t("../../event/EventType"),u=t("../../event/Event"),l=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r(this,e);var n=i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.prevZoom=t.prevZoom,n.targetZoom=t.targetZoom,n.prevViewport=t.prevViewport,n.targetViewport=t.targetViewport,n.targetPos=t.targetPos,n}return o(e,t),a(e,[{key:"update",value:function(t){var e=this.getT(t),n=this.targetZoom-this.prevZoom,r=this.prevZoom+n*e,i=this.plot;i.zoom=r,i.viewport=this.prevViewport.zoomToPos(this.prevZoom,i.zoom,this.targetPos);var o=new u(i);return e<1?(i.emit(s.ZOOM,o),!1):(i.emit(s.ZOOM_END,o),!0)}},{key:"cancel",value:function(){var t=this.plot;t.continuousZoom||(t.zoom=Math.round(t.zoom),t.viewport=this.prevViewport.zoomToPos(this.prevZoom,t.zoom,this.targetPos));var e=new u(t);t.emit(s.ZOOM_END,e)}},{key:"finish",value:function(){var t=this.plot;t.zoom=this.targetZoom,t.viewport=this.targetViewport;var e=new u(t);t.emit(s.ZOOM_END,e)}}]),e}(t("./Animation"));e.exports=l},{"../../event/Event":145,"../../event/EventType":148,"./Animation":170}],173:[function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),s=function t(e,n,r){null===e&&(e=Function.prototype);var i=Object.getOwnPropertyDescriptor(e,n);if(void 0===i){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,r)}if("value"in i)return i.value;var a=i.get;if(void 0!==a)return a.call(r)},u=t("../../event/EventType"),l=t("../../event/MouseEvent"),c=function(t,e,n){return new l(e,n,t.mouseToPlot(n),t.mouseToViewPx(n))},f=function(t){function e(t){return r(this,e),i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t))}return o(e,t),a(e,[{key:"enable",value:function(){var t=this;s(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"enable",this).call(this);var n=this.plot,r=null;this.mousedown=function(e){r=t.mouseToViewPx(e)},this.mouseup=function(e){if(r){var i=t.mouseToViewPx(e),o={x:r.x-i.x,y:r.y-i.y};o.x*o.x+o.y*o.y<225&&(n.setDirty(),e.preventDefault(),t.plot.emit(u.CLICK,c(t,n,e))),r=null}},this.dblclick=function(e){n.setDirty(),e.preventDefault(),t.plot.emit(u.DBL_CLICK,c(t,n,e))};var i=n.getContainer();i.addEventListener("mousedown",this.mousedown),i.addEventListener("mouseup",this.mouseup),i.addEventListener("dblclick",this.dblclick)}},{key:"disable",value:function(){s(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"disable",this).call(this);var t=this.plot.getContainer();t.removeEventListener("mousedown",this.mousedown),t.removeEventListener("mouseup",this.mouseup),t.removeEventListener("dblclick",this.dblclick),this.mousedown=null,this.mouseup=null,this.dblclick=null}}]),e}(t("./DOMHandler"));e.exports=f},{"../../event/EventType":148,"../../event/MouseEvent":149,"./DOMHandler":174}],174:[function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=function(){function t(e){r(this,t),this.plot=e,this.enabled=!1}return i(t,[{key:"enable",value:function(){if(this.enabled)throw"Handler is already enabled";this.enable=!0}},{key:"disable",value:function(){if(this.enabled)throw"Handler is already disabled";this.enabled=!1}},{key:"mouseToPlot",value:function(t){var e=this.plot,n=e.getPixelExtent(),r=e.getViewportPixelSize();return{x:e.viewport.x+t.clientX/n,y:e.viewport.y+(r.height-t.clientY)/n}}},{key:"mouseToViewPx",value:function(t){var e=this.plot.getViewportPixelSize();return{x:t.clientX,y:e.height-t.clientY}}},{key:"viewPxToPlot",value:function(t){var e=this.plot.getPixelExtent();return{x:t.x/e,y:t.y/e}}},{key:"plotToViewPx",value:function(t){var e=this.plot.getPixelExtent();return{x:t.x*e,y:t.y*e}}},{key:"isLeftButton",value:function(t){return t.which?1===t.which:0===t.button}},{key:"isMiddleButton",value:function(t){return t.which?2===t.which:1===t.button}},{key:"isRightButton",value:function(t){return t.which?3===t.which:2===t.button}}]),t}();e.exports=o},{}],175:[function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),s=function t(e,n,r){null===e&&(e=Function.prototype);var i=Object.getOwnPropertyDescriptor(e,n);if(void 0===i){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,r)}if("value"in i)return i.value;var a=i.get;if(void 0!==a)return a.call(r)},u=t("../../event/EventType"),l=t("../../event/MouseEvent"),c=function(t,e,n){return new l(e,n,t.mouseToPlot(n),t.mouseToViewPx(n))},f=function(t){function e(t){return r(this,e),i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t))}return o(e,t),a(e,[{key:"enable",value:function(){var t=this;s(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"enable",this).call(this);var n=this.plot;this.mousedown=function(e){n.setDirty(),e.preventDefault(),n.emit(u.MOUSE_DOWN,c(t,n,e))},this.mouseup=function(e){n.setDirty(),e.preventDefault(),n.emit(u.MOUSE_UP,c(t,n,e))},this.mousemove=function(e){n.setDirty(),e.preventDefault(),n.emit(u.MOUSE_MOVE,c(t,n,e))},this.mouseover=function(e){n.setDirty(),e.preventDefault(),n.emit(u.MOUSE_OVER,c(t,n,e))},this.mouseout=function(e){n.setDirty(),e.preventDefault(),n.emit(u.MOUSE_OUT,c(t,n,e))},this.wheel=function(t){n.setDirty(),t.preventDefault()};var r=n.getContainer();r.addEventListener("mousedown",this.mousedown),r.addEventListener("mouseup",this.mouseup),r.addEventListener("mousemove",this.mousemove),r.addEventListener("mouseover",this.mouseover),r.addEventListener("mouseout",this.mouseout),r.addEventListener("wheel",this.wheel)}},{key:"disable",value:function(){s(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"disable",this).call(this);var t=this.plot.getContainer();t.removeEventListener("mousedown",this.mousedown),t.removeEventListener("mouseup",this.mouseup),t.removeEventListener("mousemove",this.mousemove),t.removeEventListener("mouseover",this.mouseover),t.removeEventListener("mouseout",this.mouseout),t.removeEventListener("wheel",this.wheel),this.mousedown=null,this.mouseup=null,this.mousemove=null,this.mouseover=null,this.mouseout=null,this.wheel=null}}]),e}(t("./DOMHandler"));e.exports=f},{"../../event/EventType":148,"../../event/MouseEvent":149,"./DOMHandler":174}],176:[function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),s=function t(e,n,r){null===e&&(e=Function.prototype);var i=Object.getOwnPropertyDescriptor(e,n);if(void 0===i){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,r)}if("value"in i)return i.value;var a=i.get;if(void 0!==a)return a.call(r)},u=t("lodash/defaultTo"),l=t("../animation/PanAnimation"),c=t("../../event/EventType"),f=t("../../event/Event"),h=!0,p=.2,v=3400,y=function(t,e){t.isZooming()||(t.viewport.x+=e.x,t.viewport.y+=e.y,t.panRequest(),t.emit(c.PAN,new f(t)))},d=function(t){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};r(this,e);var o=i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return o.inertia=u(n.inertia,h),o.inertiaEasing=u(n.inertiaEasing,p),o.inertiaDeceleration=u(n.inertiaDeceleration,v),o}return o(e,t),a(e,[{key:"enable",value:function(){var t=this;s(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"enable",this).call(this);var n=this.plot,r=!1,i=null,o=null,a=[],u=[];this.mousedown=function(e){t.isLeftButton(e)&&(r=!0,i=t.mouseToViewPx(e),o=Date.now(),t.inertia&&(n.panAnimation=null,a=[],u=[]))},this.mousemove=function(e){if(r){var s=t.mouseToViewPx(e),l=Date.now();0===a.length&&n.emit(c.PAN_START,new f(n)),t.inertia&&(a.push(s),u.push(l),l-u[0]>50&&(a.shift(),u.shift()));var h={x:i.x-s.x,y:i.y-s.y};y(n,t.viewPxToPlot(h)),o=l,i=s}},this.mouseup=function(e){if(r=!1,!n.isZooming()&&t.isLeftButton(e)&&0!==a.length)if(t.inertia){for(var s=Date.now();s-u[0]>50;)a.shift(),u.shift();if(u.length<2)n.emit(c.PAN_END,new f(n));else{var h=t.inertiaDeceleration,p=t.inertiaEasing,v={x:i.x-a[0].x,y:i.y-a[0].y},y=(o-u[0]||1)/1e3,d={x:v.x*(p/y),y:v.y*(p/y)},m=Math.sqrt(d.x*d.x+d.y*d.y)/(h*p),b={x:Math.round(d.x*(-m/2)),y:Math.round(d.y*(-m/2))};n.panAnimation=new l({plot:n,start:n.getViewportPosition(),delta:t.viewPxToPlot(b),easing:p,duration:1e3*m})}}else n.emit(c.PAN_END,new f(n))},n.getContainer().addEventListener("mousedown",this.mousedown),document.addEventListener("mousemove",this.mousemove),document.addEventListener("mouseup",this.mouseup)}},{key:"disable",value:function(){s(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"disable",this).call(this),this.plot.getContainer().removeEventListener("mousedown",this.mousedown),document.removeEventListener("mousemove",this.mousemove),document.removeEventListener("mouseup",this.mouseup),this.mousedown=null,this.mousemove=null,this.mouseup=null}},{key:"panTo",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=this.plot,r=n.getViewportCenter(),i={x:t.x-r.x,y:t.y-r.y};e?(n.emit(c.PAN_START,new f(n)),n.panAnimation=new l({plot:n,start:n.getViewportPosition(),delta:i,easing:this.inertiaEasing,duration:800})):(n.emit(c.PAN_START,new f(n)),y(n,i),n.emit(c.PAN_END,new f(n)))}}]),e}(t("./DOMHandler"));e.exports=d},{"../../event/Event":145,"../../event/EventType":148,"../animation/PanAnimation":171,"./DOMHandler":174,"lodash/defaultTo":108}],177:[function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),s=function t(e,n,r){null===e&&(e=Function.prototype);var i=Object.getOwnPropertyDescriptor(e,n);if(void 0===i){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,r)}if("value"in i)return i.value;var a=i.get;if(void 0!==a)return a.call(r)},u=t("lodash/clamp"),l=t("lodash/defaultTo"),c=t("../../util/Browser"),f=t("../../event/EventType"),h=t("../../event/Event"),p=t("../animation/ZoomAnimation"),v=t("../Viewport"),y=t("./DOMHandler"),d=300,m=250,b=4,g=100,_=!1,x=Date.now(),w=function(t,e){var n=Date.now(),r=n-x;return x=n,e%4.000244140625!=0&&(Math.abs(e)<4||(!t||0===t.duration)&&r<40)},O=function(t,e,n,r){var i=t/n;return e||(i=t>0?Math.ceil(i):Math.floor(i)),u(i,-r,r)},E=function(t,e,n,r,i){var o=void 0;return o=n?n.targetZoom+t:e+t,u(o,r,i)},T=function(t,e,n,r){var i=E(n,t.zoom,t.zoomAnimation,t.minZoom,t.maxZoom);if(i!==t.getTargetZoom()){var o=t.viewport.zoomToPos(t.zoom,i,e);t.panAnimation=null,r>0&&(t.zoomAnimation=new p({plot:t,duration:r,prevZoom:t.zoom,targetZoom:i,prevViewport:new v(t.viewport.x,t.viewport.y,t.viewport.width,t.viewport.height),targetViewport:o,targetPos:e})),t.emit(f.ZOOM_START,new h(t)),0===r&&(t.zoom=i,t.viewport=o,t.emit(f.ZOOM_END,new h(t))),t.zoomRequest()}},P=function(t,e,n,r,i){if(0!==r){var o=O(r,i,t.deltaPerZoom,t.maxConcurrentZooms),a=t.zoomDuration;i&&w(e.zoomAnimation,r)&&(a=0),T(e,n,o,a)}},S=function(t,e){return 0===e.deltaMode?c.firefox?-e.deltaY/t.pixelRatio:-e.deltaY:1===e.deltaMode?20*-e.deltaY:60*-e.deltaY},k=function(t){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};r(this,e);var o=i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return o.continuousZoom=l(n.continuousZoom,_),o.zoomDuration=l(n.zoomDuration,m),o.maxConcurrentZooms=l(n.maxConcurrentZooms,b),o.deltaPerZoom=l(n.deltaPerZoom,d),o.zoomDebounce=l(n.zoomDebounce,g),o}return o(e,t),a(e,[{key:"enable",value:function(){var t=this;s(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"enable",this).call(this);var n=this.plot,r=0,i=null,o=null;this.dblclick=function(e){var r=t.mouseToPlot(e);T(n,r,1,t.zoomDuration)},this.wheel=function(e){var a=S(n,e);if(t.continuousZoom||!(Math.abs(a)<4)){if(r+=a,t.continuousZoom){var s=t.mouseToPlot(e);P(t,n,s,r,!0),r=0}else o=e,i||(i=setTimeout(function(){var e=t.mouseToPlot(o);P(t,n,e,r,!1),r=0,i=null,o=null},t.zoomDebounce));e.preventDefault(),e.stopPropagation()}};var a=n.getContainer();a.addEventListener("dblclick",this.dblclick),a.addEventListener("wheel",this.wheel)}},{key:"disable",value:function(){s(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"disable",this).call(this);var t=this.plot.getContainer();t.removeEventListener("dblclick",this.dblclick),t.removeEventListener("wheel",this.wheel),this.dblclick=null,this.wheel=null}},{key:"zoomTo",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=this.plot,r=this.plot.getViewportCenter(),i=t-n.zoom;e?T(n,r,i,this.zoomDuration):T(n,r,i,0)}}]),e}(y);e.exports=k},{"../../event/Event":145,"../../event/EventType":148,"../../util/Browser":190,"../Viewport":169,"../animation/ZoomAnimation":172,"./DOMHandler":174,"lodash/clamp":106,"lodash/defaultTo":108}],178:[function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),s=function(t){function e(){return r(this,e),i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this))}return o(e,t),a(e,[{key:"onAdd",value:function(t){return this}},{key:"onRemove",value:function(t){return this}},{key:"pick",value:function(t){return null}},{key:"clear",value:function(){return this}},{key:"draw",value:function(t){return this}}]),e}(t("events"));e.exports=s},{events:1}],179:[function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),s=function(t){function e(){r(this,e);var t=i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return t.overlay=null,t}return o(e,t),a(e,[{key:"onAdd",value:function(t){if(!t)throw"No overlay provided as argument";return this.overlay=t,this}},{key:"onRemove",value:function(t){if(!t)throw"No overlay provided as argument";return this.overlay=null,this}}]),e}(t("../Renderer"));e.exports=s},{"../Renderer":178}],180:[function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),s=function t(e,n,r){null===e&&(e=Function.prototype);var i=Object.getOwnPropertyDescriptor(e,n);if(void 0===i){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,r)}if("value"in i)return i.value;var a=i.get;if(void 0!==a)return a.call(r)},u=t("../../webgl/shader/Shader"),l=t("../../event/EventType"),c=t("./OverlayRenderer"),f=Symbol(),h=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r(this,e);var n=i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.gl=null,n[f]=null,n}return o(e,t),a(e,[{key:"onAdd",value:function(t){var n=this;return s(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"onAdd",this).call(this,t),this.gl=this.overlay.plot.getRenderingContext(),this.refreshBuffers(),this[f]=function(){n.refreshBuffers()},this.overlay.on(l.REFRESH,this[f]),this}},{key:"onRemove",value:function(t){return this.overlay.removeListener(l.REFRESH,this[f]),this[f]=null,this.gl=null,s(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"onRemove",this).call(this,t),this}},{key:"refreshBuffers",value:function(){throw"`refreshBuffers` must be overridden"}},{key:"createShader",value:function(t){return new u(this.gl,t)}},{key:"getOrthoMatrix",value:function(){return this.overlay.plot.getOrthoMatrix()}}]),e}(c);e.exports=h},{"../../event/EventType":148,"../../webgl/shader/Shader":194,"./OverlayRenderer":179}],181:[function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function a(t,e,n,r){var i=e.y-t.y,o=t.x-e.x,a=r.y-n.y,s=n.x-r.x,u=i*s-a*o;if(u>-p&&u<p)return null;var l=i*t.x+o*t.y,c=a*n.x+s*n.y;return{x:(s*l-o*c)/u,y:(i*c-a*l)/u}}function s(t,e,n,r,i,o){var s=_(e,t),u=_(n,e);s=y(s),u=y(u),O(t,e,n)>0&&(s=d(s),u=d(u)),s=b(s),u=b(u),s=v(s,o),u=v(u,o);var l=a(g(s,t),g(s,e),g(u,n),g(u,e)),c=null,f=Number.MAX_VALUE,h=null;l&&(c=_(l,e),f=m(c),h=d(v(c,1/o)));var p=_(t,e),x=m(p),w=_(e,n),E=m(w),P=b(s),S=d(P),k=b(u),A=d(k);f>x||f>E?(r.push(t),r.push(t),r.push(e),i.push(P),i.push(S),i.push(P),r.push(t),r.push(e),r.push(e),i.push(S),i.push(P),i.push(S),T(e,g(e,s),g(e,u),n,r,i),r.push(n),r.push(e),r.push(e),i.push(k),i.push(A),i.push(k),r.push(n),r.push(e),r.push(n),i.push(k),i.push(A),i.push(A)):(r.push(t),r.push(t),r.push(e),i.push(P),i.push(S),i.push(h),r.push(t),r.push(e),r.push(e),i.push(P),i.push(h),i.push(P),r.push(e),r.push(e),r.push(e),i.push(P),i.push({x:0,y:0}),i.push(h),T(e,g(e,s),g(e,u),_(e,c),r,i),r.push(e),r.push(e),r.push(e),i.push({x:0,y:0}),i.push(k),i.push(h),r.push(n),r.push(e),r.push(e),i.push(k),i.push(h),i.push(k),r.push(n),r.push(e),r.push(n),i.push(k),i.push(h),i.push(A))}var u=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),l=function t(e,n,r){null===e&&(e=Function.prototype);var i=Object.getOwnPropertyDescriptor(e,n);if(void 0===i){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,r)}if("value"in i)return i.value;var a=i.get;if(void 0!==a)return a.call(r)},c=t("lodash/defaultTo"),f=t("../../../webgl/vertex/VertexBuffer"),h={vert:"\n\t\tprecision highp float;\n\t\tattribute vec2 aPosition;\n\t\tattribute vec2 aNormal;\n\t\tuniform vec2 uViewOffset;\n\t\tuniform float uScale;\n\t\tuniform float uLineWidth;\n\t\tuniform mat4 uProjectionMatrix;\n\t\tvoid main() {\n\t\t\tvec2 wPosition = (aPosition * uScale) - uViewOffset + aNormal * uLineWidth;\n\t\t\tgl_Position = uProjectionMatrix * vec4(wPosition, 0.0, 1.0);\n\t\t}\n\t\t",frag:"\n\t\tprecision highp float;\n\t\tuniform vec4 uLineColor;\n\t\tuniform float uOpacity;\n\t\tvoid main() {\n\t\t\tgl_FragColor = vec4(uLineColor.rgb, uLineColor.a * uOpacity);\n\t\t}\n\t\t"},p=1e-6,v=function(t,e){return{x:t.x*e,y:t.y*e}},y=function(t){return{x:-t.y,y:t.x}},d=function(t){return{x:-t.x,y:-t.y}},m=function(t){return Math.sqrt(t.x*t.x+t.y*t.y)},b=function(t){var e=Math.sqrt(t.x*t.x+t.y*t.y);return{x:t.x/e,y:t.y/e}},g=function(t,e){return{x:t.x+e.x,y:t.y+e.y}},_=function(t,e){return{x:t.x-e.x,y:t.y-e.y}},x=function(t,e){return v(g(t,e),.5)},w=function(t,e){return t.x===e.x&&t.y===e.y},O=function(t,e,n){return(e.x-t.x)*(n.y-t.y)-(n.x-t.x)*(e.y-t.y)},E=function(t,e){if(t.length<2)throw"A valid polyline must consist of at least 2 points";var n=e/2,r=[],i=[],o=[],a=!1;if(2===t.length)s(t[0],x(t[0],t[1]),t[1],r,i,n);else{if(w(t[0],t[t.length-1])){var u=x(t.shift(),t[0]);t.unshift(u),t.push(u),a=!0}for(var l=0;l<t.length-1;l++)0===l?o.push(t[0]):l===t.length-2?o.push(t[t.length-1]):o.push(x(t[l],t[l+1]));for(var c=1;c<o.length;c++)s(o[c-1],t[c],o[c],r,i,n)}if(!a){var f=t[0],h=t[1],p=y(_(h,f));T(f,g(f,p),_(f,p),h,r,i),f=t[t.length-1],h=t[t.length-2],p=y(_(h,f)),T(f,g(f,p),_(f,p),h,r,i)}return{positions:r,normals:i}},T=function(t,e,n,r,i,o){var a=Math.atan2(n.y-t.y,n.x-t.x),s=Math.atan2(e.y-t.y,e.x-t.x),u=a;s>a?s-a>=Math.PI-p&&(s-=2*Math.PI):a-s>=Math.PI-p&&(a-=2*Math.PI);var l=s-a;if(Math.abs(l)>=Math.PI-p&&Math.abs(l)<=Math.PI+p){var c=_(t,r);0===c.x?c.y>0&&(l=-l):c.x>=-p&&(l=-l)}for(var f=Math.ceil(16*Math.abs(l/Math.PI)),h=l/f,v={x:0,y:0},y=0;y<f;y++){var d={x:Math.cos(u+h*y),y:Math.sin(u+h*y)},m={x:Math.cos(u+h*(1+y)),y:Math.sin(u+h*(1+y))};i.push(t),i.push(t),i.push(t),o.push(v),o.push(d),o.push(m)}},P=function(t,e){for(var n=new Float32Array(4*t.length),r=0;r<t.length;r++){var i=t[r],o=e[r];n[4*r]=i.x,n[4*r+1]=i.y,n[4*r+2]=o.x,n[4*r+3]=o.y}return n},S=function(t,e){var n=t.lineWidth,r=E(e,n),i=P(r.positions,r.normals);return new f(t.gl,i,{0:{size:2,type:"FLOAT",byteOffset:0},1:{size:2,type:"FLOAT",byteOffset:8}},{mode:"TRIANGLES",count:r.positions.length})},k=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r(this,e);var n=i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.lineColor=c(t.lineColor,[1,.4,.1,.8]),n.lineWidth=c(t.lineWidth,2),n.shader=null,n.lines=null,n}return o(e,t),u(e,[{key:"onAdd",value:function(t){return l(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"onAdd",this).call(this,t),this.shader=this.createShader(h),this}},{key:"onRemove",value:function(t){return l(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"onRemove",this).call(this,t),this.shader=null,this}},{key:"refreshBuffers",value:function(){var t=this,e=this.overlay.getClippedGeometry();this.lines=e?e.map(function(e){return S(t,e)}):null}},{key:"draw",value:function(){if(!this.lines)return this;var t=this.gl,e=this.shader,n=this.lines,r=this.overlay.plot,i=r.cell,o=this.getOrthoMatrix(),a=Math.pow(2,r.zoom-i.zoom),s=this.overlay.opacity,u=i.project(r.viewport,r.zoom);return t.enable(t.BLEND),t.blendFunc(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA),e.use(),e.setUniform("uProjectionMatrix",o),e.setUniform("uViewOffset",[u.x,u.y]),e.setUniform("uScale",a),e.setUniform("uLineWidth",this.lineWidth/2),e.setUniform("uLineColor",this.lineColor),e.setUniform("uOpacity",s),n.forEach(function(t){t.bind(),t.draw()}),this}}]),e}(t("../WebGLOverlayRenderer"));e.exports=k},{"../../../webgl/vertex/VertexBuffer":200,"../WebGLOverlayRenderer":180,"lodash/defaultTo":108}],182:[function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),s=function t(e,n,r){null===e&&(e=Function.prototype);var i=Object.getOwnPropertyDescriptor(e,n);if(void 0===i){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,r)}if("value"in i)return i.value;var a=i.get;if(void 0!==a)return a.call(r)},u=t("lodash/defaultTo"),l=t("../../../webgl/vertex/VertexBuffer"),c={vert:"\n\t\tprecision highp float;\n\t\tattribute vec2 aPosition;\n\t\tattribute vec2 aNormal;\n\t\tuniform vec2 uViewOffset;\n\t\tuniform float uScale;\n\t\tuniform float uLineWidth;\n\t\tuniform float uPixelRatio;\n\t\tuniform float uPointRadius;\n\t\tuniform mat4 uProjectionMatrix;\n\t\tvoid main() {\n\t\t\tvec2 wPosition = (aPosition * uScale) - uViewOffset;\n\t\t\tgl_Position = uProjectionMatrix * vec4(wPosition, 0.0, 1.0);\n\t\t\tgl_PointSize = uPointRadius * 2.0 * uPixelRatio;\n\t\t}\n\t\t",frag:"\n\t\t#ifdef GL_OES_standard_derivatives\n\t\t\t#extension GL_OES_standard_derivatives : enable\n\t\t#endif\n\t\tprecision highp float;\n\t\tuniform vec4 uPointColor;\n\t\tuniform float uOpacity;\n\t\tvoid main() {\n\t\t\tvec2 cxy = 2.0 * gl_PointCoord - 1.0;\n\t\t\tfloat radius = dot(cxy, cxy);\n\t\t\tfloat alpha = 1.0;\n\t\t\t#ifdef GL_OES_standard_derivatives\n\t\t\t\tfloat delta = fwidth(radius);\n\t\t\t\talpha = 1.0 - smoothstep(1.0 - delta, 1.0 + delta, radius);\n\t\t\t#else\n\t\t\t\tif (radius > 1.0) {\n\t\t\t\t\tdiscard;\n\t\t\t\t}\n\t\t\t#endif\n\t\t\tgl_FragColor = vec4(uPointColor.rgb, uPointColor.a * alpha * uOpacity);\n\t\t}\n\t\t"},f=function(t){for(var e=new Float32Array(2*t.length),n=0;n<t.length;n++){var r=t[n];e[2*n]=r.x,e[2*n+1]=r.y}return e},h=function(t,e){var n=f(e);return new l(t,n,{0:{size:2,type:"FLOAT"}},{mode:"POINTS",count:e.length})},p=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r(this,e);var n=i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.pointColor=u(t.pointColor,[1,0,1,1]),n.pointRadius=u(t.pointRadius,4),n.shader=null,n.ext=null,n.points=null,n}return o(e,t),a(e,[{key:"onAdd",value:function(t){return s(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"onAdd",this).call(this,t),this.ext=this.gl.getExtension("OES_standard_derivatives"),this.shader=this.createShader(c),this}},{key:"onRemove",value:function(t){return this.shader=null,this.ext=null,this.points=null,s(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"onRemove",this).call(this,t),this}},{key:"refreshBuffers",value:function(){var t=this.overlay.getClippedGeometry();t&&t.length>0?this.points=h(this.gl,t):this.points=null}},{key:"draw",value:function(){if(!this.points)return this;var t=this.gl,e=this.shader,n=this.points,r=this.overlay.plot,i=r.cell,o=this.getOrthoMatrix(),a=Math.pow(2,r.zoom-i.zoom),s=this.overlay.opacity,u=i.project(r.viewport,r.zoom);return t.enable(t.BLEND),t.blendFunc(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA),e.use(),e.setUniform("uProjectionMatrix",o),e.setUniform("uViewOffset",[u.x,u.y]),e.setUniform("uScale",a),e.setUniform("uPointColor",this.pointColor),e.setUniform("uPointRadius",this.pointRadius),e.setUniform("uPixelRatio",r.pixelRatio),e.setUniform("uOpacity",s),n.bind(),n.draw(),this}}]),e}(t("../WebGLOverlayRenderer"));e.exports=p},{"../../../webgl/vertex/VertexBuffer":200,"../WebGLOverlayRenderer":180,"lodash/defaultTo":108}],183:[function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=function(t,e){var n=1/Math.pow(2,e.z-t.z);return[e.x*n-t.x,e.y*n-t.y,n,n]},a=function(){function t(e,n,i,o){r(this,t),this.tile=e,this.hash=e.coord.hash,this.scale=n,this.tileOffset=i,this.uvOffset=o}return i(t,[{key:"toCanvas",value:function(t,e){var n=this.uvOffset;n[1]=1-n[2]-n[1];var r=this.tileOffset;return r[1]=t.height-r[1]-e*this.scale,this}}],[{key:"fromTile",value:function(e,n,r,i,o){var a=r*i;return new t(e,r,[n.x*a-o.x,n.y*a-o.y],[0,0,1,1])}},{key:"fromAncestor",value:function(e,n,r,i,a,s,u){var l=r*i,c=[0,0];if(u===s)c[0]=n.x*l-a.x,c[1]=n.y*l-a.y;else{var f=1/Math.pow(2,u.z-s.z),h=u.x*f-s.x,p=u.y*f-s.y;c[0]=(n.x+h)*l-a.x,c[1]=(n.y+p)*l-a.y,r*=f}return new t(e,r,c,o(e.coord,u))}},{key:"fromDescendant",value:function(e,n,r,i,o,a){var s=r*i,u=1/Math.pow(2,e.coord.z-a.z),l=e.coord.x*u-a.x,c=e.coord.y*u-a.y;return new t(e,r*u,[(n.x+l)*s-o.x,(n.y+c)*s-o.y],[0,0,1,1])}},{key:"fromAncestorPartial",value:function(e,n,r,i,a){var s=e.tile,u=e.target,l=e.relative,c=r*i,f=[0,0];if(l===e.target)f[0]=n.x*c-a.x,f[1]=n.y*c-a.y;else{var h=1/Math.pow(2,l.z-u.z),p=l.x*h-u.x,v=l.y*h-u.y;f[0]=(n.x+p)*c-a.x,f[1]=(n.y+v)*c-a.y,r*=h}return new t(s,r,f,o(s.coord,l))}},{key:"fromDescendantPartial",value:function(e,n,r,i,o){var a=e.tile,s=e.target,u=r*i,l=1/Math.pow(2,a.coord.z-s.z),c=a.coord.x*l-s.x,f=a.coord.y*l-s.y;return new t(a,r*l,[(n.x+c)*u-o.x,(n.y+f)*u-o.y],[0,0,1,1])}}]),t}();e.exports=a},{}],184:[function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),s=t("../../event/EventType"),u=t("../../geometry/RTreePyramid"),l=t("../Renderer"),c=t("./TileRenderable"),f=Symbol(),h=Symbol(),p=function(t){function e(){r(this,e);var t=i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return t[f]=new Map,t[h]=new Map,t.layer=null,t}return o(e,t),a(e,[{key:"onAdd",value:function(t){if(!t)throw"No layer provided as argument";return this.layer=t,this}},{key:"onRemove",value:function(t){if(!t)throw"No layer provided as argument";return this.layer=null,this}},{key:"createRTreePyramid",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.createCollidables;if(!n)throw"`options.createCollidables` argument is missing";var r=new u({nodeCapacity:e.nodeCapacity}),i=function(e){var i=e.tile,o=i.coord,a=t.layer.plot.tileSize,s=o.x*a,u=o.y*a,l=n(i,s,u);r.insert(o,l)},o=function(t){r.remove(t.tile.coord)};return this.layer.on(s.TILE_ADD,i),this.layer.on(s.TILE_REMOVE,o),this[f].set(r,i),this[h].set(r,o),r}},{key:"destroyRTreePyramid",value:function(t){this.layer.removeListener(s.TILE_ADD,this[f].get(t)),this.layer.removeListener(s.TILE_REMOVE,this[h].get(t)),this[f].delete(t),this[h].delete(t)}},{key:"getRenderables",value:function(){for(var t=this.layer.plot,e=this.layer.pyramid,n=t.tileSize,r=t.zoom,i=t.getViewportPixelOffset(),o=t.getVisibleCoords(),a=[],s=0;s<o.length;s++){var u=o[s],l=u.normalize(),f=e.get(l);if(f){var h=Math.pow(2,r-u.z),p=c.fromTile(f,u,h,n,i);a.push(p)}}return a}},{key:"getRenderablesLOD",value:function(){for(var t=this.layer.plot,e=this.layer.pyramid,n=t.tileSize,r=t.zoom,i=t.getViewportPixelOffset(),o=t.getVisibleCoords(),a=[],s=0;s<o.length;s++){var u=o[s],l=u.normalize(),f=Math.pow(2,r-u.z),h=e.getAvailableLOD(l);if(h)for(var p=0;p<h.length;p++){var v=h[p],y=v.tile,d=void 0;d=y.coord.z===u.z?c.fromTile(y,u,f,n,i):y.coord.z<u.z?c.fromAncestorPartial(v,u,f,n,i):c.fromDescendantPartial(v,u,f,n,i),a.push(d)}}return a}}]),e}(l);e.exports=p},{"../../event/EventType":148,"../../geometry/RTreePyramid":156,"../Renderer":178,"./TileRenderable":183}],185:[function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),s=function t(e,n,r){null===e&&(e=Function.prototype);var i=Object.getOwnPropertyDescriptor(e,n);if(void 0===i){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,r)}if("value"in i)return i.value;var a=i.get;if(void 0!==a)return a.call(r)},u=t("lodash/defaultTo"),l=t("../../event/EventType"),c=t("../../webgl/shader/Shader"),f=t("../../webgl/texture/TextureArray"),h=t("../../webgl/vertex/VertexAtlas"),p=t("./TileRenderer"),v=Symbol(),y=Symbol(),d=function(t,e){t.set(e.coord.hash,e.data)},m=function(t,e){t.delete(e.coord.hash)},b=function(t,e){t.set(e.coord.hash,e.data,e.data.length/t.stride)},g=function(t,e){t.delete(e.coord.hash)},_=function(t){function e(){r(this,e);var t=i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return t.gl=null,t[v]=new Map,t[y]=new Map,t}return o(e,t),a(e,[{key:"onAdd",value:function(t){return s(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"onAdd",this).call(this,t),this.gl=this.layer.plot.getRenderingContext(),this}},{key:"onRemove",value:function(t){return this.gl=null,s(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"onRemove",this).call(this,t),this}},{key:"getOrthoMatrix",value:function(){return this.layer.plot.getOrthoMatrix()}},{key:"createShader",value:function(t){return new c(this.gl,t)}},{key:"createTextureArray",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=new f(this.gl,{format:t.format,type:t.type,filter:t.filter,invertY:t.invertY,premultiplyAlpha:t.premultiplyAlpha},{numChunks:this.layer.pyramid.getCapacity(),chunkSize:t.chunkSize}),n=u(t.onAdd,d),r=u(t.onRemove,m),i=function(t){n(e,t.tile)},o=function(t){r(e,t.tile)};return this.layer.on(l.TILE_ADD,i),this.layer.on(l.TILE_REMOVE,o),this[v].set(e,i),this[y].set(e,o),e}},{key:"destroyTextureArray",value:function(t){this.layer.removeListener(l.TILE_ADD,this[v].get(t)),this.layer.removeListener(l.TILE_REMOVE,this[y].get(t)),this[v].delete(t),this[y].delete(t)}},{key:"createVertexAtlas",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=new h(this.gl,t.attributePointers,{numChunks:this.layer.pyramid.getCapacity(),chunkSize:t.chunkSize}),n=u(t.onAdd,b),r=u(t.onRemove,g),i=function(t){n(e,t.tile)},o=function(t){r(e,t.tile)};return this.layer.on(l.TILE_ADD,i),this.layer.on(l.TILE_REMOVE,o),this[v].set(e,i),this[y].set(e,o),e}},{key:"destroyVertexAtlas",value:function(t){this.layer.removeListener(l.TILE_ADD,this[v].get(t)),this.layer.removeListener(l.TILE_REMOVE,this[y].get(t)),this[v].delete(t),this[y].delete(t)}}]),e}(p);e.exports=_},{"../../event/EventType":148,"../../webgl/shader/Shader":194,"../../webgl/texture/TextureArray":198,"../../webgl/vertex/VertexAtlas":199,"./TileRenderer":184,"lodash/defaultTo":108}],186:[function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),s=function t(e,n,r){null===e&&(e=Function.prototype);var i=Object.getOwnPropertyDescriptor(e,n);if(void 0===i){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,r)}if("value"in i)return i.value;var a=i.get;if(void 0!==a)return a.call(r)},u=t("../../../webgl/vertex/VertexBuffer"),l={vert:"\n\t\tprecision highp float;\n\t\tattribute vec2 aPosition;\n\t\tattribute vec2 aTextureCoord;\n\t\tuniform vec4 uTextureCoordOffset;\n\t\tuniform vec2 uTileOffset;\n\t\tuniform float uScale;\n\t\tuniform mat4 uProjectionMatrix;\n\t\tvarying vec2 vTextureCoord;\n\t\tvoid main() {\n\t\t\tvTextureCoord = vec2(\n\t\t\t\tuTextureCoordOffset.x + (aTextureCoord.x * uTextureCoordOffset.z),\n\t\t\t\tuTextureCoordOffset.y + (aTextureCoord.y * uTextureCoordOffset.w));\n\t\t\tvec2 wPosition = (aPosition * uScale) + uTileOffset;\n\t\t\tgl_Position = uProjectionMatrix * vec4(wPosition, 0.0, 1.0);\n\t\t}\n\t\t",frag:"\n\t\tprecision highp float;\n\t\tuniform sampler2D uTextureSampler;\n\t\tuniform float uOpacity;\n\t\tvarying vec2 vTextureCoord;\n\t\tvoid main() {\n\t\t\tvec4 color = texture2D(uTextureSampler, vec2(vTextureCoord.x, 1.0 - vTextureCoord.y));\n\t\t\tgl_FragColor = vec4(color.rgb, color.a * uOpacity);\n\t\t}\n\t\t"},c=function(t,e,n){var r=new Float32Array(24);return r[0]=e,r[1]=e,r[2]=n,r[3]=e,r[4]=n,r[5]=n,r[6]=e,r[7]=e,r[8]=n,r[9]=n,r[10]=e,r[11]=n,r[12]=0,r[13]=0,r[14]=1,r[15]=0,r[16]=1,r[17]=1,r[18]=0,r[19]=0,r[20]=1,r[21]=1,r[22]=0,r[23]=1,new u(t,r,{0:{size:2,type:"FLOAT",byteOffset:0},1:{size:2,type:"FLOAT",byteOffset:48}},{count:6})},f=function(t){function e(){r(this,e);var t=i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return t.quad=null,t.shader=null,t.array=null,t}return o(e,t),a(e,[{key:"onAdd",value:function(t){return s(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"onAdd",this).call(this,t),this.quad=c(this.gl,0,t.plot.tileSize),this.shader=this.createShader(l),this.array=this.createTextureArray({chunkSize:t.plot.tileSize}),this}},{key:"onRemove",value:function(t){return this.destroyTextureArray(this.array),this.array=null,this.quad=null,this.shader=null,s(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"onRemove",this).call(this,t),this}},{key:"draw",value:function(){var t=this.gl,e=this.shader,n=this.array,r=this.quad,i=this.getRenderablesLOD(),o=this.getOrthoMatrix();e.use(),e.setUniform("uProjectionMatrix",o),e.setUniform("uTextureSampler",0),e.setUniform("uOpacity",this.layer.opacity),t.enable(t.BLEND),t.blendFunc(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA),r.bind();for(var a=0;a<i.length;a++){var s=i[a];n.bind(s.hash,0),e.setUniform("uTextureCoordOffset",s.uvOffset),e.setUniform("uScale",s.scale),e.setUniform("uTileOffset",s.tileOffset),r.draw()}return r.unbind(),this}}]),e}(t("../WebGLTileRenderer"));e.exports=f},{"../../../webgl/vertex/VertexBuffer":200,"../WebGLTileRenderer":185}],187:[function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),s=function t(e,n,r){null===e&&(e=Function.prototype);var i=Object.getOwnPropertyDescriptor(e,n);if(void 0===i){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,r)}if("value"in i)return i.value;var a=i.get;if(void 0!==a)return a.call(r)},u=t("lodash/defaultTo"),l=t("../../../webgl/vertex/VertexBuffer"),c={vert:"\n\t\tprecision highp float;\n\t\tattribute vec2 aPosition;\n\t\tattribute vec2 aOffset;\n\t\tattribute float aRadius;\n\t\tuniform vec2 uTileOffset;\n\t\tuniform float uScale;\n\t\tuniform mat4 uProjectionMatrix;\n\t\tvoid main() {\n\t\t\tvec2 wPosition = (aPosition * aRadius) + (aOffset * uScale) + uTileOffset;\n\t\t\tgl_Position = uProjectionMatrix * vec4(wPosition, 0.0, 1.0);\n\t\t}\n\t\t",frag:"\n\t\tprecision highp float;\n\t\tuniform vec4 uColor;\n\t\tvoid main() {\n\t\t\tgl_FragColor = uColor;\n\t\t}\n\t\t"},f=function(t){var e=2*Math.PI/5,n=e/2,r=e/4,i=new Float32Array(24);i[0]=0,i[1]=0;for(var o=0;o<5;o++){var a=o*e,s=.4*Math.cos(a-r),u=.4*Math.sin(a-r);i[4*o+2]=s,i[4*o+1+2]=u,s=1*Math.cos(a+n-r),u=1*Math.sin(a+n-r),i[4*o+2+2]=s,i[4*o+3+2]=u}return i[i.length-2]=i[2],i[i.length-1]=i[3],new l(t,i,{0:{size:2,type:"FLOAT"}},{mode:"TRIANGLE_FAN",count:i.length/2})},h=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r(this,e);var n=i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return n.color=u(t.color,[1,.4,.1,.8]),n.shape=null,n.shader=null,n.atlas=null,n}return o(e,t),a(e,[{key:"onAdd",value:function(t){return s(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"onAdd",this).call(this,t),this.shape=f(this.gl),this.shader=this.createShader(c),this.atlas=this.createVertexAtlas({chunkSize:16384,attributePointers:{1:{size:2,type:"FLOAT"},2:{size:1,type:"FLOAT"}}}),this}},{key:"onRemove",value:function(t){return this.destroyVertexAtlas(this.atlas),this.atlas=null,this.shape=null,this.shader=null,s(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"onRemove",this).call(this,t),this}},{key:"draw",value:function(){var t=this.gl,e=this.shader,n=this.atlas,r=this.shape,i=this.getRenderables(),o=this.getOrthoMatrix();t.enable(t.BLEND),t.blendFunc(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA),e.use(),e.setUniform("uProjectionMatrix",o),e.setUniform("uColor",this.color),r.bind(),n.bindInstanced();for(var a=0;a<i.length;a++){var s=i[a];e.setUniform("uScale",s.scale),e.setUniform("uTileOffset",s.tileOffset),n.drawInstanced(s.hash,r.mode,r.count)}return n.unbindInstanced(),r.unbind(),this}}]),e}(t("../WebGLTileRenderer"));e.exports=h},{"../../../webgl/vertex/VertexBuffer":200,"../WebGLTileRenderer":185,"lodash/defaultTo":108}],188:[function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),s=function t(e,n,r){null===e&&(e=Function.prototype);var i=Object.getOwnPropertyDescriptor(e,n);if(void 0===i){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,r)}if("value"in i)return i.value;var a=i.get;if(void 0!==a)return a.call(r)},u=t("lodash/defaultTo"),l=t("../../../geometry/CircleCollidable"),c=t("../../../webgl/vertex/VertexBuffer"),f={vert:"\n\t\tprecision highp float;\n\t\tattribute vec2 aPosition;\n\t\tattribute float aRadius;\n\t\tuniform float uRadiusOffset;\n\t\tuniform vec2 uTileOffset;\n\t\tuniform float uScale;\n\t\tuniform float uPixelRatio;\n\t\tuniform mat4 uProjectionMatrix;\n\t\tvoid main() {\n\t\t\tvec2 wPosition = (aPosition * uScale) + uTileOffset;\n\t\t\tgl_PointSize = (aRadius + uRadiusOffset) * uScale * 2.0 * uPixelRatio;\n\t\t\tgl_Position = uProjectionMatrix * vec4(wPosition, 0.0, 1.0);\n\t\t}\n\t\t",frag:"\n\t\t#ifdef GL_OES_standard_derivatives\n\t\t\t#extension GL_OES_standard_derivatives : enable\n\t\t#endif\n\t\tprecision highp float;\n\t\tuniform vec4 uColor;\n\t\tvoid main() {\n\t\t\tvec2 cxy = 2.0 * gl_PointCoord - 1.0;\n\t\t\tfloat radius = dot(cxy, cxy);\n\t\t\tfloat alpha = 1.0;\n\t\t\t#ifdef GL_OES_standard_derivatives\n\t\t\t\tfloat delta = fwidth(radius);\n\t\t\t\talpha = 1.0 - smoothstep(1.0 - delta, 1.0 + delta, radius);\n\t\t\t#else\n\t\t\t\tif (radius > 1.0) {\n\t\t\t\t\tdiscard;\n\t\t\t\t}\n\t\t\t#endif\n\t\t\tgl_FragColor = vec4(uColor.rgb, uColor.a * alpha);\n\t\t}\n\t\t"},h=function(t){var e=new Float32Array(2);return e[0]=0,e[1]=0,new c(t,e,{0:{size:2,type:"FLOAT"}},{mode:"POINTS",count:1})},p=function(t,e,n){for(var r=t.data,i=new Array(r.length/3),o=0;o<r.length;o+=3)i[o/3]=new l(r[o],r[o+1],r[o+2],e,n,t);return i},v=function(t,e,n,r){e.setUniform("uColor",r),e.setUniform("uRadiusOffset",0),t.bind();for(var i=0;i<n.length;i++){var o=n[i];e.setUniform("uScale",o.scale),e.setUniform("uTileOffset",o.tileOffset),t.draw(o.hash,"POINTS")}t.unbind()},y=function(t,e,n,r,i,o){var a=r.tile.coord,s=Math.pow(2,n.zoom-a.z),u=n.getViewportPixelOffset(),l=[(a.x*n.tileSize+r.x)*s-u.x,(a.y*n.tileSize+r.y)*s-u.y];e.setUniform("uTileOffset",l),e.setUniform("uScale",s),e.setUniform("uColor",i),e.setUniform("uRadiusOffset",o+r.radius),t.bind(),t.draw(),t.unbind()},d=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r(this,e);var n=i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return n.color=u(t.color,[1,.4,.1,.8]),n.shader=null,n.point=null,n.tree=null,n.atlas=null,n.ext=null,n}return o(e,t),a(e,[{key:"onAdd",value:function(t){return s(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"onAdd",this).call(this,t),this.ext=this.gl.getExtension("OES_standard_derivatives"),this.point=h(this.gl),this.shader=this.createShader(f),this.tree=this.createRTreePyramid({nodeCapacity:32,createCollidables:p}),this.atlas=this.createVertexAtlas({chunkSize:16384,attributePointers:{0:{size:2,type:"FLOAT"},1:{size:1,type:"FLOAT"}}}),this}},{key:"onRemove",value:function(t){return this.destroyVertexAtlas(this.atlas),this.destroyRTreePyramid(this.tree),this.atlas=null,this.shader=null,this.point=null,this.tree=null,this.ext=null,s(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"onRemove",this).call(this,t),this}},{key:"pick",value:function(t){return this.layer.plot.isZooming()?null:this.tree.searchPoint(t.x,t.y,this.layer.plot.zoom,this.layer.plot.getPixelExtent())}},{key:"draw",value:function(){var t=this,e=this.gl,n=this.layer,r=n.plot,i=this.getOrthoMatrix(),o=this.shader;r.renderBuffer.bind(),r.renderBuffer.clear(),e.enable(e.BLEND),e.blendFunc(e.SRC_ALPHA,e.ONE),o.use(),o.setUniform("uProjectionMatrix",i),o.setUniform("uPixelRatio",r.pixelRatio),v(this.atlas,o,this.getRenderables(),this.color),n.getSelected().forEach(function(e){y(t.point,o,r,e,t.color,4)});var a=n.getHighlighted();return a&&!n.isSelected(a)&&y(this.point,o,r,a,this.color,2),r.renderBuffer.unbind(),r.renderBuffer.blitToScreen(this.layer.opacity),this}}]),e}(t("../WebGLTileRenderer"));e.exports=d},{"../../../geometry/CircleCollidable":154,"../../../webgl/vertex/VertexBuffer":200,"../WebGLTileRenderer":185,"lodash/defaultTo":108}],189:[function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),s=function t(e,n,r){null===e&&(e=Function.prototype);var i=Object.getOwnPropertyDescriptor(e,n);if(void 0===i){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,r)}if("value"in i)return i.value;var a=i.get;if(void 0!==a)return a.call(r)},u=t("lodash/defaultTo"),l={vert:"\n\t\tprecision highp float;\n\t\tattribute vec2 aPosition;\n\t\tattribute float aRadius;\n\t\tuniform vec2 uTileOffset;\n\t\tuniform float uScale;\n\t\tuniform float uPixelRatio;\n\t\tuniform mat4 uProjectionMatrix;\n\t\tvoid main() {\n\t\t\tvec2 wPosition = (aPosition * uScale) + uTileOffset;\n\t\t\tgl_PointSize = aRadius * 2.0 * uPixelRatio;\n\t\t\tgl_Position = uProjectionMatrix * vec4(wPosition, 0.0, 1.0);\n\t\t}\n\t\t",frag:"\n\t\t#ifdef GL_OES_standard_derivatives\n\t\t\t#extension GL_OES_standard_derivatives : enable\n\t\t#endif\n\t\tprecision highp float;\n\t\tuniform vec4 uColor;\n\t\tvoid main() {\n\t\t\tvec2 cxy = 2.0 * gl_PointCoord - 1.0;\n\t\t\tfloat radius = dot(cxy, cxy);\n\t\t\tfloat alpha = 1.0;\n\t\t\t#ifdef GL_OES_standard_derivatives\n\t\t\t\tfloat delta = fwidth(radius);\n\t\t\t\talpha = 1.0 - smoothstep(1.0 - delta, 1.0 + delta, radius);\n\t\t\t#else\n\t\t\t\tif (radius > 1.0) {\n\t\t\t\t\tdiscard;\n\t\t\t\t}\n\t\t\t#endif\n\t\t\tgl_FragColor = vec4(uColor.rgb, uColor.a * alpha);\n\t\t}\n\t\t"},c=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r(this,e);var n=i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return n.color=u(t.color,[1,.4,.1,.8]),n.shader=null,n.atlas=null,n.ext=null,n}return o(e,t),a(e,[{key:"onAdd",value:function(t){return s(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"onAdd",this).call(this,t),this.ext=this.gl.getExtension("OES_standard_derivatives"),this.shader=this.createShader(l),this.atlas=this.createVertexAtlas({chunkSize:16384,attributePointers:{0:{size:2,type:"FLOAT"},1:{size:1,type:"FLOAT"}}}),this}},{key:"onRemove",value:function(t){return this.destroyVertexAtlas(this.atlas),this.atlas=null,this.shader=null,this.ext=null,s(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"onRemove",this).call(this,t),this}},{key:"draw",value:function(){var t=this.gl,e=this.shader,n=this.atlas,r=this.layer.plot,i=this.getRenderables(),o=this.getOrthoMatrix();r.renderBuffer.bind(),r.renderBuffer.clear(),t.enable(t.BLEND),t.blendFunc(t.SRC_ALPHA,t.ONE),e.use(),e.setUniform("uProjectionMatrix",o),e.setUniform("uColor",this.color),e.setUniform("uPixelRatio",r.pixelRatio),n.bind();for(var a=0;a<i.length;a++){var s=i[a];e.setUniform("uScale",s.scale),e.setUniform("uTileOffset",s.tileOffset),n.draw(s.hash,"POINTS")}return n.unbind(),r.renderBuffer.unbind(),r.renderBuffer.blitToScreen(this.layer.opacity),this}}]),e}(t("../WebGLTileRenderer"));e.exports=c},{"../WebGLTileRenderer":185,"lodash/defaultTo":108}],190:[function(t,e,n){"use strict";var r=(navigator&&navigator.userAgent||"").toLowerCase(),i=(navigator&&navigator.vendor||"").toLowerCase();e.exports={firefox:!!function(){return r.match(/(?:firefox|fxios)\/(\d+)/)}(),chrome:!!function(){return/google inc/.test(i)?r.match(/(?:chrome|crios)\/(\d+)/):null}(),ie:!!function(){return r.match(/(?:msie |trident.+?; rv:)(\d+)/)}(),edge:!!function(){return r.match(/edge\/(\d+)/)}(),opera:!!function(){return r.match(/(?:^opera.+?version|opr)\/(\d+)/)}(),safari:!!function(){return r.match(/version\/(\d+).+?safari/)}()}},{}],191:[function(t,e,n){"use strict";e.exports=function(t,e){var n=new XMLHttpRequest;n.open("GET",t,!0),n.responseType="arraybuffer",n.onload=function(){var t=n.response;if(t)e(null,t);else{var r="Unable to load ArrayBuffer from URL: `"+event.path[0].currentSrc+"`";e(r,null)}},n.onerror=function(t){var n="Unable to load ArrayBuffer from URL: `"+t.path[0].currentSrc+"`";e(n,null)},n.withCredentials=!0,n.send(null)}},{}],192:[function(t,e,n){"use strict";e.exports=function(t,e){var n=new Image;n.onload=function(){e(null,n)},n.onerror=function(t){var n="Unable to load image from URL: `"+t.path[0].currentSrc+"`";e(n,null)},n.crossOrigin="anonymous",n.src=t}},{}],193:[function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=t("./texture/Texture"),a=t("./shader/Shader"),s=t("./vertex/VertexBuffer"),u={vert:"\n\t\tprecision highp float;\n\t\tattribute vec3 aVertexPosition;\n\t\tattribute vec2 aTextureCoord;\n\t\tvarying vec2 vTextureCoord;\n\t\tvoid main(void) {\n\t\t\tvTextureCoord = aTextureCoord;\n\t\t\tgl_Position = vec4(aVertexPosition, 1.0);\n\t\t}\n\t\t",frag:"\n\t\tprecision highp float;\n\t\tuniform float uOpacity;\n\t\tuniform sampler2D uTextureSampler;\n\t\tvarying vec2 vTextureCoord;\n\t\tvoid main(void) {\n\t\t\tvec4 color = texture2D(uTextureSampler, vTextureCoord);\n\t\t\tgl_FragColor = vec4(color.rgb, color.a * uOpacity);\n\t\t}\n\t\t"},l=function(t,e,n){var r=new Float32Array(24);return r[0]=e,r[1]=e,r[2]=n,r[3]=e,r[4]=n,r[5]=n,r[6]=e,r[7]=e,r[8]=n,r[9]=n,r[10]=e,r[11]=n,r[12]=0,r[13]=0,r[14]=1,r[15]=0,r[16]=1,r[17]=1,r[18]=0,r[19]=0,r[20]=1,r[21]=1,r[22]=0,r[23]=1,new s(t,r,{0:{size:2,type:"FLOAT",byteOffset:0},1:{size:2,type:"FLOAT",byteOffset:48}},{count:6})},c=function(t,e,n,r){t.bindFramebuffer(t.FRAMEBUFFER,e),t.framebufferTexture2D(t.FRAMEBUFFER,t["COLOR_ATTACHMENT"+r],t.TEXTURE_2D,n.texture,0),t.bindFramebuffer(t.FRAMEBUFFER,null)},f=function(t,e,n,r,i){n.use(),t.enable(t.BLEND),t.blendFunc(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA),n.setUniform("uOpacity",i),n.setUniform("uTextureSampler",0),e.bind(0),r.bind(),r.draw(),r.unbind()},h=function(){function t(e,n,i){r(this,t),this.gl=e,this.framebuffer=e.createFramebuffer(),this.shader=new a(e,u),this.quad=l(e,-1,1),this.texture=new o(e,null,{width:n,height:i,filter:"NEAREST",invertY:!1,premultiplyAlpha:!1}),c(this.gl,this.framebuffer,this.texture,0)}return i(t,[{key:"bind",value:function(){var t=this.gl;return t.bindFramebuffer(t.FRAMEBUFFER,this.framebuffer),this}},{key:"unbind",value:function(){var t=this.gl;return t.bindFramebuffer(t.FRAMEBUFFER,null),this}},{key:"clear",value:function(){return this.gl.clearColor(0,0,0,0),this.gl.clear(this.gl.COLOR_BUFFER_BIT),this}},{key:"blitToScreen",value:function(t){return f(this.gl,this.texture,this.shader,this.quad,t),this}},{key:"resize",value:function(t,e){return this.texture.resize(t,e),this}}]),t}();e.exports=h},{"./shader/Shader":194,"./texture/Texture":197,"./vertex/VertexBuffer":200}],194:[function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=t("lodash/map"),a=t("./parseShader"),s={bool:"uniform1i","bool[]":"uniform1iv",float:"uniform1f","float[]":"uniform1fv",int:"uniform1i","int[]":"uniform1iv",uint:"uniform1i","uint[]":"uniform1iv",vec2:"uniform2fv","vec2[]":"uniform2fv",ivec2:"uniform2iv","ivec2[]":"uniform2iv",vec3:"uniform3fv","vec3[]":"uniform3fv",ivec3:"uniform3iv","ivec3[]":"uniform3iv",vec4:"uniform4fv","vec4[]":"uniform4fv",ivec4:"uniform4iv","ivec4[]":"uniform4iv",mat2:"uniformMatrix2fv","mat2[]":"uniformMatrix2fv",mat3:"uniformMatrix3fv","mat3[]":"uniformMatrix3fv",mat4:"uniformMatrix4fv","mat4[]":"uniformMatrix4fv",sampler2D:"uniform1i",samplerCube:"uniform1i"},u=function(t,e,n){a([e,n],["uniform","attribute"]).forEach(function(e){if("attribute"===e.qualifier)t.attributes.set(e.name,{type:e.type,index:t.attributes.size});else{var n=e.type+(e.count>1?"[]":"");t.uniforms.set(e.name,{type:e.type,func:s[n]})}})},l=function(t,e){var n=e-(t=t.toString()).length;t+=":";for(var r=0;r<n;r++)t+=" ";return t},c=function(t,e,n){var r=t.createShader(t[n]);if(t.shaderSource(r,e),t.compileShader(r),!t.getShaderParameter(r,t.COMPILE_STATUS)){var i=e.split("\n"),o=i.length.toString().length+1,a=i.map(function(t,e){return l(e+1,o)+" "+t}).join("\n"),s=t.getShaderInfoLog(r);throw"An error occurred compiling the shader:\n\n"+s.slice(0,s.length-1)+"\n"+a}return r},f=function(t){var e=t.gl;t.attributes.forEach(function(n,r){e.bindAttribLocation(t.program,n.index,r)})},h=function(t){var e=t.gl,n=t.uniforms;n.forEach(function(r,i){var o=e.getUniformLocation(t.program,i);null===o?n.delete(i):r.location=o})},p=function(t){return o(t,function(t,e){return"#define "+e+" "+t}).join("\n")},v=function(t,e){var n=t.gl,r=p(e.define)+(e.common||""),i=r+e.vert,o=r+e.frag,a=c(n,i,"VERTEX_SHADER"),s=c(n,o,"FRAGMENT_SHADER");if(u(t,i,o),t.program=n.createProgram(),n.attachShader(t.program,a),n.attachShader(t.program,s),f(t),n.linkProgram(t.program),!n.getProgramParameter(t.program,n.LINK_STATUS))throw"An error occured linking the shader:\n"+n.getProgramInfoLog(t.program);h(t)},y=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(r(this,t),!n.vert)throw"Vertex shader argument `vert` has not been provided";if(!n.frag)throw"Fragment shader argument `frag` has not been provided";this.gl=e,this.program=null,this.attributes=new Map,this.uniforms=new Map,v(this,n)}return i(t,[{key:"use",value:function(){return this.gl.useProgram(this.program),this}},{key:"setUniform",value:function(t,e){var n=this.uniforms.get(t);if(!n)throw"No uniform found under name `"+t+"`";if(void 0===e||null===e)throw"Value passed for uniform `"+t+"` is undefined or null";return"mat2"===n.type||"mat3"===n.type||"mat4"===n.type?this.gl[n.func](n.location,!1,e):this.gl[n.func](n.location,e),this}}]),t}();e.exports=y},{"./parseShader":195,"lodash/map":126}],195:[function(t,e,n){"use strict";var r=t("./preprocess"),i=/(\/\*([\s\S]*?)\*\/)|(\/\/(.*)$)/gm,o=/(\r\n|\n|\r)/gm,a=/\s{2,}/g,s=/(\s*)(\[)(\s*)(\d+)(\s*)(\])(\s*)/g,u=/([a-zA-Z_][a-zA-Z0-9_]*)(?:\[(\d+)\])?/,l=/\bprecision\s+\w+\s+\w+;/g,c=/\b(highp|mediump|lowp)\s+/g,f=function(t){return t.replace(i,"")},h=function(t){return t.replace(l,"").replace(c,"")},p=function(t){return t.replace(o," ").replace(a," ").replace(s,"$2$4$6")},v=function(t,e,n){var r=n.match(u);return{qualifier:t,type:e,name:r[1],count:void 0===r[2]?1:parseInt(r[2],10)}},y=function(t){var e=t.split(",").map(function(t){return t.trim()}),n=e.shift().split(" "),r=n.shift(),i=n.shift();return n.concat(e).map(function(t){return v(r,i,t)})},d=function(t,e){var n=t.split(";"),r=e.join("|"),i=new RegExp("\\b("+r+")\\b.*"),o=[];return n.forEach(function(t){var e=t.match(i);e&&(o=o.concat(y(e[0])))}),o},m=function(t){var e={};return t.filter(function(t){return!e[t.name]&&(e[t.name]=!0,!0)})};e.exports=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(0===t.length||0===e.length)return[];t=Array.isArray(t)?t:[t],e=Array.isArray(e)?e:[e];var n=[];return t.forEach(function(t){t=f(t),t=r(t),t=h(t),t=p(t),n=n.concat(d(t,e))}),m(n)}},{"./preprocess":196}],196:[function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o="__DEFINED__",a=/#define\b/i,s=/#undef\b/i,u=/#if\b/i,l=/#ifdef\b/i,c=/#ifndef\b/i,f=/#else\b/i,h=/#elif\b/i,p=/#endif\b/i,v=/#define\s+(\w+)(\s(\w*)?)?/i,y=/#undef\s+(\w+)/i,d=/#if\s+\(?\s*(!?\s*\w+)\s*(==|!=|>=|<=|<|<|>)?\s*(\w*)\s*\)?/i,m=/#ifdef\s+(\w+)/i,b=/#ifndef\s+(\w+)/i,g=/#elif\s+\(?\s*(!?\s*\w+)\s*(==|!=|>=|<=|<|<|>)?\s*(\w*)\s*\)?/i,_=/#([\W\w\s\d])(?:.*\\r?\n)*.*$/gm,x=function(t,e,n){if(void 0===e)return"!"===t[0]?!("true"===t||t>=1):"true"===t||t>=1;switch(e){case"==":return t===n;case"!=":return t!==n;case">":return t>n;case">=":return t>=n;case"<":return t<n;case"<=":return t<=n}throw"Unrecognized logical operator `"+e+"`"},w=function(){function t(e,n){r(this,t),this.type=e,this.conditional=n.trim(),this.body=[],this.children=[]}return i(t,[{key:"eval",value:function(){var t=void 0;switch(this.type){case"if":return t=d.exec(this.conditional),x(t[1],t[2],t[3]);case"ifdef":return(t=m.exec(this.conditional))[1]===o;case"ifndef":return(t=b.exec(this.conditional))[1]!==o;case"elif":return t=g.exec(this.conditional),x(t[1],t[2],t[3])}throw"Unrecognized conditional type `"+this.type+"`"}}]),t}(),O=function(){function t(e,n,i){r(this,t),this.if=new w(e,n),this.elif=[],this.else=null,this.parent=null,this.current=this.if,this.startLine=i,this.endLine=null}return i(t,[{key:"addElse",value:function(t){this.current=new w("else",t),this.else=this.current}},{key:"addElif",value:function(t){this.current=new w("elif",t),this.elif.push(this.current)}},{key:"addBody",value:function(t,e){this.current.body.push({string:t.trim(),line:e})}},{key:"nest",value:function(t){t.parent=this,this.current.children.push(t)}},{key:"extract",value:function(){var t=[];if(this.if.eval())return t=t.concat(this.if.body),this.if.children.forEach(function(e){t=t.concat(e.extract())}),t;for(var e=0;e<this.elif.length;e++){var n=this.elif[e];if(n.eval()){t=t.concat(n.body);for(var r=0;r<n.children.length;r++){var i=n.children[r];t=t.concat(i.extract())}return t}}return this.else?(t=t.concat(this.else.body),this.else.children.forEach(function(e){t=t.concat(e.extract())}),t):[]}},{key:"eval",value:function(){return this.extract().sort(function(t,e){return t.line-e.line}).map(function(t){return t.string}).join("\n")}}]),t}(),E=function(t){var e=[],n=null;if(t.forEach(function(t,r){if(t.match(u)){var i=new O("if",t,r);n?n.nest(i):e.push(i),n=i}else if(t.match(l)){var o=new O("ifdef",t,r);n?n.nest(o):e.push(o),n=o}else if(t.match(c)){var a=new O("ifndef",t,r);n?n.nest(a):e.push(a),n=a}else if(t.match(h)){if(!n)throw"Invalid preprocessor syntax, unexpected `#elif`";n.addElif(t)}else if(t.match(f)){if(!n)throw"Invalid preprocessor syntax, unexpected `#else`";n.addElse(t)}else if(t.match(p)){if(!n)throw"Invalid preprocessor syntax, unexpected `#endif`";n.endLine=r,n=n.parent}else n&&n.addBody(t,r)}),n)throw"Invalid preprocessor syntax, missing expected `#endif`";return e},T=function(t){var e=new Map,n=[];return t.forEach(function(t){if(t.match(a)){var r=v.exec(t);e.set(r[1],r[2]||o)}else if(t.match(s)){var i=y.exec(t);e.delete(i[1])}else if(t.match(l)){var u=m.exec(t);e.has(u[1])&&(t=t.replace(u[1],o)),n.push(t)}else if(t.match(c)){var f=b.exec(t);e.has(f[1])&&(t=t.replace(f[1],o)),n.push(t)}else e.forEach(function(e,n){t=t.replace(n,e)}),n.push(t)}),n};e.exports=function(t){var e=t.split("\n");e=T(e);for(var n=E(e),r=n.length-1;r>=0;r--){var i=n[r],o=i.eval();o.length>0?e.splice(i.startLine,i.endLine-i.startLine+1,o):e.splice(i.startLine,i.endLine-i.startLine+1)}return e.join("\n").replace(_,"")}},{}],197:[function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=t("lodash/defaultTo"),a=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};r(this,t),this.gl=e,this.texture=e.createTexture(),this.format=o(i.format,"RGBA"),this.type=o(i.type,"UNSIGNED_BYTE"),this.filter=o(i.filter,"LINEAR"),this.wrap=o(i.wrap,"CLAMP_TO_EDGE"),this.invertY=o(i.invertY,!1),this.premultiplyAlpha=o(i.premultiplyAlpha,!1),this.bufferData(n,i.width,i.height),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e[this.wrap]),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e[this.wrap]),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e[this.filter]),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e[this.filter])}return i(t,[{key:"bind",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=this.gl;return e.activeTexture(e["TEXTURE"+t]),e.bindTexture(e.TEXTURE_2D,this.texture),this}},{key:"unbind",value:function(){var t=this.gl;return t.bindTexture(t.TEXTURE_2D,null),this}},{key:"bufferData",value:function(t,e,n){var r=this.gl;return r.bindTexture(r.TEXTURE_2D,this.texture),r.pixelStorei(r.UNPACK_FLIP_Y_WEBGL,this.invertY),r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,this.premultiplyAlpha),t&&t.width&&t.height?(this.width=t.width,this.height=t.height,r.texImage2D(r.TEXTURE_2D,0,r[this.format],r[this.format],r[this.type],t)):(this.width=e||this.width,this.height=n||this.height,r.texImage2D(r.TEXTURE_2D,0,r[this.format],this.width,this.height,0,r[this.format],r[this.type],t)),this}},{key:"bufferSubData",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:void 0,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:void 0,o=this.gl;return o.bindTexture(o.TEXTURE_2D,this.texture),o.pixelStorei(o.UNPACK_FLIP_Y_WEBGL,this.invertY),o.pixelStorei(o.UNPACK_PREMULTIPLY_ALPHA_WEBGL,this.premultiplyAlpha),t.width&&t.height?o.texSubImage2D(o.TEXTURE_2D,0,e,n,o[this.format],o[this.type],t):o.texSubImage2D(o.TEXTURE_2D,0,e,n,r,i,o[this.format],o[this.type],t),this}},{key:"resize",value:function(t,e){return this.bufferData(null,t,e),this}}]),t}();e.exports=a},{"lodash/defaultTo":108}],198:[function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=t("lodash/defaultTo"),a=function(t,e,n,r,i,o,a,s){var u=t.createTexture();return t.bindTexture(t.TEXTURE_2D,u),t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,a),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,s),t.texImage2D(t.TEXTURE_2D,0,t[e],n,n,0,t[e],t[r],null),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t[o]),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t[o]),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t[i]),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t[i]),u},s=function(){function t(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1];var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};r(this,t),this.gl=e,this.chunkSize=o(n.chunkSize,256),this.numChunks=o(n.numChunks,256),this.format=o(n.format,"RGBA"),this.type=o(n.type,"UNSIGNED_BYTE"),this.filter=o(n.filter,"LINEAR"),this.wrap=o(n.wrap,"CLAMP_TO_EDGE"),this.invertY=o(n.invertY,!1),this.premultiplyAlpha=o(n.premultiplyAlpha,!1),this.available=new Array(this.numChunks);for(var i=0;i<this.numChunks;i++)this.available[i]={texture:a(this.gl,this.format,this.chunkSize,this.type,this.filter,this.wrap,this.invertY,this.premultiplyAlpha)};this.used=new Map}return i(t,[{key:"has",value:function(t){return this.used.has(t)}},{key:"get",value:function(t){return this.used.get(t)}},{key:"set",value:function(t,e){if(this.has(t))throw"Tile of coord "+t+" already exists in the array";if(0===this.available.length)throw"No available texture chunks in array";var n=this.available.pop(),r=this.gl;r.bindTexture(r.TEXTURE_2D,n.texture),r.pixelStorei(r.UNPACK_FLIP_Y_WEBGL,this.invertY),r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,this.premultiplyAlpha),e.width&&e.height?r.texImage2D(r.TEXTURE_2D,0,r[this.format],r[this.format],r[this.type],e):r.texImage2D(r.TEXTURE_2D,0,r[this.format],this.chunkSize,this.chunkSize,0,r[this.format],r[this.type],e),this.used.set(t,n)}},{key:"delete",value:function(t){if(!this.has(t))throw"Tile of coord "+t+" does not exist in the array";var e=this.used.get(t);return this.used.delete(t),this.available.push(e),this}},{key:"bind",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(!this.has(t))throw"Tile of coord "+t+" does not exist in the array";var n=this.gl,r=this.used.get(t);return n.activeTexture(n["TEXTURE"+e]),n.bindTexture(n.TEXTURE_2D,r.texture),this}},{key:"unbind",value:function(){return this}}]),t}();e.exports=s},{"lodash/defaultTo":108}],199:[function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=t("lodash/defaultTo"),a=t("lodash/forIn"),s={BYTE:1,UNSIGNED_BYTE:1,SHORT:2,UNSIGNED_SHORT:2,FIXED:4,FLOAT:4},u=function(t,e){var n=0;return t.forEach(function(t){n+=s[t.type]*t.size*e}),n},l=function(t,e,n){var r=0;e.forEach(function(e,i){t.byteOffsets[i]=n+r,r+=s[e.type]*e.size})},c=function(t){var e=0;return t.forEach(function(t){e+=t.size}),e},f=function(t){var e=new Map,n=0;return a(t,function(t,r){e.set(r,{type:t.type,size:t.size,byteOffset:n,byteStride:0}),n+=s[t.type]*t.size}),e.forEach(function(t){t.byteStride=n}),e},h=function(){function t(e,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(r(this,t),this.gl=e,this.ext=e.getExtension("ANGLE_instanced_arrays"),!this.ext)throw"ANGLE_instanced_arrays WebGL extension is not supported";if(this.chunkSize=o(i.chunkSize,16384),this.numChunks=o(i.numChunks,256),!n)throw"No attribute pointers provided";this.pointers=f(n),this.stride=c(this.pointers),this.available=new Array(this.numChunks);for(var a=u(this.pointers,this.chunkSize),s=0;s<this.numChunks;s++){var h=s*a,p={count:0,chunkOffset:s*this.chunkSize,chunkByteOffset:h,byteOffsets:{}};l(p,this.pointers,h),this.available[s]=p}this.used=new Map,this.buffer=e.createBuffer();var v=a*this.numChunks;e.bindBuffer(e.ARRAY_BUFFER,this.buffer),e.bufferData(e.ARRAY_BUFFER,v,e.DYNAMIC_DRAW)}return i(t,[{key:"has",value:function(t){return this.used.has(t)}},{key:"get",value:function(t){return this.used.get(t)}},{key:"set",value:function(t,e,n){if(this.has(t))throw"Tile of coord "+t+" already exists in the atlas";if(0===this.available.length)throw"No available vertex chunks in atlas";if(n>this.chunkSize)throw"Data count of "+n+" is greater that allocated size of "+this.chunkSize;var r=this.available.pop();if(r.count=n,n>0){var i=this.gl;i.bindBuffer(i.ARRAY_BUFFER,this.buffer),i.bufferSubData(i.ARRAY_BUFFER,r.chunkByteOffset,e)}this.used.set(t,r)}},{key:"delete",value:function(t){if(!this.has(t))throw"Tile of coord "+t+" does not exist in the atlas";var e=this.used.get(t);return this.used.delete(t),this.available.push(e),this}},{key:"bind",value:function(){var t=this.gl;return t.bindBuffer(t.ARRAY_BUFFER,this.buffer),this.pointers.forEach(function(e,n){t.enableVertexAttribArray(n),t.vertexAttribPointer(n,e.size,t[e.type],!1,e.byteStride,e.byteOffset)}),this}},{key:"bindInstanced",value:function(){var t=this.gl,e=this.ext;return t.bindBuffer(t.ARRAY_BUFFER,this.buffer),this.pointers.forEach(function(n,r){t.enableVertexAttribArray(r),e.vertexAttribDivisorANGLE(r,1)}),this}},{key:"unbind",value:function(){var t=this.gl;return this.pointers.forEach(function(e,n){t.disableVertexAttribArray(n)}),this}},{key:"unbindInstanced",value:function(){var t=this.gl,e=this.ext;return this.pointers.forEach(function(n,r){t.disableVertexAttribArray(r),e.vertexAttribDivisorANGLE(r,0)}),this}},{key:"draw",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;if(!this.has(t))throw"Tile of coord "+t+" does not exist in the atlas";var i=this.gl,o=this.used.get(t);o.count>0&&i.drawArrays(i[e],o.chunkOffset+n,r||o.count)}},{key:"drawInstanced",value:function(t,e,n){if(!this.has(t))throw"Tile of coord "+t+" does not exist in the atlas";var r=this.gl,i=this.ext,o=this.used.get(t);this.pointers.forEach(function(t,e){r.vertexAttribPointer(e,t.size,r[t.type],!1,t.byteStride,o.byteOffsets[e])}),o.count>0&&i.drawArraysInstancedANGLE(r[e],0,n,o.count)}}]),t}();e.exports=h},{"lodash/defaultTo":108,"lodash/forIn":110}],200:[function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=t("lodash/defaultTo"),a=t("lodash/forIn"),s={BYTE:1,UNSIGNED_BYTE:1,SHORT:2,UNSIGNED_SHORT:2,FIXED:4,FLOAT:4},u=function(t){if(1===t.size)return 0;var e=0,n=0,r=0;return t.forEach(function(t){var i=t.byteOffset,o=t.size,a=t.type;n+=o*s[a],i>e&&(e=i,r=i+o*s[a])}),e>=n?0:r},l=function(t){var e=new Map;return a(t,function(t,n){var r=parseInt(n,10);t.byteOffset=o(t.byteOffset,0),e.set(r,t)}),e},c=function(){function t(e,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};r(this,t),this.gl=e,this.mode=o(a.mode,"TRIANGLES"),this.count=o(a.count,0),this.indexOffset=o(a.indexOffset,0),this.pointers=l(i),this.byteStride=u(this.pointers),n instanceof WebGLBuffer?this.buffer=n:(this.buffer=e.createBuffer(),n&&this.bufferData(n))}return i(t,[{key:"bufferData",value:function(t){var e=this.gl;e.bindBuffer(e.ARRAY_BUFFER,this.buffer),e.bufferData(e.ARRAY_BUFFER,t,e.STATIC_DRAW)}},{key:"bufferSubData",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this.gl;return n.bindBuffer(n.ARRAY_BUFFER,this.buffer),n.bufferSubData(n.ARRAY_BUFFER,e,t),this}},{key:"bind",value:function(){var t=this,e=this.gl;return e.bindBuffer(e.ARRAY_BUFFER,this.buffer),this.pointers.forEach(function(n,r){e.vertexAttribPointer(r,n.size,e[n.type],!1,t.byteStride,n.byteOffset),e.enableVertexAttribArray(r)}),this}},{key:"unbind",value:function(){var t=this.gl;return this.pointers.forEach(function(e,n){t.disableVertexAttribArray(n)}),this}},{key:"draw",value:function(){var t=this.gl;return t.drawArrays(t[this.mode],this.indexOffset,this.count),this}}]),t}();e.exports=c},{"lodash/defaultTo":108,"lodash/forIn":110}]},{},[152])(152)});